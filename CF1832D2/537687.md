看到“最小值的最大值”，考虑二分答案 $x$，判断能否在恰好 $k$ 次内将最小值变为 $x$。

将 $a$ 升序排序，看一下有多少个数小于 $x$，记个数为 $c$。$x$ 可才是最终序列最小值，所以要把这些小于 $x$ 的给消灭掉，具体就是给最小的加上一次最大的操作，即进行操作使之变为 $a'_1=a_1+k,a'_2=a_2+k-1,\cdots,a'_c=a_c+k-c+1$。

但如果都这么做了，还是无法避免出现小于 $x$ 的元素，那么就无解。

否则，还要用掉 $k-c$ 次操作，可以发现给一个数连续操作两次会让其 $-1$，所以把操作那前 $c$ 个数，因为我们刚刚粗略地操作后会让数大于 $x$，实际上让数与 $x$ 齐平即可，所以看看超出了 $x$ 多少，超了多少就连续两次操作多少次。

记 $s=\sum_{i=1}^ca'_i-x$，那么可以操作 $s\times 2$ 次。

再看看这 $k-c-s\times 2$ 次操作，记该数为 $h$。

- 如果 $n=c$，已经无数可操作，无解。

- 如果 $h$ 是奇数，那么全加在一个数上，由于操作数是奇数所以这个数一定是变大的。

- 如果 $h$ 是偶数，如果 $n-c\ge2$，那么把 $h$ 分成两个奇数，选两个数分别加奇数次

- 否则，将这 $h$ 次操作搞在最大的 $a_n$ 上，即看看 $a_n-\frac{h}{2}$ 是不是 $\ge x$。