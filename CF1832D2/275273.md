首先，如果一个点变成蓝色，在下一次立刻把它变成红色最优。这样对这个点造成的影响是减 $1$。直观感受一下，这样能最小化损失。并且在最后几次操作，可以把大部分甚至所有点变成蓝色。具体地，特判 $m \le n$ 的情况后，如果 $m$ 和 $n$ 奇偶性相同，最后 $n$ 次操作会把所有点变成蓝色，否则最后 $n - 1$ 次操作会把其中 $n - 1$ 个点变成蓝色。

考虑二分。设二分最小值为 $x$。首先可以确定最后 $n$ 或 $n - 1$ 次操作的对象，一定是让最小值加 $m$，次小值加 $m - 1$，以此类推。所以可以先对原数组排序，然后根据奇偶性分类讨论。

- 如果 $m,n$ 奇偶性相同，如果 $\min\limits_{i=1}^n a_i + m - i + 1 - x < 0$ 就寄了，因为就算对这个值不进行减 $1$，它都无法达到 $x$；然后如果 $\sum\limits_{i=1}^n a_i + m - i + 1 - x < \frac{m - n}{2}$ 也寄了，因为需要 $\frac{m - n}{2}$ 次对其中某个元素减 $1$，如果满足这个条件就不够减；否则可行。

- 如果 $m,n$ 奇偶性不同，最后会剩一个值加不了。这个值取 $a_n$ 显然最优。在接下来的判断需要对 $a_n$ 特殊处理。如果 $a_n < x$ 或者 $\min\limits_{i=1}^{n-1} a_i + m - i + 1 - x < 0$ 或者 $a_n - x + \sum\limits_{i=1}^{n-1} a_i + m - i + 1 - x < \frac{m - (n - 1)}{2}$ 就寄了，否则可行。

直接暴力判断可以[通过 D1](https://codeforces.com/contest/1832/submission/206414836)。考虑优化。发现要判断的值只与 $\sum\limits_{i=1}^n a_i - i$ 和 $\min\limits_{i=1}^n a_i - i$ 有关，可以做到 $O(1)$ 判断。~~但是我急急忙忙敲了个整体二分才发现（~~

[这个](https://codeforces.com/contest/1832/submission/206416183)是整体二分的实现。