由 `D1` 的结论，将最后 $n$ 个操作倒序加入原数组，然后每个数用偶数次操作，每两次操作 $-1$，最后可能剩下一个操作，加到最大数上。

感性理解，由于要使得最后的操作是 $+$，那么前面一定是 $+-+-+-$ 排列的，那么每次 $-1$ 最优。

考虑二分答案。

考虑“最后 $n$ 个操作倒序加入原数组”的操作，记 $a_i'$ 为 $a_i+k-i+1$，则 $a_i$ 变为 $a_i'$。

记 $<x$ 的数有 $c$ 个，如果 $\min_{j=1}^{c}a_j'<x$，那么无解。

否则，用掉 $c$ 次操作，剩下 $k-c$ 次，设 $s=\sum_{j=1}^{c}a_j'$，则前 $c$ 个数可消耗掉 $2s$ 次操作，那么剩下 $k-c-2s$ 次操作分给后面 $n-c$ 个数。

如果 $n-c=0$，无解。

如果 $k-c-2s$ 为奇数，那么全部分给一个数，显然增加，必然有解。

如果 $n-c\ge 2$，那么选择两个数分别操作奇数次，由上，必然有解。

否则，剩下偶数次操作，只能分给一个数，那么 $a_n$ 必须减去 $\frac{k-c-2s}{2}$，判断是否 $\ge x$ 即可。

时间复杂度 $\mathcal O(q\log k)$。