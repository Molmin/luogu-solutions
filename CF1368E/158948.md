这道题好像没这么神，虽然我没想到但还是很套路。

首先构造题肯定是按要求完成，要求每条路径只有一条边。

由于这是个拓扑图，为了方便，先设每个点有个深度 $dp_x$。

我们规定由 $x\to y$ 的边一定满足 $dp_y=dp_x+1$，同时我们规定当其中有点被删掉时这个条件可以失效。

初始有没有被指向的点，它们的深度为 $1$，由它们指出去的点应该有深度为 $2$ 的点。

但肯定不是所有都是，因为有一些会被删掉。

由于我们希望达到一个构造下界，所有我们肯定能不删就不删。

如果一个深度为 $2$ 的点指向了一个点，那么这个点必定被删掉。

而一个点肯定不能随便成为一个深度为 $2$ 的点，考虑这个图的特性，这是个拓扑图。

所以当拓扑序比它小的点都确定了，并且有深度为 $1$ 指向它的时候，它就会成为深度为 $2$ 点。

被删掉的点看作深度为 $3$，它们指向的点拓扑序都更大，可能是深度为 $2$，也有可能深度未定。

同理，当拓扑序比它小的点都确定了，并且有深度为 $3$ 指向这些深度未定的点时其深度为 $4$。

不难发现它们与深度为 $1$ 的点类似，因为深度为 $3$ 的点已经被删掉，它们的边可以看作不存在，就可以看作没有被点指向。

于是按照 $dp_x\bmod 3$ 的循环构造即可。

最后来证明这个下界是多少：令 $c_x$ 为深度为 $x$ 的点的个数。

显然有 $\forall x\bmod3\neq0,2c_x\ge c_{x+1}$，因为每个点只有两条出边，而有的出边可能指向同一个点。

故有 $\forall k\in N,4c_{3k+1}\ge2c_{3k+2}\ge c_{3k+3}$。

解一下就知道 $\sum c_{3k+3}\le \frac47 n$，故这样构造满足题意。