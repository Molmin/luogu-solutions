### 前言：

[$ \large{}\color {#6495ED} \mathcal{MyBlog} $](https://xjx885.coding-pages.com/)


---

#### update：（第一次食用本题解时，请略过）

①（感谢@YoOXiii的提醒）

在原题解中，当$a^{2}-4b>0$时，

判断$(2x-2y+a)$是否大于0是没有必要的的...

因为$(2x-2y+a)$实际上就等于j，而枚举j的时候已经保证j是正数了

②（感谢@Y15BeTa的提醒）

在原题解中，我认为$(2x+2y+a)$恒大于0

实际上它是可以等于0的

---

### 题目大意：

已知方程$y ^{2}-x ^{2}=ax+b$

给定整数a和b，求满足方程的自然数x,y的对数

数据范围：$a<= 10^{8} ,  b <=10^{15}$

---

### 题目分析：

显然，按照原方程直接枚举x,y是不可靠的...

因为我们枚举的上界过大...

我们可以对方程进行一些处理..

原式:

$$y ^{2}-x ^{2}=ax+b$$

把含x的项移到一边，配方得：

$$(x+\frac{1}{2}a) ^{2}+b-\frac{1}{4}a^{2}=y ^{2}$$

把x,y移到一边，a,b移到另一边，得：

$$(x+\frac{1}{2}a) ^{2}-y ^{2}=\frac{1}{4}a^{2}-b$$

左边用平方差公式，得：

$$(x+\frac{1}{2}a+y)*(x+\frac{1}{2}a-y)=\frac{1}{4}a^{2}-b$$

左右同乘4得：

$$(2x+2y+a)*(2x-2y+a)=a^{2}-4b$$

分析这个式子，式子右边是一个定值，左边是两个数的乘积

其中$(2x+2y+a)$ 恒大于等于0

所以我们可以讨论$a^{2}-4b$的大小

---
---

#### 当$a^{2}-4b<0$时，$(2x-2y+a)<0$  --- ①

左右同乘-1，有：

$$(2y+2x+a)*(2y-2x-a)=4b-a^{2}$$

设

$$i=2y+2x+a , j=2y-2x-a  (i>j>0)$$

很明显，将$4b-a^{2}$分解为两数之积可以得到一组$i,j$

又有

$$i+j=4y , i-j-2a=4x$$

故枚举$j$，算出$i$，再算出$x,y$

判断$x,y$是否是自然数即可

---

#### 当$a^{2}-4b>0$时，推断方法一样，此处略去

---

#### 当$a^{2}-4b=0$时，$2x-2y+a=0$

由$a^{2}-4b=0$可推知，$a$是个偶数（这个就不用我证了吧...0 . 0）

故有$x+\frac{1}{2}a=y$ 

显然，对于任意$x$，有一个与它对应的$y$满足条件

---

#### 题目分析到此为止，大体思路应该很清晰了....

代码复杂度为O（$\sqrt{a^{2}-4b}$）,最差为O（$a$）

---

### 代码：

（请不要在意我蒟蒻的码风）

```cpp
#include <bits/stdc++.h>
#define int long long//不开longlong见祖宗 
using namespace std;

int a, b, ans;

signed main() {
	scanf("%lld %lld", &a, &b);

	int delta = 4 * b - a * a; //思路里我用的是a^2-4b，这里用4b-a^2，是一样的

	if(delta == 0) { //delta=0时，必然无穷解
		printf("inf");
		return 0;
	}

	if(delta < 0) {
		delta *= -1; //变成正数
		int Maxn = sqrt(delta); //j的枚举上限

		for(int j = 1; j <= Maxn; j++)
			if(delta % j == 0) {
				int i = delta / j; //计算i

				int x = j + i - 2 * a, y = i - j; //计算4x,4y

				if(x % 4 != 0 || y % 4 != 0 ) // x,y必须为整数
					continue;

				x /= 4, y /= 4; //这个是真正的x,y

				if(x >= 0 && y >= x ) //判断是否满足条件
					ans++;//统计对答案的贡献
			}
	} else {
		//同上
		int Maxn = sqrt(delta);

		for(int j = 1; j <= Maxn; j++)
			if(delta % j == 0) {
				int i = delta / j;

				int x = i - j - 2 * a, y = i + j;

				if(x % 4 != 0 || y % 4 != 0 )
					continue;

				x /= 4, y /= 4;

				if(x >= 0 && y >= x )
					ans++;
			}
	}

	printf("%lld", ans);
	return 0;
}
```

---

### 结语：

如果本题解有BUG...

那么...那么...那么...（随意了）还请私信作者....

---

## END