看到 $k\le 5$，直接合理推测拆开式子，建 $k$ 棵线段树。

$(i-l+1)^k$ 是一个奇怪的式子，我们不妨考虑将其利用二项式定理拆开。

有：

$$(i-l+1)^k= [(i+1)-l]^k= \sum_{j=0}^k{\binom{k}{j}\times (i+1)^j\times (-l)^{k-j}}$$

将 $a_i$ 带入，有：

$$\sum_{i=1}^na_i \sum_{j=0}^k{\binom{k}{j}\times (i+1)^j\times (-l)^{k-j}}$$

看到这个式子，我们先考虑将 $a_i$ 和后面的一堆东西扔在一起，用线段树维护。

结果就变成了：

$$\sum_{j=0}^k{{\binom{k}{j}\times (-l)^{k-j}}\times [\sum_{i=1}^n a_i(i+1)^j]}$$

后面的中括号里的那一撮东西用可以用线段树维护