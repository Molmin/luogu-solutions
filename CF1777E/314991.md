二分答案。

考虑怎么 check：如果题目条件略加改动，将可以重定向某些边改为将这些变成双向边，则由 [经典结论](https://www.luogu.com.cn/problem/P2341) 知这张图合法当且仅当只有一个强联通分量入度为 $0$。下面将证明即使是重定向边，这一方法依旧正确。

记将可重定向边看作双向边的图为 $G'$，这些双向边构成的集合为 $E'$。若 $G'$ 中不存在可以到达其他所有点的点，则显然无论怎样定向也都不会存在。若 $G'$ 中存在这样的点，记其为 $s$，则必然存在 $(u,v)\in E'$，使得存在 $s\to u$ 的某一条路径，不经过任何 $E'$ 中的元素。此时我们发现，对于 $(u,v)$ 这条可重定向的边，选择 $u\to v$ 一定不劣于选择 $v\to u$（假如选择了 $v\to u$，这条边会使你到达点 $u$ 这一原本就可以到达的点，因此这条边没有任何价值），故我们可以将 $(u,v)$ 定向为 $u\to v$，并将其从 $E'$ 中删去。归纳即可。

复杂度 $\mathcal O((n+m)\log V)$