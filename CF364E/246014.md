## CF364E 【Empty Rectangles】

### 题意

+ $n\times m$ 的 01 矩阵，求多少个子矩阵和为 $k$；
+ $n,m\le2500$，$0\le k\le6$。

### 做法

容易想到分治，对于行数在 $[l,r]$ 内的区间，递归计算 $[l,mid-1]$ 和 $[mid+1,r]$ 的答案，然后统计跨过第 $mid$ 行的答案。单次统计的复杂度为 $O(km^2)$，总复杂度为 $O(knm^2\log n)$，不可过。

注意到 $m^2$ 很大，而且 $n$ 和 $m$ 某种角度上是对称的，所以考虑轮流对 $n$ 和 $m$ 分治，对 $n$ 分治时，统计复杂度为 $O(km^2)$，对 $m$ 分治时，统计复杂度为 $O(kn^2)$。因为对两者轮流分治，即两者同阶，相当于对 $n$ 分治，单次统计复杂度 $O(n^2)$，总复杂度为 $O(kn^2\log n)$，可过。

代码实现上可以每次对 $n$ 和 $m$ 中较大的分治，据说会更快。