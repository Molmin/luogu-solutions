这里给出一种不知道比出题人的做法好写到哪里去的做法

考虑我们已经结束了子树中的抉择 来到了某个节点$u$的处

那么我们考虑这个节点是否选取 只需要去掉子树中的一个最小权值点 然后把这个点加入我们的答案点集中去

不难发现这样不会影响子树中的抉择情况 我们便得到了一个可撤销贪心

我们需要一个数据结构来维护这个东西 参照dsu-on-tree的想法 我们直接继承重儿子 然后暴力合并轻儿子

复杂度是$O(n\log n)$ 常数和代码复杂度都显著小于出题人的做法

顺便吐槽一句数据有点水 我赛时拿set启发式合并+两只log的垃圾做法通过数据分治过去了