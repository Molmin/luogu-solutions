## [P4979 矿洞：坍塌](https://www.luogu.com.cn/problem/P4979)

## 题目大意：
一个区间有若干颜色，有两个操作：

A. 将该区间从 `x` 到 `y` 变成 `k` 色。

B. 询问区间 `x` 到 `y` 是否合法。

- 合法定义为该区间颜色均相同且 `x-1` 的颜色与 `y+1` 的颜色不相同。若 `x=1` 或 `y=N` 时不用判断后者。

## solution:
区间修改，区间查询，我们考虑使用线段树。

线段树的每个节点保存如下信息：
```cpp
struct shu{
	int l,  //区间左端点
	r,    //区间右端点
	se,    /区间颜色，若不相同为-1
	tag;  //懒标记，代表要变成的颜色，初始为-1
}tr[N<<2];
```
颜色：这里我将 `A` `B` `C` 分别映射成三个数字 `1` `2` `3` 

区间修改：若 `x` `y` 包含访问到的区间，则将此区间变成该颜色，并把懒标记赋值。

区间查询：若 `x` `y` 包含访问到的区间，则返回该颜色，否则递归进左右子树，合并信息：

1. 若 询问区间不包含左区间，返回右区间的颜色。同理不包含右则返回左。
2. 如果左右区间有一个是混色或者左右区间颜色不同返回 `-1` 。
3. 如果左右区间颜色相同，返回该颜色。

别忘了以上操作都要 `pushdown` 将信息传下去。
## 接下来是细节的处理：
判断要格外小心。 $\text{Yes}$ 要满足两个条件：
1. 区间颜色相同。
2. `x==1` 、 `y==n` 、 `x-1` 的颜色与 `y+1` 颜色不同，三者满足其一。

否则是 $\text{No}$ 。

PS：注意 **Yes**、**No**的大小写。

看到这的同学，可以自己去写代码了(~~tf口吻~~)

[code](https://www.luogu.com.cn/paste/1ut3788r)
### End
## 作者的碎碎念：

有用留赞(~~言简意赅~~)