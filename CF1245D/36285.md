# CF1245D - Shichikuji and Power Grid
- https://www.luogu.com.cn/problem/CF1245D
- 贪心、最小生成树

## 题意
已知一个二维平面上有 $n(1\leq n\leq 2000)$ 个城市，第 $i$ 个城市的坐标为 $(x_i,y_i)\ (1\leq x_i,y_i\leq 10^6)$。

需要给这个 $n$ 个城市均通上电。

一个城市要有电，需要满足如下任一条件：
- 这个城市有发电站；
- 这个城市和一个有电的城市用电缆相连。

在一个城市建造发电站的花费是 $c_i\ (1\leq c_i\leq 10^9)$。

$u$ 和 $v$ 两个城市相连的花费是 $(k_u+k_v)\cdot dis_{u,v}$，其中 $dis_{u,v}$ 指的是 $u$ 和 $v$ 的曼哈顿距离。

求最少花费的方案。

## 思路

设 $w_{u,v}=(k_u+k_v)\cdot dis_{u,v}$。

考虑给这 $n$ 个点两两连边，每条边的边权为这两个城市电缆的花费。

最终图的形态是多个连通块，每个连通块均是一棵最小生成树。

最小花费为：$\sum$ 每棵最小生成树权值 $+$ $\sum$ 每棵最小生成树中最小的 $c_i$。

考虑将所有边按照升序排序，仿照 Kruskal 算法，在用并查集维护最小生成树的信息的基础上，同时维护边权的加和以及最小的 $c_i$。

加边时，需要注意加边的条件： $w_{u,v}\leq \max(u$ 所在的连通块中最小的 $c_i,v$ 所在的连通块中最小的 $c_i)$。

**考虑下面这种情况：**



假设现在有连通块 $A,B,C$，其中 $w_{A,B}=w_{A,C}<w_{B,C}$。

此时，应该先考虑 $A\leftrightarrow B$，还是先考虑 $A\leftrightarrow C$？

先后顺序无关紧要，因为无论先选哪条边，都节省了 $c-w$ 的花费。