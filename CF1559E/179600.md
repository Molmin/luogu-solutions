# CF1559E Mocha and Stars

~~考场上过了这个题结果前缀和写挂导致FST~~

考虑枚举最后的 **公因数** 然后进行容斥。

设 $F(i,j,k)$ 表示枚举的公因数为 $i$ ，目前已经考虑了前 $j$ 个数，加起来的总和是 $i\times k$ 的方案数。

由于 $j$ 不大，$k$ 的总和也是一个调和级数，因此可以通过背包+前缀和在 $O(nm\ln m)$ 的时间复杂度内求出 $F$ （实际上我们也只需要对于每个 $i$ 求出 $\sum_{k} F(i,n,k)$ 即可）。

设 $g(i)$ 表示 $\gcd$ 为 $i$ 的方案数，$f(i)$ 表示存在公因数为 $i$ 的方案数，这个显然就是莫比乌斯反演的形式了，那我们只想知道 $f(1)$ ，因此答案就是

$$
\sum_{i=1}^{n} g(i)\mu(i)
$$
