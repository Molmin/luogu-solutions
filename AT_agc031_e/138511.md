## AT4695 [AGC031E] Snuke the Phantom Thief 题解

[题面](https://www.luogu.com.cn/problem/AT4695) [代码](https://atcoder.jp/contests/agc031/submissions/12968364)

---

这么奇怪的限制和比较小的数据范围，不难想到网络流吧。

我们可以想到用流量来限制小贼的取舍，但这条路显然是不通的。

---

我们先考虑一维。把们排好序，我们转化一下限制：**枚举偷窃珠宝个数k**

- 横坐标小于等于 $a_i$的珠宝最多偷 $b_i$个 $\Leftrightarrow$ 如果$k>b_i$，那么珠宝编号$\ge b_i+1$，其横纵标$>a_i$

- 横坐标大于等于 $a_i$的珠宝最多偷 $b_i$个 $\Leftrightarrow$ 如果$k>b_i$， 那么珠宝编号$\le k-b_i$，其横纵标$<a_i$

我们可以的得到每一个珠宝的取值范围，那么偷珠宝相当于$k$个取值范围，和$n$个珠宝的价值做二分图最大权匹配。$EK$费用流即可。

两维情况，和一维情况差不多吧。

建出来的图大概长这样：(建图是网络流的灵魂)

![](https://cdn.luogu.com.cn/upload/image_hosting/d1zcd10r.png)

图例中表示$N=4,K=3$的情况。

$x,y$表示横纵坐标上的取值范围。

$(a,b)$表示流量$a$,费用$b$。$w_i$表示每个珠宝的价值。

其中$x->a$ $A->y$会根据坐标是否匹配连一些$(1,0)$的边（没画出来）。

最后跑从S到T的最大费用最大流就可以了，注意最大流必须等于k时才更新答案。
