如果您没有看过 F1 的题解，建议先看一看 -> [link](https://www.luogu.com.cn/blog/gyh20/solution-cf1534f1)

先从一些显而易见的结论开始：

$1.$ 如果某一个沙掉落，那么下面的所有沙掉落。

也就是说，只需要第 $a_i$ 个沙掉下来即可。

令每一列前 $a_i$ 个点为 $A$ 类点，其余点为 $B$ 类点。

$2.$ 假设只看 $A$ 类点，我们只用管缩点之后的 $0$ 度点（像 F1 一样求）。

这些 $0$ 度点必须被扰动，而扰动之后所有点都会被扰动。

也就是说，我们只需要管这些 $0$ 度点与 $B$ 类点构成的图。

$3.$ 每一列的 $0$ 度点至多只有 $1$ 个。

$4.$ 所有的 $A$ 类点都在同列的 $B$ 类点下方。

此时，我们可以再次建图，求出每个 $B$ 类点能影响到的所有 $0$ 度点，然后就转成了 DAG 上的奇怪问题， $n\leq 4\times 10^5$ 时完全无法解决。

当感觉一个问题不可做时，可以检查一下自己转化问题的时候是不是漏了什么性质。

每个 $B$ 类点影响的 $0$ 度点到底是什么样的？

先给出结论：一段区间！

证明：如果第 $i$ 列的 $B$ 类点影响了第 $x(x>i)$ 列的 $0$ 度点，由于我们初始的连边只有 $i$ 向 $[i-1,i+1]$ 的点连边，那么在中途 $i<k<x$ 所有第 $k$ 列中且在两点纵坐标之间的点一定存在。

那么对于中间的每一列，这个纵坐标的点一定为 $B$ 类点，否则，若第 $x$ 列的那个点为 $A$ 类点，而根据最开始连边的定义，$0$ 度点是 $A$ 类点缩点之后入度为 $0$ 的点，也就是说，不可能存在其它的 $A$ 类点可达，而这个 $B$ 类点一定会影响下面的 $0$ 度点。

于是，这个问题就转为了线段覆盖的经典问题。

代码还没写，先咕着。
