## 【题解】P5446 [THUPC2018]绿绿和串串(manacher)

考虑对于一个串进行$f$操作，就是让他变成一个以最后一个节点为回文中心的回文串。

那么对于某个位置$p$，假如它是一个合法的位置，那么它一直倍增一直倍增当长度大于这个原串的时候就使得$T$出现过一次了。

- 倍长一次就大于原串了，此时$p$是一个回文中心，且$p$的回文半径到达了$|T|$
- 倍长两次才大于原串，此时$S$倍增一次后的那个点$p'$是一个回文中心，且$p'$的回文半径到达了$|T|$。但为了保证第一次倍增的合法性，此时原$p$这个位置的回文半径要顶着$1$节点。
- 倍长三次...

递归地思考，一个位置合法当且仅当**这个位置是回文半径顶到右边界，或者他的右边界合法且自己的会问半径顶到边界。**

用manacher实现即可，注意一个细节，就是马拉车对于每个非辅助字符的字符，他为中心的回文串的回文边界一定是个辅助字符，要减去$1$以达到效果。

复杂度$O(2\sum |S|)$

[代码](https://www.cnblogs.com/winlere/p/11598697.html)