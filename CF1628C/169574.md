**Update 2022.2.6:** 修正了错别字（将“亦或”修改为“异或”）。

---

**Preface**：考场上最后三分钟打完结果忘判边界而亡。

### 题意

有一个 $n\times n$（$n$ 为偶数） 的矩阵，告诉你这个矩阵中每个位置四周的数字的异或和，求矩阵中所有数的异或和。

### 思路

以下称每个格子四周的数字异或和组成的矩阵为 $a$。

稍微想想就知道应该怎么构造（~~xxs都会吧~~。

先来看一下对于一个 $6\times 6$ 的矩阵该怎么算。

![](https://cdn.luogu.com.cn/upload/image_hosting/8827lbin.png)

在第一幅图中，红色格子的 $a$ 值的异或和为黄色格子所有数字的异或和。

在第二幅图中，蓝色格子的 $a$ 值的异或和为绿色格子所有数字的异或和。

绿色格子与黄色格子合起来就是整个矩阵了。所以只要将红、蓝格子的 $a$ 值异或起来就是答案。

再来看一下对于一个 $8\times 8$ 的矩阵该怎么算：

![](https://cdn.luogu.com.cn/upload/image_hosting/z7558vr4.png)

算的方法和 $6\times 6$ 一样。

是不是瞬间豁然开朗（bushi。

----

接下来看看红点与蓝点位置有什么特征。

很容易发现蓝点与红点关于中间的竖线对称，即若位置 $(i,j)$ 为红点，则位置 $(i,n-j+1)$ 必是蓝点。所以问题简化：红点位置有什么特征。

对于 $8\times 8$ 的矩阵，把红点位置都表示出来：

- $(1,3)$，$(3,1)$
- $(1,7)$，$(3,5)$，$(5,3)$，$(7,1)$
- $(4,8)$，$(6,6)$，$(8,4)$
- $(8,8)$

容易发现，第一组横纵坐标值和为 $4$，第二组为 $8$，第三组为 $12$，第四组为 $16$。而且每一组的相邻两个横坐标差为 $2$。

再观察一下，发现前两组的第一个横坐标为 $1$，后两组第一个横坐标为 $2$（可以反推一下，$(4,8)$ 前面一个是 $(2,10)$，$(8,8)$ 一直往前推是 $(2,14)$）。而前两组的横纵坐标和小于等于 $n$，后两组横纵坐标和大于 $n$。特征便显而易见了。

在用这种方法算一下 $6\times 6$ 的矩阵，发现也符合规律。所以着这种方法是可行的。

### 代码

**Talk is cheap, show me the code.**

[Codeforces status](https://codeforces.com/contest/1628/submission/143737617)

```cpp
int n,a[1010][1010];
void work(){
	n=read();
	For(i,1,n) For(j,1,n) a[i][j]=read();
	int ans=0;
	for(int sum=4;sum<=2*n;sum+=4){
		if(sum<=n){
			for(int i=1;i<=n;i+=2){
				int j=sum-i;
				if(j>n||j<1) continue;
				ans^=a[i][j];
				ans^=a[i][n-j+1];
			}
		}else{
			for(int i=2;i<=n;i+=2){
				int j=sum-i;
				if(j>n||j<1) continue;
				ans^=a[i][j];
				ans^=a[i][n-j+1];
			}
		}
	}
	cout<<ans<<endl;
}
```