官方题解

考虑通过询问叶子节点得到权值和。

先询问所有叶子节点的 dfs 序，然后从小到大排序。

然后询问第 $i$ 个和第 $i+1$ 个的距离，特别的，定义第 $n+1$ 个叶子是第 $1$ 个。

得到的距离和除以 $2$ 就是权值和。

证明：考虑每个边的贡献，正好被这些路径覆盖两次。

对叶子个数分治，叶子节点较少时执行以上算法，较多时删除。

交互次数证明：

设当前叶子个数为 $B$。

询问次数为 $T(n)=\min(T(n-B)+1,2B+1)$。分别对应删除和求出。

提前预处理出每个 $n$ 分治的界即可。通过写程序 dp 可以发现上界是 $141$。

更简单的方法是直接判断是否到 $142$ 次，超过 $142$ 次时删除。
