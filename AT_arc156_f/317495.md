~~哇，金牌题！~~

### 题意

给定序列 $\{a_n\},\{b_n\},\{c_n\}$，找到一个符合如下条件的**不可重集** $S$：

1. 它可以通过将 $\forall i \in [1, n]$，$a_i$ 或 $b_i$ 加入集合生成；
2. 它可以通过将 $\forall i \in [1, n]$，$a_i$ 或 $c_i$ 加入集合生成；
3. 它是所有满足该条件的集合中大小最大的。

输出一个合法的集合 $S$。

### 分析

先考虑一个弱化版的生成方式：

- 对于 $\forall i \in [1, n]$，将 $a_i$ 或 $b/c_i$ 或空加入集合。

这时候如何求 $S$ 的最大大小呢？考虑使用网络流：

1. 源点向所有 $a/b$ 的决策点连边，所有 $a/c$ 决策点向汇点连边。
2. 将每个值拆点；对于 $\forall i \in [1, n]$，左部点 $i$ 向 $a_i,b_i$ 连边，$a^\prime_i,c^\prime_i$ 向右部点 $i$ 连边（流量均为 $1$）。

显然此时的最大流即为弱化问题的答案，容易构造一组合法的解，这显然是原问题的一个上界。

思考为什么同样的做法不能应用到原问题：若存在一个点 $i$ 满足 $a_i$ 和 $b_i$ 对应的权值点均无流量，则无法构造出一种合法方案（下称这种决策点为**空节点**）。

我们考虑分析这个网络与空节点的关系，结论：**在 Dinic 增广的过程中，不会出现新的空节点**。

证明：若出现新的空节点，设其为 $u$，则意味着在增广的过程中，选择了一条增广路退回了 $S \to u \to v_u$ 的流量（$v_u$ 为 $u$ 选择的权值点），也就是说可以将过程拆分成：$S \to \dots \to S \to \dots \to T$；在 Dinic 增广的过程中，因为进行了分层优化，所以显然会走最短的一条增广路，而前半段显然不符合这一性质，所以这种情况是不会出现的。

有了这个性质，我们相当于将问题转化成：找到一个**残余网络**，满足没有空节点，在它上面进行 Dinic 增广。

显然 $a_1,a_2,\dots,a_n$ 是一个合法的点集，只需要每个点都向 $a$ 增广就能构造出一个合法的残余网络。

总时间复杂度 $\mathcal O(n\sqrt n)$。

### Code

提交记录：<https://atcoder.jp/contests/arc156/submissions/43221939>。

