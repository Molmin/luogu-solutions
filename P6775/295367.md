[P6775 [NOI2020] 制作菜品](https://www.luogu.com.cn/problem/P6775?contestId=70211)

用一种基于随机的做法过的，但是用起来很优秀。

想法就是从 $m$ 与 $n$ 的关系入手去分析。

$m$ 与 $n$ 差较大的可以乱搞几次变成  $m$ 与 $n$ 差较小的，这里比较显然。

我们考虑 $m=n-1$ 的情况。

想想能不能直接用最小的和最大的去解决当前所需用料。

首先得证明他够。

假设最小的值等于 $x$，所以剩余值为 $(n-1)\times k-x$，再用鸽巢原理算发现最大值不小于 $\frac{n-1}{n-1}\times (k-x)$，必然大于等于 $k-x$，所以两者之和大于等于 $k$。

这样是无法转到 $m=n-2$ 的。

想想怎么把 $m=n-2$ 转化为 $m=n-1$ 的子问题。

于是发现： $m_1+m_2=n_1+n_2-2\rightarrow m_1=n_1-1,m_2=n_2-1$。

不合法的情况就是分不出的情况。

我们设 $val_i$ 的值为 $|a_i-k|$，把所有点最后分成两个集合：$S_1,S_2$，我们手玩几组数据就会发现当 $\sum_{i=1}^{n}val_i[i\in S_1']=\sum_{i=1}^{n}val_i[i\in S_2']$ （前式），再把 $S_1'$ 中 $val<0$ 的与 $S_2'$ 中 $val<0$ 的交换以后得到 $S_1,S_2$ 时原式（后式）也成立。

而得到前一个式子中两边的集合需要随机化，只要来一个 $sum$，如果大于原来的一半就随机减一个数，小于原来的一半就随机加一个数，否则跳出循环表示找到了。

反正挺玄学的，我跑了 2e6 次是可以在本题上 AC 的。

但是我们还要证明为什么这两个式子互为充要条件，感性理解是显然的，这里再理性分析一下，也只指一下方向，$\LaTeX$ 写写太麻烦了见谅哦。

证明前式交换以后必然满足后式要求：拆掉绝对值，考虑每部分的正数和和负数和，最后解开来就是说左右两式一样，于是得证。

证明后式必然能从前式推来：倒着做一遍，差不多思路。

于是这道题就做完了。