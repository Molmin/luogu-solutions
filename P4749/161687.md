考虑 $7$ 是个质数，因此要么一个轮盘数字全一样就是怎么转就行，即没有限制，要么就是有唯一的旋转位置。把怎么转都行的剔除掉。

考虑把这个环的东西弄成模意义的数值问题，设位置状态是 $i$，意义即顺时针转 $i$ 次的状态，在 $\bmod 7$ 意义下。那么问题就变成了一个序列，最初全为 $0$，有一个目标状态 $a$ 数组，每次可以连续选一段 $+k$，问最少操作多少次变成目标状态。

考虑是操作是互逆的，可以将初始和目标反转，又考虑这个连续的一段操作，可以用差分变成两个点的操作，设 $b$ 为 $a$ 的差分数组，那么问题转化为：

* 一个操作可以选择一个 $l < r$ 和 $k$， 使得 $b[l]$ 加 $k$，$b[r]$ 减 $k$。

问变成全 $0$ 最少操作次数。

这个东西还是不太好做，考虑转化。发现一个关键性质就是每次操作不改变 $b$ 的和。考虑一组最优解，把每次选择的 $l, r$ 之间连边，那么对于每一个大小为 $cnt$ 的连通图而言，需要满足他们的 $b$ 的和模意义是 $0$，并且至少操作 $cnt - 1$ 次，如果我们能构造出一种 $cnt - 1$ 次数的答案。因此就可以说明一定存在一组最优解是分成若干组，并且使用的是我们的这种构造方式，那么我们只需要求这种方式的最优值就好了。那么问题就等价于：

* 把序列分成若干组，每组的 $b$ 和为 $0$。设有 $k$ 组，每组大小是 $cnt_i$，答案即 $\sum_{i=1}^k (cnt_i - 1) = n - k$。

------

构造的证明：

考虑把这些点从左到右排序，依次是 $p_1, p_2, p_3,..., p_{cnt}$。

考虑第 $i$ 次操作，前 $i - 1$ 个都变成 $0$ 了，现在让 $b_{p_i}$ 变成 $0$。

让 $l = p_i, r = p_{i+1}, k = 7 - b_{p_i}$ 就好了。

因为和是 $0$，因此前 $cnt - 1$ 变成 $0$ 了，最后一个也是 $0$。

------

因此我们需要最大化分的组数。

直接求是一个非常大的背包不太可做。

我们先考虑把 $a + b = 7$ 这样大小可以为 $2$ 的组给安排了。

那么最终 $1, 6$ 、$2, 5$，$3, 4$，三种组，分配后剩下每组最多只有一种，因此剩下的数字种类最多 $3$ 个。

用这三个（设为 $x, y, z$）用的数量做一个三位背包就好了，考虑物品 $i\times x +j\times y+  k \times z$，必须满足 $i, j, k < 7, \gcd(i,j,k) = 1$（还有单独七个特判），否则可以继续分成两半，更优，可以打表发现物品个数最多是 $41$ 个。

设剩下的数字种类每个数分别 $A_1, A_2, A_3$。

那么时间复杂度是 $O(\prod A \times 41)$。

用均值不等式发现这个东西最大是 $2e8$ 左右，可以苟过。

