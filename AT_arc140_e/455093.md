# [ARC140E] Not Equal Rectangle 题解

## 题意简述

给出一个 $N\times M(N,M\le 500)$ 的方格图，要求在方格中填入 $1\sim 25$ 的数字，使得不存在一个子矩形的四个角上填入的数字相同。

## 思路分析

首先，我们可以将 $N\times M$ 的方格图扩大，使得 $N=M=23^2$，然后再输出其子矩阵作为答案。

接下来，我们根号分块，以边长为 $23$ 的正方形为一块。接下来，考虑每一种数字（我们只会用到 $23$ 种数字），它们应该在每个块中都出现 $23$ 次。我们可以先填出数字 $1$ 的方案，接下来将其在每一个块中的填法进行横向的循环位移，就可以得到其他数字的方案，正确性显然。记块中最左上角的块坐标为 $(0,0)$，如果数字 $1$ 填在了 $(x,y)$，那么数字 $m$ 就应该相应地填在 $(x,(y+m-i)\bmod 23)$。

对于数字 $1$，我们不妨直接将其填在最左上角一块的对角线上，其他填法可以通过交换列得到，即填在 $\{x\in [0,22]|(x,x)\}$。接下来，我们通过对左上角一块进行横向循环位移得到其他所有块。记 $D(x,y)$ 表示位于第 $x$ 行第 $y$ 列的 $23\times 23$ 的块相对于最左上角的块进行了多少次横向循环位移，那么，显然可以发现，不符合题目条件当且仅当存在 $x_1,x_2,y_1,y_2\in [0,22],x_1\not =x_2,y_1\not =y_2$ 使得 $D(x_1,y_1)-D(x_2,y_1)\equiv D(x_1,y_2)-D(x_2,y_2)\pmod {23}$。考虑一个函数：$D(x,y)=x(y-1)$。那么，如果不符合题意，需要满足：

$$
x_1(y_1-1)-x_2(y_1-1) \equiv x_1(y_2-1)-x_2(y_2-1) \\
x_1y_1-x_2y_1 \equiv x_1y_2-x_2y_2 \\
(x_1-x_2)y_1 \equiv (x_1-x_2)y_2
$$

由于 $x_1,x_2\in [0,22]$，所以 $(|x_1-x_2|,23)=1$，上式子化为 $y_1\equiv y_2$，矛盾，故这样的构造符合题目条件。

## 代码

```cpp
#include<bits/stdc++.h>
using namespace std;
int a[630][630];
int main(){
	int n,m;
	for(int i=1;i<=23;i++){
		for(int j=1;j<=23;j++){
			for(int pyl=0;pyl<=22;pyl++){
				int xbase=(i-1)*23,ybase=(j-1)*23;
				int tpyl=(pyl+(j-1)*i)%23;
				for(int k=1;k<=23;k++){
					a[xbase+k][ybase+((k+tpyl-1)%23)+1]=pyl+1;
				}
			}
		}
	}
	cin>>n>>m;
	for(int i=1;i<=n;i++){
		for(int j=1;j<=m;j++) printf("%d ",a[i][j]);
		puts("");
	}
	return 0;
}
```