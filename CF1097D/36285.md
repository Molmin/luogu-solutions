## CF1097D - Makoto and a Blackboard
- https://codeforces.com/problemset/problem/1097/D
- 质因数分解、积性函数、概率期望
- 紫、*2200
## 题意
- 你手里有一个数字，每次操作可以把这个数字等概率变成这个数字的某个约数（因数）
- 给出 $n(1\leq n \leq 10^{15})$ 和 $K(1\leq K\leq 10^4)$，分别代表手里的数字的初始值，和操作的次数
- 问 $K$ 次操作后，手里数字的期望

## 思路
### 超时做法
- 令 $dp[i][j]$ 为操作了 $i$ 次，当前因数为 $j$ 的概率（用 map 实现 DP 数组）
- 转移：$dp[i][j]\rightarrow dp[i+1][p]\ \ ,i<K,p|j$

### 正确思路
- 手里的数字可以按质因子考虑，也就是说，可以写成 $p_1^{x_1}\times p_2^{x_2}\times \dots \times p_k^{x_k}$ 的形式
- 每次操作相当于将每个 $x_1,x_2,\dots x_k$ 随机降低某个值（可以是 $0$）
- 那么，分别算出上式中 $p_1^{x_1}, p_2^{x_2}, \dots ,$ 和 $p_k^{x_k}$ 在操作 $K$ 次后的大小的期望，乘在一起，就是答案
