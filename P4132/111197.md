这篇题解主要是为了造福众多看不懂另一篇题解的~~未来的巨佬~~


# 思路：

首先观察到 

$ \sum_{i=1}^{\frac{p-1}{2}}{[\frac{kq}{p}]}$和$ \sum_{i=1}^{\frac{q-1}{2}}{[\frac{kp}{q}]}$

发现ｋ的上界为$\frac{p-1}{2}$和$\frac{q-1}{2}$

又有ｐ和ｑ一定，ｋ在变化，~~(自然地)~~想到是一次函数

于是构造函数ｆ（ｘ）＝$\frac{q}{p}$x和ｇ（ｘ）＝$\frac{p}{q}$x

接着注意到是向下取整，就是把所有在函数范围之内的整数ｘ的函数值分别向下取整，发现这就是在找函数图像之下的整点个数

用https://www.luogu.org/blog/rc-tianbu/solution-p4132　中的例子

设两个数为p,q。如下图（p=7,q=11）
![](https://cdn.luogu.com.cn/upload/pic/14245.png)

这就是g(x)的图像


f(x)的同理

![](https://cdn.luogu.com.cn/upload/pic/14246.png)

但我们可以发现两个图像拼在一起就是整个矩形！！！

但你可能会问两个图形拼在一起顶点会不会多算或少算

这正是下面的重点

注意到ｐ，ｑ互质，这说明$\frac{q}{p}$和$\frac{p}{q}$均不为整数，所以不用计算，$\frac{q}{p}$和$\frac{p}{q}$为整数只有在ｘ＝ｐ的倍数和ｘ＝ｑ的倍数时，但这都超过了$\frac{p-1}{2}$和$\frac{q-1}{2}$

所以拼在一起不会存在点少算或多算（简单讲就是函数值不为整数）

所以此时有整点$$\frac{p-1}{2}\cdot\frac{q-1}{2}$个。

## 但是！！！，这并不是绝对正确的

当ｐ＝＝ｑ时$\frac{q}{p}$和$\frac{p}{q}$均为１，公式瞬间凉凉


这时f(x)=g(x)=x，所以函数值就是ｘ的值，所以在取值范围之内函数值可以为整数

那就一起算再加上重复的点不就ＯＫ了么

取ｐ＝ｑ＝７为例

ａｎｓ＝((p-1)/2)*((p-1)/2)+(p-1)/2;

((p-1)/2)*((p-1)/2)是矩形中的点数，后面是重复的点（有((p-1)/2)*((p-1)/2)个点就有(p-1)/2)个点在对角线上，拼起来会重合）

提出(p-1)/2就是($p^2$−1)/4，ｐ为奇数，平方减一是偶数除以４与本身除以４同效（整数会自动舍弃小数位）

代码（第一篇提高＋题解，喜欢请点赞）

```
#include<bits/stdc++.h>
using namespace std;
int main()
{
    long long x,y;
    cin>>x>>y;
    if(x!=y)cout<<((x-1)/2)*((y-1)/2);
    else　cout<<x*x/4;
    return 0;
}
```

１０行ＡＣ一道省选题，爽不

讲了大家有些不懂的地方，管理大大求通过～～～