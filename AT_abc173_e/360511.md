提供一个不需要脑子的做法。

答案肯定是从小到大排序后一段前缀和一段后缀。

我们发现比较两个数的大小可以比较他们 $\log$ 的大小，而 $\log(ab)=\log(a)+\log(b)$，所以我们可以记录前缀 $\log$ 的和与后缀 $\log$ 的和，枚举前缀即可。

重中之重：$\texttt{long double}$。