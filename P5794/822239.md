作为一道紫题，它的代码量出奇的小，下面我们就看看这道题的解题思路。

从数据范围的提示中我们就可以知道，先假设每个字符各不相同。

根据题意进行排序操作，显然，我们可以得到排序后的字符矩阵的第一列和最后一列，然后就可以知道每个字符的后继即后面一个字符是什么。

如果有字符相同，我们可以通过一些操作让它们不同。我们把同样的字符按照从它开始的字符串的字典序大小来区分，于是乎，通过排序，我们就可以知道第一列每个字符分别是同种字符中字典序第几小的。

但是还不够，我们还需要知道最后一列字符对应的是哪一个。因为最后一个字符的后一个是第一个字符，所以最后的字符串也是按照字典序排好序的。

于是乎这个问题就被我们解决啦，时间复杂度可以达到 $O(N)$。

正如开头所说，这道题的代码量出奇的小，压压行的话可以在 $25$ 行之内完成，所以在这里就不放出代码了，要自己思考哟！