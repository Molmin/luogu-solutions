本篇题解是对 @Missa 大佬题解的一些浅显易懂的解读与补充。

我们定义前 $n$ 个点为白点，后 $m$ 个点为黑点。

首先要对这些点连边，我们从 $i$ 向 $p_i$ 连一条边，那么我们最终的要求就是整个图所有点都变成孤立点。

画一画图，发现，我们对两个数 $x,y$ 进行操作等价于交换 $x$ 和 $y$ 连向的那个点，再画一画图，发现一个规律：若 $x,y$ 当前不在一个环内，则 $x$ 和 $y$ 被并到了一个环中，否则原来的环在 $x,y$ 两个点被断开，分裂成两个独立的弧。

如果两个异色点 $x$ 与 $y$，且 $p_x=y$，则我们操作 $x,y$，可以使 $p_x=p_y,p_y=p_x=y$，发现 $y$ 变成了一个孤立点，我们成功把 $y$ 分裂出来了。如果此环是非纯色的，则我们一定能找到两个点 $x,y$ 满足以上条件。每次减少一个颜色多于另一色的颜色，就能保证可以把所有点分开。

那么，只要把所有纯色环合并，就能通过 $n+m-cnt$ 次操作分开所有点，其中 $cnt$ 表示环的数量。

贪心地想，环数越多越好。同时，把一对纯异色环合并起来，一次操作能减少两个纯色环，也是很贪心的选择。

剩下的部分参见 [Missa 大佬的博客](https://www.luogu.com.cn/blog/purplevine/solution-arc124d)，我认为他讲的很清楚了。