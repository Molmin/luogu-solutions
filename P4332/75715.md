# [SHOI2014]三叉神经树

这是一个正常的```LCT```题。

## 题解

对于一次修改，无非就是修改一条链的某一部分。比如这次修改的是叶子节点```a```，那么首先```access(a)```。然后对于那个维护这个链的```splay```，要看哪些东西是被修改过的。那么我们看这次修改是把```0->1```还是把```1->0```。就以从$0$改成$1$为例。设一个点的权值为这个点儿子中有多少个$1$，那么如果从$0$到$1$，一定就是更改了自底向上的一段全都为$1$的部分。一个点维护一个点向上深度最深的非权值$1$的结点，和权值非$2$的结点，当然这在$splay$里面的就是用一个结点维护当前节点的子树中最深的不为```1```或者不为```2```的结点。这还需要区间加，因为每一次都需要把一个点的所有为$1$的祖先都要加$1$，所以我们需要用一个变量$tag$当作延迟标记。当然这么空口说没什么用。需要写代码使劲避免错误！

## 代码

[Link](https://paste.ubuntu.com/p/srTf4ZZGjz/)