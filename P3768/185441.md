努力写个最容易懂的题解  
题意是求
$$\sum_{i=1}^{n}\sum_{j=1}^{n}ijgcd(i,j)$$
显然先把gcd枚举一下，假设gcd(i,j)==k
原式就为
$$\sum_{k=1}^{n}k\sum_{i=1}^{n}\sum_{j=1}^{n}ij[gcd(i,j)==k]$$
后面这个式子根据套路可以往外提一下
$$\sum_{k=1}^{n}k^3\sum_{i=1}^{n/k}\sum_{j=1}^{n/k}ij[gcd(i,j)==1]$$
这样子看着一脸可莫比乌斯反演的样子，令
$$f(x)=\sum_{i=1}^{x}\sum_{j=1}^{x}ij[gcd(i,j)==1]$$

根据某引理
$$\sum_{d|x}\mu(d)=[x=1]$$
$$f(x)=\sum_{i=1}^{x}\sum_{j=1}^{x}\sum_{d|gcd(i,j)}\mu(d)$$
换过来枚举d
$$f(x)=\sum_{d=1}^{x}\mu(d)\sum_{d|i}\sum_{d|j}ij$$
后面那玩意可以O(1)算的
$$f(x)=\sum_{d=1}^{x}\mu(d)d^2(1+2+3+...+[\frac{x}{d}])^2$$
反演完了，我们把它代回去
$$\sum_{k=1}^{n}k^3f([\frac{n}{k}])$$
$$\sum_{k=1}^{n}k^3\sum_{d=1}^{n/k}\mu(d)d^2(1+2+3+...+[\frac{n}{kd}])^2$$
令$sum(x)=1+2+3+...+x,g=kd$枚举g,再随便枚举个k
$$\sum_{g=1}^{n}sum(g)^2\sum_{k|g}k^3(\frac{g}{k})^2\mu(\frac{g}{k})$$
有些项可以消掉
$$\sum_{g=1}^{n}sum(g)^2\sum_{k|g}g^2k\mu(\frac{g}{k})$$
显然$g^2$可以提出来
$$\sum_{g=1}^{n}sum(\frac{n}{g})^2g^2\sum_{k|g}k\mu(\frac{g}{k})$$
显然前面可以整除分块  
主要需要快速求出后面的
$$g^2\sum_{k|g}k\mu(\frac{g}{k})$$
这时候狄利克雷卷积就有用了  
常见的几个狄利克雷卷积  
$d=1*1$  
$\sigma=1*id$  
$e=1*\mu$  
$\phi=\mu*id$  
$id=\phi*1$    
$id$表示$f(x)=x$  
显然这里我们需要用的是$\phi=\mu*id$  
卷完以后我们可以得到
$$f(g)=g^2\phi(g)$$
这时候需要计算上面函数的前缀和$s(n)$，那么就是杜教筛的套路
$$g(1)s(n)=\sum_{i=1}^{n}(g*f)(i)-\sum_{i=2}^{n}g(i)s(\frac{n}{i})$$
看看要卷的东西
$$(g*f)(i)=\sum_{d|i}g(d)f(\frac{i}{d}) =\sum_{d|i}g(d)(\frac{i}{d})^2\phi(\frac{i}{d})$$
显然令$g(x)=x^2$就可以把$(\frac{i}{d})^2$消掉
$$i^2\sum_{d|i}\phi(\frac{i}{d})$$
$$1*\phi(i)=id$$
$$i^2\sum_{d|i}\phi(\frac{i}{d})=i^3$$
$$s(n)=\sum_{i=1}^{n}i^3-\sum_{i=2}^{n}i^2s(\frac{n}{i})$$
这个前缀和用杜教筛处理之后，总复杂度是$O(n^{\frac{2}{3}})$