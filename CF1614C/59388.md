这个萌萌题我竟然做了 30min。

显然首先我们每一位能取 $1$ 就取 $1$ 是一定满足条件的。因此就变成了初始全部数是 $2^{30}-1$，每次 `l r x` 代表将 $a_l$ 到 $a_r$ 与 $x$ 取 `and`。容易想到拆位用区间加维护。

然而这是不必要的。下面直接给出结论：答案就是所有 $x$ 的 `or` 和乘以 $2^{n-1}$。

由于题目给的条件一定能成立，那么只要有某个 $x$ 在某一二进制位上为 $1$，那么必然有某个 $a_i$ 在此位上也为 $1$。

由于题目保证每个 $a_i$ 至少被一个限制条件所覆盖，所以只要某一个二进制位所有 $a_i$ 值均为 $0$，那么所有 $x$ 在此位上也均为 $0$。

在上面两个条件下，两个结论的逆命题也均成立。

因此所有 $a_i$ 的 `or` 和等于所有 $x$ 的 `or` 和。

然后，我们设某一位有 $s$ 个 $a_i$ 为 $1$，剩下 $n-s$ 个为 $0$。那么考虑计算这一位对答案的贡献。首先贡献肯定是这一位的值（即 $2^j$）的倍数，下面计算这个倍数的值。显然就是选出奇数个 $1$ 与任意个 $0$ 的方案数，首先 $n-s$ 个 $0$ 有 $2^{n-s}$ 种选择方法，然后 $s$ 个 $1$ 有

$$\sum_{i=0}^{\left\lfloor\frac{s-1}{2}\right\rfloor}\binom{s}{2i+1}=[s>0]2^{s-1}$$

种选择方法。由乘法原理，这个倍数的值为 $[s>0]2^{n-1}$。

因此最终答案就是 $a_i$ 的 `or` 和乘以 $2^{n-1}$，即 $x$ 的 `or` 和乘以 $2^{n-1}$。

Code 懒得放了。