[题目传送门](https://www.luogu.com.cn/problem/CF1699C)。

同步发表于我的 [$\text{cnblogs}$](https://www.cnblogs.com/UperFicial/p/16716496.html)。

~~全程手玩即可。~~

观察样例，或者手玩一下会发现，显然 $0$ 和 $1$ 的位置是固定的。

考虑 $2$ 可放入的位置，如果在序列 $a$ 中 $2$ 位于 $0$ 和 $1$ 之间，那么 $2$ 是可以随便移动的，否则 $2$ 的位置会被固定。这个手玩即可。

这个显然是可以推广到 $k$ 个数的。 

考虑第 $k$ 个数，以及我们已经加入过得数 $0,\cdots,(k-1)$，设它们在原序列的位置分别为 $c_0,c_1,\cdots,c_{k-1}$，如果 $k$ 在原序列位置 $p\in[\min_{0\le i<k} \{c_i\},\max_{0\le i<k} \{c_i\}]$，那么 $k$ 是可以随便移动的，如果在外面的话，$k$ 的位置就被固定了。

这个证明显然，如果 $k$ 在外面的话，若 $k$ 移动到 $\left(\max_{0\le i<k} \{c_i\}+1\right)$ 这个位置，那么 $[\min_{0\le i<k} \{c_i\},\max_{0\le i<k} \{c_i\}+1]$ 这个区间的 $\operatorname{mex}$ 为 $(k+1)$，实际上应该是 $k$。

代码实现也很简单，我们只需要记录一下填过的数的最左端位置 $l$，以及最右端位置 $r$，如果目前填的数 $i$ 满足 $l<i<r$，那么 $i$ 在这个区间可以随意移动，但是其中有我们填过的 $(i-1)$ 是不能移动的，所以方案数为 $(r-l-i+1)$。

时间复杂度 $\Theta(n)$。

[代码](https://codeforces.com/contest/1699/submission/172923386)。
