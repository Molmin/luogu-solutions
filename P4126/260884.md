- [类题](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/post-tu-lun-edges-in-mst)。

**题意**
- [链接](https://www.luogu.com.cn/problem/P4126)。
- 给定一个有向图连通图，源点和汇点，判断它的每条边属于这三种情况的哪一种：在所有最小割上，在部分最小割上，不在任何最小割上。
- 点数不大于 $4000$，边数不大于 $60000$。

**分析**
- 首先，根据我们对流和割的理解（[参见](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/wang-lao-liu)流模型章节），我们可以构造一种一般化的最小割方案，构造 $S,T$ 为两个分别包含源点和汇点的点集，使得从 $S$ 到 $T$ 所有的边都是满流的，那么这个边集一定是最小割，而且所有这样的边集组成最小割的所有可能方案。
- 基于最大流和最小割完全相等，我们容易证明这个事实，个人认为理解了这一点，后面的就很容易推导。
- 我们容易得到：如果一条边未满流，那么它不在任何最小割上。
- 那么如果一条边满流了，它是否总在某个最小割上呢？下面是一个反例。
![](https://cdn.luogu.com.cn/upload/image_hosting/rpir7iep.png)
- 没错，如果我们某条边满流，但是我们知道：这只不过是个巧合，证据就是存在另一条路径，它也可以流这一条，然后让这条不流，所以割这条边是没用的（反之，割这条边可以让某两个点不连通，根据上面的推论，它可以出现在割的方案内）。
- 考虑反向边此时显然有流，我们可以得出判定：两个端点不在同一个强连通分量内的满流边一定在某个最小割方案内。
- 接下来进行缩点，图即变成了有向无环图，根据上面的推论：如果一条边始终在最小割上，那么显然要求若不割这条边，$S$ 与 $T$ 始终连通。
- 所以我们就得到了第二个判定，如果在残量网络上加上这条边，$S$ 将与 $T$ 连通，考虑到反向边的因素，缩点后这条边可以看作是从 $S$ 流向 $T$，[代码实现](https://www.luogu.com.cn/paste/0w4dfpzy)。
- 说句实话，在残量网络上 $\text{Tarjan}$ 缩点然后建出一个 $\text{DAG}$（实际上，是从 $T$ 到 $S$ 的 $\text{DAG}$），上面任意（严格定义）的 $S,T$ 割都是最小割，然后直接从 $S$ 指向到 $T$ 的边一定在任意的最小割上，这个性质实在太优美了。
- 从实用性的角度，它已经可以解决如下问题，指定 $k$ 条边，询问它们是否能够同时在某个最小割上，除去网络流的复杂度，我们显然可以在线性时间内解决它。