$AwA$ $OvO$ $QwQ$

---

一篇复杂度正确的题解

显然每个点可以到达的点一定是连续的区间，那么我们可以对于每组询问，求出 $S$ 能到达的区间 $[L,R]$ ，然后判断 $T$ 在不在此区间内。

---

我们可以先把没有锁的门缩成连通块，一下简称`块` 。

我们发现一共有三种`块`：

1. 只能向左边拓展的块
2. 只能向右边拓展的块
3. 两边都能拓展的块

---

前两种块本质相同，我们以第一种为例：

首先容易发现只有 $x \leq y$ 的钥匙才有意义。

那么我们可以对于每个块，枚举这个块内的所有钥匙。

我们用并查集维护每个块所在的`可以相互到达的块`的集合，并记录下可以到达的最左边的块。每次`开门`操作，就相当于把两个集合合并。

这一部分的时间复杂度是 $O((n+m)\cdot\alpha(n))$ 。

---

对于第三种块：

我们可以直接暴力 $O(n+m)$ 拓展每个第三种块。拓展的过程很简单，这里不再赘述。

我们来证明一下时间复杂度的正确：

对于两个相邻的块 $a$ 和 $b$ ，若 $a$ 可到达 $b$ ，则 $b$ 不可到达 $a$ 。   


这个结论我们可以这样证明：假设 $b$ 在 $a$ 右边。由题意知，$a$ 到 $b$ 的钥匙一定在 $a$ 或 $a$ 的左边。所以从 $b$ 就不可能拿到这把钥匙，因此不可能到 $a$ 。

由这个结论易得知：任何两个第三种块的交不大于 $1$ 。

因此，每个块最多被拓展两次，拓展所有第三种块总的复杂度为 $O(n+m)$ 。

---

所以，算法的总复杂度为 $O((n+m)\cdot\alpha(n))$ 。

代码可以私信找 @A_C_L 要，这里就不放了。
