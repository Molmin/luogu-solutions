[看这个](https://www.luogu.com.cn/blog/Isaunoya/solution-p5390)

然后就会做了。
树链剖分线段树或，然后qpow一下就做完了。