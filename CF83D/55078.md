没啥思维难度的题。

看到 2e9 想想暴力。第一个结论就是 $k$ 必须是个质数。否则答案为 $0$。

容易发现当 $k$ 比较大的时候可以 $O(\dfrac{r}{k})$ 干过去。

$k$ 比较小的时候就容斥一下所有小于 $k$ 的质数就可以了。复杂度 $O(w \cdot 2^w)$，$w$ 为小于 $k$ 的质数个数。

取阈值为 $k = 70$ 可以较好通过。精细实现可以做到 $O(\dfrac{r}{k})$，不精细需要带一个 $\ln$。事实上不精细实现可以很轻松的艹过去。

实现细节较多，可以参考代码。

YLWang 不知道正解是什么。知道的可以私信 YLWang 一下，十分感谢。

代码链接：https://www.luogu.com.cn/paste/wovttdgl

update on 2020.8.11 : 

复杂度 $O(2^w)$ -> 复杂度 $O(w \cdot 2^w)$。手误了。