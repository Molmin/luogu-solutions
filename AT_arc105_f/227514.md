跟 SoyTony 交流了一下好像确实不是很困难。

对于一个点集 $S$，考虑有多少种连边方案使得其为连通二分图。那么容斥一下需要排掉不连通和不是二分图的情况，对于不连通的情况，套路地枚举 1 号点所在连通块即可，所以只需要计算对于某个点集随便选边中二分图的数量。

枚举左部点 $S_1\subseteq S$，那么答案就是：
$$\prod_{i\in S_1}2^{|T_i\cap(S\setminus S_1)|}$$
其中 $T_i$ 是与 $i$ 有边的点的集合。

转为先枚举 $S\setminus S_1$，然后枚举 $S_1$，进而确定 $S=(S\setminus S_1)\cup S_1$。只需要考虑每次 $S_1$ 中增加一个元素的影响，这是容易计算的。

注意这种计算方法对于每种二分图会重复计算 $2^b$ 次，其中 $b$ 为连通块个数。而且考虑了孤立点的情况。

这个做法的时间复杂度为 $\Theta(3^n)$，可以通过。

[Submission](https://atcoder.jp/contests/arc105/submissions/44400607)。