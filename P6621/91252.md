[省选联考 A 卷题解集合](http://endsah.tk/blog/%E7%9C%81%E9%80%89%E8%81%94%E8%80%83-A-%E5%8D%B7%E9%A2%98%E8%A7%A3/#more)

首先解决一下题目所给的关于线性基的问题。

在拟阵的理论中，有这样一个公理：

> 设 $A, B$ 是拟阵 $I$ 中的两个不相同的基，那么对于任意的 $x \in A - B$，存在 $y \in B - A$，使得 $A - {x} + {y}$ 是拟阵 $I$ 中的一个基。

感性理解的话相当于是，将 $A$ 这个基删掉一个 $x$ 之后，线性空间的维数会减去 $1$；$B$ 又是另一个极大线性无关子集，那么肯定能挑出来一个补进去，把 $A$ 的维数补回来。

所以，题目给的对 $A, B$ 集合的和是最小和最大值的限制就比较好解决了：

枚举 $x \in A$，看是否有元素 $y$ 能够加入 $A - {x}$ 这个线性无关集合内，如果能则从 $x$ 向 $y$ 连一条边，表示最后的 $v _x \le v _y$。$B$ 集合同理。

必要性是显然的；上面说的边只要有一个没连上，就会存在一个 $A - x + y$ 集合比 $A$ 更小。

充分性考虑利用上面那个公理，假设有一个与 $A$ 不同的基 $C$，那么将 $A - C$ 里面的元素应用公理一个个替换成 $C$ 中的元素，直到成为 $C$ 为止，可以发现一定满足小于等于的关系。

再考虑有了这些限制边后，怎么处理让 $(v _x - v' _x) ^2$ 最小的问题。（$v' _x$ 是原来的值）

这是个保序回归问题，考虑整体二分。一个点如果在当前情况中取 $mid$ 这个值最优，那么在最终答案，其应取 $mid$ 以下的值；否则会取 $mid + 1$ 以上的值（证明要看论文，但是感性理解起来挺对的……）

于是钦定所有点一开始为 $mid$，选择一个点相当于将其变为 $mid + 1$，那么小于等于的边就相当于选了这个点之后强制选择其相连的点；这是个经典的最小权闭合子图问题，网络流即可。

复杂度大概是 $O(n ^2 m \log V)$？不太会证明 $m$ 的上界，最粗略的估计是 $O(n B)$（$B$ 是指基的大小，这题里面是 $64$）。不过 Dinic 还是很难跑满 $O(n ^2 m)$ 的。