## Start
简单的 $\operatorname{DP}$  
&nbsp;
## DP 数组
显然地，二维 $\operatorname{DP}$

第一位是处理到第 $i$ 位，第二位表示修改过的方案比原方案少错 $j$ 个

**注意：** $j$ 有可能 $<0$，所以 $dp$ 数组第二位要处理一下

观察了 $n$ 的范围，于是我：  
`const int N(2003);`  
`long long dp[N][4007];`  
`#define f(x, y) dp[x][y + N];`

这样就可以非常方便的处理负数的 $j$  
&nbsp;  
## 状态转移方程
分类讨论

如果位移后答案正确性不变，即 $h_i=h_{(i\mod n)+1}$，那么 $f(i,j)=f(i-1,j)\times k$

否则 $f(i,j)=f(i-1,j-1)+f(i-1,j+1)+f(i-1,j)\times(k-2)$

对于第二种情况，稍作解释 $f(i-1,j-1)$ 代表答案 $i$ 由不正确位移后变为正确（正确数 + 1），$f(i-1,j+1)$ 代表答案 $i$ 由正确位移后变为不正确（正确数 - 1），$f(i-1,j)$ 代表位移后答案正确性不变，一共有 $k-2$ 种选法，故乘以 $k-2$  
&nbsp;
## End
需要开 `long long`

统计答案时求 $\sum_{i=1}^{n}f(n,i)$

记得取模