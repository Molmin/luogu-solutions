题意，给定$n$个数，$a_1..a_n$，每次给出$l,r$，令$f(l,r)$为$[l,r]$中最大值，求$\sum\limits_{i=l}^r f(l,i)$

令$suf[i]$表示第一个大于$a[i]$的位置，若不存在则为$n+1$

然后每次查询时，我们考虑每个点最为最大值的贡献，先找到当前区间中第一个$suf[i]$大于$r$的点，则区间$[i,r]$的最大值为$a[i]$，后面的和可以直接算出，用线段树求出这个点，复杂度$O(log n)$

然后前面的点，我们从第一个点开始算答案，每算完一个点$i$就跳到$suf[i]$，依次计算，但如果序列单调递增，这样的复杂度就是$O(n)$的，需要优化

考虑到每个点的后继是唯一的，我们可以把它看作一棵树的形态，用树上前缀和，预处理复杂度$O(n)$，单次查询复杂度$O(1)$

总时间复杂度$O(qlogn)$

然后找最大值那个地方可以用$01rmq$，就可以线性复杂度

反正是一道屑题