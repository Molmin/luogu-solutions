若只有一次询问， 我们可以这样找到可能的答案： 记当前可能的答案为 x， 权值 v 开始为 0， 每次加入一个数， 如果与 x 不同， 若 v=0 则用这个数替换 x 并使 v=1， 否则使 v 减 1；如果与 x 相同则使 v 加 1。可以发现若存在答案则必然是最后的x。 这个信息满足区间加法， 我们可以用线段树维护， 每次询问找到可能合法的答案后， 只需要检验该答案在区间内出现的次数即可， 我们对每种权值开一棵平衡树维护出现的位置即可解决，复杂度$O(n log n)$ 。
