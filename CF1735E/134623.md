朋友的房子可以在 $p_0,p_1$（下文简称为两原点）的同一侧，也可能在两原点之间。也就是说，对于某个合法情境，两原点之间的距离 $|p_0-p_1|$ 一定为某个房子的 $r_0+r_1$ 和 $|r_0-r_1|$ 其中之一。题目的距离序列是乱序的，这提示我们去匹配 $r_0$ 和 $r_1$ 数组，使得对于所有匹配关系可以对应同一个 $|p_0-p_1|$。

我们可以先考虑枚举 $L=|p_0-p_1|$。考虑 $r_{0,1}$ 和 $r_{1,i}$ 匹配，那么我们可以得到 $L$ 的两种情况 $r_{0,1}+r_{1,i}$ 和 $|r_{0,1}-r_{1,i}|$，可以 $O(n)$ 枚举。接下来就是匹配了。

有两种方法。第一种是暴力网络流，假如我们已经知道了 $L$，那么我们可以让 $r_{0,i}$ 和 $r_1$ 中的 $r_{0,i}+L$ 和 $|r_{0,i}-L|$ 匹配。建图跑 dinic，在残量网络上构造方案即可。虽然建出来的图是二分图，但是到汇点的边并不一定为 $1$ ，并不是二分图匹配模型，所以蒟蒻并不知道此方法的复杂度QwQ。

第二种是正解，更巧妙一点。在确定了 $L$ 后，考虑每次在 $r_0$ 与 $r_1$ 序列中大于 $L$ 的距离中取出最大值 $r_{max}$，那么显然它一定要与 $r_{max}-L$ 匹配。否则假如与 $r_{max}+L$ 匹配，这与当前最大矛盾。对于剩下的小于 $L$ 的距离两两互补匹配即可。随便用什么数据结构维护都可以。复杂度是 $O(n^2\log n)$。

两种方法都推荐写一写 。

[两个参考Code](https://www.luogu.com.cn/paste/1zl188xk)