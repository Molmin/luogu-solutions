首先需要知道在只有一个政党的情况下，题目弱化为求一个树中最远的两个点的距离，这个是可以用两遍BFS的方法求出，具体步骤为：

- 随便选择一个节点x，BFS求出距离x最远的节点y（有相同的随便选）。

- 以节点y为起点，BFS求出距离y最远的节点z（有相同的随便选）。

- 节点y和节点z之间的距离，就是这棵树中最远距离。


有了上面这个之后，在本题中，我们对每个政党都做一遍这个方法即可，但是我们不能进行BFS了。注意到BFS只是为了求距离最远的点，那么如果我们可以通过其他方法来求得任意两点间距离的话，步骤就可以转变为：

- 随便选择该政党的一个节点x，枚举该政党的其他节点，求出距离x最远的节点y。

- 以节点y为起点，枚举该政党的其他节点，求出距离y最远的节点z。

- 节点y和节点z的距离，就是该政党的最远距离。


对于求树上任意两点间的距离，一般转化为求LCA的，即


Dist(x, y) = Depth(x) + Depth(y) - 2 \* Depth(LCA(x, y))

求LCA的方法有很多，这里就不再描述了。
