初看此题，可以发现题目的限制是个类似 $n$ 维偏序，因为 $m$ 不大，不难想到预处理出他们两两之间是否存在偏序关系，然后形似记忆化搜索地做个 dp，但直接暴力预处理的复杂度是 $O(n^2m)$ 的，考虑用 `bitset` 维护两两之间是否存在偏序关系，我们可以每次选择一维进行排序，那么排完序后的每个数的前面的数不可能比该数优，每次用 `bitset` 进行一次 `&` 操作即可，`bitset` 的 `&` 的复杂度为 $m \over w$，因此总时间复杂度为 $O(nm log n+ {{n^2m} \over w})$，其中 $w$ 等于 $64$。

[Code](https://www.luogu.com.cn/paste/v61u3fo8)