
## sol
在同一强连通分量内的物品，只需在第一次访问时拾取即可。因此，通过将各个强连通分量合并为一个，可以假定图是一个有向无环图。

以下假定图是一个有向无环图，顶点 1，2，…，N 按拓扑顺序排列。可以将问题转化为最小费用流问题。

首先想到的方法是：

对于 $1 \le u \le N$，准备顶点 $in_u$ 和 $out_u$。另外，准备起点和终点 $S,T$。
对于 $1 \le u \le N$，从 $in_u$ 到 $out_u$ 连边，容量为 1，费用为 $-X_u$。同时，还要连边，容量为 $\infty$，费用为 0。
对于每条边 $(u,v)$，从 $out_u$ 到 $in_v$ 连边，容量为 $\infty$，费用为 0。
从 $S$ 到 $in_1$ 连边，容量为 $\infty$，费用为 0。
对于 $1 \le u \le N$，从 $out_u$ 到 $T$ 连边，容量为 $\infty$，费用为 0。
将 $S$ 到 $T$ 的流量设为 $K$，再将最小费用乘上 $-1$，即为答案。

但是，用这种方法会产生负边。通过以下方法可以消除负边：

对于 $1 \le u \le N$，从 $in_u$ 到 $out_u$ 连边，容量为 1，费用为 0。同时，还要连边，容量为 $\infty$，费用为 $X_u$。
对于每条边 $(u,v)$，从 $out_u$ 到 $in_v$ 连边，容量为 $\infty$，费用为 $X_{u+1}+\cdots+X_{v-1}$。
从 $S$ 到 $in_1$ 连边，容量为 $\infty$，费用为 0。
对于 $1 \le u \le N$，从 $out_u$ 到 $T$ 连边，容量为 $\infty$，费用为 $X_{u+1}+\cdots+X_N$。
答案为流量为 $K$ 时 $S$ 到 $T$ 的最小费用减去 $K(\sum_u X_u)$。