[题目传送门](/problem/CF417E)

怎么大家都来做这题了。

显然构造矩阵和构造一行是等价的，直接对行列分别构造然后相乘即可。

考虑一行怎么做。一个很 naive 的想法就是先塞 $n-1$ 个 $1$ 然后用最后一个调整。也就是说，我们要找到一个 $a$ 使得关于 $x$ 的方程 $n-1+a^2=x^2$ 有正整数解。

根据平方差公式容易得到 $(x+a)(x-a)=n-1$，于是构造 $\begin{cases}x+a=n-1\\x-a=1\end{cases}$，即 $\begin{cases}x=n/2+1\\a=n/2-1\end{cases}$。

但 $n$ 不一定能被 $2$ 整除，直接把这整行 $\times2$ 即可。

因为 $a$ 是正整数所以 $n\le2$ 的时候要特判，不然构造出的 $a\le0$。

时间复杂度 $O(nm)$。代码非常好写。