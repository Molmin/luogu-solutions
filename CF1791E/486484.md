本题有几个关键的性质：

$1.$ 每个数至多被选择 $1$ 次。

$2.$ 若对一段连续的区间 $[l,r]$ 进行操作，那么最终结果是 $a_l=-a_l$，$a_{r+1}=-a_{r+1}$，并且其他位置均不改变。

这样一来，对于序列中的任意两个数，我们都能使他们同时取反。

统计序列中负数的数量，设为 $cnt$。

若 $cnt$ 为偶数，则直接将序列中所有负数取反。

若 $cnt$ 为奇数，且序列中最小的非负整数绝对值小于序列中最大的负数的绝对值，则将序列中所有负数取反，并将最小的非负整数取反。

否则，将除最大负数的所有负数取反。

这样做能保证答案最优。

时间复杂度 $\mathcal{O}(T n \log n)$，空间复杂度 $\mathcal{O}(n)$。时间复杂度较劣的原因是因为我使用了排序。

[AC Code](https://codeforces.com/contest/1791/submission/191997324)