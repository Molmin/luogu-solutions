朴素实现需要用 dilworth 定理进行对偶后转最小链覆盖，赛时写的这坨东西也没能过去。

考虑抓住值域 $2m$ 和选出的数的个数 $m$ 之间的关系。显然对于所有形如 $k·2^i(k\in\text{odd})$ 的数，我们最多选出一个，因此总共可能选出的数的个数的上界就是 $m$，而要使选出的数的个数为 $m$，我们也必须恰好选择一个。

我们假设对于奇数 $k$，我们选择 $k·2^{p_k}$，那么合法的要求是 $\forall k_1\mid k_2,p_{k_2}<p_{k_1}$。因此我们考虑求出 $p_k$ 的上下界 $L_k,R_k$，这显然可以调和级数地预处理出来。

那么什么样的 $i$ 满足 $k·2^i$ 可能合法呢？答案是所有 $L_k\le i\le R_k$ 都合法，因为显然我们可以取 $p=\{R_1,R_3,\cdots,R_{k-2},i,L_{k+2},L_{k+4},\cdots,L_{2n-1}\}$。

这样总复杂度就是 $n\ln n$。