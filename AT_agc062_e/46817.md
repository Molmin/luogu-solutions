~~为啥这题没有英文题解~~

---

先不考虑 $k$ 的限制。考虑枚举二叉树，数有多少个满足条件的区间序列。经过下面的分析可以说明，每个区间序列会恰好被数一次。

由深到浅确定这些区间的位置关系，一个点上的区间 $l,r$ 需要满足和子树的区间都交，那么 $l$ 必须在左子树所有右端点左边，容易发现这个选法是“不断向左儿子走的次数” $+1$，$r$ 的选法同理。

因此可以把树剖成若干条链，一条长度为 $d$ 的链贡献 $(d+1)!$ 的系数，一棵树的总方案数是所有系数之积。

转化一下计数对象，将一条链缩成一个点，新图两点间有边当且仅当在原树对应的链有交。原树上的链长变为新树上的度数。

于是问题变为对点有标号的，以某条边作为根的有根树计数，且区分根的左右儿子，容易证明钦定度数后连边的方案数是 $2(n-1)!$，而一棵树会被重复计数 $n!$ 次，即：
$$
\frac{2}{n}[x^{2n-2}](\sum\limits_{d=1}^n(d+1)!x^d)^n
$$
考虑 $k$ 的限制，这样的点一定是叶子，并且会将所在长度为 $d$ 的链的系数由 $(d+1)!$ 变为 $d!$。其它叶子的贡献是 $(d+1)!-d!$。最终答案为：

$$
\frac{2}{n}\binom{n}{k}[x^{2n-2}](\sum\limits_{d=1}^nd!x^d)^k(\sum\limits_{d=1}^n((d+1)!-d!)x^d)^{n-k}
$$
多项式快速幂即可，复杂度 $O(n\log n)$。