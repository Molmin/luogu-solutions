当初在讨论区被问到这题本来想胡个数点胡挂了，那个时候就乱胡了一个 $n\log$ 的扫描线，现在听机房说网上没啥靠谱（$n^2$ 除外）的题解？

口胡选手不邀自来，经机房验证正确性无误。

------------

如果是矩形求并很容易就想到扫描线，现在我们只有一个矩形的左下角了，我们还是考虑扫描线。

回顾矩形，我们用它左边界代表加入，右边界代表删除，而直角三角形我们发现只有一个左边界，往右扫的过程中自然递减而消失。

于是我们也就只考虑左边界，用三元组 $(x,l,r)$ 表示横坐标为 $x$，纵坐标覆盖 $[l,r]$ 的区间，把三元组按 $x$ 排序后加入。

------------

我们手动给这道题出一个便于思考的 Subtask，$\forall(a,b,c),a=1$，即所有三角形左边界的横坐标相同，扫描线会在第一个时刻全部加入。

由于排完序后第一维作用就少了很多，以下二元组表示三元组的后两维，容易发现，如果 $\exists (a,b),(c,d),c\le a\le b\le d$，那么 $(a,b)$ 是无用的。

剩下的二元组形如：$(a_i,b_i),a_{i-1}<a_{i},b_{i-1}<b_i$。

若 $b_{x-1}\ge a_x$，那么前面的高一点的左边界覆盖着低一点的左边界上端，否则出现了断层，一个断层只会有最高处一处递减，下面由于被覆盖无变化。

观察往后移而不新增 $b_{i-1}<a_i$ 的情况，每一时刻的差量是一样的，可以用~~高中~~初中知识搞个二次函数算贡献。

考虑出现 $b_{x-1}\ge a_x\to b_{x-1}<a_x$ 的情况，此时出现了新的断层，显然的发现这样的断层只会在相邻的两个二元组处出现。

$b$ 在递减而 $a$ 不动，同时 $\forall a_x<a_y,b_x<b_y$，容易发现这样的断层在最初就能确定其发生时间。

我们时刻维护当前递减的量，发生了断层对差量的变化量贡献也是 $O(1)$ 的，后续处理是容易的。

------------

考虑做原问题，不保证三角形左边界横坐标相同。

其实也就是将加入时间变得不一样了，考虑在某个时刻插入了 $(l,r)$ 的二元组有何变化。

- 首先 $\exists(a,b),a\le l\le r\le b$，则弹出 $(a,b)$，并删除其对应的断层事件，势能分析显然。
- 然后查找 $(l,r)$ 的前驱后继，讨论并加入断层事件，不要忘了还有递减到消失的消失事件。

以上过程可以简单的使用 `set` 维护，整理一下需要做的事：

- 维护贡献，在不出现任何事件时贡献使用二次函数计算。
- 加入事件，真就加入一个 $(l,r)$，弹出无用元素并相应的修改断层事件。
- 断层事件，只对贡献造成影响。
- 消失事件，只可能对贡献造成影响。

注意这里的二元组应该是与扫描线的时间有关的，我们应该插入 $(l,r+t)$，其中 $t$ 为插入时的时间（横坐标）。

查询时丢入 $T$，则真实二元组为 $(l,r+t-T)$，其中 $T$ 为当前时间（横坐标）。

复杂度 $O(n\log n)$，全带在 `set` 上。