# 简单题

### 前言

这里讲一个楼下没有讲过的做法。

题目链接：[$\text{Link}$](https://www.luogu.com.cn/problem/CF961B)

$AC$ 记录：[$\text{Link}$](https://www.luogu.com.cn/record/42073460)

目前是最优解（不开 $O2$）

### 题目大意

给定长度为 $n$ 的数列 $a$ 和只含 $0,1$ 的数列 $t$。

你可以将 $[i,i+k-1]$ 这一区间的 $t_i$ 都变为 $1$。（只能用一次）

求 $\sum_{i=1}^na_it_i$ 的最大值。

$1\le n\le 10^5,1\le a_i\le 10^4$。

### 解题思路

不难想到，既然要求出 $\sum_{i=1}^na_it_i$ 这个柿子的最大值，那么我们肯定是要将上述操作放在有 $0$ 的区间里的，毕竟没有 $0$ 的话就跟啥都没干是一样的。

我们便可以对于每个 $t_i=0$ 的位置 $i$ 挨个进行操作，如果在 $[i,i+k-1]$ 这个区间进行操作后，它的贡献会是多少。

显然，对于每个 $t_i=1$ 的位置肯定是要算上这个位置的 $a_i$，而在这个区间的每个 $t_i=0$ 的位置上的 $a_i$ 也要算上。

但这样最坏情况下复杂度为 $O(n^2)$。

但这显然是个求和的问题，可以通过前缀和来做，$sum_i$ 为所有 $t_i=1$ 上的 $a_i$ 的和，$h_i$ 为所有 $t_i=0$ 上的 $a_i$ 的和，这样对于区间 $[i,i+k-1]$ 进行操作产生的贡献就是：

$$sum[n]+h[i+k-1]-h[i-1]$$

去个最大值即可，但有两个问题要注意：

- $i+k-1$ 可能 $>n$，所以需要特判。

- 如果所有 $t_i$ 都等于 $1$，那么根本不会进行取最大值的操作，于是可以将 $h[i+k-1]-h[i-1]$ 中取个最大值，最后输出时 $+sum[n]$。

但是还可以优化，比如 $n=1e5$ 而只有一个 $t_i=0$ 则在枚举的时候浪费了太多的时间，所以可以做一个类似单向链表的东西存所有 $t_i=0$ 的位置。

[$code$](https://paste.ubuntu.com/p/srNthPF9qQ/)

去掉读入的时间复杂度：$O(num_0)$（$num_0$ 为 $t_i=0$ 的个数）

空间复杂度：$O(n)$。

$$\texttt{The End.by UF}$$