这个矩形中有大量相同的数，于是对之做行查分，得到新的 $b_{i,j}=a_{i,j}-a_{i+1,j}$ 。

发现对于 $1\le j<i<n,b_{i,j}=0$ 。 于是求行列式时，如果排列中一个置换环大小 >1 ，那这个环一定包含 $n$ ，且环的连边顺序是从小往大连，连到 $n$ 后再连回去。

先把全是自环算了，然后令这个大环内的数是 $p_1,p_2,...,p_m$ ，其中 $m\geq 2,p_m=n$ ，且对于 $i<m$ ， $p_i<p_{i+1}$。则这个选法的贡献是 $(-1)^{m-1}C\prod_{i=1}^{m-1}b_{p_i,p_{i+1}} (1-C)^{n-m}=(1-C)^{n-1}C\prod_{i=1}^{m-1}\frac{1}{C-1}b_{p_i,p_{i+1}}$ 。

我们再来思考 $b$ 有什么性质。根据定义不难得到，当$i+1=j$ 时，$b_{i,j}=C-1-C[i|j]$ ，否则 $b_{i,j}=C[i+1|j]-C[i|j]$ 。

我们是可以把 $b_{i,j}$ 的前后两个式子拆开算的。再算上 $\frac{1}{C-1}$ 的系数，可以把问题转化成：

在 $i,i+1$ 间有权值为 $1$ 的边，$i,k(i+1)(k>1)$ 间有权值为 $\frac{C}{C-1}$ 的边，$i,ki(k>1)$ 间有权值为 $\frac{-C}{C-1}$ 的边。从 $1\le i<n$ 的一个点出发，最后要走到 $n$ ，问所有方案的权值乘积之和。

但是从 $i$ 到 $k(i+1)$ ，可以直接走，权值为 $\frac{C}{C-1}$ ；也可以先走到 $i+1$ ，再走到 $k(i+1)$ ，权值为 $-\frac{C}{C-1}$ 。于是这两种就抵消了，非常神秘。

于是我们就只会先走一段 $i,ki$ ，再走一段 $i,i+1$ 。

令 $V=\frac{-C}{C-1}$ ，$F(x)=V\sum\limits_{i\geq 2} x^i$ ，$G(x)=\sum\limits_{i\geq 0} F(x)^i$ 。

则上述问题答案为 $\sum [x^i]G(x)\left\lfloor\dfrac{n}{i}\right\rfloor-1$ 。如果能筛出来 $G$ 的前缀和就好了。

虽然 $G$ 不是积性函数，但由于 $F*G=e$ ，且 $F$ 的前缀和易求，我们仍然可以用杜教筛解决问题。复杂度 $O(n^{2/3})$ 。
