赛时过了这题，写篇题解纪念下。

---

首先，假设序列为 $2\;4\;5\;1\;3(n=5)$，对于第一个字符（假设为 $\text{a}$）：

- 第一次重排后，由于 $p_1=2$，所以 $\text{a}$ 到达了第二个位置；
- 第二次重排后，由于 $p_2=4$，所以 $\text{a}$ 到达了第四个位置；
- 第三次重排后，由于 $p_4=1$，所以 $\text{a}$ 回到了第一个位置。

不难发现，$\text{a}$ 经过的所有位置组成了一个环，所以，每 $3$ 次重排，$\text{a}$ 就回到了原点。

这样来说，就有了最初版的解题思路：

> 寻找所有环，统计长度的 $\operatorname{lcm}$

但是分析样例的第一组数据，发现：

有可能出现环内存在循环的情况，此时应该取最短循环节的长度。

所以，正确思路是：

> 寻找所有环的最短循环节，统计长度的 $\operatorname{lcm}$

最后注意记得开`long long`。