## Preface

感觉没有蓝。

## Solution

考虑一次操作其实相当于删除除了钦定点以外的叶子，如果这棵树只有一个节点就输了。

我们考虑一个树的结构**其实是困难的**。但是考虑到经过若干次操作后，一些点总会并到另外一些点上，而**那些最后被删掉的点，其实是一条直径**，这启发我们维护树的直径。

具体地，令树的直径上有 $n$ 个节点。一次操作可以让 $n \leftarrow n - 2$（若 $n \gt 2$，选择非直径端点节点）或 $n \leftarrow n - 1$（选择直径端点）。若操作后 $n = 1$ 则对方输，其实就是操作前 $n = 2$ 必败。

这是经典的博弈论问题，下面直接给出结论：

+ $n \bmod 3 = 2$。后手始终保证 $n \bmod 3 = 2$（先手减 $1$，后手减 $2$，反之亦然），那么先手到了 $n = 2$ 时必败。
+ $n \bmod 3 \neq 2$。先手第一步让 $n \bmod 3$ 变为 $2$，先手必胜。

时间复杂度 $\mathcal O(N)$。