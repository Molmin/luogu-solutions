我们考虑每次操作，若选在非叶子节点，外围一圈的叶子结点的硬币都向内移，若选在当前的叶子节点则除了这个节点以外的叶子结点内移

如果我们把内移转化到直径上，每次操作可以让直径长度$-1$或$-2$

谁先操作使直径长度为0获胜

因为如果选直径上的点，直径外的点一定在直径为0之前消失，我们先不考虑直径外的点

先手必胜的条件是直径长度$\mod 3$不等于$0$

因为只要先手取直径长度$\mod 3$，后手无论怎么取，先手都能取与之不同的使剩余数对3取模不变

反之亦然

只要必胜方坚持取直径上的点，直径外的点无法影响答案

但是若最后剩下2个点，我一次只能消掉1个

所以有以下策略

$len\mod 3 = 0$ ，先手先消1个，然后与对方拼3，最后剩2个，先手必胜

$len\mod 3 = 1$ ，若只有1个，直接消，否则先手先消2个，然后与对方拼3，最后剩2个，先手必胜

$len \mod 3 =2$，后手与先手拼3，最后剩2个，先手先拿，后手必胜