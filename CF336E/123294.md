### *[CF336E Vasily the Bear and Painting Square](https://www.luogu.com.cn/problem/CF336E)

挺酷的题目。

不区分颜色，求出选择 $k$ 个三角形的方案数，再乘以 $k!$。

三角形只有这四种：

- 大小为 $1$ 且不经过原点的小三角形。
- 大小为 $2$ 且不经过原点的小三角形。
- 以原点为顶点的大三角形。
- 两个以原点为顶点的大三角形拼起来的经过原点的大三角形。

设 $f_{n, k}$ 表示答案。前两类三角形在 $f_n\to f_{n + 1}$ 时关于 $f_n$ 是独立的，但后两类不是。对于第三类三角形，它要求 $f_n$ 的对应的象限没有被选中任何三角形。对于第四类三角形，它要求 $f_n$ 的对应的两个象限没有被选中任何三角形。

记录 $S$ 表示每个象限是否被选中三角形即可。

时间复杂度 $\mathcal{O}(nk)$。

[代码](https://codeforces.com/contest/336/submission/210629569) 使用了一种完全不同的做法：设 $f_{p, n, k}$ 表示 $p$ 个连续的象限的答案，根据实际意义转移。为了防止枚举大三角形时复杂的分类讨论，设 $g_{p, n, k}$ 表示 $p$ 个连续的象限，且没有选 $n$ 阶大三角形的答案。有一种情况的转移需要背包，时间复杂度 $\mathcal{O}(nk ^ 2)$。