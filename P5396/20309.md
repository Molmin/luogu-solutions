无意间整出了第二类斯特林数·列的生成函数...过来水一篇题解...

首先把第二类斯特林数的组合意义转化一下，变成$k$个有标号的盒子。这直接把第二类斯特林数乘个$k!$就好了。

那么这可以看成一个长度为$n$的序列，有$k$种颜色供挑选，求有多少种染色方案满足序列正好有$k$个颜色。

不难发现答案等于

$$\prod_{i_1>1}\prod_{i_2>1}...\prod_{i_k>1}\frac{n!}{\prod_{j=1}^k(i_j)!}$$

提出来就发现这是一个$\mathbf{EGF}$相乘的形式。

$$k!\frac{S_n^k}{n!}=(e^x-1)^k[x^n]$$

$$\frac{S_n^k}{n!}=\frac{(e^x-1)^k}{k!}[x^n]$$

即

$$\sum_{i=0}^{\infty}S_i^k\frac{x^i}{i!}=\frac{(e^x-1)^k}{k!}$$

然后倍增快速幂可以做到$O(n\log_2^2n)$，多项式快速幂直接就$O(n\log_2n)$了。

请各位大佬不要$D$我，也不要问我怎么想到的，这是各类环境因素（包括以前做过的计数题，一些大佬的发言）引发的突发奇想...