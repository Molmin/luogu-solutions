没题解？发一弹。

----


ST表，倍增

有$n$个人围成一圈，要传递消息。第$i$个人会在$1$个时刻内把消息传递到距离他不超过$a_i$的人。

问第$0$时刻分别只有$1,2,3,···,n$知道消息时，各需要多少时间才能把消息传递到所有人?

序列上做法：

每一时刻传递到信息的人一定是连续的，记录这段区间为$[l,r]$。

那么，下一次传递，我们就让$[l,r]$中能往左、右传递最远的两个点进行传递。

这个可以用ST表维护区间最值，然后$O(1)$单次跳。

查询时，也倍增。

时空复杂度：$O(n \log ^2 n)$。

_____

圈上做法：

将序列变成三倍长度，建ST表。

从中间开始倍增，如果每次跳完后区间长度$\geq n$则说明完全覆盖。以此倍增。

时空复杂度同序列上做法。

但是三倍的空间开不下，三分的查询是类似的，所以可以只开一倍空间，每次查询分三段。

刚好卡进$256MB$。

