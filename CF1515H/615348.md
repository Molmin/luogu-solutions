细节题，思维难度 $2500$。

看到位运算，考虑 $\text{01-trie}$。区间操作可以通过字典树合并和分裂来做。

异或是好维护的，打一个标记就行了，考虑或和与。比如或，发现实际上就是把线段树上那几位的左孩子与右孩子合并，考虑势能，可以只考虑既有左孩子又有右孩子的那些与「或」相关的节点，其余的就是把左孩子变成右孩子，不会影响答案（当然在 $\text{01trie}$ 合并之后可能会），直接打标记即可。$\text{trie}$ 的每个节点来维护那些位既有左孩子又有右孩子，作为势能，即可。