魏老师的题，很酷！

题解区全是 $O(n)$ 的，但是实际上完全不需要。

考虑求出所有 $\gcd(i,n)$ 之后，剩余的部分都是简单的高精度运算，所以我们需要做的其实是尽量快地求出所有 $\gcd(i,n)$。普通的 $O(n\log n)$ 做法显然被卡掉了，但是在考虑莫反这种高级算法之前，我们可以继续尝试暴力。

考虑对于 $n$ 的每个质因数 $p$，我们暴力地给 $p^1,p^2,\cdots$ 的倍数的 $\gcd$ 数值乘 $p$。这玩意的操作次数是 $\frac{n}{p}$ 到 $\frac{n}{p-1}$ 之间的一个数。因为 $2\times 3\times 5\times 7\times 11\times 13\times 17\times 19$ 和 $10^7$ 很接近，直接计算操作次数最大值就可以发现操作次数是可以接受的。

事实上写出代码跑在最后一个 sub 跑出了 $\text{50ms}$ 的好成绩。