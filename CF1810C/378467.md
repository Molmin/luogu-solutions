容易发现，一个排列中不能有重复的数字。所以排列中所有的重复的数字都要被删除。

然后枚举每一个数字 $x$，计算 $1\sim x$ 的排列的代价即可。

~~时间复杂度 $O(n^2)$ 没错我在逗你~~

考虑优化。

首先将 $a$ 数组去重并排序。

然后枚举每一个数字 $x$，容易发现需要补全 $[1,x]$ 中的数，并且删除 $[x+1,+\infty)$ 中的数。

这个鬼玩意用线段树随便算一下就可以了。

时间复杂度 $O(n\log n)$。