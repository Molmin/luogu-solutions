看了一下远古题解，表示格式和内容非常谔谔。

题意很是不清楚。

### 题意

有 $n$ 个瓶子，每个瓶子有一个容量。从中选 $k$ 个交给火星人，火星人会在一些操作后将装了燃料的瓶子给你。火星人很不善良，想要尽量少的给你，但是为了不显得吝啬，不能不给你。火星人只能执行以下操作：

1. 装满一个瓶子；
2. 倒空一个瓶子；
3. 将一个瓶子中的燃料倒入另一个瓶子，直到那个瓶子满了或者这个瓶子空了。

问你最多能获得多少燃料。

### 思路

经典问题。

先考虑两个瓶子的情况。设容量分别为 $x,y$，且 $x<y$。

当 $x$ 是满的，$y$ 是空的时：

1. 倒空：相当于减去 $x$。
2. 倒满：相当于加上 $y$。
3. $x\to y$：要么不变，要么同倒空。


当 $y$ 是满的，$x$ 是空的时：

1. 倒空：相当于减去 $y$。
2. 倒满：相当于加上 $x$。
3. $y\to x$：若再倒掉 $x$，相当于减去 $x$；若再倒掉 $y$，相当于减去 $y-x$。

当 $x,y$ 内都有燃料的情况也可以类似分析。发现无论怎样，总燃料都可以表示为 $ax + by$。根据裴蜀定理，$ax+by=k$ 的所有解都满足 $\gcd(x,y)\mid k$，所以 $ax+by$ 的最小正整数解为 $\gcd(x,y)$。换句话说，当给外星人容量为 $x,y$ 的两个瓶子时，他会给你 $\gcd(x,y)$ 的燃料。

推广到 $k$ 个瓶子，外星人将会给你 $\gcd(a_1,a_2,a_3,\cdots,a_k)$ 的燃料。所以现在要在 $n$ 个数中选取 $k$ 个，使得这个值最大。

只需要分解出每个数的所有因数，记录 $cnt_x$ 表示有多少个数含有因数 $x$。选取最大的 $x$ 满足 $cnt_x\geq k$ 即可。时间复杂度 $\mathcal O(n\sqrt a)$。

好吧我为了图方便写了 map 居然也能过，但这已经不是本题解的重点了。用桶实现就行。

分解因数时应当注意完全平方数的情况，不过这个题好像没卡。

[AC code 记录](https://www.luogu.com.cn/record/100806041)
```cpp
int n, k, a[1010];
map <int, int> cnt;

int main() {
	read(n, k); rer(i, 1, n, a);
	rep1(i, 1, n) {
		rep1(j, 1, sqrt(a[i])) if (a[i] % j == 0) {
			++cnt[j];
			if (j * j != a[i]) ++cnt[a[i] / j];
		}
	}
	int ans = 1;
	for (auto v : cnt) if (v.snd >= k && v.fst > ans) ans = v.fst;
	printf("%d", ans);
	rout;
}
```