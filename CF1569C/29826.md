可以注意到，答案只会和最大的两个数有关（因为到后面的轮次时只会剩下这两个数）。设最大为 $a$，出现了 $A$ 次；次大为 $b$，出现了 $B$ 次。

当 $a\ge b+2$ 时，手动模拟可以发现是无解的；

当 $A\ge 2$ 时，同样可以发现任意排列都是合法的；

比较麻烦的是 $a=b+1$ 的情况，注意此时 $A=1$。条件等价于至少有一个 $b$ 放在 $a$ 的后面。从概率角度考虑，在全排列的情况下只考虑 $a,b$，那么 $a$ 不放在最后的概率是 $\frac B{B+1}$。因此答案为 $n!\frac B{B+1}$。