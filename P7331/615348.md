[AC record](https://www.luogu.com.cn/record/113898915)

# 题解成分

- 官方题解中的 'Node-to-Prefix' 的另一种清真做法；
- 如何卡常。

## 官方题解中的 'Node-to-Prefix' 的另一种清真做法

官方题解中给出了一种所谓的“暴力”做法，然而也有另一种做法。

我们令额外加入的 $m$ 条边 $(u, v)$ 中的 $u$ 为关键点，那么每个点可以用一个 `unsigned` 来存储是否能到达每一个关键点。

现在就变为了有一个 $\le m + 1$ 个点的点集，考虑按照 $\text{dfn}$ 排序，然后其路径并实际上就是每个点到根节点的路径减去相邻两点的 $\text{LCA}$ 到根节点的路径。

## 如何卡常

如何去除 $\text{MLE}$：

1. 手写内存池代替 vector；
2. 无用数组及时释放。

如何去除 $\text{TLE}$：

1. 在莫队处理 $\forall i \in [1, x - 1]$ 能到达到 $x$ 的数量和对端点进行扫描线的部分可以合并。
2. 注意减少莫队常数，比如左右端点直接跳的时候可以用前缀和将这部分的根号去掉。
3. 实在不行自己试试吧 >_<。