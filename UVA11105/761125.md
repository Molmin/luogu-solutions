## UVA11105 题解

### 前置知识

- 埃氏筛

### 题目解法

首先，我们把题目分解成几个步骤。

#### 一、筛出 “H 素数”

这个地方呢，我们采用了埃氏筛的变形（其实只用把开始值设为 $5$，每次加 $4$ 就可以了，其它按照埃氏筛写）：

```cpp

int n=1000000;
//埃氏筛板子
for(int i=5;i<=n;i+=4){//注意这里每次加 4
	if(a[i]==0)p[++t]=i;
	for(int j=i*2;j<=n;j+=i){
		a[j]=1;
	} 
}
	
```

#### 二、筛出 “H 合成数”

筛好 H 素数发现其实只有 $9\times10^4$ 左右个，那么我们可以放心的枚举两个 H 素数，把它们乘起来，再顺手做一个和欧拉筛差不多的优化，就好了。

```cpp

for(int i=1;i<=t;++i){
	for(int j=1;j<=t&&p[i]*p[j]<=n;++j){
		h[p[i]*p[j]]=1;//标记这个数成为 H 合成数
	}
}
```

#### 三、处理答案

直接枚举答案肯定会爆炸，我们使用前缀和的思想，预处理出每一个答案。最后一个一个输出即可。

这块代码不放了，看完整代码。

### AC 代码

```cpp
#include<iostream>
using namespace std;
int p[1000005],t,T,ans[1000005];
bool a[2000005],h[2000005];
int main(){
	int n=1000000;
	for(int i=5;i<=n;i+=4){//第一步
		if(a[i]==0)p[++t]=i;
		for(int j=i*2;j<=n;j+=i){
			a[j]=1;
		} 
	}
	for(int i=1;i<=t;++i){//第二步
		for(int j=1;j<=t&&p[i]*p[j]<=n;++j){
			h[p[i]*p[j]]=1;
		}
	}
	for(int i=1;i<=n;++i){//第三步
		ans[i]=ans[i-1]+h[i];
	}
	int x;
	while(cin>>x){
		if(x==0)break;
		cout<<x<<" "<<ans[x]<<endl; //输出，别忘了换行
	}
	return 0;
}
```



