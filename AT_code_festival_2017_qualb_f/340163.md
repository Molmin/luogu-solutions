不妨假设 $\gcd(X,Y,Z)=1$，如果不为 $1$ 答案串会出现循环节。

显然原问题给的是 $X+Y+Z$ 个 Lyndon 串。我们直接把串用最小表示来表示（也就是 Lyndon 形式），合并就直接把小的接在大的后面。

为什么这样合法并且优？合法性可以直接考虑 Lyndon 串性质，满足 $u < v$ 的 $uv$ 一定是 Lyndon 串（这里不会取等，因为没有循环节）。为什么不循环位移 $v$ 再拼接（不循环位移 $u$ 的原因显然）？这样一方面会破坏 Lyndon 串的性质，另一方面整个串的最小表示不会变小，原因是，如果拆出来的 $v$ 的前缀本来就比 $u$ 大，显然不优；和 $u$ 的前缀相等，因为 $u$ 是 $u$ 的所有后缀中最小的那个，也不优。

那么剩下的问题是若干个字符串拼接，每次选两个将小的拼在大的前面形成一个字符串塞回去，问最后形成的字符串字典序最大是多少。贪心策略是最小的字符串和最大的字符串拼接。因为当前最小的字符串一定会作为字符串的前缀出现在答案串，如果拼接的不是最大的串一定不优。所以 exchange argument 可证每次操作一定采取上述策略。

代码大家都有。