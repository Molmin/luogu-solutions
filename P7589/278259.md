## P7589 黑白棋（2021 CoE-II B）

水 Nim。

题目稍长，先读清楚题:

- 有若干条直线，直线上双方各摆一个棋子，棋子坐标为整数。
- 游戏过程中，规定前进方向为对方棋子的方向，在某一方的回合中，操作方可以选择一条直线上自己的棋子前进或后退整数单位距离一次。
    - 前进最多移到对方棋子面前，除此之外没有距离限制。
    - 后退最多移动 $d$ 距离。整局游戏最多移动 $k$ 次。
- 若一方合法策略为空时，则判其负。
- 求先手是否必胜。

读完我们可以知道，后退是没有任何的作用的，因为每次执行后退，对方都可以通过前进同样的长度来保持局面。所以我们可以直接不考虑后退。

先只考虑一根直线构成的子游戏，那么当两个棋子之间坐标差 $>1$ 时，先手可以直接把棋子移到对面棋子前面一个单位长度上，使得对方的棋子无法移动，此时先手必胜。

我们设这样一个游戏的 SG 函数值为两个棋子的坐标差 $-1$。由于直线与直线之间没有影响，所以直接对这些单独直线组成子游戏求和。也就是将这些子游戏的 SG 函数求异或和就得到了整个游戏的 SG 函数。

也就是说，这就是一个几乎裸的 Nim 游戏。每个直线的两个棋子之间的距离差 $-1$ 即是石子数量。

```cpp
#include <bits/stdc++.h>
using namespace std;

const int N=1e5+10;

int arr[N];

int main()
{
	int t;
	scanf("%d",&t);
	while(t--)
	{
		int n,k,d;
		scanf("%d%d%d",&n,&k,&d);
		int res=0;
		for(int i=1;i<=n;i++)
		{
			int y,a,b;
			scanf("%d%d%d",&y,&a,&b);
			res^=abs(a-b)-1;
		}
		if(res) printf("Yes\n");
		else printf("No\n");
	}
	return 0;
}
```
