### 前言

[题目link](https://www.luogu.com.cn/problem/AT187)。这个题被我用了远远高于蓝题的算法解决了。~~虽然我还没有写。~~

但是思维难度真的低。

### 正文

题目大概意思就是 $n$ 和 $m$ 给定，然后让你求出用 $m$ 个整数的乘积表示 $n$ 的方法数。

首先，不管这个 $m$ 是整是负，我们都能知道这 $m$ 个整数一定是 $n$ 的约数。

想到了约数，并且这个题又是一个数数题，那么~~不~~自然地就能够想到 pollard-rho。

首先跑一遍 pollard-rho 把 $n$ 唯一分解。这里讲一个小技巧：我们可以用 STL 的 map 来存储底数（素因数）和其指数的关系。这个也是易于实现的。略过了。

然后继续来看。

我们假设这个 $n$ 唯一分解以后长成这个样子：

$$n=\prod_{i=1}^{\text{unknown}}p_i^{k_i}$$

其中 $\text{unknown}$ 表示 $n$ 含有不同的素因子个数，$p_i$ 是素因子，$k_i$ 是指数。

然后进一步思考。我们要求得的答案是他分解为 $m$ 个数的方案种类。那么这个问题就变成了一个组合数学问题。

现在我有 $z$ 个因数，我需要知道从其中挑出 $m$ 个数，他们的积正好是 $n$ 的种数。

由于我已经将 $n$ 唯一分解了，那么我就知道了每一个素因数对应的指数。对于每一个素因数，$n$ 所对的 $p_i$ 的指数 $k_i$，一定是所有分解得来的数的 $p_i$ 的 $k'_i$ 之和。

进一步来说，我们可以写出这样一个式子：

$$\sum k'_i=k_i$$

其中 $k'_i$ 是分解的数的某一个质因数的指数，$k_i$ 是原数 $n$ 所含的这个质因数的指数。

感性的认识一下上面那个式子所对应的问题：一个有 $k_i$ 个小球的盒子，现在要把它分成 $m$ 堆，有几种方法。

对于每一个素因数我们都来求解这样一个问题，然后用乘法原理来算一下即可。

这是我们的第一个子问题。就是 $n$ 为正，且所有分解得到的数都为正数。

然后我们来思考接下来一个问题，如果 $n$ 为正，有可能分解得到的数为负数怎么办？

由于负数一定有偶数个，那么我们可以先行遍历一遍求出所有的符号可能性，然后和之前的结果乘一下就行了。

然后我们再讨论一下 $n$ 为负数时所得的结果。这个也是很简单的，跟 $n$ 为正数其实一样，只是后面讨论负数个数的时候稍微有些差别。

就是这样。这个题其实真的挺简单的。











