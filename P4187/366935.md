## Tag

递推，计数。

## Description

一个长为 $n$ 的序列，用 $m$ 中颜色对其染色，要求至少有 $1$ 个长度为 $k$ 的相同颜色的颜色块的方案有多少种。

$\texttt{data range:} n,k,m \leq 10^6$.

## Solution

一道非常有意思的题，如果我们正向考虑的话会很容易发现很难以判断掉重复情况，如果是容斥的话会漏掉一些情况，所以我们要换一种角度考虑：不满足的方案。

根据题目的性质，我们很容易就能找到不满足的方案，那么总共的方案也很好找，就是 $m^n$，那么我们考虑前 $i$ 个方块的不满足方案为 $f_i$，那么我们就很容易知道：
$$
f_i=mf_{i-1}\ \ \ (i < k)
$$
因为前 $k$ 个不可能有可行情况嘛……

然后我么考虑后面的情况，对于长度正好为 $k$ 的时候，我们就应该用**当前不合法情况减去合法情况**，这就是这题十分重要的一个思路：**从合法中找不合法，再从不合法中找合法**。

那么长度正好为 $k$ 的合法情况就只有 $m$ 种，就是正好全都是一个颜色的方案。
$$
f_k=mf_{k-1}-m
$$
然后再考虑大于 $k$ 的情况，那么只要使得第 $i-k$ 个与第 $i$ 个不是相同颜色即可，那么就是：
$$
f_i=mf_{i-1}-(m-1)f_{i-k}\ \ \ (i > k)
$$
然后直接做就可以了，时间复杂度 $O(n)$。