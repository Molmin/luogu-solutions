> CF1637G Birthday

关键性质：最终得到的相同的数不含奇质因子。因为若 $p\nmid x \lor p\nmid y$，则必然 $p\nmid x +y \lor p\nmid |x - y|$。存在 $1$ 不被任何奇质因子整除，得证。

若存在 $0$，我们可以将任意数乘以 $2$：$(0, x)\to (x, x)\to (0, 2x)$，因此考虑先将所有数变为 $2$ 的幂，再通过上述操作全部变为不小于 $n$ 的最小的 $2$ 的幂。考虑递归构造 $\mathrm{solve}(n)$：将 $1\sim n$ 变为 $2$ 的幂。

- 若 $n \leq 2$，则已经满足条件，返回。
- 否则，若 $n$ 是 $2$ 的幂，则递归 $\mathrm{solve}(n - 1)$。
- 否则，设 $p = 2 ^ {\lceil\log_2 n\rceil}$，执行 $(p - 1, p + 1), (p - 2, p + 2),\cdots, (2p - n, n)$。没有被执行的数为 $1\sim 2p - n - 1$ 和 $p$，后者已经是 $2$ 的幂，故执行 $\mathrm{solve}(2p - n - 1)$。上述操作得到了若干 $2p$ 和 $2, 4,\sim 2n - 2p$，前者已经是 $2$ 的幂，故执行 $\mathrm{solve}(n - p)$，再将所有操作的数乘以 $2$。

不难发现 $\mathrm{solve}(n)$ 可以满足我们的要求。接下来，当 $n = 2$ 时，我们无法凑出 $0$，故无解。否则，根据 **鸽笼原理**，必然存在两个 **小于** $n$ 的 $2$ 的幂 $(2 ^ r, 2 ^ r)$。执行 $(2 ^ r, 2 ^ r)$ 即可得到 $0$ 和 $2 ^ {r + 1}$，后者不超过答案。通过不断地利用 $0$ 把每个数乘以 $2$，我们最终得到了一个 $0$ 和 $n - 1$ 个不小于 $n$ 的最小的 $2$ 的幂 $ans$。执行 $(0, ans)$ 即可。

$\mathrm{solve}(n)$ 部分的操作数量不超过 $n\log n$，后半部分操作数量也不超过 $n\log n$。实际表现非常好，可以接受。[代码](https://codeforces.com/contest/1637/submission/146188011)。

构数题优先考虑 $2$ 的幂，通过逆推操作观察性质。