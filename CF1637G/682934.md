纪念自己过的第一道 *3000。

写个搜索可以发现最小的答案是 $2^{\lceil\log n\rceil}$，另外我们考虑操作 $(x,y)\to (x-y,x+y)\to (2x,2y)$，所以我们可以考虑先把所有的数变成 $2$ 的幂次的形式。

自然可以考虑把问题归到更小的规模。对于 $n$，可以尝试尽可能把数配对成 $2^{\lceil\log n\rceil}$，即对于任意 $2^{\lceil\log n\rceil-1}<x\leq n$，操作 $(x,2^{\lceil\log n\rceil}-x)$。此时我们会剩下一个偶数数列和一个正整数列。只需要把偶数数列全体除以 $2$ 即可得到两个更小的子问题。容易证明它们的规模都是小于 $O(\frac{n}{2})$ 的。

最后考虑如何把这些 $2$ 的幂次转化成同一个数。容易发现如果把指数做差，问题完全等价于对于一个序列 $a$，每次选择序列中的两个元素并把它们同时 $-1$，目标是将 $a$ 全变成 $0$。$\sum _i a_i$ 为偶数的情况是容易处理的。对于奇数的情况，可以造出一个 $0$ 并重复执行 $(0,x)\to (x,x)\to(0,2x)$。最后处理所有 $0$ 即可。

操作复杂度大概是 $O(n\log n)$ 的，不过这玩意神奇地跑到了 $2n\sim 3n$ 级别。

https://codeforces.com/contest/1637/submission/148414304