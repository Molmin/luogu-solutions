绿题杀手，正是在下。

## 题目大意

有一个 $w$ 元的红包，当一个人开红包会等概率得到 $[0,w]$（实数范围）中的钱，求第 $k$ 个人开红包期望得到多少钱。

## 题解

容易猜出答案是 $\frac{w}{2^k}$。

因为在直觉上，每一次期望拿走一半的钱；但是我感觉这个期望是不能叠加的。

所以选择另一种推导。这个推导同时也证明了在某种特定条件下，期望就可以直接叠加。

设 $E_k$ 表示第 $k$ 次之后期望剩多少钱。$f_k(a)$ 表示前 $k-1$ 次抢红包的时候一共抢走 $a$ 元的概率。

那么对于任意 $t$，我们都有：

$$

\int f_t(a)\text{d}a=1

$$

显然 $E_1=w/2$。

并且我们就有：

$$

\int (w-a)f_2(a)\text{da}=E_1\to\int f_2(a)\text{da}=w-E_1

$$

于是 $E_2$ 的各种各个部分都可以算了

$$

E_2=\int \frac{w-a}{2}f_2(a)\text{da}=w/4

$$

同时我们有关系：

$$

\int (w-a)f_3(a)\text{da}=E_2\to \int af_3(a)\text{da}=w-E_2

$$

于是，我们就可以得出 $E_3$ 的关系：

$$

E_3=\int \frac{w-a}{2}f_3(a)\text{da}=\frac{w}{2}-\frac{w-E_2}{2}=w/8

$$

此时，我们就已经可以归纳出所有的 $k$ 了。

$$

E_k=\frac{w}{2^k}

$$

并且

$$

\int af_{k+1}(a)\text{da}=w-E_k

$$

$$

E_{k+1}=\int \frac{w-a}{2}f_{k+1}(a)\text{da}=\frac{w}{2}-\frac{w-\frac{w}{2^k}}{2}=\frac{w}{2^{k+1}}

$$

反正我觉得这题应该是这样做的。

## 扩展

那么，我们考虑更加一般的情况，假设现在有 $w$ 元，并且来一个人取钱，他期望会取 $A(w)$ 元。用 $A$ 替换掉上面的 $\frac{1}{2}$。

下面的关系仍然是成立的：

$$

\int af_{k+1}(a)\text{da}=w-E_k

$$

而 $E$ 的推导就换一下：

$$

E_{k+1}=\int A(w-a)f_{k+1}(a)\text{da}

$$

观察 $a$ 什么时候可以提出来？就是 $A(x)$ 是关于 $x$ 的线性关系！

也就是说我们如果假设 $A(x)=kx+b$，那么我们可以转化上式：

$$

E_{k+1}=\int (kw-ka+b)f_{k+1}(a)\text{da}

$$

$$

E_{k+1}=(kw+b)-k\int af_{k+1}(a)\text{da}=kw+b-k(w-E_k)=kE_k+b

$$

所以，只要 $A$ 是个一次函数，那么 $E_{k+1}=A(E_k)$。

当然肯定有大佬会根据期望的线性性一眼看出来，但对我而言并不那么直观。所以也只是希望能够为和我一样没那么厉害的选手提供一点帮助。