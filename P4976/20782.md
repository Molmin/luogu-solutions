#### $Subtask 1$

感觉不必多说..暴力建图$+Floyd(O(N^6)) / Dijkstra(O(N^4 \times log_2N^2))$拿走你的$10$分..

#### $Subtask 2$

也不必多说..把$T4$的正解偷过来暴力算每一个点的距离即可。。

复杂度$O(N^4)$。兴许$Dijkstra$也能跑过。。

#### $Subtask 3$

到这里就需要一些推理了。。

首先我们发现菱树一个性质：每一层的边权相等。

所以我们可以考虑直接计算每一层的贡献。

这样的话我们就分为两种情况：

第一种是在图中选择的两个点一个在这一层的下方，一个在这一层的上方。

根据$T4$的最短路的结论，我们可以推断出这种情况只可能通过这一层一次。

第二种是两个点都在这一层的下方。

这样一上一下，肯定要经过两次。

那么考虑直接计算贡献。

首先第一种的方案非常好求。就是这一层上面的节点个数$\times$下面的节点个数。转化为式子就是:

$$ \frac{i \times (i+1)}{2} \times (\frac{n \times (n + 1)}{2} - \frac{i \times (i+1)}{2}) $$

然后计算答案就乘上一个$i$就好了。

第二种的话。。

首先可以多画几个草图，发现需要满足右边的点到这一层的距离需要大于或等于左边的点与右边的点在该层从左往右数的相对位置的差。

事实上如果推出了$T4$的三种情况，那这个还是挺好想到的。

那么这样的话我们就考虑枚举左边的点。然后右边可以选择的点就是一个公差为$(n-i)$的等差数列。然后左边每一列的点一共有$(n-i)$个，则可以得到方案数为：

$$(n-i)^2 \times \frac{i \times (i+1)}{2}$$

然后由于需要一上一下，所以答案需要乘上一个$2 i$。

综上所述，最后的答案就是

$$\sum_{i=1}^{n-1}( \frac{i \times (i+1)}{2} \times (\frac{n \times (n + 1)}{2} - \frac{i \times (i+1)}{2}) \times i + (n-i)^2 \times i ^ 2 \times (i+1))$$

复杂度$O(N^2)$

#### $Subtask 4$

还是用上面的式子。~~也许~~可以化简一下变成$O(N)$

我们把它拆分一下:

$$\frac{n \times (n + 1)}{2} \times \sum_{i=1}^{n-1}(\frac{i \times (i+1)}{2} \times i) - \sum_{i=1}^{n-1} ((\frac{i \times (i+1)}{2})^2 \times i) + \sum_{i=1}^{n-1} (n^2-2\times i \times n +i^2) \times i ^ 2 \times (i+1))$$

$$= \frac{n \times (n + 1)}{2} \times \sum_{i=1}^{n-1}(\frac{i \times (i+1)}{2} \times i) - \sum_{i=1}^{n-1} ((\frac{i \times (i+1)}{2})^2 \times i) + n ^ 2 \times \sum_{i=1}^{n-1} (i ^ 2 \times (i + 1)) - 2\times n \times \sum_{i=1}^{n-1} (i ^ 3 \times (i+1)) + \sum_{i=1}^{n-1}(i ^ 4 \times (i+1))$$

然后发现所有$\sum$里面的东西都可以$O(N)$递推，所以答案也可以$O(N)$递推了。