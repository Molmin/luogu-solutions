提供一个树上莫队做法。

考虑求出来原树的 DFS 序，那么我们可以把询问 $(x,y)$ 看做从 $1\sim x$，$1\sim y$ 两条 DFS 序路径上最后经过的深度为 $i$ 的点的乘积和。

于是我们以 $(x,y)$ 关键字跑莫队即可，转移到时候需要简单分讨，时间复杂度是一个根号。