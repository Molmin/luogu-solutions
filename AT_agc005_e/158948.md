~~总感觉 AGC 的模拟构造的题在谷难度都虚高，比如~~[这场的 C](https://www.luogu.com.cn/problem/AT2061)~~。~~

这是人类智慧模拟博弈过程情况，和其他题解考虑距离和子树的不太一样。

由于可以不动，想办法考虑最大化步数的 A 肯定更简单。

自然的想法考虑 A 一直走下去可能的办法，重要的性质就是在一棵树上，没有环。

同时 A 肯定是在一两条边上无限跳跃就够了，而不用在一条更长的路径上走。

考虑 A 树上的一条边使得 A 无限循环，自然的就发现以下两种情况不可行：

- 如果这条边在两棵树上都有，走过这条边 B 立马可以跟上，A 就会被赶走，显然不行。

- 如果这条边在 A 树上，但是 B 树上两端点都连向了同一个点，那么只要 B 走到那个点就可以支配这两个点，A 也会被赶走。

其他的边由于 B 既无法跟上又不能支配，只能被 A 放风筝。

这样的边对 A 极有优势，将这样边的两个端点都进行标记，表示走到这个点就永远不会被抓住。

如果没有这样的边 A 只能找躲的最远的位置，DFS 一下即可。

否则是有这样的边，也就有标记点，A 肯定想去往那边走，那么 B 就会去拦。

考虑怎么会被拦住，由于是在树上走，只有一条路径，所以只要有一个点 B 能在 A 之前到达，B 就能拦住去往这个点子树内的标记点。

如果只是像这样来回横跳的话在一条边上跳就够了，也就是直接去找标记点。

但还有一种情况就是 B 可以拦住 A 去标记点的路但还是抓不住，也就是两条边无限循环走的情况。

对于 B 来说，最优秀的情况就是 A 能到达的所有标记点都被某一个点给拦住，然后由于不可行以无限循环的边都可以把 A 赶着走，B 必定能把 A 抓住。

否则，B 要么拦不住，要么由于有两个拦 A 的点而抓不到，如果 B 往其中一边走 A 是可以退回去往另一边的标记点走的。

这种思路没有利用一般题解利用的子树的性质，如果利用了可以直接忽略第二种情况，~~反正咱也不需要我就不说了啊~~。

所以这道题分两步走就行了，先判是否能抓住，就是要么没有标记点，要么标记点没被 B 拦住，要么有两个子树分别被拦（注意不能是两个点被一条边支配的拦住）。

然后像这样被抓住的如前文所说躲一个最远的位置，否则输出 -1 即可。