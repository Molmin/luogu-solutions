这题有 `*3500`？？？有点搞笑的。

（虽然可能 std 的确比较难）

首先我们发现这个题目上面有 全 $0$ 和 奇数 两个条件，可以自然的想去把这两个条件简化成一个条件。我们注意到每一行有且仅有一段区间是 $1$，那么你把这段区间的**右端点**置为 $0$（其他还是正常放 $1$），在这个情况下，题目条件就转化成了：

- 对于一段区间 $[l,r]$，如果 $[l,r-1]$ 里面的 $1$ 的个数是偶数，那么就是满足条件的。（注意是 $[l,r-1]$ ！！！）

证明是显然的，我们考虑分类讨论：

- 如果一段区间本身就是全 $0$，那么显然符合条件。
- 如果一段区间包含奇数个 $1$ 且包含 $r$，那么也是满足的。（本来是奇数个，去掉了 $r$）
- 如果一段区间包含奇数个 $1$ 且不包含 $r$，同样满足条件。（这样子右端点的值一定是 $1$，本来是奇数个，去掉了右端点）

不符合的区间同样也会不符合：

- 如果一段区间包含非零、且偶数个 $1$ 且包含 $r$，那么不满足。（本来是偶数个，去掉了 $r$）
- 如果一段区间包含非零、且偶数个 $1$ 且不包含 $r$，也是不满足。（本来是偶数个，去掉了右端点）

那么现在就只有一个条件了。现在考虑如何解决 $n$ 行都要满足出现次数是偶数这个东西，直接搞比较难处理，可以采用随机化哈希来解决。这样就转换成了区间的异或和是 $0$。

那么就做完了，拿两个 map 记录一下当前前缀异或和数组的 $\sum p[s_p=w]$ 和 $\sum[s_p=w]$ 就好了。全 $0$ 区间可以放到最后减去。


[提交记录](https://codeforces.com/contest/799/submission/180189895)。