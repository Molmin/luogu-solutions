首先，因为 $a$ 单调不降，$b$ 单调不升，可以将条件 $3$ 转化为 $a_m\le b_m$，由于我们需要维护 $a$，$b$ 的末尾的元素，可以考虑 `dp`：

维护 $a$：定义 $dp1_{i,j}$ 表示前 $i$ 个数构成的一个单调不降的序列的最后一个数为 $j$ 的方案数，因为 $a_i\le a_{i-1}$，所以 $dp1_{i,j}\gets\sum\limits_{k=1}^jdp1_{i-1,k}$；初始化，对于同一个元素，在第一位放它可以得到唯一的一种方案，所以 $dp1_{1,i\in[1,n]}\gets1$。

维护 $b$：同理，定义 $dp2_{i,j}$ 表示前 $i$ 个数构成的单调不升的序列的最后一个数为 $j$ 的方案数，所以 $dp2_{i,j}\gets\sum\limits_{k=j}^ndp2_{i-1,k}$，初始化 $dp2_{1,i\in[1,n]}\gets 1$。

因为 $a_m\le b_m$，所以答案就是 $\sum\limits_{i=1}^n\sum\limits_{j=i}^ndp1_{m,i}\times dp2_{m,j}$。