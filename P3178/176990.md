题目链接[树上操作](https://www.luogu.com.cn/problem/P3178)
#### 题意
- 有一棵点数为 n 的树，以点 1 为根，且点有点权。然后有 m 个操作，分为三种：

- 操作 1 ：把某个点 x 的点权增加 a 。

- 操作 2 ：把某个点 x 的子树中所有点的点权都增加 a 。

- 操作 3 ：询问某个点 x 到根的路径中所有点的点权和。

- n,m<=100000


------------
这题可以看作一个树剖的模板题。

再介绍一种做法。

先普及一个概念： 树的括号序列
- 在 $dfs $过程，进入一个点，就将一个左括号加入序列，退出一个点，就将一个右括号加入序列。这个序列，称为树的括号序列。

#### 思路
- 设 l[x]为x的左括号所在位置，r[x]为x的右括号所在位置。

- 给一个点 x 的点权加上一个数，就是给x子树中所有点到根路径的权值和加上这个数，即为给[l[x],r[x]-1] 加上这个数。在查询时询问 l[x] 处的值。

- 通过差分，可以转化为给 l[x]加上这个数，给 r[x] 减去这个数。在查询时询问 [1,l[x]] 的和。

- 那么，给一个点x子树里的所有点加上一个数，可以转化为区间加入一个数，贡献系数是区间里左括号个数-右括号个数。

- 时间复杂度O(nlogn)


------------

#### 代码
~~自己打~~