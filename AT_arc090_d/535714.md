众所周知，目前这篇题解的复杂度都是 $O({k \over {\log k}})$ 的，所以下文给出一个 $O(k^{0.5})$ 复杂度的算法。

1. $f(r) = f(l)$ 枚举因子，用光速幂即可做到根号。

2. $f(r) = f(l)+1$ 这里比原题解更复杂的地方只在于这里可能会有某种位数被全部填满而导致不可行，但原题解做法因为只考虑 $f(l) \geq 8$ 导致不会出现这种情况。观察可得，仅在 $f(l) \leq O(\log k)$ 时会出现这种情况，特殊处理即可；更大的直接按照原题解方法加上一个值即可。这一块复杂度 $O(\log k)$。

3. $f(r) - f(l) \geq 2$ 枚举 $f(l),f(r)$，这里 $f(l) , f(r) = O(\log k)$，所以暴力枚举即可，直接用扩欧计算答案，注意这里也可能存在上一类的填满问题，但是这相当于给扩欧的变量一个上下界，不是问题。这一块复杂度 $O(\log^3 k)$。

综上，我们得到了一个复杂度为 $O(\sqrt{k} + \log k +\log^3 k) = O(\sqrt{k})$ 的做法。

没有实现过，如果假了欢迎正义辱骂。