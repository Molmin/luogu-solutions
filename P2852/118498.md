假设有出现 k 次且长度为 L 的模式， 那么需要：能够把某 k 个后缀拿出来， lcp 要 ≥ L。

在 sa 数组中考虑这些拿出来的后缀， 记为 $s_1,s_2,\cdots,s_k$：

由于对于任意 $s_i,s_{i+1}$， 其 lcp ≥ L， 那么对于 $sa[rk[s_i] \sim rk[s_{i+1}]]$， 相邻的两个的 lcp 也是 ≥ L 的。进一步推出对于 $sa[rk[s_1] \sim rk[s_k]]$ 来说， 相邻的两个的 lcp 也是 ≥ L 的。

进一步推出， 在 height 数组中一定存在一个长度为 k-1 的区间，这个区间里的数的最小值 ≥ L。

所以只需要单调队列扫一遍 height 数组就行了。