来说一个骚操作

题目要求就是字符串匹配，设$|s|=|t|$，如果$s$匹配$t$，那么设$s_i=a,t_i=b$，必须满足$a=b$或$p_a=b$。

一种做法是推出$a,b$的贡献为$(a-b)^2(p_a-b)^2=0$，由于它一定非负所以只需求出$s,t$对应两个字符的贡献之和，为$0$就匹配上了。

拆开这个巨大的式子，每一项都形如$ca^rp_a^sb^t$。

将$s$串反转之后就容易可以用9轮FFT求出答案。注意这里的FFT长度设为$|t|$就够了。

（这种做法和字符集大小无关，比较优秀）

另一种方法是，暴力枚举26种$b$，直接暴力计算$a=b$和$p_a=b$的$(a,b)$对数。

反转$s$，只要用两个数组$S,T$，$S_i=[s_i=b\lor p_{s_i}=b],T_i=[t_i=b]$，直接卷积即可。

但是可以将两个字符放一起做，假设一起处理字符$p,q$，设$S_i=[s_i=p\lor p_{s_i}=p]+[s_i=q\lor p_{s_i}=q]i,T_i=[t_i=p]-[t_i=q]i$（有变量重名但能看懂，$S,T$最后乘的那个$i$是虚数单位）就可以减小一半常数，比较轻松地通过这题。