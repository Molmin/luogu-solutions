### 前言

似乎又是道不错的 Symbolic Method 练习题？

大力宣传一下[符号化方法](https://xyix.github.io/posts/?postname=combinatorics)，使用这一方法可以秒掉许多困难的数数题。

### 思路

不是让你求期望吗？直接求比值即可。

注意对 $i=1,2$ 的情况特判。

#### 分子

即竞赛图哈密顿回路计数。

不妨钦定 $1$ 为起点，然后直接枚举接下来的路径中 $n-1$ 个点，最后连回起点。

然后直接把剩下 ${n(n-1)\over2}-n$ 条边任意定向。

即，总哈密顿回路数为 $(n-1)!2^{{n(n-1)\over2}-n}$。

#### 分母

一个结论：竞赛图缩点后会变成一条链状 DAG，其中每个点往其后的**所有**点引出一条边。

另一个结论：竞赛图有哈密顿回路等价于其强连通，即可以缩成单个点。

我们记 $\mathcal T$ 表示带标号强连通竞赛图所对应的组合类，记 $\mathcal U$ 表示带标号竞赛图所对应的组合类。

立刻由结论得到：

$$\mathcal U=\operatorname{SEQ}(\mathcal T)$$

其中 $\operatorname{SEQ}$ 表示**带标号 Sequence 构造**。

于是立刻有：

$$\hat U={1\over1-\hat T}$$

故：

$$\hat T=1-\hat U^{-1}$$

直接做就好了。
