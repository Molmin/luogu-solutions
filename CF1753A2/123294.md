如果序列和为奇数，即不为 $0$ 的数的个数为奇数，显然无解。

考虑两个不为 $0$ 的数 $a_x, a_y$，满足 $a_{x + 1} \sim a_{y - 1}$ 都是 $0$。

- 如果 $a_x + a_y = 0$，可以分成 $[x, y - 1]$ 和 $[y, y]$。

- 否则 $a_x = a_y$。若 $x + 1 = y$ 则分成 $[x, y]$，否则分成 $[x, y - 2]$ 和 $[y - 1, y]$。

我们将 $[x, y]$ 分成了若干段，它们的权值之和为 $0$。将第 $2k + 1$ 个不为 $0$ 的数和第 $2k + 2$ 个不为 $0$ 的数像这样配对，剩下来没有被覆盖的所有数均为 $0$，容易得到一组分段方案。

时间复杂度 $\mathcal{O}(n)$。[代码](https://codeforces.com/contest/1753/submission/177541721)。