依次遍历每枚硬币。对于一枚硬币，找出它的所有约数的硬币（但是不包括它本身）。可以用以下代码来实现找约数：
```cpp
for(int i=1;i<=n;++i){
	int v=0;//v为约数个数
	for(int j=1;j<=n;++j)if(j!=i&&p[i]%p[j]==0)++v;
}
```
这枚硬币最终能正面朝上的概率是恰好这 $v$ 枚硬币有偶数枚在它左边。可以理解为这 $v+1$ 枚硬币随机排序，此枚硬币恰好排在奇数位置上的概率，为：$(\left\lfloor\dfrac{v}{2}\right\rfloor+1)/(v+1)$

只要将答案加上这个数。遍历完后的答案就是题目所求
```cpp
ans+=(double)(int)(v/2+1)/(v+1);
```