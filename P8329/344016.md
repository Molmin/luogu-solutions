做法 1： $f_{i,j,a,b}$ 表示前 $i$ 个点中，有 $j$ 个点是第一棵树中没有儿子的非叶子结点，有 $a$ 个点是第一棵树中的叶子结点，有 $b$ 个点在第二棵树中没有父亲。分类讨论第 $i$ 个点在第一棵树上是叶子结点还是非叶子结点，转移 $\mathcal{O}(n)$，复杂度 $\mathcal{O}(n^5)$，卡常可以卡到 60 分。

做法 2： 

容斥，将第一棵树上的非叶子结点钦定为叶子结点，设钦定个数为 $S$，容斥系数显然为 $(-1)^S$

$f_{i,j,k}$ 表示前 $i$ 个点中，第一棵树没有被容斥的非叶子结点有 $j$ 个，第二棵树没有父亲的点有 $k$ 个。

转移则分类讨论：  


1. 在第二棵树上是非叶子结点(在第一棵树上是叶子结点)： $f_{i,j,a} \times \binom a b \times j \to f_{i+1,j,a-b+1}$

2. 在第二棵树上是叶子结点(在第一棵树上是非叶子结点)：

	2.1. 被容斥了 $f_{i,j,k} \times (-1) \times  j \to f_{i+1,j,k+1}$

	2.2 没有被容斥 $f_{i,j,k} \times j \to f_{i+1,j+1,k+1}$

复杂度 $\mathcal{O}(n^4)$，在质数情况下可以用前缀和优化到 $\mathcal{O}(n^3)$，可以得到 80 分。

做法 3：

做法 2 是对第一棵树进行容斥，考虑对两棵树进行容斥。所有的点要么是第一棵树的叶子要么是第二棵树的叶子，而容斥则钦定原本是第一棵树的叶子是第二棵树上的叶子，或者原本是第二棵树的叶子是第一棵树上的叶子。

设 $f_{i,j,k}$ 表示前 $i$ 个点中有 $j$ 个点**不**是第一棵树上的叶子，而后 $n-i$ 个点中有 $k$ 个点**不**是第二棵树上的叶子。

转移也是分类讨论，复杂度 $\mathcal{O}(1)$，总复杂度 $\mathcal{O}(n^3)$

