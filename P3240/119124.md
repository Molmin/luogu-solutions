### 此为一个补充性质的题解（因为后面部分与上面所有题解相同）。这篇题解主要讲如果不会组合数学 $ORZ$ 怎么求（使用dp）。

注：$ORZ$ 为将 $i$ 段和 $j$ 合并成 $k$ 段的方案数（详见第一篇题解）。

设 $g_{i,j,k,0/1/2}$ 表示 $i$ 段和 $j$ 段合并成 $k$ 段，结尾是来自第一条中的/第二条中的/两条都有（中间用 $=$ 连接）的方案数。

对于 $0$ 和 $1$ 来说，最后一段前面只能用 $<$ 连接，转移方程显而易见。

对于 $2$ 来说，由于 $=$ 两边交换顺序只算一种，所以规定等号右边是来自第二条的。

$$g_{i,j,k,2}=g_{i-1,j,k,1}$$

考虑一下循环顺序就解决了。

部分代码：

```cpp
void ginit()
{
    for (int i=1; i<=n; i++) g[i][0][i][0]=g[0][i][i][1]=1; 
    for (int ipj=2; ipj<=n; ipj++)
        for (int i=1; i<ipj; i++)
        {
            int j=ipj-i;
            for (int k=1; k<=ipj; k++)
            {
                g[i][j][k][0]=(1ll*g[i-1][j][k-1][0]+g[i-1][j][k-1][1]+g[i-1][j][k-1][2])%ljc;
                g[i][j][k][1]=(1ll*g[i][j-1][k-1][0]+g[i][j-1][k-1][1]+g[i][j-1][k-1][2])%ljc;
                g[i][j][k][2]=g[i-1][j][k][1];
            }
        }
}
```

最终 $ORZ=g_{i,j,k,0}+g_{i,j,k,1}+g_{i,j,k,2}$，时间复杂度 $O(N^3)$。

~~可能有点蠢，能过就行:)~~