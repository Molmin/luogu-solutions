先特判掉删 $0$ 条和 $1$ 条边的情况。$0$ 随便乱判，$1$ 可以用 tarjan 跑一遍割边判掉。

接下来是删两条边的情形。

显然如果要删 $2$ 条的话割边肯定不会去删，把割边的代价改为 $\infty$。

否则就是求两条边的最小割，给每个条边加上 $10^{14}$ 的边权跑最小割，这样最小割仅会割 $2$ 条边（多割就会多 $10^{14}$ 的代价，显然不优，少的话必须割 $\infty$，也不优）。

跑最大流即可。

[code](https://codeforces.com/contest/700/submission/140712904)