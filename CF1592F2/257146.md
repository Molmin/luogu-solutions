### CF1592F1

发现操作 $2$ 和操作 $3$ 的等效于执行 $2$ 次操作 $1$，更优。

记 $a_{x,y}$ 表示 $(x,y)$ 是否为黑色，再记 $b_{x,y}=a_{x,y}\oplus a_{x,y+1}\oplus a_{x+1,y}\oplus a_{x+1,y+1}$，可以发现操作 $1$ 等价于翻转 $b_{x,y}$，而操作 $4$ 等价于翻转 $b_{x-1,y-1},b_{x-1,m},b_{n,y-1},b_{n, m}$。

注意到我们使用 $4$ 操作的次数不会超过 $1$，因为两次操作 $4$ 可用六次操作 $1$ 代替，代价相等不会更劣。

这样统计有多少个 $b_{x,y}=1$再统计一下是否存在一组 $(x,y)$，满足 $b_{x-1,y-1},b_{x-1,m},b_{n,y-1},b_{n,m}$ 均为 $1$，若存在，答案减少 $1$。

时间复杂度 $\mathcal O(nm)$。

### CF1592F2

与上题相似。

发现要尽可能多得使用操作 $4$。

二分图匹配即可。

时间复杂度 $\mathcal O(n^2\sqrt n)$。