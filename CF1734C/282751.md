不难想到一个数让它在尽可能小的因数时被删，并且一个数被删了不会影响后面的数被删，因为对于每个 $k$ 能删的是一段 $k$ 的倍数的前缀。

所以可以枚举 $k$，能删则删，复杂度是调和级数，$O(n \log n)$。注意开 long long。

代码见 CF 提交。