# 题意

Chip 在数轴原点处，给定一个正整数 $k$，使得 Chip 可以向数轴正方向移动若干次，第 $i$ 次的步长必须为 $k+i-1$ 的倍数。求对于给定正整数 $n\ (n\le2\times10^5)$，对于数轴上区间 $[1,n]$ 中的点，Chip 到达每个点的方案数。

# 分析

注意到第 $i$ 次的步长一定为 $k + i - 1$ 的任意倍数，我们不妨将该问题转化为与之等价的下面这个问题：

有 $n$ 个背包，容积分别为 $1,2,\cdots,n$，给定一个正整数 $k$，对于每个背包，你可以进行若干次操作，第 $i$ 次操作可以向该背包内放入任意数量 $(>0)$ 的体积为 $k + i - 1$ 的物品，求恰好将该背包装满的方案数。

对于背包问题，我们从以下三个角度考虑代码实现：

+ 初始状态：显然，第 $1$ 步能装满的背包容积一定为 $k$ 的倍数，且方案数为 $1$；
+ 状态转移方程：让 $f_{i,j}$ 维护当前物品体积为 $i$，容积为 $j$ 的背包装满的方案数，则状态转移方程为 $f_{i, j} = f_{i-1,j-i}+f_{i,j-i}$；
+ 边界条件：不难想到，边界条件一定在枚举物品体积时出现，当放入第 $i$ 个物品时，背包的容积至少为 $k+(k+1)+\cdots+(k+i-1)$，当该数 $>n$ 时，没有继续枚举的必要，循环结束。

关于状态转移方程的进一步解释：放入体积为 $i$ 的物品后，容积为 $j$ 的背包恰好装满的方案数 $(f_{i,j})$ 一定从容积为 $j-i$ 的背包的方案数转移而来，又因为当前物品的体积为 $i$，所以上一个物品的体积一定为 $i$ 或 $i-1$，两种情况的方案数分别为 $f_{i, j-i}$ 和 $f_{i-1,j-i}$，由此可得状态转移方程。

通过估算可得，时间复杂度约为 $\mathcal O(n\sqrt n)$，$f$ 数组大小同样约为 $\sqrt n\times n$，显然超限，由于转移时只涉及两行 $(f_i,f_{i-1})$，这里采用滚动数组记录。

最后通过 $g_j$ 维护装满容积为 $j$ 的背包的总方案数。

文章最后附有两组样例对应的 $f,g$ 数组的值便于理解。

# 代码

```cpp
#include<iostream>
#define sfor(i, h, t) for(int i = (h); i <= (t); ++i)
using namespace std;
const int MAXN = 0x30D48;
const int P = 0x3B800001;
int N, K;
int f[2][MAXN], g[MAXN];
int sum;
signed main(void) {
    ios::sync_with_stdio(false);
    cin >> N >> K;
    for(int j = K; j <= N; j += K)
        g[j] = f[1][j] = 1;
    sum = K + 1;
    for(int i = K + 1; sum < N; sum += ++i) {
        sfor(j, sum - i, sum - 1) {
            f[0][j] = f[1][j];
            f[1][j] = 0;
        }
        sfor(j, sum, N) {
            f[0][j] = f[1][j];
            (f[1][j] = f[0][j - i] + f[1][j - i]) %= P;
            (g[j] += f[1][j]) %= P;
        }
    }
    sfor(j, 1, N)
        cout << g[j] << ' ';
    cout << '\n';
    return 0;
}
```

# 样例解释

样例1：

| 数组 \ $j$ | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    |
| ---------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| $f_1$      | 1    | 1    | 1    | 1    | 1    | 1    | 1    | 1    |
| $f_2$      | 0    | 0    | 1    | 1    | 2    | 2    | 3    | 3    |
| $f_3$      | 0    | 0    | 0    | 0    | 0    | 1    | 1    | 2    |
| $g$        | 1    | 1    | 2    | 2    | 3    | 4    | 5    | 6    |

样例2：

| 数组 \ $j$ | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   |
| ---------- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| $f_2$      | 0    | 1    | 0    | 1    | 0    | 1    | 0    | 1    | 0    | 1    |
| $f_3$      | 0    | 0    | 0    | 0    | 1    | 0    | 1    | 1    | 1    | 1    |
| $f_4$      | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 1    | 0    |
| $g$        | 0    | 1    | 0    | 1    | 1    | 1    | 1    | 2    | 2    | 2    |

