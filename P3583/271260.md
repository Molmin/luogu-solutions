**前言**

------------

很妙的结论题，拿到了最优解前三。

**正文**

------------

首先打一个动态规划寻找无法被表达的数，我们发现有且仅有 $31$ 个数。

根据这个信息我们可以得到：当一个数足够大时一定能被表达出来，进一步寻找，我们会发现对于一个数 $x$，一定有：

$\frac{ (y - 1) \times y \times ( y \times 2 - 1 ) }{ 6 } < x \leq \frac{ y \times ( y + 1 ) \times ( y \times 2 + 1 ) }{ 6 }$ 时 $x$ 一定能被 $ y + 1 $ 以内的数拆分。

那么可以进行二分查找寻找 $y$ 值，而超重数的数量可被分为 $y$ 个整体，而每个整体里都会有 $31$ 个超重数，剩下的部分循环枚举即可。需要预处理然后分段讨论。

**code**

------------

```
#include<bits/stdc++.h>
using namespace std;
#define max(x,y) x>y?x:y
#define min(x,y) x>y?y:x
template<typename G>inline void read(G&x){x=0;G f=1;char ch=getchar();while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}while(ch>='0'&&ch<='9')x=x*10+(ch^48),ch=getchar();x*=f;}
const int MAXN=2310+5;
int dp[MAXN]={0,1,1061109567,1061109567,2,2,1061109567,1061109567,1061109567,3,3,1061109567,1061109567,3,3,1061109567,4,4,1061109567,1061109567,4,4,1061109567,1061109567,1061109567,4,4,1061109567,1061109567,4,4,1061109567,1061109567,1061109567,5,5,6,6,5,5,6,5,5,1061109567,1061109567,5,5,1061109567,1061109567,6,5,5,6,6,5,5,6,6,7,7,1061109567,6,6,7,8,6,6,1061109567,8,7,6,6,1061109567,8,6,6,1061109567,6,6,7,8,6,6,7,7,7,6,6,7,7,6,6,1061109567,8,7,7,1061109567,9,7,7,7,7,7,7,7,7,7,9,1061109567,8,7,7,1061109567,8,7,7,8,8,8,7,7,8,8,7,7,8,7,7,1061109567,8,7,7,9,8,8,7,7,9,8,7,7,8,8,8,9,8,8,8,8,8,8,8,8,8,8,8,9,10,8,8,9,9,8,8,8,8,8,8,8,8,8,9,9,10,8,8,9,10,8,8,9,9,9,8,8,9,9,8,8,10,8,8,9,10,8,8,9,9,9,8,8,9,9,8,8,9,9,9,9,10,9,9,9,10,9,9,9,9,10,9,9,9,9,9,9,10,9,9,9,9,9,9,9,9,9,9,9,10,10,9,9,10,10,9,9,9,9,9,9,9,9,9,10,10,10,9,9,11,10,9,9,10,10,10,9,9,10,10,9,9,10,9,9,11,10,9,9,11,10,10,9,9,10,10,9,9,10,10,10,11,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,10,10,10,11,10,10,10,10,11,10,10,10,10,10,10,11,10,10,10,10,10,10,10,10,10,10,10,11,11,10,10,11,11,10,10,10,10,10,10,10,10,10,11,11,11,10,10,11,11,10,10,11,11,11,10,10,11,11,10,10,11,10,10,11,11,10,10,11,12,11,10,10,11,11,10,10,11,11,11,11,11,11,11,11,12,11,11,11,12,11,11,11,11,11,11,11,11,11,11,11,12,11,11,11,12,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,11,11,11,12,11,11,11,11,12,11,11,11,11,11,11,12,11,11,11,11,11,11,11,11,11,11,11,12,12,11,11,12,12,11,11,11,11,11,11,11,11,11,12,12,12,11,11,12,12,11,11,12,12,12,11,11,12,12,11,11,12,11,11,12,12,11,11,12,12,12,11,11,12,12,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,12,12,12,13,12,12,12,12,12,12,12,12,12,12,12,13,12,12,12,13,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,12,12,12,13,12,12,12,12,13,12,12,12,12,12,12,13,12,12,12,12,12,12,12,12,12,12,12,13,13,12,12,13,13,12,12,12,12,12,12,12,12,12,13,13,13,12,12,13,13,12,12,13,13,13,12,12,13,13,12,12,13,12,12,13,13,12,12,13,13,13,12,12,13,13,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,13,13,13,14,13,13,13,13,13,13,13,13,13,13,13,14,13,13,13,14,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,13,13,13,14,13,13,13,13,14,13,13,13,13,13,13,14,13,13,13,13,13,13,13,13,13,13,13,14,14,13,13,14,14,13,13,13,13,13,13,13,13,13,14,14,14,13,13,14,14,13,13,14,14,14,13,13,14,14,13,13,14,13,13,14,14,13,13,14,14,14,13,13,14,14,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,14,14,14,15,14,14,14,14,14,14,14,14,14,14,14,15,14,14,14,15,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,14,14,14,15,14,14,14,14,15,14,14,14,14,14,14,15,14,14,14,14,14,14,14,14,14,14,14,15,15,14,14,15,15,14,14,14,14,14,14,14,14,14,15,15,15,14,14,15,15,14,14,15,15,15,14,14,15,15,14,14,15,14,14,15,15,14,14,15,15,15,14,14,15,15,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,15,15,15,16,15,15,15,15,16,15,15,15,15,15,15,16,15,15,15,15,15,15,15,15,15,15,15,16,16,15,15,16,16,15,15,15,15,15,15,15,15,15,16,16,16,15,15,16,16,15,15,16,16,16,15,15,16,16,15,15,16,15,15,16,16,15,15,16,16,16,15,15,16,16,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,16,16,16,17,16,16,16,16,17,16,16,16,16,16,16,17,16,16,16,16,16,16,16,16,16,16,16,17,17,16,16,17,17,16,16,16,16,16,16,16,16,16,17,17,17,16,16,17,17,16,16,17,17,17,16,16,17,17,16,16,17,16,16,17,17,16,16,17,17,17,16,16,17,17,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,17,17,17,18,17,17,17,17,17,17,17,17,17,17,17,18,17,17,17,18,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,17,17,17,18,17,17,17,17,18,17,17,17,17,17,17,18,17,17,17,17,17,17,17,17,17,17,17,18,18,17,17,18,18,17,17,17,17,17,17,17,17,17,18,18,18,17,17,18,18,17,17,18,18,18,17,17,18,18,17,17,18,17,17,18,18,17,17,18,18,18,17,17,18,18,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,18,18,18,19,18,18,18,18,18,18,18,18,18,18,18,19,18,18,18,19,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,18,18,18,19,18,18,18,18,19,18,18,18,18,18,18,19,18,18,18,18,18,18,18,18,18,18,18,19,19,18,18,19,19,18,18,18,18,18,18,18,18,18,19,19,19,18,18,19,19,18,18,19,19,19,18,18,19,19,18,18,19,18,18,19,19,18,18,19,19,19,18,18,19,19,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19};
int mn[MAXN],sum[MAXN];
long long n,l=15,r=1500000,ans,k;
int main() {
	read(n);mn[2311]=0x3f3f3f3f;
	for(int i=2310;i>=1;--i) {
		mn[i]=min(dp[i],mn[i+1]);
		if(mn[i]<dp[i]) sum[i]=1;
	}
	for(int i=1;i<=2310;++i) sum[i]+=sum[i-1];
	if(n<=2310) {
		if(dp[n]==0x3f3f3f3f) printf("- ");
		else printf("%d ",dp[n]);
		printf("%d",sum[n]);
		return 0;
	}
	while(l<=r) {
		long long mid=(l+r)>>1;
		if(mid*(mid+1)*(2*mid+1)/6>=n) r=mid-1,k=mid;
		else l=mid+1;
	}
	long long num=sum[2310]+(k-19)*31;
	ans=k*(k+1)*(k*2+1)/6;
	if(ans-n<=128&&ans-n>0&&dp[ans-n]==0x3f3f3f3f) ++k;
	for(int i=1;i<=128;++i) {
		if(dp[i]==0x3f3f3f3f&&ans-i<=n) {
			++num;
		}
	}
	printf("%lld %lld",k,num);
	return 0;
}
/*
105041937
*/
```