
## statement
给出一个长度为 $N$ 的字符串 $S$，$S$ 仅含 `A,B,C`。每次操作选择 $l,r$ 和 $(X,Y,Z)$，$X,Y,Z $ 都是 `A,B,C` 其中之一，且互不相同。接着对于 $S_{[l,r]}$，将 `A` 变成 $X$，`B` 变成 $Y$，`C` 变成 $Z$。

$Q$ 组询问，每次询问 $L,R$，求将 $S_{[L,R]}$ 都变成同一字符的最小操作次数。$1\le N,Q \le 10^5$

## solution

对于操作序列 $a_{1\dots n}$，将其首尾相连，操作同等地对环进行即可。因为对于一个操作区间，对这个区间进行置换，等价于对区间外的字符进行逆置换。


设环的颜色段数为 $n$，显然一次操作减少颜色段数量上界为 $2$。

结论是：**除颜色段形如 $ABC$ 与 $AB$ 外，每次操作都能够减少两个颜色段。**

可以如下考虑此结论：

操作场景分为形如 $AB\dots AB$ 与 $AB\dots BA / ABA$ 两类考虑，发现通过一次操作可以分别变成 $AA\dots BB$ 与 $AA\dots AA/AAA$，均减少两个颜色段。

通过若干次此类操作，如果仍未同色，其一定变为 $ABC$ 或者 $AB$ 的形式，分别需要 $2$ 次与 $1$ 次减少一个颜色段的操作。

综上所述，最多会进行一次减少一个颜色段的操作。

因此对于询问 $l,r$，答案为 $\left\lceil\frac{\left(\sum_{i=l}^{r-1} s_{i} \neq s_{i+1}\right)+\left[s_{l} \neq s_{r}\right]}{2}\right\rceil$。


