这里给出一种线段树的思路

### 题目分析

注意到题目中给出的两个参数 $a,b$，其中我们要维护的是二进制第 $b$ 位上的系数。这是我们不免想到高精。

显然直接朴素维护高精不可取。每次直接更改可能会修改 $O(n)$ 位。如当前 $x=2^{10^6}$ ，此时我们反复进行 $+1$ 和 $-1$ 操作，每一位上都会发生改变。

但这并不意味着维护高精的方法不可取。我们可以观察每一次修改对 $x$ 每一位上的影响，如设 $x=(1100011110010111)_ 2$，我们对它进行加 $a=(111100000)_ 2$ 操作，不妨竖式来观察

$$
\begin{aligned}
& x&=&&1100011110010111\\
& a&=&&111100000\\
& x^\prime&=&&1100100101110111
\end{aligned}
$$

我们可以将 $x^\prime$ 分为 $5$ 个部分：

$$
\begin{aligned}
& x&=&&{\color{red}{1100}}{\color{Purple}{0}}{\color{Goldenrod}11}{\color{Magenta}{1100}}{\color{lightblue}{10111}}\\
& a&=&&{\color{Magenta}1111}{\color{lightblue}00000}\\
& x^\prime&=&&{\color{red}{1100}}{\color{Purple}{1}}{\color{Goldenrod}00}{\color{Magenta}{1011}}{\color{lightblue}{10111}}
\end{aligned}
$$

红色：加法进位没有影响到的位置。

紫色：加法进位影响到的位置，使之加 $1$。

黄色：加法进位影响到的位置，使变为 $0$。

粉色：加法直接影响到的位置，直接计算，对应 $a\times2^b$ 的部分。

蓝色：加法没有影响到的位置，对应后 $b-1$ 位。

### 思路

注意到有区间修改，单点查询，查询当前往左第一个 $0$ 的位置，当前往左第一个 $1$ 的位置。显然可以使用线段树进行操作。

单次要修改 $O(\log a)$ 位，那么到线段树上时间复杂度为 $O(\log ^2n)$ ，显然还不够优秀。考虑压位，设每 $w$ 位压为一位。那么单次修改时间复杂度为 $O(\log n+\dfrac {\log^2 n} w)$，当 $w$ 取到 $\log n$ 时最佳。注意叶节点的区间覆盖对应按位与运算。

代码略。