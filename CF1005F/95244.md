首先可以看出符合题目中两个条件的一定是最短路径树，但最短路径树显然不唯一。

我们对于点 $u$ 维护一个可能成为一棵最短路径树上的边的边集 $E_u$，形式化的说有 $E_u=\{v\to u:v\in V,dis_u=dis_v+1\}$，其中 $dis_u$ 为 $1\to u$ 的最短路。

可以证明从每个 $u\neq 1$ 的 $E_u$ 中取一条边构成的 $n-1$ 个点的图一定是一个连通图，并且进一步我们还可以证明它是一棵最短路径树。读者可以尝试使用归纳证明法自行证明。

于是我们可以爆搜方案，方案数也可以算出来：

$$
ans=\prod_{u\neq 1} |E_u|
$$

