### [ARC065D シャッフル / Shuffling](https://www.luogu.com.cn/problem/AT2161)

$n,m\le 3000$，明摆着 $O(n^2)$。

设 $f_{i,j}$ 表示考虑前 $i$ 位填了 $j$ 个 $1$ 的方案数。

显然有 $f_{i,j}\gets f_{i-1,j-1}+f_{i-1,j}$，关键是转移上下界如何确定，因为有些地方是不能放 $1$ 的。

于是可以预处理出每个 $i$，能随意排列到的最右端点 $r_i$；以及每个前缀 $1$ 的个数 $c_i$。

则转移中 $j$ 的下界的话你当然希望前 $i$ 个位尽量放 $0$，所以先把 $i$ 到 $r_i$ 尽量全放 $1$，于是 $l_j=\max\{0,i-(r_i-c_{r_i})\}$。

对于上界，你也当然希望前 $i$ 位尽量放 $1$，所以先把 $r_{c_i}$ 个 $1$ 都放 $i$ 里面，于是 $r_i=\min\{i,r_{c_i}\}$。

然后就可以愉快地转移啦！

[AC 记录](https://atcoder.jp/contests/arc065/submissions/35464170)