提供一个写着比较简便的写法。

注意到一条边 $\langle u,v \rangle$ 能删除，当且仅当 $(d_u+d_g) \bmod 2 =0$（其中 $d_u$ 表示 $u$ 的度数）。

那么从叶子开始向上分别考虑每个点，对于 $u$ 这个点可以得到类似 $\langle fa_u,u \rangle$ 这条边需要在 $d_{fa_u} \bmod 2 = 0/1$（其中 $fa_u$ 表示 $u$ 在树上的父亲，根可以任意指定）时被删除。

具体的，分析一个点 $u$ 周边的点一个一个被删除，$d_u$ 的变化。注意到 $d_u$ 为偶数的时刻共有 $\lfloor \frac{d}{2} \rfloor$ 个，而为奇数则有 $\lceil \frac{d}{2} \rceil$ 个。现在未确定的边是 $\langle fa_u,u \rangle$，要按一个奇数一个偶数的删除可能不成功，这个时候我们就要删除 $\langle fa_u,u \rangle$ 跳过一次不够的删除，同时这个时候就能够对无解进行判定。同时注意到根没有父边，不能特殊处理。

最后考虑递归构造。如果现在需要删除父边可以直接删除，否则就递归下去删除那棵子树（这是为了保证父边度数奇偶性正确）。

可以查看[具体实现](https://codeforces.com/problemset/submission/1667/177661966)。