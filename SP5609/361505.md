找规律好题。

~~这篇题解已经鸽了半年了~~

[题目传送门](https://www.luogu.com.cn/problem/SP5609)

# 题意

~~翻译好评~~

在一个无限大的国际象棋棋盘上有一个马。定义 $f(n)$ 为马走 $n$ 步时恰好到达黑色格的走法个数。给定 $T$ 个 $n$，输出 $f(n)$。

# 思路

有很多种，讲一种骗分思路和一种正解。

### 骗分思路1——广搜

根据马的走法，从白格走出的马只能到黑格，同理从黑格出来的马只能到白格。

考虑广搜，用结构体标记上一个节点是黑格白格，并在第 $n$ 步时用一个 ``set`` 记录坐标，以防重复。做 $n$ 次广搜，最终输出 ``set`` 的大小就是答案。

但是 $n$ 可以达到 $10^8$，所以只用广搜 ``TLE`` 妥妥的。一种可能的优化思路是打表，即通过广搜求出每个 $n$ 的结果，然后对于每一次询问访问 $a_n$。 

理论上来说打表可以比直接广搜多得一些分，但是要开一个 $10^8$ 个 ``int`` 的数组，广搜时还会受到 ``set``、``queue`` 等 ``STL`` 的限制，因而拿不到满分。

### 正解——找规律

想要拿满分，在 $T \leq 10^6$ 和 $n \leq 10^8$ 的情况下，单词查询时间复杂度必须是 $O(1)$。这里提供一种找规律做法。

- 显然，根据马的走法，在奇数次时是**无论如何都走不到黑格上的**。

- 若 $n = 0$，$f(n) = 1$，初始格。

- 若 $n = 2$，$f(n) = 33$，得自己画。

- 若 $n$ 为其它偶数，$f(n) = \dfrac{(4n+1)^2+1}{2}-4(\dfrac{n}{2})^2$。

图可以参考楼下的图。

可以发现，把所有可能位置画出来后，会呈现出一个八边形，这个八边形中的所有黑块的数量就是 $f(n)$。

考虑用一个正方形减去四个角得到这个八边形。

那么这个正方形的边长就是 $4n+1$，然后其中的黑色方块数量是比白色方块要多一个的，因而求其中黑色方块的数量的公式就是 $\dfrac{(4n+1)^2+1}{2}$。

减去四个角，可以发现四每个角的构造都是 $1+3+5+.....+n-1$ 的奇数数列，变化得到 $(\dfrac{n}{2})^2$，乘四即可。

# 代码

```cpp
#include<bits/stdc++.h>
using namespace std;
#define ll long long

int t,n;
int main(){
    scanf("%d",&t);
    while(t--){
        scanf("%d",&n);
        if(n % 2 != 0)printf("0\n");
        if(n == 0)printf("1\n");
        if(n == 2)printf("33\n");
        if(n % 2 == 0 && n != 0 && n != 2){
			ll ans = (ll)((ll)(4 * n + 1) * (ll)(4 * n + 1) + 1) / 2 - (ll)(n / 2) * (ll)(n / 2) * 4;
            cout<<ans;
		}
	}
	return 0;
}

```
