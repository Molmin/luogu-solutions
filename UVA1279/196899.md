考虑 CF1633E 的套路，MST 的种类数只和两两边权的大小关系有关。

然后这题一共 $n^2$ 条边，一共 $n^4$ 种大小关系。

一条边的长度是关于时间 $t$ 的二次函数，这个可以直接预处理出来。

然后两个二次函数最多只有 2 个交点，交点意味着两条边的大小关系发生改变。

这样就可以预处理出来 $n^4$ 种大小关系的每种关系对应的时刻。

按照 $t$ 排序，然后每次变化一个大小关系时暴力 check 即可。

复杂度 $O(n^5)$。