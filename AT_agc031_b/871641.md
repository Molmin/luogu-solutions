### 思路：

这是一个需要 $O(n)$ 复杂度的计数问题，所以想到线性 $\texttt{DP}$。

带取模的 $\texttt{DP}$ 常看前继贡献。设 $f_i$ 为前 $i$ 个的合法方案数，转移有两种情况：

- $c_i = c_{i-1}$ 时，$f_i$ 直接继承 $f_{i-1}$ 的答案。

- $c_i \neq c_{i-1}$ 时，$f_i + f_{pre_i} \to f_i$。

然后是边界，直接 $1 \to f_0$。

题目要求每一次染色都应在两个颜色相同的石头之间，方便转移，进一步降低复杂度，开一个桶 $pre_i$ 统计第 $i$ 个石头前面离他最近的与它颜色相同的石头的编号。（记住，在每次转移完成后必须要及时维护）

代码需要私信。