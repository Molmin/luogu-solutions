这是一个爆标做法。

直接计数很难考虑到 $A_i$ 互不相同的限制，考虑容斥。

这是一个经典的容斥模型，即集合划分容斥。

考虑将原序列划分成若干集合，每个集合内的数强制相等，然后一个集合内的容斥系数就是 $(-1)^{|S|-1}(|S|-1)!$，证明可以考虑枚举圆排列，然后用下斯特林数相关结论就得证了。

然后就是要计算对于可能的集合个数，其带上容斥系数的方案数之和。

不妨设一个集合的集合幂级数是 $F$，那么就是要求 $\exp F$。

$F$ 的计算显然可以枚举一个集合，然后求出 $\text{lcm}$。

可以用除法规避爆 long long 的问题。

复杂度是 $O(n^22^n+2^n\log V)$ 的。