考虑模拟这些学生跑到中间的过程。  
肯定会有一个方案和最优解等价并且在一个宿舍里面要么一个人都没有，要么有恰好 $b$ 人。  
显然如果有多余 $b$ 个人，要么可以用这些人去补另一个宿舍，要么可以藏起来。  
分别考虑左半部分和右半部分；  
我们对每一半都计算出最多有多少个宿舍可以补到 $b$ 人（等价于最少有多少个宿舍怎么都补不到 $b$ 人）。答案明显是（左边不能补到最少数量，右边不能补到最少数量）的 $\max$。注意计算时候可以搬过来另一半的人来减少本半的答案（具体为什么我不知道（（（。  
现在就很简单了：来处理一半，只需要对每个位置 $i$ 算“可以在 $i$ 关门之前跑到 $i$ 的位置”人数之和，如果这个数量 $>b$ 就直接“模拟搬过来” $b$ 人。  
观察到当 $i$ 更靠近中间，可以跑到它的区间更大，并且还永远包含任意里中间更远的 $j$ 的区间。这样就根本不需要管“搬过来”的人是从哪些宿舍搬过来，只需要记已经固定了（不能搬来搬去）多少人。  
两端这样模拟就好了。

主要代码：

```cpp
    int ar[100005];
     
    signed main() {
        ios_base::sync_with_stdio(false); cin.tie(0);
        ll n, d, b; gi(n), gi(d), gi(b);
    	rep1(i, n) gi(ar[i]), ar[i] += ar[i-1];
    	ll m = (n+1)/2, c1 = 0, c2 = 0;
    	for(int i=1; i<=m; i++) c1 += (ar[min(n,i*(d+1))]-c1*b>=b);
    	for(int i=n; i>m; i--) c2 += (n*b-ar[max(0ll,n-(n+1-i)*(d+1))]-c2*b>=b);
    	print(max(m-c1,n-m-c2));
    }
```

神仙给我 idea 的提交：

https://codeforces.com/contest/949/submission/63757814