小学数学题（bushi）。

------------

这题的关键点是如果将猪分成三组且前两组猪数量相等，那么只要将前两组猪分别放在天平两侧进行一次称量，即可知道要找的猪在三组中的哪一组。

设 $f(x)$ 为猪的数量为 $x$ 时的答案。显然 $f(1)=0$，且当 $m$ 不变时，$f(x)$ 单调不下降。

可以发现每次分组时让三组中猪数量最多的那组猪数量最小时更优，考虑如何分组。

先不考虑 $m$ 的限制。

+ $n=3k$

显然此时令三组猪的数量均为 $k$ 时是最优的。

+ $n=3k+1$

此时令前两组猪数量为 $k$，最后一组为 $k+1$ 最优。

+ $n=3k+2$

令前两组猪数量为 $k+1$，最后一组为 $k$ 最优。

于是有递推式 $f(x)=f(\left\lceil\dfrac{x}{3}\right\rceil)+1$。

现在考虑加上 $m$ 的限制后会有什么影响。

发现只有当 $x\geq 3m+2$ 时才会对我们原先的策略产生影响。实际上此时的递推式也很容易发现是 $f(x)=f(x-2m)+1$。

综合起来，有 $f(x)=\begin{cases}0&x=1\\f(\left\lceil\dfrac{x}{3}\right\rceil)+1&0<x<3m+2\\f(x-2m)+1&x\geq 3m+2\end{cases}$。

实际上上面递推式的 $3m+2$ 换成 $3m+1$ 或 $3m$ 也能得到同样结果。

现在的问题是怎么计算 $f(n)$。容易发现上面式子第二部分直接递归就是 $O(\log m)$ 的，而第三部分每次规模都是 $-2m$，可以直接推式子 $O(1)$ 求出。

```cpp
#include<bits/stdc++.h>
#define ll long long
using namespace std;
ll n,m;
ll f(ll x)
{
	if(x==1)return 0;
	if(x>3*m){ll k=(x-3*m-1)/(2*m)+1;return f(x-k*2*m)+k;}
	return f((x-1)/3+1)+1;
}
int main()
{
	scanf("%lld%lld",&n,&m);
	printf("%lld",f(n));
}
```