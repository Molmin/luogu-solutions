先提出一个思路，以重心为根计数，可以对计算有多少种不同构的树的问题起到去重的作用。

那么有一个基本的想法是，将所有和题目有关的要素加入到 DP 定义。定义 $dp_{i,j,k}$ 表示，用了 $i$ 个结点，根结点度数为 $j$，其 $j$ 棵子树大小全部**不超过** $k$。

发现这样竟然就能转移了……分两种情况：

1. 没有大小为 $k$ 的子树：$dp_{i,j,k}=dp_{i,j,k-1}$；   
2. 枚举有 $p$ 个大小为 $k$ 的子树：$\displaystyle dp_{i,j,k}=\sum_{l} dp_{i-kl,j-l,k-1}\dbinom{dp_{k,d-1,k-1}+dp_{k,0,k-1}+l-1}{l}$。

欸欸，那个组合数是什么意思呢？其实是我们往下接上 $l$ 个大小为 $k$ 的子树（不必要满足子树的根是子树的重心哦）的方案数。首先 $dp_{k,d-1,k-1}+dp_{k,0,k-1}$ 就是往下接一个子树的方案数，因为下面的点要么没有儿子要么有 $d-1$ 个儿子；然后接 $l$ 个的方案数就是这个组合数了，可以看作网格图向右向上的路径模型，从 $(1,0)$ 出发到 $(dp_{dp_{k,d-1,k-1}+dp_{k,0,k-1},l})$（其中纵坐标表示已经确定了多少个子树，横坐标表示当前选的子树种类；向上就是再选一个当前横坐标代表的子树，向右就是去考虑选下一种合法的子树）。

然后就能暴力转移啦\~答案就是 $dp_{n,d,n/2}$。（其中 $a/b$ 表示 $a$ 除以 $b$ 向下取整，下同。）

但是有一点让 emu 非常困扰呢！就是 $n$ 是偶数的时候重心可能有两个呢。我们需要进一步的去重。注意到这种情况会被多计数一次，我们只需要算一下出现两个重心的方案数就好了！以某一个重心为根的子树大小为 $n/2$，度数为 $d-1$，且与另外一个重心相连，要求相似，那就是在 $dp_{n/2,d-1,n/2-1}$ 里面选出两种树，然后连上他们的根。注意没有顺序，所以这个需要减去的贡献还得除以 $2$。

这样我们就做到不重不漏啦！是不是非常 wonderhoy☆ 呢？

但是有一个很严重的问题！组合数怎么算呢，上面的数不仅非常大，而且会取模 \>\_\<，是不是算不了了？

根据 Lucas 定理，因为 $l \leq 10$，所以 $\dbinom{n}{d}$ 中就算 $n$ 咚、轰轰的大，贡献也只会是 $\dbinom{n/mod}{d/mod} = \dbinom{n/mod}{0} = 1$（沿用题目定义，不用正体），所以可以直接取模，没有问题啦！

完整代码点这里哦：[酸っぱい顔　＞＿＜](https://www.luogu.com.cn/paste/d6capgm1)。