感觉这题肯定能评黑啊！

考虑写出 $\sum v_i$ 个多项式，其中 $x^i$ 有 $v_i$ 个，那么答案相当于从这 $\sum v_i$ 个多项式里面选 $m$ 个，求出乘积（其中 $x^a\times x^b=x^{a \text{ xor }b}$），再全部求和。

考虑 FWT，相当于选 $m$ 个多项式，把它们 FWT 后乘起来，再对所有这种的 FWT 之和求和，再 IFWT 回去。

发现每个序列 FWT 后会有若干位 $1$ 和若干位 $-1$，考虑先算出来所有序列的 FWT 之和。那么通过这一位上的值就能解出这一位上 $-1$ 的个数，假设有 $a$ 个，则答案的 FWT 在这一位上（乘法情形时）的值就是
$$
\sum_{i=0}^a(-1)^i\binom{a}{i}\binom{n-a}{m-i}=a!(n-a)!\sum_{i=0}^a\dfrac{(-1)^i}{i!(m-i)!}\times \dfrac{1}{(a-i)!(n-m-(a-i))!}
$$
发现是个卷积，可以用 NTT $O(n\log n)$ 预处理。时间复杂度是 $O(n\log n+w2^w)$。

但是这样只有 $98$ 分，考虑 $n\le 10^9$ 怎么做。

其实说起来也没什么！注意到这个组合数求和是关于 $a$ 的不超过 $m+1$ 次多项式！因此你可以先 NTT 算出前 $O(m)$ 项！然后快速插值得到多项式！最后多点求值要算的那 $2^w$ 项就可以了！！复杂度是 $O(m\log ^2m+w2^w)$！！！