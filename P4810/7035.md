操作树。

首先，可以建出这些点的操作树。

对于插入操作，直接将这个点挂在前驱节点的下面。

对于删除操作，直接将这个点和前驱节点的**父亲节点**合并，用并查集维护。

那么，可以知道，询问操作所问的就是两个点在操作树上的距离(因为加入的所有数字都互不相同)。直接处理即可。

注意因为要支持删除操作的输出，需要记录栈底元素是什么。

这样做的时间复杂度取决于求$lca$的时间。根据实现的不同可以得到$O(n\alpha(n))$或者$O(n(\log n+\alpha(n)))$的复杂度。