考虑 $n \leq 750$，将具有包含关系的字符串之间连边后询问二分图的最大独立集即可。                       

考虑 $m = \sum |S| \leq 10 ^ 7$，得想到一种比较快的方法连边。            

使用 AC 自动机优化建图，假设每个字符串的结尾点在 $p_i$，将所有 $p_i$ 置为关键点后压缩关键点之间的路径，这个过程可以使用并查集压缩路径做到 $O(m\alpha(m))$ 的时间复杂度。               

由于压缩树比较小，根据 AC 自动机的性质，对于第 $i$ 个字符集 $s_i$，向祖先中最近的一个 $p_x$ 以及 $p_x$ 与 $p_i$ 之间点 fail 指针最先找到的字符串连边，最后传递闭包即可做到 $O(n ^ 3)$ 建边，使用 bitset 可以做到 $O(\frac{n ^ 3}{w})$。           

最后就是在二分图上构造最大独立集。考虑找到最大匹配，将左边未被匹配的点都先假设在独立集内，但此时未判断二分图右边的点是否合法（因为左右两边点的选择意义是一样的），所以我们将左边的每个未被匹配的点都拉出去按照左往右沿未匹配边，右往左按匹配边的顺序 dfs 一遍。

对于每个点现在可以知道它在左/右图中是否被二次 dfs 到过，如果一个点在左图中被遍历到且在右图中未被遍历到，那么这个点就在最大独立集中。      

因为匹配的边表示着两边的点都不能被选择，而未匹配的边就相当于没有确定。所以按照未被匹配的边走就相当于确定了走出点为选择点，走入点为不能选择点，又由于走入点不能被选择了，所以原来的匹配作废，可以重新考虑选择，所以要从右边按照原来的匹配边走回左边。           

时间复杂度 $O(\frac{n^3}{w} + m\alpha(m))$。