写复杂了/kk。

首先需要知道一个事情，就是两个点间所有路径的异或都可以表示为这两点的一条简单路径异或若干个环。

所以考虑将环的的异或和加到一个线性基里，记 $s_i$ 表示 $1 \rightarrow i$ 一条简单路径的异或和。根据上述结论，我们发现两个点 $i, j$ 之间的路径异或和可以表示为 $s_i \oplus s_j \oplus x$ 其中 $x$ 是线性基里的一个子集，这样我们枚举点可以做到 $O(n^2\log V)$。

枚举点是不优的，所以考虑计算每一个二进制位的贡献，记当前二进制为 $w$，$s$ 中第 $w$ 位为 $1$ 的有 $o$ 个，第 $w$ 位为 $0$ 的有 $z$ 个。线性基中第 $w$ 位为 $1$ 的有 $op$ 个，第 $w$ 位为 $0$ 的有 $zp$ 个。

假设 $s_i \oplus s_j$ 的第 $w$ 位为 $0$，那么这样的 $(i, j)$ 共有 $\binom{o}{2} + \binom{z}{2}$ 种，如果产生贡献，则 $op$ 中要选奇数个，这样有 $2^{op - 1}$ 种选法，所以这样一共就有 $2^{zp}2^{op - 1}(\binom{o}{2}+ \binom{z}{2})$ 种情况。

假设 $s_i \oplus s_j$ 的第 $w$ 为为 $1$，那么这样的 $(i, j)$ 共有 $oz$ 种，如果产生贡献，则 $op$ 中要选偶数个，也有 $2^{op - 1}$ 种选法，这样一共有 $2^{zp}2^{op - 1}oz$ 中情况。

注意当 $op = 0$ 时，第一种情况不存在，第二种情况的方法数为 $2^{zp}oz$。

这样直接对着式子写即可，时间复杂度 $O(n\log^2V)$。[Code](https://codeforces.com/contest/724/submission/207369365)