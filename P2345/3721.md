按位置进行划分而不是按人数进行划分，线段树维护三个域 num distl distr ，分别表示位置l到位置r之间的人数、到0的距离（sum(x[i]-0)）、到右端点的距离(sum(20000-x[i]+1))。对

v进行排序，然后每次拿出来一个最大的，求解其左侧点的答案和右侧点的答案，求出解之后删除。关键代码如下。

```cpp

for ( i=1;i<=n;++i)  
    {  
        ans = ans+v[i]*(queryl(x[i]+1,20000,1)-querynum(x[i]+1,20000,1)*x[i]+queryr(1,x[i]-1,1)-querynum(1,x[i]-1,1)*(20000-x[i]+1));  
        del(x[i],1,x[i],20000-x[i]+1);  
    }  

```
最难的就是求距离的公式  queryl(x[i]+1,20000,1)-querynum(x[i]+1,20000,1)\*x[i] 多画画图写个样例就懂了
