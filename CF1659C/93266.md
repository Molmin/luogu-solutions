[题目传送门](https://www.luogu.com.cn/problem/CF1659C)

*1500 都不会了，这水平。

首先考虑一种简单情况就是 $a \le b$，显然这时候迁移肯定比不迁移好，所以每次都迁，最后迁到 $x_{n-1}$，所以答案就是 $ax_{n-1}+bx_n$。

然后考虑 $a>b$ 怎么做。发现当前如果不迁移，以后迁移的收益会更低（早迁移的话，迁移费少了，而且攻打的费用也少了），所以如果当前不迁那以后更不会迁了。

于是最佳策略一定是不断迁移到 $x_k$，然后从 $x_{k+1} \sim x_n$ 只攻打不迁移。这样答案就是 $ax_k+bx_k+b[\sum\limits_{i=k+1}^nx_i-(n-k)x_k]$，这个式子处理一下前缀和可以直接 $O(1)$ 求。

所以暴力枚举 $k$ 算贡献取最小值，复杂度 $O(n)$。

可以看出 $a \le b$ 的情况就是 $a>b$ 时，$k=n-1$ 的特殊情况。