回顾 Floyd 求最短路的过程，枚举中转点来进行松弛操作。

在 SPFA 及 Dijkstra 求最短路的过程中，一个点 $u$ 到其他点 $v$ 的边能够用来更新最短路，只有当 $v$ 作为中转点时才行。

然后考虑 $u$ 到其他点的最短路求不出来，就是与 $u$ 相邻的所有点都不是标记点。

于是我们随便找出一个点 $u$，与非标记点连边。

剩下的点只要不连到 $u$ 想砸连咋连。

考虑无解的情况，$n = k$ 肯定无解。

还有其它情况吗？

按照上面的连边方法，边数是有上界的，就是完全图的边数减去除 $u$ 外的标记点数。

为了使上界更大，$u$ 应该取标记点，这样减去的数量为 $k - 1$。

因此 $m \gt \frac{n(n - 1)}{2} - k + 1$ 时无解。