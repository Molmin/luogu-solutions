### 题意
构造一个 $n$ 阶混合图，满足其基图为完全图，且恰有 $n$ 条无向边。从图中选择四个点，要求最大化选出的四个点的导出子图强连通的方案数。  
$1 \le n\le 99,n=2k+1,k\in \mathbb{N}_+$

### 题解
这篇题解主要是解释 xht 神仙的做法，看不懂神仙的题解可以来这里。

同样，我们可以知道，一组不强连通的 $4$ 个点必然属于以下三种情况之一：  
1. 从一个点向其他三个点各连一条有向边
2. 不满足 1 的情况下，三个点向另一个点各连一条有向边
3. 存在两条端点各不相同的无向边，且第一条无向边的两个端点各自向第二条无向边的两个端点连两条有向边

容易看出上述情况互异，不存在同时满足两种情况的方案。  
可以用图论知识证明，所有不满足上述三种情况的四阶混合图必然强连通，所有非强连通图必然属于上述情况之一。由于只有 $729$ 种带标号的四阶混合图，我们可以暴力枚举来 `check`，这里不再赘述。

我们记一个点连出的**有向边**数量为 $S_i$，一共有 $\frac{n(n-1)}2-n=\frac{n(n-3)}2$ 条有向边，也就是 $\sum_{i=1}^n S_i=\frac{n(n-3)}2$。

令 $X$ 为满足第一种情况的方案数，容易知道 $X=\sum_{i=1}^n C_{S_i}^3$，也就是枚举连出有向边的点，从它的出边中选择三条作为方案。由于一种满足第一种情况的方案只会有一个点连出三条出边，可以知道这样计数是不重不漏的。  
令 $f(x)=C_{x}^3=\frac{x(x-1)(x-2)}6~(x\ge 3)$，可以得到 $f''(x)=x-1$，也就是 $f(x)$ 在 $[3,+\infty]$ 上是凸函数。  
根据这一结论，我们可以得到一个引理：  
> $\forall x,y\in [4,+\infty]\cap\mathbb{N}_+,~x\le y$，$C_{x-1}^3+C_{y+1}^3\ge C_x^3+C_y^3$ 恒成立。  

容易把这一结论拓展到 $x,y$ 取 $0,1,2,3$ 的情况。  
因此，为了最小化 $X$，我们要让所有的 $S_i$ 尽可能接近。由于 $n$ 是奇数，所以可以将每个 $S_i$ 设成 $\frac{n-3}2$，就能最小化 $X$ 了。

接下来证明最小化 $X$ 的情况下，可以构造方案使得剩下两种情况均不存在。  
按照 xht 的构造方法，我们将 $n$ 个点放在正 $n$ 边形的顶点上。对于一个点，向顺时针接下来的 $\frac{n-3}2$ 个点连有向边，向顺时针接下来的第 $\frac{n-1}2$ 和第 $\frac{n+1}2$ 个点连无向边。这样满足一共有 $n$ 条无向边，$S_i=\frac{n-3}2$。

首先证明第二种情况不存在。  
如果有四个点 $a,b,c,d$ 满足 $a,b,c$ 向 $d$ 连有一条有向边，那么，将 $a$ 重新编号为 $1$，必然有 $a<b<c<d\le \frac{n-1}2$。因此 $a$ 必然会向 $b,c,d$ 连有向边，属于第一种情况。

接下来证明第三种情况不存在。  
我们令 $a=1,b=\frac{n+1}2$，则要找到两个点 $c,d$ 满足 $a,b$ 分别向 $c,d$ 连有向边，且 $c,d$ 之间连无向边。为了使得 $a$ 向 $c,d$ 连有向边，必须满足 $a<c<d<b$，这种情况下，$c,d$ 之间显然只能是有向边。  
$a=1,b=\frac{n+3}2$ 的情况可以用类似的方法证明不合法，所以不存在第三种情况。

最终，我们的答案就是 $n\times C_{\frac{n-3}2}^3=\dfrac{n(n-3)(n^2+6n-31)}{48}$。
### 代码
```cpp
#include<bits/stdc++.h>
#define reg register
typedef long long ll;
using namespace std;
const int MN=105;
int n,mp[MN][MN];
int main(){
	scanf("%d",&n);
	if(n==1)return 0*puts("0\n0");
	printf("%d\n",n*(n-3)*(n*n+6*n-31)/48);
	for(reg int i=1;i<=n;i++)
		for(reg int j=1;j<=(n+1)/2;j++)
			mp[i][(i+j-1)%n+1]=1;
	for(reg int i=1;i<=n;i++,puts(""))
		for(reg int j=1;j<=n;j++)
			printf("%d ",mp[i][j]);
	return 0;
}
```