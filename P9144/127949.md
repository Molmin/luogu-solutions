[题目传送门](/problem/P9144)

场上没加二分，一直寄/ll

一看 $n\le 6$，可以直接对每个关卡的三种决策进行爆搜，取概率的 $\max$。

然后你会发现搜的时候需要用到自己的概率，这时候考虑二分。具体的，先把这个概率设成某个数，如果搜出来的结果比它大，则答案区间应该增大，反之亦然。

注意特判掉第一关就放弃或者寄了，这些情况是完全没有意义的。

精度不能设太小不然会被卡常。

代码很丑，不贴了。