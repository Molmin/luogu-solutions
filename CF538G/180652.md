# CF538G

首先我们发现，既然是每 $l$ 步一个循环，那么应该有一个位移向量 $(x_0,y_0)$ 满足对于任意间隔 $l$ 的时间的位置，位移都是 $(x_0,y_0)$。一旦知道了位移条件，我们就能很快地解出答案。

设第 $i$ 条信息在第 $p_i$ 个循环的第 $k_i$ 秒，我们对所有条件按 $k$ 排序（若存在 $k$ 相同那么结果就直接定了）那么我们的 $(x_0,y_0)$ 应该满足
$$
|x_i-p_ix_0-x_{i-1}+p_{i-1}x_0|+|y_i-p_iy_0-y_{i-1}+p_{i-1}y_0|\le k_i-k_{i-1}
$$
我们取 $c_i=p_i-p_{i-1}$， $a_i=\frac{x_{i}-x_{i-1}}{c_i}$，$b_i=\frac{y_i-y_{i-1}}{c_i}$，$d_i=\frac{k_i-k_{i-1}}{c_i}$，则式子化为
$$
|a_i-x|+|b_i-y|\le d_i
$$
即 $(x_i,y_i)$ 到 $(a_i,b_i)$ 的曼哈顿距离不超过 $d_i$，即在以 $(a_i,b_i)$ 为中心，半径长 $d_i$ 的一个斜方形中。我们把坐标轴转 $45°$，或者把上面那个绝对值不等式给拆了，则可以得到
$$
-d_i+(a_i+b_i)\le x+y \le d_i+(a_i+b_i)
$$
$$
-d_i+(a_i-b_i)\le x-y \le d_i+(a_i-b_i)
$$
这样我们就可以得到一个关于 $x+y$，$x-y$ 的不等式。显然，任意满足上述条件的 $x,y$ 在距离上都是合法的。由于 $l\le 10^6$，所以通过枚举 $x$ 的取值，我们可以得到一些合法的 $(x,y)$。

现在距离的问题解决了，唯一的问题在于奇偶性。我们对于每一个点都必定满足 $x_i+y_i+t_i$ 是偶数，且在距离合法的情况下，任意满足这个奇偶性条件的解都能给出简单的构造。上述条件可以转化为
$$
p_i(x_0+y_0)\equiv t_i+x_i+y_i\pmod 2
$$
但是由于 $l+x+y\equiv 0\pmod 2$，于是我们还要判断一下是否能有满足条件的 $x_0+y_0$ 的奇偶性并依次构造即可。

代码巨长，一堆讨论。被各种 Cases 给搞寄了。

https://codeforces.com/contest/538/submission/177723313