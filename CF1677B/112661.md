## Description

给出一个 $n$ 行 $m$ 列的矩阵，最初全部为空。现给出一个 01 序列 $S$，逐位将序列内的数放至矩阵的 $(1,1)$ 位置，并将矩阵内所有其余数后移一位（特别的，每一行第 $m$ 列的数移至下一行的第 1 列），问加入 $S$ 的每一位时，矩阵中“好的行和列”的数量为多少。

我们定义一行或一列是好的，当且仅当这一行/列有至少一个数为 1。（$1 \leq \sum n \times m \leq 10^6$）

## Solution

我们将行和列分别考虑。

对于列来说，我们发现编号对 $m$ 取模相同的数在加入数字时永远在同一列，所以开一个桶记录每一列是否已经有 1 出现即可。

但是行的计算与列不同，因为这里的计算是逐行转移，而列只需考虑与 $m$ 取模的结果即可。

通过观察，发现对于每个元素 $S_i$，其在矩阵中某行的可能的状态只有 $m$ 种（即 $S_i$ 在第 1 列、第 2 列…第 $m$ 列），因此考虑类似队列的区间移动，从头开始对 $S$ 进行扫描，每次将第 $i$ 位加入，将第 $i-m$ 位弹出，记录此时区间内 1 的数目，再考虑对答案的贡献，时间复杂度为扫描每一位的 $O(n \times m)$。

## [code](https://www.luogu.com.cn/paste/9l5795tg)