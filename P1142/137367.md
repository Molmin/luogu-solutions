【前言（~~废话~~）】

这道题需要联想到初中阶段所学习的平面直角坐标系。因为题目中提到直线，所以我们必然会想到一次函数。本蒟蒻对一次函数的表达式进行了略微的推导，已经熟知的大佬请忽略。

【一次函数简介】

对于一条在平面直角坐标系中的直线，它必定能够用形如$y=kx+b$的形式表示，其中$k\neq0$。当$b=0$时，$y=kx$，此时$y$与$x$成正比例。

下图是$y=-4x+5$的函数图像：

![](https://cdn.luogu.com.cn/upload/image_hosting/aoak0ois.png)

在直线$y=-4x+5$上的点有无数个，但在输入中出现的是有限的，甚至并不存在。

所以我们必须要找到满足条件的$y=kx+b$，使得该直线上包含输入样例中的点最多。

【思路与分析】

这道题可以用略小于$O(n^3)$的算法。主要思路就是通过$i,j$的坐标求出函数表达式，然后检查$k$的坐标是否满足该表达式即可。

我们设第一个点的坐标为$(x_1,y_1)$，第二个点坐标为$(x_2,y_2)$。设函数表达式为$y=kx+b$，则满足：

$$
\begin{cases}
y_1=kx_1+b\cr
y_2=kx_2+b
\end{cases}$$

用上式减去下式，得到：

$$y_1-y_2=(kx_1+b)-(kx_2+b)$$

这时发现$b$已经消去，而$x_1,x_2,y_1,y_2$均为已知量，所以我们进一步化简：

$$y_1-y_2=kx_1-kx_2$$
$$y_1-y_2=k(x_1-x_2)$$
$$k=\frac{y_1-y_2}{x_1-x_2}$$

这个时候我们可以通过任意一种方法得到$b$的值（可以利用$b=y_1-kx_1$或$b=y_2-kx_2$，下面以前者为例）：

$$b=y_1-kx_1$$
$$b=y_1-\frac{x_1(y_1-y_2)}{x_1-x_2}$$
$$b=\frac{y_1(x_1-x_2)-x_1(y_1-y_2)}{x_1-x_2}$$
$$b=\frac{y_1x_1-y_1x_2-x_1y_1+x_1y_2}{x_1-x_2}$$
$$b=\frac{x_1y_2-y_1x_2}{x_1-x_2}$$

求得$k,b$用坐标表示的代数式之后，我们得到函数表达式：

$$y=\frac{y_1-y_2}{x_1-x_2}·x+\frac{x_1y_2-y_1x_2}{x_1-x_2}$$

我们将其稍稍做一点改动：

$$y(x_1-x_2)=x(y_1-y_2)+x_1y_2-y_1x_2$$

现在我们要寻找一个符合条件的数对$(x_3,y_3)$使其满足上式。只要满足了，就能使得$(x_1,y_1),(x_2,y_2),(x_3,y_3)$在同一直线上。

以此类推，我们每找到符合条件的一个点，就可以发现这几个点在同一直线上。

当然，上述的操作必须保证$x_1\neq x_2,y_1\neq y_2$，否则会出现除数为$0$的现象。

【特殊情况的考虑】

我们还需要考虑两种直线$x=k,y=k$的情况（这两种直线都平行于坐标轴）。此时，函数不为一次函数，直线平行于两个坐标轴之一（即与其中一个坐标轴没有交点）。

下图是$y=1$的函数图像：

![](https://cdn.luogu.com.cn/upload/image_hosting/mottgvmd.png)

下图是$x=-10$的函数图像：

![](https://cdn.luogu.com.cn/upload/image_hosting/cfle6d6q.png)

这就较为简单了——找到两个点，使其横坐标相同；再找到两个点，使其纵坐标相同。

我们综合上述两条直线的情况，根据简单贪心的算法，找到各个直线的点个数的最大值即可。

【代码】

本蒟蒻喜好使用`Python`写部分程序，~~但是`Python`的运行速度实在太慢，导致`TLE`~~。`C++`在$O(n^3)$算法下居然不会$TLE$，看来暴力算法也可以过。`Python`代码基本上是从`C++`翻译过来的，大家可以参考参考。

运行结果：

|结果|语言|时间大小|空间大小|代码大小|提交记录|代码
| :----------: | :----------: | :----------: | :----------: | :----------: | :----------: | :----------: |
|$\color{#52C410}AC$|`C++`|$436ms$|$732.00KB$|$887B$|[记录](/record/33480524)|[代码](/paste/psl32n6p)|
|$\color{#052242}TLE$|`Python3`|$7.53s$|$3.48MB$|$930B$|[记录](/record/33481727)|[代码](/paste/py9r56qq)|