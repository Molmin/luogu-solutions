考虑 DP。

令 $f_i$ 表示目前如果要使 $i$ 的点是最大值的最小操作次数。初始时，$f_1=0$，其余的 $f$ 均为 $+\infty$。

依次枚举每一个排序区间，则 $f_{r_i} = \min \limits_{j=l_i}^{r_i} f_j + 1$。

容易发现可以用线段树优化。