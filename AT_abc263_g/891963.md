我去看了一下英语题解，感觉理解起来有些困难，所以写一下非官方做法。

首先，我们看见这个 $n\le 100$ 的匹配问题就想到网络流，看到 $b_i\le 10^9$ 就知道一定不是费用流。如果没有 $1$，可以直接在可以组成质数的奇数、偶数之间连边，构成一个二分图，创造一个源点和一个汇点，然后直接跑最大流即可。

但是现在有 $1+1=2$，所以我们要换一种建图方式。对于每一个数，我们将它拆成 $2$ 个点，一个入点，一个出点，然后对于所有和为质数的 $x$ 和 $y$，我们从 $x$ 的入点向 $y$ 的出点连流量为无限的边，建立源点向所有入点连流量为其个数限制的边，所有出点向汇点连流量为其个数限制的边，跑出最大流除以 $2$ 即可。

用 Dinic 和试除法，时间复杂度 $O(n^4+n^2\sqrt {a_i})$。

[AC 代码](https://atcoder.jp/contests/abc263/submissions/43528612)。

当然也可以用 HLPP 和 Miller_Rabin，时间复杂度 $O(n^3+n^2\log a_i)$。