### 一、题意

英文题面也大致能看懂，翻译也很清楚了，不多赘述。

### 二、思路

纯纯的诈骗题。

首先很显然想到使用线段树、树状数组、ST表之类的维护区间最值，然后暴力找 $l,r$，求最小值。

单次时间复杂度是 $O(n\log n+n^2)$，显然无法通过。 

思考正解，要让原式最大，就要让两个 $\max$ 得到的值最大，$\min$ 得到的值最小。

什么最大？什么最小？当然是最大、次大、最小、次小这四个值！

这时有人要问了：你怎么保证一定能把这四个值分成符合条件的两组呢？

干脆枚举，简洁明了。设最大、次大、最小、次小分别是 $a,b,c,d$。

+ $abcd$，可以变成 $a|bc|d$。
+ $abdc$，可以变成 $a|bd|c$。
+ $adbc$，可以变成 $|ad|bc$。
+ $\cdots$

这说明了我们的猜想是正确的（实际上这就是分割一个环）。

就这样得到最优的 $O(n)$ 做法，输出 $a+b-c-d$ 即可。