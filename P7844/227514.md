SoyTony 科技 orz。

考虑 DFT 相当于代入 $\omega^i$，IDFT 相当于代入 $\omega^{-i}$ 后除以项数。

显然 $\omega^{2^n}=1$，于是可以发现代入 $\omega^{-i}$ 对应序列翻转，考虑给恰一半的 DFT 翻转改成 IDFT，除以项数的部分可以直接提出来。

发现这样操作会产生 $\dfrac k2$ 次翻转，两次翻转才能抵消，于是不管除以项数的部分则答案有长为 $4$ 的循环节，前面直接做，后面散的部分暴力 NTT 即可。

时间复杂度 $\Theta(n2^n)$。