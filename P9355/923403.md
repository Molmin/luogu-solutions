# [原题](https://www.luogu.com.cn/problem/P9355)
我开考这场比赛时仅剩 30 分钟的时间了，竟然还能 AC 一道题！

---
### 分析
刚看到这题我一头雾水，再加上时间很紧，我就想着打个表先把数据范围很小的 `Subtask #1` 先过了。

结果这一打，还真打出名堂来了。

以下是我打的表：

| $n$ \ $m$ | $1$ | $2$ | $3$ |
| :-----------: | :-----------: | :-----------: | :-----------: |
| $1$ | $0$ | $1$ | $2$ |
| $2$ | $1$ | $4$ | $7$ |
| $3$ | $2$ | $7$ | $12$ |


[骗分记录](https://www.luogu.com.cn/record/110955535)

我观察了一会，发现每一行都是一个等差数列。

等差数列的每一项都可以通过公式求出来，这样就能以 $O(1)$ 的时间复杂度求出答案。

求出某一项需要知道等差数列的首项和公差，我们一项一项分析：

- 首项：很明显，根据如上表格，每一行的首项是 $n-1$。
- 公差：无法直观看出规律，可以根据入上表格列举一下：

	| $n=$ | 公差 |
	| :-----------: | :-----------: |
	| $1$ | $1$ |
	| $2$ | $3$ |
	| $3$ | $5$ |
	可以发现，公差就是第 $n$ 个奇数，即 $n \times 2 - 1$。
    
最后，再套入求等差数列的某一项的公式，最终的结果就变为了：
$$(n - 1) + (n \times 2 - 1) \times (m - 1)$$

**注意：本题卡 `int`！**

---
代码：
```cpp
#include <bits/stdc++.h>
#define int unsigned long long //注意！
using namespace std;
int t , n , m , ans;
signed main()
{
	cin >> t;
	while (t--)
	{
		cin >> n >> m;
		ans = (n - 1) + (n * 2 - 1) * (m - 1);
		cout << ans << endl;
	}
	return 0;
}
```

---
以上为考试时时间紧张的应急之策（并不知道公式原因），接下来，我来讲讲我赛后的思路。

首先，根据题目可得知，每个棋子能得到的分数在 $1$ ~ $4$ 之间。因此，我们可以分类讨论在每一种分数下，棋盘中会放置多少个能得对应分数的棋子，最后在加起来。

很明显，交替放置是最优策略。

注：在分类讨论时，$n$ 为宽（短边），$m$ 为长（长边），因此必定 $n \le m$。

综上，开始分类讨论：

0. 特判：$n = 1$ $\land$ $m = 1$，输出 $0$。
1. 得 $1$ 分

	特殊条件：$n = 1$
    
   这种棋子只会出现在棋盘是一维时棋盘的两端。
   
   - $m$ 是偶数
   
   	 $1$ 个。
     
   - $m$ 是奇数

	  $2$ 个。
2. 得 $2$ 分

	这种棋子只会出现在矩形棋盘的角落，一维棋盘的中间。
   
   若 $n > 1$
   
     - $n$，$m$ 都是偶数

       $2$ 个。

     - $n$ 是偶数且 $m$ 是奇数或 $n$ 是奇数且 $m$ 是偶数

       $2$ 个。

     - $n$，$m$ 都是奇数

       $4$ 个。
       
	若 $n = 1$
    
    - $m \div 2 - 1$ 个。

3. 得 $3$ 分

	特殊条件：$m \ge 3$ $\land$ $n \ge 2$。
   
   这种棋子只会出现在二维棋盘边缘上（除去角落），所以我们可以求出棋盘周长并减去角落里的棋子的数量（即 $ n > 1$ 时得 $2$ 分的情况）。

4. 得 $4$ 分

	特殊条件：$n \ge 3$ $\land$ $ m \ge 3$。
   
   由于上下左右都需要预留空间，因此只能在 $(n - 1) \times (m - 1)$ 的矩形内放置，其中的所有棋子均得 $4$ 分。

---
分类讨论代码：
```cpp
#include <bits/stdc++.h>
#define int unsigned long long
using namespace std;
int t , n , m , s1 , s2 , s3 , s4 , ans;
signed main()
{
	cin >> t;
	while (t--)
	{
		cin >> n >> m;
		int tn = min(n , m) , tm = max(n , m);
		n = tn; m = tm;
		s1 = s2 = s3 = s4 = 0;
		
		//特判 
		if (n == 1 && m == 1) {cout << 0 << endl; continue;}
		
		//得1分 
		if (n == 1)
		{
			if (m % 2 == 0) s1 = 1;
			else s1 = 2;	
		} 
		
		//得2分 
		if (n > 1)
		{
			if (n % 2 == 0 && m % 2 == 0) s2 = 2;
			else if (n % 2 == 1 && m % 2 == 1) s2 = 4;
			else s2 = 2;
		}
		else s2 = m / 2 - 1;
		
		//得3分 
		if (m > 2 && n > 1) s3 = 2 * (n + (m - 2)) / 2 - s2;
		
		//得4分 
		if (n > 2 && m > 2)
		{
			int s = (n - 2) * (m - 2);
			if (s % 2 == 0) s4 = s / 2;
			else s4 = s / 2 + 1;
		}
		//求出结果 
		ans = s1 + s2 * 2 + s3 * 3 + s4 * 4;
		cout << ans << endl;
	}
	return 0;
}
```
  
---
[愉快的评测记录~](https://www.luogu.com.cn/record/list?pid=P9355&user=923403&page=1)