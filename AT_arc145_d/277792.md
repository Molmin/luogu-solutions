先抛开和为 $M$ 的限制不谈，我们考虑如何构造出一个不出现 $y-x=z-y$ 的集合。

先移项，得到 $x+z=2y$，一个~~神秘的~~观察：**三进制**

我们考虑选出的数的三进制表示，如果只选择三进制表示下各位上只有 $0$ 和 $1$ 的数，那么一定可以符合要求。因为 $x,y$ 至少有一位不同，$x+y$ 的三进制表示中一定会出现 $1$，而 $2y$ 的三进制表示中只有 $2$。

在值域的限制下，能选出的数的总数大于 $10^4$，于是我们暂时完成了这一步构造。

再考虑如何满足和为 $M$ 的限制。令当前构造出的集合的数的和为 $sum$，$diff=M-sum$，若 $n \mid diff$，则我们可以将差值均摊到每个数上，此时仍不会出现 $x+z=2y$ 的情况，因为两侧的增量相同，仍然不会相等。

当 $n \nmid diff$ 时，我们可以将 $diff$ 补齐到 $n$ 的倍数再均摊下去。做法很妙，通过修改一下第一步构造集合的操作，我们强制选出的数的第 $0$ 位为 $0$，这样每个数都可以在满足限制的条件下再增加 $1$，于是我们只需要给 $diff \bmod n$ 个数加一即可。