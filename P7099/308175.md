[传送门](https://www.luogu.com.cn/problem/P7099)

## 原题
### 题目描述
- 扶苏被困在了勒本星球，灼闻羽驾驶着一架宇宙飞船正打算穿越虫洞到达勒本星球拯救扶苏。

- 在一条数轴上有 $n$ 个虫洞，第 $i$ 个虫洞的坐标为 $x_i$ 。进入这些虫洞的任意一个都可以直接到达勒本星球拯救扶苏。飞船到达数轴所在直线上后，会因为磁场的效应失去操控能力，飞船每秒会等概率向左或向右移动一个单位长度。

- 灼闻羽非常焦急，他给出了 $q$ 个飞船进入数轴所在直线的初始坐标，对于每个坐标，他想知道期望需要多少秒才能到达一个虫洞。

- 如果你计算出的期望是个分数，你需要求出这个分数对 $998244353$ 取模的答案。有关分数取模的定义你可以参考「提示」中的内容。

- 为了避免输出过大，你只需要输出四个整数，分别表示你所有回答（对 $998244353$ 取模之后，下同）的按位异或之和、你共有多少次回答的答案是奇数，你的所有答案中的最大值、你的所有答案中的最小值。

### 输入格式
- 第一行是一个整数，表示测试点所对应的编号 $T$ 。

- 第二行有两个整数，分别表示虫洞的个数 $n$ 和初始坐标的个数 $q$ 。

- 第三行有 $n$ 个整数，第 $i$ 个整数表示第 $i$ 个虫洞的坐标 $x_i$ 。

- 接下来 $q$ 行，每行一个整数，表示一个飞船进入数轴所在直线的初始坐标 $y_j$ 。

- **保证给出的 $y_j$ 以不降序排序。**

### 输出格式
- 输出四行，每行一个整数，依次表示你所有回答的按位异或之和、你共有多少次回答的答案是奇数，你的所有答案中的最大值、你的所有答案中的最小值。

## 简化题意
给定一个点的位置，一个左端点和一个右端点，每秒有 $\frac{1}{2}$ 的概率向左或向右走一个单位长度，询问期望多少秒可以到达左端点或右端点。

## 题目思路
- 第一种方法，高斯消元
- 第二种方法，数学题推式子，下面是简要证明过程：

设 $f(i)$ 为从位置为 $i$ 的点走到左端点或右端点任意一个的期望时间

则 $f(l)=f(r)=0$ 。
其中期望是试验中每次可能结果的概率乘以其结果的总和，可以理解为取平均值。则对于每个 $f(i)$ ，有
$$
f(i)=\frac{f(i-1)+1+f(i+1)+1}{2}
$$
整理得
$$
f(i)=\frac{1}{2}\times (f(i+1)+f(i-1)) +1
$$
等号两边同时乘以 $2$ 得
$$
2\times f(i)=f(i+1)+f(i-1)+2
$$
移项得
$$
f(i+1)-f(i)=f(i)-f(i-1)-2
$$
设 $g(i)=f(i+1)-f(i)$ ,则上式可得
$$
g(i)=g(i-1)-2
$$
等差数列通项公式可得
$$
g(i)=g(1)-(i-1)\times2
$$
由上式可知， $g$ 为等差数列
由于
$$
f(l)=f(r)=0
$$
所以
$$
f(r)-f(l)=0
$$
展开
$$
f(r)-f(r-1)+f(r-1)-...-f(l+1)+f(l+1)-f(l)=0
$$
将 $g(i)=f(i+1)-f(i)$ 代入上式
$$
\sum^{r-1}_{i=1} g(i)=0 
$$
由等差数列求和公式可知
$$
\frac{(g(r-1)+g(l))\times(r-l)}{2}=0
$$
则
$$
g(r-1)+g(l)=0
$$
由 $g(i)=g(1)-(i-1)\times2$ 可得
$$
g(1)-(r-2)\times2+g(1)-(l-1)\times2=0
$$
$$
g(1)-r\times2+4+g(1)-l\times2+2=0
$$
$$
g(1)\times2=l\times2+r\times2-6
$$
$$
g(1)=l+r-3
$$
由于最终询问 $f(p)$ ，且 $f(l)=0$ ，可得
$$
f(p)=f(p)-f(l)
$$
同 $f(r)-f(l)=0$ 的展开方式
$$
f(p)=f(p)-f(p-1)+f(p-1)-...-f(l+1)+f(l+1)-f(l)
$$
$$
f(p)=g(p-1)+g(p-2)+...+g(l+1)+g(l)
$$
$$
f(p)=\sum^ {p-1}_ {i=l} g(i)
$$
$$
f(p)=\frac{(g(l)+g(p-1))\times(p-l)}{2}
$$
$$
f(p)=\frac{(g(1)-(l-1)\times2+g(1)-(p-2)\times2)\times(p-l)}{2}
$$
$$
f(p)=\frac{(g(1)\times2-l\times2-p\times2+6)\times(p-l)}{2}
$$
$$
f(p)=(g(1)-l-p+3)\times(p-l)
$$
将 $g(1)=l+r-3$ 代入上式，可得
$$
f(p)=(r-p)\times(p-l)
$$
至此，证明位置 $p$ 的答案就是 $(p-l)\times(r-p)$ 。
## Some Tricks
- 题目中给定了一些虫洞的位置，需要我们预处理出离询问最近的左右两个虫洞。
- 用 set 可以很好地解决问题。 set 中的 lower_bound(x) 函数可以查询到大于等于 $x$ 的最小值，而小于等于 $x$ 的最大值就是 lower_bound 函数查询值的前一个位置，因为 set 具有去重和排序功能，所以相邻两个位置数值不等，且相隔最近。
- code
```cpp
it=s.lower_bound(y);
r=*it;
--it;
l=*it;
```
## In the End
[100pts code](https://www.luogu.com.cn/paste/8y9dinw1)