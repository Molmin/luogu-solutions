**CF914F sol。**

考虑一个好想点的做法：由于存在单点修改，若使用字符串型数据结构需要推平。

所以优先考虑构造是线性时间复杂度的结构——SAM。

先进行一次根号分治，对于 $|y| > \sqrt {\sum|y|}$ 的字符串暴力进行 kmp，时间复杂度是 $O(\sqrt {\sum|y|} |s|)$ 的。

对于 $|y| <= \sqrt {\sum|y|}$ 的我们直接按此为块长分块，显然串至多跨越两个块，维护相邻块的 SAM 即可维护整块答案，这部分时间复杂度为 $O(\sqrt {|s|} (\sum |y|))$ 的。

对于散块我们也暴力连利两端的整块进行一次 kmp，这部分时间复杂度也是 $O(\sqrt {|s|} (\sum |y|))$ 的。注意一些细节即可通过此题。

考虑不那么好想，至少我没想到的是直接开 $26$ 个维护字符集位置的 bitset，即 $bs_{c,i}$ 表示第 $i$ 个位置是否有字符 $c$ 出现。

修改是简单的。

对于查询，我们考虑维护每个开头是否是可行的，这个可以用上述维护的 bitset 数组加速判断。

接着筛选合法区间内的合法左端点即可，时间复杂度 $O(\frac{\sum|y| \times |s|}{w})$。

