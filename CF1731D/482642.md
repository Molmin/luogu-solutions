显然，答案具有单调性，故考虑二分答案。

那么问题转化为判定性的，我们可以将矩阵中大于等于 $mid$ 的设置为 `1`，否则设置为 `0`，观察到 $n\times m\leq 10^6$，故我们可以枚举左上端点，由于知道矩阵大小，我们可以利用二维前缀和很快求出 01 矩阵的子矩阵的数字和，若存在这个和为 $mid^2$，也就是全部为 `1` 的，便是一个符合条件的子矩阵。

复杂度为 $\Theta\left(nm\log \max\{n,m\}\right)$ 的，足以通过本题。

[Code](https://codeforces.com/contest/1731/submission/188818942)