**非正解**

~~考场上没想到分治，就无脑写分块了（~~

这么大一个数据结构题，直接考虑分块（

对于非整块的查询，直接暴力搞就行了

对于整块，考虑将块内排序，分成 $b_i< d$ 和 $b_i\ge d$ 两类处理

1. 对于 $b_i\ge d$ 的点，我们发现它们排完序之后都在一个连续区间内，于是用可持久化 trie 类似于主席树一样查询即可

2. 对于 $b_i<d$ 的点，我们可以考虑把询问离线下来按 $d$ 从小到大排序，于是发现每次新处理一次询问这一种点的数量只会增加  
然后每次新加入一个点的时候考虑有哪些 $c$ 满足 $a_i\oplus c\le b_i$，考虑依次处理每一位，发现这种 $c$ 是一些区间的交  
于是就变成了区间加 1，单点查询问题，用树状数组维护就行了

设块长 $S$，则对于非整块，查询复杂度 $\mathcal O(QS)$，对于整块，查询复杂度 $\mathcal O(Q\frac nS \log a)$，于是当 $S=\sqrt{n\log a}$ 的时候取到理论最优复杂度 $\mathcal O(Q\sqrt{n\log a})$

实测 $S=1750$ 时最优，可以获得 90pts 的好成绩，会被 $l=1,r=n$ 卡掉（本机跑 6s 左右）~~（原来这不是部分分而是光明正大卡 sqrt 算法啊~~

于是只能加上特判，在 $l=1,r=n$ 的时候把 $S$ 调成 $n$ 才能通过/dk/dk

[**code**](https://www.luogu.com.cn/paste/6d9paxz0)