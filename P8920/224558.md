# 前言

感觉有中位绿。

分档：

- 30pts 3 级 暴力

- 100pts 5 级 找性质

可恶怎么是 JV 出的...

# 正文

有送分的爆搜诶 20pts. 然后 Subtask 1 也是送的，于是可拿 30pts.

不甘于这么点分，考虑正解。题目问了什么呢：给你 $N$ 个闭区间，然后让你选 $N$ 个数，使其方差最大。

然后这 $N$ 个闭区间有些性质，就是前一个左端点比这个左端点左，前一个右端点比这个右端点左，考虑运用这些性质。

一句废话：一定有解，全删光即可。

结论一：一定有个最优解单调不降，因为如果有个最优解不满足的话，交换逆序对的值仍可以使得该解合法且方差不变，成为一个新的满足单调不降的最优解。

结论二：一定有个最优解有个 $i$，使得 $c_{1 \to i - 1}$ 为 $a_{1 \to i - 1}$，$c_{i + 1 \to N}$ 为 $b_{i + 1 \to N}$。为啥嘞？

反证法，先证右边。我们考虑这个结论的假想敌 $j$，认为有这么一个 $j$ 使得：

$$i < j, c_i > a_i, c_j < b_j$$

如果是这样的话，我方差并没有到最大，因为这组数据的波动程度显然可以更大，令 $c_i$ 变小，$c_j$ 变大即可。左半部分亦然。

这样子 $c$ 画出来就是个单调不降的家伙。注意上述结论没有考虑恰好是 $i$ 时选谁方差大。

继续刚才的思路，我们发现根据此时只有 $c_j$ 不确定，其他家伙都为常数。这个时候方差为关于 $c_j$ 的二次函数！

根据第一个结论发现 $c_j$ 的两个边界为 $a_j, b_j$，然后又易得这个二次函数开口向上，所以最大在边界取得。那么其实 $j$ 就为 $i$ 或者 $i + 1$。

于是乎就可以枚举 $i$ 了，复杂度约为 $\mathcal{O}(N)$。

~~喂喂喂不会有人连前缀和都不会吧...~~

# 后言

还是有点意思的。