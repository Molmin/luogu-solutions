**逆元的概念**

看过一些人的题解，发现他们对逆元的定理有所不同，我在这里概括一下教科书上的定义吧

**逆元**

若整数b，m互质，并且b|a，则存在一个整数x，使得a/b≡a*x（mod m）。
称x为**b的模m乘法逆元**，记为b^(-1)（mod m）。

**逆元的应用**

```
用于求解a/b≡（mod m）的值
```



这道题有很多解法，刚看到题目就想到了**扩展欧几里得定理求乘法逆元**

求解同余方程即可：b*x≡1（mod m） ，解法与同余方程那题就一样了

但是提交上去发现最后一个点完美的TLE了，只好转换思路

试试用**费马小定理**求解一个快速幂？显然**复杂度nlog（p）**不允许

下面有一个非常优秀的解法，复杂度O（n），~~貌似和Lucas定理有点关系~~

**线性求所有逆元**

~~突然发现LaTeX真是个好东西，可惜我不会，不过在学，现就放个截图吧~~

![](https://b2.bmp.ovh/imgs/2019/08/f1aaa100a24737d4.png)



80分扩欧代码：

略

100分线性递推代码：
```
#include<cstdio>
using namespace std;
long long inv[3000010],p,n;
int main() {
	inv[1] = 1;
	scanf("%d%d",&n,&p);
	printf("1\n");
	for(int i = 2; i <=n; i++)
		inv[i]=p-(p/i)*inv[p%i]%p,printf("%d\n",inv[i]);
		
	return 0;
}

```

