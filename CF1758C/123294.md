挺奇妙的。

设 $x$ 的倍数有 $c$ 个，$p_1$ 占了一个，如果不是 $n$ 空出来，就无解了。因为只有 $c - 1$ 个 $x$ 的倍数，却要填入 $c$ 个位置。因此，当 $x\nmid n$ 时，无解。

从 $i\to p_i$ 连边。不是 $x$ 倍数的位置上，除了 $p_1$ 以外，其它位置都要满足 $p_i = i$，因为除了自环，一个环上必然有至少一个 $i$ 满足 $i\nmid p_i$。因为 $p_1 = x$，$p_n = 1$，所以唯一非自环形如 $n\to 1\to x\to \cdots \to n$，而除了 $n$ 以外，每个在环上的位置 $i$ 需要满足 $p_i$ 是 $i$ 的倍数，因此相当于找到字典序最小的链 $x\to a_1\to  \cdots \to n$，使得后一个数是前一个数的约数。贪心枚举倍数即可。

时间复杂度 $\mathcal{O}(n)$。[代码](https://codeforces.com/contest/1758/submission/184672381)。