部分内容参考了官方题解的证明。

首先 $ n \bmod k \neq 0 $ 的情况显然是无解的。

通过观察，发现最优的排列一定满足将某些元素左移位置，剩下的元素保持在原位，再观察这些被移动的元素，发现刚好满足 $ x \mid a_1 \mid a_2 \mid ... \mid a_n $，其中 $ a $ 代表被移动的元素构成的排列，并且一定是所有满足这个条件的排列里最长的。因此质因数分解 $ \frac{n}{x} $ 之后即可得到答案。

证明：

推论：对于任意一个长度大于 $ 1 $ 的环 $ c_i $，都存在至少一个 $ p_{c_i} $ 不能被 $ c_i $ 整除。

首先由于 $ p_{c_i}-c_i $ 的总和为 $ 0 $，而这个排列是长度大于 $ 1 $ 的环，所以必然存在 $ p_{c_i}-c_i < 0 $，也就是 $ p_{c_i} < c_i $，这样必然不能整除。

但原排列都已经被固定了，所以只能通过移动 $ p_n $ 的位置来打破这个限制。又因为要构造字典序最小的排列，因此我们需要最长的这样的链使得字典序最小。如果有多个这样的排列取前面的数最小的。于是质因数分解后排序，然后循环移动这个序列即可。

时间复杂度 $ \mathcal{O}(n) $，可以通过。