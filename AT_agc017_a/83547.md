一句话题意：给定 $n,p$ 和一个正整数序列，求有多少种从序列中取数的方法使得取出来的数的和与 $p$ 奇偶性相同，可以不选。

我们发现这道题是有阶段性的，考虑在前 $i$ 个数中选出若干个数使得和为奇/偶数的方案数只和前 $i-1$ 个数的方案数与当前数的奇偶性相关。于是可以设计一个简单的动态转移方程，我们设 $f_{i,0}$ 表示前 $i$ 个数中选若干个数的和为偶数的方案数，$f_{i,1}$ 为奇数，那么容易有：

$$f_{1,0}=1+[a_1\bmod{2}=0],f_{1,1}=[a_1\bmod{2}=1]$$

想要得到 $f_{i,0/1}$，可以发现有几种情况，第一种是不选，第二种是选了改变奇偶性，第三种是选了不改变奇偶性，于是就可以得到：

$$f_{i,0}=f_{i-1,0}+f_{i-1,a_i\bmod{2}}$$

$$f_{i,1}=f_{i-1,1}+f_{i-1,(a_i+1)\bmod{2} }$$