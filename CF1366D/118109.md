### 题目链接

洛谷：[CF1366D](https://www.luogu.com.cn/problem/CF1366D)

CF：[CF1366D](https://codeforces.com/problemset/problem/1366/D)

### 题意简述

给出 $n$ 个数 $a_1 \sim a_n$，对于每一个 $a_i$，求出其 $2$ 个因子 $d_1,d_2$，满足 $\gcd(d_1 + d_2, a_i) = 1$。

如果不存在，输出 $-1$。

### 解

容易想见，当 $a = p^k(p \in \mathbb{P}, k \in \mathbb{N})$ 时，不存在这样的 $2$ 个因子。这是因为，$p^k$ 的任一因子都是 $p$ 的幂，则两因子之和依然有 $p^\alpha$ 因子，不可能与 $p^k$ 互质。

那么当 $a$ 有不小于 $2$ 个质因子时，如何构造出 $d_1$ 和 $d_2$ 呢？

简单的想法是取 $d_1 = p_1, d_2 = p_2$，这里 $p_1 \not= p_2$ 是 $a$ 的 $2$ 个质因子。不过很快可以发现，这种做法无法保证 $(d_1+d_2) \not | \ \ a$。$30$ 即为一个容易举出的反例。

那么应该怎样做呢？若 $a = p^kq$，且 $p^k || a$ 即 $p \not| \ \ q$，则 $d_1 = p^k, d_2 = q$ 是满足要求的。

已经确定 $p^k \perp q$，现在需要证明 $p^k + q$ 不会成为 $a$ 的因子。

反证。我们假设 $(p^k + q) | a$，即 $(p^k + q) | p^kq$。易见，我们可以写出如下形式：

$$d(p^k + q) = p^kq$$

此处 $d \in \mathbb{N^+}$。

从而，在 $d$ 和 $(p^k + q)$ 中至少有一个是 $q$ 的倍数。

若 $q | d$，则

$$\begin{aligned}
qd^\prime(p^k+q) &= p^kq \\
d^\prime(p^k+q) &= p^k
\end{aligned}$$

很明显，这不可能成立。

若 $q | (p^k + q)$，则 $p^k$ 必然是 $q$ 的倍数。那么 $q$ 只能是 $p$ 的幂。然而前面已经限定 $p \not| \ \ q$，矛盾，故同样不成立。

综上，即得证 $d_1 = p^k, d_2 = q$ 是满足要求的一组构造。

数论证明真是妙趣横生。

&nbsp;

按当前（2021 年 6 月 25 日）的默认排序，现存题解中只有最后两篇明确提及考虑到了加和可能不互质的情形。这里通过较为详细的证明来明晰这个构造的正确性。

代码参考其它题解即可。