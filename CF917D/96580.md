学到了……

这里是一个不会 $prufer$ 序列的菜鸡。被 $\texttt{S\red{oulist}}$ 看不起的垃圾 $\Theta(n^4)$ 的做法。

## 题目大意:

给一棵 $n$ 个点的树，有多少棵由这 $n$ 个点之间的边构造成的树，与给定的树恰好有 $k$ 条边重复。（对于任意的 $k \in[1, n]$ 输出答案）

## 生成树，计数，优先想到的是矩阵树定理。

矩阵树定理是干这么一件事情。

$$\sum_{w\in T} \prod w$$

我们可以令**每条被选中的边**的边权为 $x^1$。 **没有被选中的边** 的边权为 $x^0$。

然后对应的 $x^k$ 系数就是 $k$ 条边重复的答案，可以自己玩一下（

这个玩意我们其实可以直接暴力 dft，但是过不去（

然后我们发现一件事情，我们可以先用矩阵树定理算出来把各种 $k \in [1,n]$ 的值算出来？不就可以高斯消元了吗。

令 $p_i$ 为答案，$b_i$ 为把 $i$ 带进去的值。

$$b_j = \sum_{i=0}^n p_i \times i^j$$

高斯消元大概是这样一个事情。

假设你有 $n$ 个未知数为 $p_1, ... , p_n$。已知数为 $g\{\}, b\{\}$

($b_i$ 已经计算过了，$g_{i,j} = i ^{j-1}$)

通过初中知识你知道。（

$n$ 元一次是可以用 $n$ 个式子解出来的。

$$\large\lceil g_{1,1} \times p_1 + ... + g_{1, n} \times p_n = b_1\rceil$$
$$\large| g_{2,1} \times p_1 + ... + g_{2, n} \times p_n = b_2|$$
$$......$$
$$\large\lfloor g_{n,1} \times p_1 + ... + g_{n, n} \times p_n = b_n\rfloor$$

把这个部分高斯消元板子搞搞就做完了。