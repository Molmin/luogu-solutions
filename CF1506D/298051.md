令 $f_x$ 为 $x$ 在 $a$ 中出现的次数。

那么有一个很容易猜的结论：如果存在一个数 $x$ 使得 $2f_x>n$，那么最后会剩下 $2f_x- n$ 个数。否则会剩余 $n$ 模 $2$ 的余数。

接下来提供每一部分的证明：（各部分小标题加粗方便寻找）

-----

**命题一**：如果存在一个数 $x$ 使得 $2f_x>n$，那么最后会剩下 $2f_x - n$ 个数无法消除。  

**证明**：  
由于其它所有数一共有 $n-f_x$ 个，那么最多可以消掉 $n-f_x$ 个 $x$，会剩余 $f_x-(n-f_x)=2f_x-n$ 个。  

实现：
$x$ 可以使用[摩尔投票法](https://www.luogu.com.cn/problem/P2397)花 $O(n)$ 时间和 $O(1)$ 空间搞出来。  
大概证一下：这个算法思想等于是维护一群一样的数，新数和它一样就丢进去，不一样就拎出来这一群数里的一个和它相消。而这个题里面任意安排相消次序都没法把 $x$ 消完，等于是随机次序的摩尔投票就更不可能消完了。  
所以**如果存在** $x$，那么它一定是剩下的这一堆数，但是还是由于随机投票导致可能有一个并不是超过一半的被留在了最后这一堆数里，所以还需要 $O(n)$ 统计一次统计出的数目确定是否有 $2f_x>n$。

----

**命题二**：如果 $n$ 为偶数且命题一的条件不成立，那么最后一定不会有剩余。

**证明**：  
$n=2$ 时，本结论显然。

$n=4$ 时，存在三种情况：  
* 有两个不同的数字 $x,y$，满足 $f_x=f_y=2$，命题显然成立。
* 有三个不同的数字 $x,y,z$，满足 $f_x=2$，$f_y=f_z=1$，命题显然成立。
* 有四个不同的数字 $a,b,c,d$，满足 $f_a=f_b=f_c=f_d=1$，命题显然成立。

综上，$n=4$ 时，本命题成立。

如 $n=2t$ $(t \geqslant 3)$：取出 $f_x$ 最大和第二大的两个数 $x$ 和 $y$ 并相消，那么新的情况满足如下条件：
* $n'=n$
* 因为 $2f_y \leqslant 2f_x < n$，那么$2f'_y=2(f_y-1) \leqslant 2f'_x=2(f_x-1) < n'=n-2$。
* 对于 $f_x$ 第三大及以后的数 $z$，存在 $f_z \leqslant n/3$，那么 $2f'_z=2f_z \leqslant \frac{2}3n$，又因为 $x \geqslant 3$ 即 $n \geqslant 6$，所以 $2f'_z=\frac{2}3n \leqslant n'=\frac{n}2$。

综上，最大和第二大的数相消后新的情况仍然满足命题二的条件且 $n'=n-2$，故由数学归纳法可知命题二正确。

----
**命题三**：如果 $n$ 为奇数且命题一的条件不成立，那么最后一定会剩余 $1$ 个。

**证明**：  
令 $n=2t+1$,则：  
由于消去是两两消去的，最多能消去 $2x$ 个，所以至少会留下 $1$ 个。  

如果开始时从 $f_x$ 最大的 $x$ 中指定一个为剩余的，那么：
如 $n=3$，则显然会剩余两个不一样的数，剩余的可以消完。  
如 $n>3$，则：  
* $2f'_x=2(f_x-1) < n-2 < n' = n-1$。  
* 由命题一的条件不成立的 $f_x$ 第二大及以后的 $y$ 有满足 $f_y<f_x$，则 $2f'_y=2f_y \leqslant 2(f_x-1) < n'$。

根据命题二可得指定一个为剩余的后剩余的恰好可消完，所以最多会留下 $1$ 个。

综上，恰好会留下 $1$ 个，即证。

---
综上，初始结论正确。

代码：~~我知道你们都想看这个~~
```
#include <cstdio>
#define N 200010
int a[N];
int main()
{
    int t;
    scanf("%d",&t);
    while(t--)
    {
        int n;
        scanf("%d",&n);
        for(int i=0;i<n;i++) scanf("%d",a+i);
        //判断是否存在x使得cnt(x)>cnt(others)
        //显然如果存在x p就是x
        int p=-1,c=0;
        for(int i=0;i<n;i++)
        {
            if(p==-1) p=a[i];
            if(p==a[i]) c++;
            else {if(!--c) p=-1;}
        }
        //验证是否存在
        c=0;
        for(int i=0;i<n;i++) if(p==a[i]) c++;
        if(c*2>n) printf("%d\n",c*2-n);
        else puts(n&1?"1":"0");
    }
}
```
[AC 记录](https://www.luogu.com.cn/record/77042761)