## 题意

给出一个序列$a$，要求求出一个单调递增的下标序列$b$，使得:

$$ans=\sum\limits_{i=1}^{x}(-1)^{i-1}a_{b_i}$$

最大，输出这个最大值。

同时有$q$次修改，每次修改有两个参数$l,r$，交换$a_l$和$a_r$ 求每次操作后的答案。

## solution

我们先考虑C1的解法，即没有修改操作。我们很容易想到一个dp，dp[i][j]表示前i个数，这个数是加或是减所能取到的最大值。

这个转移很容易，就是:

$$dp[i][1]=max(dp[i-1][1],dp[i-1][0]+a[i])$$

$$dp[i][0]=max(dp[i-1][0],dp[i-1][1]-a[i])$$

最后的答案就是$max(dp[n][0],dp[n][1])$。

观察这个dp转移的式子，不难发现，当且仅当$a[i]\leq a[i+1]$的时候 这个dp的最大值才会发生变化。所以我们可以发现这个dp等价于:

$$ans=\sum\limits_{i=2}^nmax(0,a[i]-a[i-1])$$

所以我们对于每次的修改操作，维护一下这个差分数组的大于等于0的数的和

具体地，我们在修改前把两个位置的相邻的差分的贡献减去，然后加上改变之后两边的差分数组的贡献。

在cf上我竟然用了个Segment_Tree来完成这件事，太蠢了就不放代码了。