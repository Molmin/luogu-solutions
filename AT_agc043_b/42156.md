首先最终答案一定是 $0,1,2$，只需要判断到底是哪一个。

不难发现，绝对值不影响奇偶性。因此先判断答案的奇偶性（等价于 $\sum a_i \text{C}_{n-1}^{i-1}$），使用 Lucas 定理或对阶乘分解质因数可以做到 $O(n\log n)$，采用 [CTSC2017] Gift 的方法可以 $O(n)$。

假如是奇数，直接输出 $1$。否则，答案一定是 $0,2$。把每个数都除以二，则答案为 $0$ 的不会改变，答案为 $2$ 的会变成 $1$。用上面的方法再判断一次即可。

评测链接：https://atcoder.jp/contests/agc043/submissions/11070036