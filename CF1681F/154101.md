显然每一种颜色是独立的，考虑分别计算每种颜色的答案。想到这里发现好像随便虚树一下就做完了。

但我不想写虚树，考虑用更无脑的做法  

假设我们在统计颜色为 $w$ 的答案，那么你可以先把所有颜色是 $w$ 的边断开，发现形成了若干个连通块，$w$ 这个颜色的贡献和就是 $\sum\limits_{(u,v),col(u,v)=w}siz_u\times siz_v$（$siz_x$ 为 $x$ 所在连通块的大小），因为一条路径上只能有一条颜色是 $w$ 的边。

这个东西直接用 lct 维护子树信息来实现加边删边，就做完了。

[代码](https://codeforces.com/contest/1681/submission/158768144)