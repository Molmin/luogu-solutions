发现选择的区间不包含且不相交，于是区间的形式为选一段空一段。

考虑到 $r-l$ 即为每个区间 $[i,i+1]$ 的贡献。

于是考虑 $[i,i+1]$ 什么时候不选，发现当左段的最大值小于右端的最大值时，$[i,i+1]$ 不选更优。

于是枚举左段的最大值 $x$，位置为 $b$，要求右段的最小值比 $x$ 大。

维护 `set` 找到前一个比 $x$ 大的数的位置 $a$，后一个比 $x$ 大的数的位置 $c$，$c$ 后面第一个比 $x$ 小的数的位置 $d$。

那么左段的左端点可以在 $(a,b]$ 中选，右端点为 $c-1$，右段的左端点是 $c$，右端点在 $(c,d]$ 中选，贡献为 $(b-a)\times (d-c)$。

时间复杂度 $\mathcal O(n\log n)$。