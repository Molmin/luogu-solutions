首先考虑如何判断有没有解。

显然每次加上一个排列的数，整个序列总和都是加上 $\frac{n(n+1)}{2}$。如果要满足序列中的每个数相等，总和一定得为 $n$ 的倍数，这就产生了两种情况：（以下记 $s=\sum a_i$）

- $n \equiv 1 \pmod 2$ 时，$s\equiv 0 \pmod n$ 时有解。

- $n \equiv 0 \pmod 2$ 时，$s\equiv 0 \pmod {\dfrac{n}{2}}$ 时有解。

先讨论第一种情况：考虑两种操作 $\{1,2,3,\dots,n\}$ 和 $\{n,n-1,n-2,\dots,1\}$，加起来这两种操作相当于全局加 $n + 1$ 。对于平均数 $g=\frac{s}{n}$，一定存在 $a_i > g$ 和 $a_j < g$。我们此时将 $a_i + 1 + (n-1) \to a_i$，$a_j+2+n\to a_j$，剩下的数按全局加 $n + 1$ 平凡做。这样相当于将 $a_i$ 减 $1$，将 $a_j$ 加 $1$。

容易发现上述做法操作数为 $\mathcal{O}(nV)$。

再讨论第二种情况：发现每做一次操作之后会从 $s\equiv 0 \pmod n$ 变为 $s\equiv 0  \pmod {\dfrac{n}{2}}$，或者相反。那么对于初始为 $s\equiv 0 \pmod n$，还是像上述做法一样做。对于初始为 $s\equiv 0\pmod {\dfrac{n}{2}}$，$\textrm{rand}$ 一次操作，再用上述做法。

时间复杂度：$\mathcal{O}(n^2V)$。