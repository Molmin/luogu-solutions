一只 $\log $ 的做法还是很有趣的。至少我不会。

首先考虑套路地 $a_i \leftarrow a_{i} - i$ 来把问题变成不下降。

那么容易发现一个 Lemma 就是最优解序列中不会出现原来没有的数。离散化再 dp 就可以了。

dp 式子在这里。

```cpp
For(i, 1, n) {
    For(j, 1, t)
        dp[i][j] = mn[i-1][j] + abs(disc[j] - disc[a[i]]);
    For(j, 1, t)
        mn[i][j] = min(mn[i][j-1], dp[i][j]);
}
```

然后我们发现这个 dp 性质非常优美，我们其实只关心最小值的位置。定义每一维的最小值出现的位置为 $x_i$。

- $x_{i-1} \leqslant a_i$。显然 $x_i = a_i$。

- $x_{i-1} \geqslant a_i$。作图或是感性分析可知 $x_i = x_{i-1}$。

然后就变成了一个容易维护的问题了。

代码满地飞就不贴了。
