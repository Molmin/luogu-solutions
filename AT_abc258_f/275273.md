发现这题有个远古的 WA 就来改了（

发现走法很多种，不想分类讨论，考虑最短路。

设起点编号为 $1$，终点为 $11$。

$x = Bn$ 和 $y = Bn$ 把坐标系分成了若干块。考虑过起点作一条平行于 $Ox$ 的直线，与左右两条 $x = Bn$ 的线有两个交点，给它们编号 $3, 5$，同样地作一条平行于 $Oy$ 的直线，与上下两条 $y = Bn$ 的线有两个交点，给它们编号 $4, 2$。然后把起点所在块的四个角分别编号 $6, 7, 8, 9$，然后连 $1 \to 2, 3, 4, 5$，$2, 3, 4, 5$ 再连到 $6, 7, 8, 9$，像这样：

![](https://s1.ax1x.com/2023/06/11/pCZCs4P.png)

对于终点也是类似地建图，编号相对于起点 $+ 10$。

那对于起点和终点不在一个块的情况，先走到起点所在块的四个角的一个再走到终点所在块四个角的一个是一种备选方案。因此连边 $x \to y + 10, x, y \in \{6, 7, 8, 9\}$，边权可以算出来。

在同一个块内，或者起点终点两个块相邻，可以不走到四个角，这个要特判，连相应的边。这里因为连边较复杂不展开，可以看代码。

然后跑一遍 $1$ 到 $11$ 的最短路就行。

[code](https://atcoder.jp/contests/abc258/submissions/42197793)