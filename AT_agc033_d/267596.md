没想到交换 dp 一维和值域这个 trick，于是来提供暴力做法。

考虑暴力 dp：设 $f _ {l, r, u, d}$ 表示子矩阵左右边界为 $l, r$，上下边界为 $u, d$ 的混乱值。直接转移，是枚举如何切的，时间复杂度 $O(n ^ 5)$，空间复杂度 $O(n ^ 4)$。

显然时间和空间都过不去阿！

所以开始优化：

- 时间上：  
  发现转移是有单调性的：如果矩阵 $A$ 被矩阵 $B$ 完全包含，那么 $A$ 的混乱值小于等于 $B$。  
  所以转移时可以二分优化，时间复杂度变成 $O(n ^ 4 \log n)$。  
  在二分时，也有一个优化：在切开的两个矩阵混乱值相同时，此时一定取到最优，所以可以直接退出二分。
- 空间上：  
  发现左右边界是一个区间，而区间共有 $\dfrac{n(n + 1)}{2}$ 个，所以可以只记录区间，这样空间总共变成了原来的 $\dfrac{1}{4}$。  
  而且又发现答案在 `unsigned char` 范围内，于是每个 dp 值只用 $1$ 个字节了。
  总的一算：大约是 $\dfrac{185 ^ 4}{4}$ 字节，约为 280MB，在范围内。

但是这样并不能通过。几乎跑满的四次方乘老哥在五秒内跑过 $n=185$，还不是一种现代艺术。

考虑继续优化：  
不能从优化转移入手，因为它确实没法优化。  
于是，尝试减少状态！

考虑弃用递推，转而使用记忆化搜索：这样可以不计算所有无用状态。  

然后就过了。不太会说明其状态数复杂度与常数，但是实际测试能过，而且很快。

[代码](https://atcoder.jp/contests/agc033/submissions/39122845)。

