显然我们无法将所有的边建出来。考虑到只有一个集合内的数会建出边，所以对每一个集合建一个虚点，集合里面的所有点都与这个虚点连边，边权即 $W_i$。显然，这样做 $(T_i,T_j)$ 的距离确实是 $W_i+W_j$。

这样就把边缩到了 $\sum |S_i| \leq 4\times 10^5$ 级别，点也变成了 $n+k$ 级别（最差应该是 $6 \times 10^5$）。直接 Dijkstra  求最短路即可。时间复杂度 $O(\sum |S_i| \log n)$。