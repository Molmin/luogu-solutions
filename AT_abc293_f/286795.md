对于找出满足要求的进制 $b$，可以很快想到两种求法：

1. 枚举 $b$ 并将 $n$ 暴力分解为 $b$ 进制。
2. 枚举 $b$ 进制下的数，在每一位上填上 $0$ 或 $1$，再用二分法求出 $b$。

第一种做法在 $b$ 较小时可以被接受，同时第二种做法在 $\log_bn$ 较小时可以被接受。所以考虑把两种做法缝在一起，将 $b$ 枚举至 $n^{\frac{1}{4}}$，然后将其换算为 $b$ 进制并检查合法性，剩余合法的 $b$ 在 $n$ 换算完进制后，一定小于等于四位，那么直接枚举并二分求解。

代码中使用了 map 判断求出的解是否重复。需要注意的一个细节是乘法溢出的问题，所以当最高位为 $1$ 时，二分上界应该为 $10^6$。最高位为 $0$ 且次高位为 $1$ 时，二分上界应为 $10^9$。

[代码](https://atcoder.jp/contests/abc293/submissions/39627388)