增加很简单，删除很困难，考虑回滚莫队。于是可撤销并查集按秩合并即可。

注意细节，右端点增加时不要添加左端点所在块的边，让左端点添加时再考虑，不然是错的，会添加左块中不在区间内的点。

时间复杂度 $O(nk\sqrt q\log n)$。