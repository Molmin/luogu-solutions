emm，我能以准备中考为借口适度口胡嘛。。

（应该是对的）

操作相当于每次给一个左下角在原点的矩形，然后把矩形内的点全部平移到矩形的上或右边界。

显然操作的边界形成了一个楼梯状的结构。对楼梯上的点和楼梯外的点分别维护。

楼梯上的点只会增加，也就是维护个线段树就可以提取出楼梯外的即将进入楼梯的点。

考虑楼梯的维护，以平移到上边界为例。

对楼梯的横竖两部分分别维护。对横的部分，就是把区间推平，对竖的部分就是把若干部分删掉，丢进横的里面；还要支持把楼梯外的点加进去。

类似 ODT，要支持将一个横/竖的分裂。

以及查询操作，显然分裂后在横竖上面都会得到一个区间。然后查询这个区间的点数。

要支持分裂，合并集合，用线段树分裂维护。上面的 ODT 状结构用平衡树维护。楼梯外的点用 CDQ 维护，时间复杂度是 $O(n\log^2 n)$ 的。。

（CDQ 不太美观，有把这个瓶颈卡掉的可能）