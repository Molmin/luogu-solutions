这道题目就一篇题解，而且有一个地方貌似讲错了，我就来发一篇题解。

--------

设一段电路断路的概率为 $P$，第 $i$ 个元件断路的概率为 $p(i)$，对于一个串联电路来说，要所有的元件都不断路才能保证这一段不断路，所以由 $n$ 个元件串联的电路断路的概率为：  

$$P=1-\prod_{i=1}^{n}(1-p(i))$$

而对于一段并联电路来说，要所有的元件都断路，这一段电路才会断路，所以由 $n$ 个元件并联的电路断路的概率为：

$$P=\prod_{i=1}^{n}p(i)$$

这样，就可以算出这些串联电路和并联电路的断路概率了。

--------

如何实现呢？拿样例来说，电路 `(A,B)((C)(D),E)` 其实可以把它分为 `A,B` 和 `(C)(D),E` 这两个子电路并联，`A,B` 又可以看成 `A` 和 `B` 这两个子电路串联，`(C)(D),E` 可以看成 `(C)(D)` 和 `E` 这两个子电路串联，最后 `(C)(D)` 可以看成 `C` 和 `D` 这两个子电路并联。所以，先找有没有括号，如果没有的话，这个电路就只有以逗号分隔的元件了，算出这些元件串联起来发生断路的概率即可；否则，找是否有逗号，如果没有的话，就以**该层**每个匹配的括号作为子电路计算下去；否则，找到逗号，就把前面的电路分隔出来串联。这样，就可以算出来整个电路断路的概率了，[代码在此](https://www.luogu.com.cn/paste/0lwlv90w)，请勿抄袭。

--------

这一道题目告诉我们，如果正着算比较难算，那就反过来算，这样也许就会容易一些。

