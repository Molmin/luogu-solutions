### 题意概要：

给定一个 $H\times W$ 的矩阵，对于每一部分，我们可以挑选相邻的行或列中间切一道，变成两个部分。将这个矩阵分成 $T+1$ 个部分，对于每个部分，权值为部分内元素的和。要求最小化最大值减最小值的差。

### 题目分析：

考虑动态规划。从题面来看，这道题要求切割。那么从反方向来想，就是将 $H\times W$ 个小矩形合并成 $T+1$ 个矩形。变成了区间合并问题，考虑区间动规。

我们钦定每次计算钦定一部分算做最小值，为 $R$。$f_{l_1,r_1,l_2,r_2,p}$ 为当前从 $(l_1,r_1)$ 到 $(l_2,r_2)$ 中所有矩形已经合并成 $p$ 个矩阵时，在满足大于等于最小值的情况下最小的和。

记 $s_{l_1,r_1,l_2,r_2}$ 为从 $(l_1,r_1)$ 到 $(l_2,r_2)$ 的和。先考虑边界情况，即

$\begin{aligned}f_{l_1,r_1,l_2,r_2,0}=\left\{
	\begin{array}{l}
    	+\infty&,s_{l_1,r_1,l_2,r_2}<R\\
      s_{l_1,r_1,l_2,r_2} &,s_{l_1,r_1,l_2,r_2} \ge R
    \end{array}
  \right.
 \end{aligned}
 $

考虑转移：

$\begin{aligned}f_{l_1,r_1,l_2,r_2,p}=\min_{i=0}^{p-1}\{\max\{f_{l_1,x,l_2,r_2,i},f_{x+1,r_1,l_2,r_2,p-i-1}\},\max\{f_{l_1,r_1,l_2,y,i},f_{l_1,r_1,y+1,r,p-i-1}\}\}\end{aligned}$

其中 $x\in[l_1,r_1),y\in[l_2,r_2)$。

代码太丑，就不放了。