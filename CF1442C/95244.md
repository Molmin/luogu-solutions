显然可以想到直接分层图最短路，但是 $m\leq 200000$ 的情况下，最劣是 $O(nm)$ 的。考虑优化这种做法：

可以发现当操作次数不超过 $18$ 时，最大单次操作代价在 $n=200000$ 的情况下比遍历全图的代价要小。这个阶段内我们可能通过反转一些边使代价更小。即，就算在第 $k$ 层 $x\to y$ 是可达的，我们也可能通过第 $k+i$ 层从 $x$ 到达 $y$。

但当操作次数超过 $18$ 时，我们发现此时单次操作的代价甚至大于遍历全图的代价！自然在这种情况下，如果在第 $k$ 层 $x\to y$ 可达，就一定会通过第 $k$ 层从 $x$ 到达 $y$。可以得到此时在层与层之间转移的代价大于在图上直接转移的代价，而我们自然希望这个代价尽可能地小，所以令操作次数最小时 $1\to n$ 可达是一定最优的，并且在这个前提下令在图上直接转移的代价之和最小。

那么就有了一个大概的思路，对于 $k\leq 18$ 的部分，直接分层图最短路。如果在 $k\leq 18$ 内无法出解，则求出最小的 $k$ 及在这个前提下在图上转移的最小代价。由于最小的 $k$ 唯一，所以只需枚举这个 $k$ 并判断在第 $k$ 层能否从 $1\to n$ 即可。对于 $k>18$ 的部分具体来说，就是枚举 $k$，对于每一层直接在图上转移，之后将每一个在最短路过程中被更新的点加入下一层的转移。

这样的话，对于 $k\leq 18$ 的部分是 $O(18m)$ 的，$k>18$ 的部分是 $O(m)$ 的，总时间复杂度就是 $O(19m)$ （奇怪的常数增加了

代码就不贴了，非常好写。