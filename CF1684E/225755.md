> 给定一个长度为 $n$ 的序列 $a$，你可以替换其中 $k$ 个数，求进行完操作后序列 $\rm DIFF-MEX$ 值的最小值。$\rm DIFF$ 为序列中不同的数的个数，$\rm MEX$ 为序列中最小的没出现过的非负整数。

我们发现序列的 $\rm MEX$ 值肯定 $\leq n$，所以可以考虑枚举每个 $\rm MEX$ 进行计算。

假设现在枚举的 $\rm MEX$ 为 $x$，那么我们要满足这个条件就需要把 $a_i$ 在值域上 $[0,x-1]$ 范围内没出现过的数给填上。

对于一个出现次数 $>1$ 的数，我们填一个空使 $\rm MEX$ 加 $1$，$\rm DIFF$ 也加 $1$，总的贡献为 $0$。对于一个出现次数 $=1$ 的数，$\rm DIFF$ 不变，$\rm MEX$ 加 $1$ 对答案贡献为 $-1$。所以我们肯定是优先拿 $[x+1,+\infty)$ 中出现次数较小的数来填空。

考虑维护一棵值域线段树，下标是出现次数，每个位置存这个出现次数的出现次数以及出现次数之和，每次我们线段树上二分数一下可以取到多少种数为 $0$ 即可。

时间复杂度为 $O(n\log n)$。[代码](https://www.luogu.com.cn/paste/dpkpw4xn)