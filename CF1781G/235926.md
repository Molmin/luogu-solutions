题目的难点在于发现它实际上是一道简单题。

考虑一个显然的下界：点数为偶数时答案为 $0$，点数为奇数时答案为 $1$。很不幸，样例就给出了反例。但是，样例其实是唯一的反例。

如果我们能将整棵树划分成若干大小为 $2$ 或者 $3$ 的连通块，满足染色后只保留每个连通块内的点也能满足题目要求，那么一定能尽可能平均分配。因为如果将两种颜色看成 $1$ 和 $-1$，那么 $2$ 连通块的权值和始终为 $0$，而 $3$ 连通块的权值可以任意为 $1$ 或 $-1$。

这样，我们考虑 $\text{dfs}$ 来分配连通块。容易使得每个点传上去的连通块大小为 $1,2$ 或 $3$。现在唯一的问题是根不能传 $1$ 连通块。分类讨论一下，发现需要特别考虑的两种情况是根有两个传上来 $3$ 连通块的儿子以及根仅有一个儿子，且传上来了 $3$ 连通块。对于第一种情况，我们可以特殊合并成权值为 $\pm 1$ 的 $7$ 连通块，现在就只需要考虑第二种情况了。

对于第二种情况，我们的解决方案是选择一个度数为 $2$ 的点作为根。当出现样例中的特例（$n=4$）时，显然无法选择。$n>4$ 时，要么直接就有一个 $2$ 度点，要么我们可以通过先合并两个兄弟叶结点和它们的父亲来得到一个 $2$ 度点（兄弟叶结点的祖父）。

这样，我们就构造证明了这个结论。

时间复杂度 $O(n)$。