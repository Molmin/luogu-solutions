01trie 妙妙题。

首先可以发现，每棵树之间是互不干涉的，最后的 SG 值就等于所有树 SG 值的异或和。考虑树形 dp，设 $f_i$ 表示以 $i$ 为根的子树的 SG 值是多少。暴力转移到 $u$ 的话是枚举子树 $u$ 内删了哪个点，同时处理出删去这个点到 $u$ 的路径后剩余子树的 SG 值的异或和是多少。设 $g_i$ 表示点 $i$ 到当前根 $u$ 这条路径后剩余子树 SG 值的异或和，$S_i=\bigoplus _{v \in son_i} f_i$，可以发现，当当前根 $u$ 变为其父亲 $fa_u$ 后，$g_i$ 的变化是异或上了 $S_{fa_u} \bigoplus f_u$。特别地，$g_u=S$，这样的话暴力 dp 的复杂度就是 $O(n^2)$ 的。

考虑如何优化这一过程，考虑将子树内所有的 $g$ 插入到一个 01trie 中，每次向上转移时相当于给 $\forall {v \in son_u}$ 的 $v$ 的子树内打上了一个区间异或的 tag，然后直接向上 01trie 合并（类似线段树合并）即可。

[Code](https://www.luogu.com.cn/paste/5sn0ifo7)