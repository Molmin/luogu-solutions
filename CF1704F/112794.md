方便起见下面称 Alice 为红方，Bob 为蓝方。

容易发现，在有相邻的红蓝方格时，双方的最优决策一定是先消除红蓝方格。在没有相邻的红蓝方格后，如果此时红方先手，那么红格必须严格大于蓝格数量，红方才能获胜；反之亦然。我们不妨称这两个阶段为阶段一、阶段二。注意到阶段一的过程中双方格子数量的差值是不变的。那么，终结阶段一，逼迫对方开启阶段二就是双方在阶段一的唯一目标。

此时，阶段一的胜负条件变为“不能行动的一方负”。这是一个典型的 Nim 博弈。设 $a_n$ 为一条长度为 $n$ 的极长红蓝交错段的 SG 值。我们有

$$
a_n=\operatorname{mex}_{i+j=n-2}\{a_{i}\operatorname{xor}a_j\}
$$

特别地，$a_0=a_1=0$。

直接计算时间复杂度 $O(n^2)$，不能承受。可以算出若干项后上 [OEIS](http://oeis.org/A002187) 上找一下，可以看到这个序列有长为 $34$ 的周期。当然也可直接打表找出这一点。这样就可以轻松解决此题了。