~~这个标题取得好中二啊。~~

看到这种限制很奇怪而且跟大小相关的题，就想试试在逆排列里考虑。

首先把输入转化为排列，离散化，如果有相同的，认为后面的更小（因为要求严格上升）。

**关键步骤**：对于这个排列 $p$，设其逆排列为 $q$。

然后把贡献的条件重新说一遍。

- “$p$ 的上升子序列”，一一对应 $q$ 的上升子序列。
- “存在 $j$ 在这个上升子序列的最后一个元素 $k$ 之后，$a_j>a_i$”，对应，存在 $q_{a_j}>q_{a_k}$，$a_j>a_i$。直接在 $q$ 里考虑，就是存在 $q_{j}>q_{k}$，$j>i$。显然，这等价于 $k$ 不是 $q$ 的后缀最大值。

我们再把题目说一遍：

- 对于 $q$ 中的第 $i$ 个值，他在某个上升子序列里面有贡献，当且仅当这个上升子序列的结尾 $k$ 不是 $q$ 的后缀最大值。

做法就很显然了，枚举每个后缀最大值把它管辖的东西减掉即可。

可以发现，这个做法完全没有观察任何性质，仅仅凭着“在逆排列上考虑”，然后复述一遍问题就把问题转化得很可做。