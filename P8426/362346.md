*一句话题意：正权无向连通图，判断是否存在两条从 $1$ 到 $n$ 长度不同的路径。*$n\le 100000,m\le 200000$

给个短一点的题解。

先考虑所有点在一个点双内的情况。根据点双的性质，对任意 $1\le x\le n$，均存在从 $1$ 到 $n$ 且经过 $x$ 的简单路径。

如果存在一个点 $1<x<n$，且 $x$ 度数为 $2$，设与它相邻的两个点为 $u,v$，可以把边 $(u,x),(x,v)$ 缩成边 $(u,v)$，不会影响答案。如果产生了重边，且它们权值不相同，那么答案一定为 $1$。否则，可以删掉其中一条边。

如果缩完之后图中存在 $1,n$ 之外的点，那么一定存在两个点度数不小于 $3$。这时候答案一定为 $1$。

> 证明：考虑反证法。假设答案为 $0$，那么有 $a+d=b+c+d\Rightarrow a=b+c$，同理有 $a+c=b$，解得 $c=0$，与边权为正矛盾。

>![](https://cdn.luogu.com.cn/upload/image_hosting/ehw5zs8b.png)

否则，缩完之后只剩边 $(1,n,dis(1,n))$，答案为 $0$。

接下来考虑 $1,n$ 不在一个点双内的情况。这时，我们需要知道哪些点 $x$ 满足：存在从 $1$ 到 $n$ 且经过 $x$ 的简单路径。只需考虑这些点即可。

结论：在图上添加一条边 $(1,n,dis(1,n))$，那么 $x$ 合法的充要条件是：在新图上，$x$ 和 $1,n$ 属于一个点双。

> 证明：先证必要性。如果原图上存在从 $1$ 到 $n$ 且经过 $x$ 的简单路径，那么在新图上，这条路径和 $(1,n,dis(1,n))$ 构成一个简单环。

> 再证充分性。如果 $u$ 和 $1,n$ 不属于一个点双，那么存在一个割点 $y$，从 $1$ 和 $n$ 出发到 $x$ 的所有路径都要经过 $y$。显然不合法。

套用之前的做法即可。

时间复杂度 $O(m\log m)$。

[提交记录](https://loj.ac/s/1699358)