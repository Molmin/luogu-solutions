### 题目描述
设 $rev(x)$ 为 $x$ 在十进制下数字翻转后所形成的新数字，定义一张无限表 $A$ ，其中 $\forall i \in N^{*}$ ，有 $A_{i,1}=i$ ， $\forall i,j \in N^{*},j\neq1$ ，有 $A_{i,j}=A_{i,j-1}+rev(A_{i,j-1})$ ，有 $Q$ 次询问，每次询问给出 $a,b$ ，求在这张表中， $[a,b]$ 间的元素出现的次数总和。

### 分析
设 $f(x)=x+rev(x)$ 

我们考虑这样一件事情，很显然的是，列表中每一行的元素是单调的，也就是说，对于任意的 $a_{i,j}$ ，其中有 $i,j \geq 2$ ， $a_{i,j}>a_{i,j-1}$ 恒成立。因此我们观察到，每一个出现在列表中的数字一定能且仅能被比这个数字小的数字转移过来。因此，在值域在 $10^6$ 范围内时，有一个非常 trivial 的做法，我们设 $dp_{i}$ 为 $i$ 在表内出现的次数，那么，很显然，我们可以刷表转移，将所有的状态初始化为 $1$ ，之后，对于每个数，已经通过所有比它小的数进行转移过后，它在表中的出现次数就已经被确定了，此时，用这个数来更新之后的状态，不妨设这个数为 $x$ ，则令 $dp_{f(x)}$ 加上 $dp_{x}$ 即可。

转移方程为：
$$dp_{f(x)}=dp_{f(x)}+dp_{x}$$

### 进一步考虑

我们先证明一个引理。

对于一个映射 $g:N^*\rightarrow N^*$ ，对于一个正整数 $a$ ，若 $\forall i \in N^*$  ，有 $g(i)\neq a$ 。则   $\forall i,j \in N^*$  ，有 $g^j(i)\neq a$ 成立。

我们利用反证法，假设 $g^j(i)= a$ ，则 $g(g^{j-1}(i))=a$ ，由于 $g$ 是 $N^*\rightarrow N^*$ 的映射，则   $g^{j-1}(i)\in N^*$ ，且 $g(g^{j-1}(i))=a$ ，与$\forall i \in N^*$ ，有 $g(i)\neq a$ 的条件矛盾，故得证。

很显然， $f$ 是一个满足这个条件的映射，我们把表中的每一个元素用 $f(x)$ 表示出来。

 $\forall i \in N^{*}$ ，有 $A_{i,1}=i$，$\forall i,j \in N^{*},j\neq1$ ，有 $A_{i,j}=f^{j-1}(i)$ 。很显然，根据这个引理，我们得出了一个重要的结论：在这个表格中，第二列没有出现过的数，在第三列及以后一定不会再次出现。

我们再次考虑另一件事情，假如在不考虑进位的情况下，在第二列中出现的某个数 $x$ 有 $k+1$ 位，分别为 $0 - k$ 位，由 $rev(x)$ 的定义可以知道，对于第 $i$ 位而言，其与第 $k-i$ 位一定是相同的，并且，当 $k$ 是偶数时，第 $\frac{k}{2}$ 位必为偶数，那么，通过 dfs ，可以求出在值域内哪些数是出现了的，根据每一位的组成情况数，也可以利用乘法原理求出出现次数，注意首位不能为 $0$ ，很显然，由于提到的第 $i$ 位与第 $k-i$ 位相同的性质，则可以出现的数的个数在 $\sqrt{n}$ 的级别内。我们可以在 dfs 的时候处理出现的数与其出现次数，将其离散化下来，再进行 dp 的转移。很显然，维护一个离散化后的前缀和，询问时直接查找区间即可，时间复杂度为 $O(\sqrt{n}\log n+Q\log n)$ 。

### tips:

这题代码细节非常繁杂，注意想清楚每个细节部分，不要漏掉分类讨论的步骤。~~由于本人写代码时思维过乱，是典型的反面教材，代码就不放了~~。