# P6282 [USACO20OPEN] Cereal S

[题目传送门](https://www.luogu.com.cn/problem/P6282)

## 30分做法

首先，我们不难想到一个$O(n^{2})$解法，只要按照题意暴力模拟即可，可拿到30pts。

### 核心代码
```cpp
int n,m,a[maxn][2];
bool vis[maxn];
for(int i=1;i<=n;++i){
  int cnt=0;
  memset(vis,true,sizeof(vis));
  for(int j=i;j<=n;++j){
      if(vis[a[j][0]])vis[a[j][0]]=false,cnt++;
      else if(vis[a[j][1]])vis[a[j][1]]=false,cnt++;
  }
}
```
## 100分做法

### 样例推导

接着，我们不妨倒着来推一下样例：

当$i=4$时，麦片1被第四头牛拿走了，$ans=1$

当$i=3$时，麦片1被第三头牛拿走了，麦片2被第四头牛拿走了，$ans=2$

当$i=2$时，麦片1被第二头牛拿走了，麦片2被第三头牛拿走了，$ans=2$

当$i=1$时，麦片1被第一头牛拿走了，麦片2被第二头牛拿走了，$ans=2$

### 形象的理解

其实上面的过程，我们完全可以看做是第四头牛本来能拿走自己最喜欢的麦片1，结果第三头牛过来，把第四头牛挤走了，第四头牛就拿走了自己第二喜欢的麦片2。

可是，第二头牛过来了，它把第三头牛挤走了，拿走了麦片1，第三头牛因为被挤走了，就又把第四头牛挤走了，拿走了麦片2，第四头牛难过地离开了。

同理，第一头牛过来了，它把第二头牛挤走了，拿走了麦片1，第二头牛因为被挤走了，就又把第三头牛挤走了，拿走了麦片2，第三头牛难过地离开了。

我们再来简单地证明一下时间复杂度为什么正确。

本题的复杂度应该是$o(n)$的，因为每头牛只能选2个自己喜欢的，所以最多只能操作$2n$次，复杂度正确。

那么代码其实就很好写了。

### 核心代码
```cpp
inline void work(int x,int y,int t=0){
	if(!vis[y])vis[y]=x,cnt++;//当前麦片还没被拿走 
	else if(vis[y]>x){//当前麦片被拿走了 
		t=vis[y],vis[y]=x;
		if(y==a[t][0])work(t,a[t][1]);
	}
}

for(int i=n;i;--i){
	work(i,a[i][0]),ans[i]=cnt;
}
for(int i=1;i<=n;++i){
	printf("%d\n",ans[i]); 
}
```

其中值得注意的是，cnt是可以不用清零的，因为cnt始终都是一个累加的过程。

本篇题解就到此结束了，如果喜欢，还请点个赞吧。