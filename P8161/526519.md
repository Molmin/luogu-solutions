#### 思路来源：431956

## 基本思路

#### 二分答案+分类讨论

分析一下题意可以发现每一科有自学和上课两种选择，所以分类讨论。

第一种情况：当上课效率比自学效率高的时候，可以选择一直上课来把掌握程度给刷满；

第二种情况：上课效率高，但由于一科最多只能上 m 课时，所以导致必须要再拿出一些课时来自学补满掌握程度；

第三种情况：自学效率高，一直自学刷满掌握程度。

好的分类讨论完了我们就要再思考如何二分。

题目中问的是最大的每一科的最小掌握程度，所以我们可以二分每一科的最小掌握程度，之后用子函数来检验一下再根据结果二分就好了

## 代码分段讲解

#### 头文件部分

```cpp
#include<bits/stdc++.h>
#define int long long
using namespace std;
int n,m,ans;
struct qwq{//每一科的上课自学理解度 
	int a,b;
}e[300010];//一定不要开小 
```
结构体数组一定要开至少三十万以上，不然会运行错误，第二行的意思是把 int 全改成 long long ，主函数的 int 改为 signed 就可以。

 ans 存放最后的答案

#### 子函数部分

```cpp
int js(int x,int y)//计算掌握程度为x时需要课时 
{
	if(x%y==0)return x/y;//如果刚好整除就直接加x/y 
	else return x/y+1;//否则还要多用一课时来到x的程度 
}
int check(int x)//检验每一科都掌握程度x是否可以 
{
	int sum=0;//sum是总的学习的课时 
	for(int i=1;i<=n;i++)//从第一科开始遍历 
	{
		if(e[i].a>=e[i].b)//如果上课效率高就上课 
		{
			if(m*e[i].a>=x)//如果一直上课可以完成x的程度就一直上课 
			  sum+=js(x,e[i].a);//加上所学课时 
			else//当必须要自学时 
			{
			  sum+=m;//加上全上课的课时 
			  sum+=js(x-m*e[i].a,e[i].b);//计算剩下需要自学的课时，x要减去全上课已经得到的掌握程度 
			}
		}
		else //如果自己学效率高就自学 
			sum+=js(x,e[i].b);//计算自学所需的课时 
		if(sum>n*m)//如果算下来所需课时超出限制 
			return 0;//证明设置的x太大了，掌握不了这么多 
	}
	return 1;//否则就是x的值可能小了 
}
```

计算函数用来计算每一科需要以自学或上课的方式所需的课时，检验函数用于检验以当前 mid 为每一科的掌握程度是否可以，主要是看所需的课时数量是否大于总共的课时数量。而且在循环里面用了分类讨论，把第一种情况和第二种情况合成上课效率比自学高的情况，其他注释都有。

#### 主函数部分

```cpp
signed main()
{
	cin>>n>>m;
	for(int i=1;i<=n;i++)
	cin>>e[i].a;//输入每一科上课可以得到的掌握程度 
	for(int i=1;i<=n;i++)
	cin>>e[i].b;//输入每一科自学可以得到的掌握程度 
	int l=1,r=1e18;//设置左右边界 
	while(l<=r)//二分 
	{
		int mid=(l+r)>>1;//相当于mid=(l+r)/2; 
		if(check(mid))//检验mid可不可以 
		  l=mid+1,ans=mid;//x取小了，左边界右移，顺便把答案存一下 
		else r=mid-1;//x取大了，右边界左移 
	}
	cout<<ans<<endl;//输出答案 
	return 0;//好习惯 
} 
```

主要二分的代码，右边界一定要大，样例调了半天