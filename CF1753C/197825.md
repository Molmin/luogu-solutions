首先，因为这个数组只包含 $0$ 和 $1$，所以它排序后一定是一段连续的 $0$ 和一段连续的 $1$。

具体地，设给定数组有 $p$ 个 $0$ 和 $(n-p)$ 个 $1$，那么排序后数组下标区间 $[1,p]$ 的值是 $0$，$[p+1,n]$ 的值是 $1$。

那么，数组没排好序当且仅当 $\exists i \in [1,p], a_i=1$。形象地说，就是存在一个 $1$ 越过下标 $p$ 和 $p+1$ 之间的分界线，出现在分界线左边。

由此想到，可以把当前下标区间 $[1,p]$ 中 $1$ 的个数记作状态。可以发现，如果现在的状态为 $k$，那么经过一步操作之后的状态是 $k$ 或 $k-1$。可以发现，从状态 $k$ 转移到状态 $k-1$ 的概率**与当前数组中数字的具体排列无关**。所以，**排序的期望操作次数也和数组中数字的具体排列无关**，只与下标区间 $[1,p]$ 中 $1$ 的个数有关。

具体地，若当前状态为 $k$，转移到状态 $k-1$ 当且仅当选中的下标 $(i,j)$ 满足 $i\in [1,p],j\in [p+1,n],a_i=1,a_j=0$。此时下标 $[p+1,n]$ 中有 $k$ 个 $0$，那么这样选择的方案数是 $k^2$。所以，从状态 $k$ 转移到状态 $k-1$ 的概率为 $\frac{k^2}{\frac{n(n-1)}{2}}$。

设 $f_k$ 表示状态 $k$ 到达状态 $0$ 的期望操作次数。根据上面计算的概率，可以得到

$$ f_k=\frac{2k^2}{n(n-1)}f_{k-1}+(1-\frac{2k^2}{n(n-1)})f_k+1 $$

该式等价于

$$ f_k=f_{k-1}+\frac{n(n-1)}{2k^2} $$

显然 $f_0=0$。设给定初始数组中下标 $[1,p]$ 中 $1$ 的个数为 $m$，那么答案就是 $f_m$。展开递推式，答案为
$$ \sum_{i=1}^{m}{\frac{n(n-1)}{2i^2}} $$

这个式子可以直接计算。