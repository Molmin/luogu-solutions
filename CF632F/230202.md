# [MAGIC](https://www.luogu.com.cn/problem/CF632F)
## 图论，最小生成树
### 前言
我太菜了，这题卡了我好久好久，主要是不知道最小生成树从何而来，有什么用（实际上不会最小生成树也是可以做的）。
### 读题
这题的题面比较简单，但仔细思考，题面中蕴含了许多有用的信息。  
不要看到矩阵就想到线性代数，不要忘了还有邻接矩阵存图这种东西。请我们将这个矩阵当作一个图。  
一个$MAGIC$矩阵满足一下条件：  
#### $1.$
$\forall i \in[1,n],a_i,_i=0$  
说明这个图是无自环的。
#### $2.$
$\forall i,j \in[1,n],a_i,_j=a_j,_i$  
说明这个图是无向图（$i$->$j$与$j$->$i$边权是相同的）。  
所以推式子时，无论如何交换$a$的下标都是无影响的。  
由$1,2$可知，此矩阵实际上是一张无自环的无向图，于是我们就把它转化为了更形象的图论。
#### $3.$ 
$\forall i,j,k \in [1,n], a_i,_j \leq max(a_i,_k,a_k,_j)$    
这是最重要的一个条件，我们拿出来单独分析。
### 条件$3$
#### 首先  
根据条件$3$：   
$a_i,_j\leq max(a_i,_k,a_k,_j)$.  
$a_i,_k\leq max(a_i,_l,a_l,_k)$.   
于是$a_i,_j\leq max(max(a_i,_l,a_l,_k),a_k,_j)$.  
就是$a_i,_j\leq max(a_i,_l,a_l,_k,a_k,_j)$.  
这个式子在图上是什么意思呢   
![](https://cdn.luogu.com.cn/upload/image_hosting/0n442crh.png)
就是说$g,h,m$三条边中，至少存在一条边大于$f$。  
换句话说，就是如果$g,h,m$三条边都比$f$边要小，那么它就是不合法的。
#### 如何判断
排序就好了，先加入小的边。当要加入$f$边时如果发现$i,j$已经相连，那么显然$i,j$是被小于$f$的边连起来的，于是就是不合法的。可以发现这一过程与最小生成树十分相似，但实际上就算不会，也是可以做这题的，并查集直接维护两点间联通关系就好。
### 最后
此题最重要的是对于题中条件的充分利用，不要看到最小生成树就往算法上死想。此题并不用直接运用最小生成树，更多的是它的思想（排序加边）。此题其实还有很多美妙的解法，~~但是我不会QAQ~~。

