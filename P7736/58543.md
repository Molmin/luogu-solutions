远闻这个是 ``LGV`` 引理 的模板题

但看到题目后，发现不对劲，怎么还有一个奇怪的限制，怎么还有一个交点个数，还要求偶数个交点减奇数个交点的方案数的个数

想了良久，我们就可以发现，最终的奇偶性只和起点和对应的终点有关

___

大概胡一下：

假设有2个起点走向终点，如图

![](https://cdn.luogu.com.cn/upload/image_hosting/gajnq6f1.png)

似乎不明显？把中间的点划掉！

![](https://cdn.luogu.com.cn/upload/image_hosting/16amtbzu.png)

可以发现，如果两个点产生了偶数个交点，必然起点对应原编号的终点；而奇数个交点，必然起点对应不同编号的终点

三个点的话，发现：逆序对数为奇数，就有奇数个交点，而偶数个交点，就有偶数个交点。往后推，发现这个方法似乎有普适性

所以我们大概来证明一下：

有 $10$ 个如果一个数字（下标） $3$ 对应数字 $7$ ，再来一个数（下标） $4$ 对应 $2$，我们就产生了一个逆序对，而这个就可以运用我们之前研究两个点的思想，如果产生了偶数个交点，那么上面的点还在上面，下面的点还在下面，示意图：

![](https://cdn.luogu.com.cn/upload/image_hosting/ubvzea0s.png)

所以说这两个一定会产生奇数个交点，然后中和一下，要是是奇数个逆序对，就有奇数个交点，偶数个逆序对，就有偶数个交点

___

我们要求：偶数个交点方案数 $-$ 奇数个交点方案数

而此时我们发现这于逆序对奇偶性挂钩，回忆一下 ``LGV`` 引理，似乎也和逆序对奇偶性挂钩！

在本题中，如果一个映射（类似于起点 $1,2,3$ 分别对应终点 $3,1,2$，$3,1,2$ 就是一种映射）是有偶数个逆序对数会被算成正贡献，奇数个逆序对数会被算成负贡献， ``LGV`` 的定义亦然！

___

但我们似乎还忘记了一个东西，**所有路径在中间不经过重复的顶点**，怎么没有用到？加上这个定义似乎不好想 $...$

索性就不想了，说不定能对，我们来想想这样做答案会不会变

假设我们有起点 $x_i,x_j$ 对应终点 $y_i,y_j$，在某个点 $p$ 相交

我们此时一定会有一个路径与之对应：让 $x_i,x_j$ 以原来的路走向 $p$，但之后 $x_i$ 走向 $y_j$ ，$x_j$ 走向 $y_i$ ，此时我们因为交换了一个数对，其逆序对奇偶性必然会改变（下面将会给证明），所以我们一正一负，恰好被容斥了

证明：

* 如果有一个排列$P$，交换任意两个数，逆序对奇偶性就会改变

不妨我们交换下标为 $i,j$ 的两个数，我们可以发现我们改变的逆序对只有三种形式：

1. $i,j$ 相互产生的影响，变化量为$1$或$-1$

2. $i$ 对 $i,j$ 中间元素的贡献，$i,j$ 中间元素大于 $P_i$ 的个数为 $(>Pi)$，小于同理，那么我们会增加 $-(<P_i)+(>P_i)$ 个逆序对，这和$i,j$ 中间元素个数是同奇偶的

3. $j$ 对 $i,j$ 中间元素的贡献 ，我们会增加 $(<P_j)-(>P_j)$ 个逆序对，这也和 $i,j$ 中间元素个数是同奇偶的

那么$i,j$ 对 $i,j$ 中间元素的贡献是偶数，而 $i,j$ 相互产生的影响是奇数

所以加起来必然是奇数，奇偶性必然改变