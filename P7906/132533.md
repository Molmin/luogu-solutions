又被二进制块长给杀掉了，SB，这种东西都看不出来。          

月赛的前 2h 一直都在想此题的分块做法……坚信了一个感觉好像 $O(n \sqrt {n \log n})$ 做法后一看发现都有人过了，一看码量就感觉不是大分块题……     

然后又盯了一下，发现……这不是静态查询吗？这个区间查询还具备单点移动后的前缀减性质，怎么感觉这个更像二离莫队了……（太久没碰二离莫队真忘完了）             

然后考虑了一下二离莫队的做法，发现瓶颈就在于维护值域内任意数对一个前缀的贡献，由于二离莫队之后就已经有 $O(n \sqrt m)$ 个询问了，所以必须用一个不劣于 $O(\sqrt w) - O(1)$ 级别的数据结构维护。            

~~当然除科技以外也就只有分块了。~~

现在我们知道了 $a_i$ 与 $x$，要在值域上对所有满足 $ai \bigoplus a_j \leq x$ 的 $a_j$ 的值加 $1$。用一般的套路我们一定可以把区间拆成 $\Theta(\log w)$ 个区间，就可以 $O(\sqrt w \log w) - O(1)$ 维护了，不过肯定也过不了。                    

发现 $\Theta(\log w)$ 个区间互不相交，那么我们只用枚举每个块被加过没有然后暴力加散块就行了，记块长为 $B$ 那么修改的总时间复杂度是 $O(n(B \log w + \frac{w}{B}))$，此时取 $B = \frac{\sqrt w}{\sqrt {\log w}}$ 可以做到 $O(n \sqrt {w \log w})$ 的总修改时间复杂度。           

但是这样的时间复杂度还是有优化的空间。我们考虑令块长为 $2 ^ x$ 并从 $0$ 开始分块，不难发现每一个块的头都是可以写成 $2 ^ x$ 的倍数的，所以当我们在取 $\Theta(\log w)$ 个区间时，如果此时区间长度大于 $2 ^ x$ 那么必将覆盖一段连续的整块，而当区间长度小于 $2 ^ x$ 时，我们知道这后面的区间长度之和为 $2 ^ x$ 数量级直接暴力加就好了。由于每个块至多被覆盖一次所以一次修改的总时间复杂度为 $O(\frac{w}{2 ^ x} + 2 ^ x)$。              

个人莫队时的块长取的是 $300$，$x$ 取到 $9$ 跑的最快，如果有同学被卡常了可以参考一下这组数据。
