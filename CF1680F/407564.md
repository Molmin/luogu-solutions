DFS 树的性质。

首先注意到题面中的这一句话：

> 最多只能有一条边，满足两个顶点都在这个点集中。

显然，“最多只能有一条边”意思就是有 $0$ 条或 $1$ 条。

### 0 条

所以每条边都恰好只有一个顶点在点集中。

很自然想到二分图染色，每条边两个顶点颜色不同。

所以只要这个图是二分图，就一定有解。

### 1 条

有一条边的两个点同色，那么去掉这个边后，剩下的图一定就是一个二分图，就转化成了上一个情况。

先 DFS 一遍。一个~~显然的~~重要的性质是：对于原图中的每条边，要么是 DFS 树中的一条边，要么是一条返祖边（即一个点连向它祖先的边）。

因为二分图中没有奇环，所以这条去掉的边一定在所有奇环上，而不能在任何一个偶环上（这样去掉之后就全是偶环了）。

考虑去掉什么边。

#### 返祖边

因为一个环在 DFS 树中一定是一条链加上一条返祖边，所以在 DFS 遇到返祖边时判断这个环是奇环还是偶环，就能统计出奇环数量了。如果奇环数量为 $1$，那么直接去掉那条返祖边即可。

#### 树边

在统计环时把环上的所有树边都标记 $+1$，最后看是否有一个树边满足：

- 所在的奇环数 $=$ 奇环总数
- 所在的偶环数 $=0$

即可。

标记时用树上差分即可，不会的同学可以左转 OI Wiki。

最后判断答案时只需要再 DFS 一遍，按照深度奇偶性染色即可。

**注意**：有可能结果是：一条边满足两个顶点都不在点集中，其他每条边都有一个顶点在点集中。这时候只需要把所有颜色反转即可。

[Code](https://www.luogu.com.cn/paste/ih3ur3wt)