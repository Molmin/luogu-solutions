考虑分类计数，讨论“没有 `DD`”、“有 `DD` 无 `o`”、“有 `DDo` 无 `S`”三种情况。

- 没有 `DD`，枚举有几种大写字母出现过；
- 剩下两种情况，考虑设 $f_{i,0/1}$ 分别表示两种情况的方案数。$f_{i,0}$ 可以从 $f_{i-1,0}$ 填大写字母转移，也可以枚举第一个出现两次的字母，然后枚举剩下出现了几个字母；$f_{i,1}$ 可以从 $f_{i-1,0}$ 和 $f_{i-1,1}$ 填小写字母转移。

时间复杂度 $O(26^2n)$，精细实现可过。

[code](https://atcoder.jp/contests/abc301/submissions/41433496)