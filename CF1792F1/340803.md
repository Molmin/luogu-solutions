注意到由红色边生成的子图和蓝色边生成的子图互为补图，因此不存在点集 $S$ 满足其既不是蓝色也不是红色，考察 $\lvert S\rvert=n$ 的情况，不难发现，红色或蓝色必然有一个是不连通的，注意到两种情况完全等价，因此仅仅考察红色不连通的情况。

记 $f_i$ 表示 $n=i$ 时满足条件的蓝色不连通图方案，如何转移能不重不漏的统计方案？发现我们每次肯定是通过将两个图拼合在一起的方式转移，大概会形如 $f_i\gets f_{j}\oplus f_{i-j}$，其中 $\oplus$ 无实际含义。可以发现如果我们在转移的时候钦定了包含 $1$ 的蓝色连通块大小，那么不会有重复转移。不难有转移：
$$
f_{i}=\sum\limits_{j=1}^n f_j\times f_{i-j}\times {n-1\choose k-1} \times (2-[i=j+1])
$$
解释转移中的几个点：

- 因为红色不连通和蓝色不连通的方案数相等，因此包含 $1$ 的大小为 $j$ 的蓝色连通块满足红色的不连通的方案数是 $f_j$。
- 剩下的部分是蓝色不连通还是红色不连通是无所谓，方案数为 $2\times f_{i-j}$。注意到 $i-j=1$ 时要特判。
- 为了满足钦定的内容，包含 $1$ 的大小为 $j$ 的蓝色连通块和剩余部分的边一定要是红色，否则我们的钦定是无效的。

