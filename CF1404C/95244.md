考虑先把问题转化。设 $b_i=i-a_i$，$c_i$ 为原数列中 $i$ 位置上的数是否被删除。则原数列中 $i$ 位置上的数能被删去的充要条件是 $\sum\limits_{j=1}^{i-1} c_j\geq b_i$。

不妨想想单个询问且无限制的情况，我们每次会取出一个当前位置上 $b_i=0$ 的 $i$，为了让方案最优我们自然希望让这个 $i$ 最靠近右边。然后，$i$ 位置上的数被删掉，$i+1\sim n$ 位置上的数向前移一位，对应的就是 $k\in(i+1,n],b_k=b_k-1$。使用线段树维护 $1\sim n$ 的最右边的 $b_i=0$ 的 $i$ 即可，时间复杂度为 $O(n \log n)$。

现在来考虑加入多个询问及限制的情况。注意到后缀限制影响的那一部分值可以直接删去，而前缀限制影响的那一部分值会影响之后的值，不能直接删去。所以我们离线统计每个询问。倒着加入每个点，仿照单个询问的做法，这样就可以得到 $[i,n]$ 内 $c_i$ 的值。时间复杂度的正确性基于，每个点的 $b$ 值只会达到一次 $0$，所以这一部分的时间复杂度仍为 $O(n \log n)$。

也可以使用主席树，第 $i$ 棵主席树维护 $i\sim n$ 内的 $c_i$ ，询问 $(x,y)$ 时即在第 $x+1$ 棵主席树上查询 $[x+1,n-y]$ 的值。对于 $c_i$，仍使用离线时处理的方法即可。

时间复杂度均为 $O((Q+n) \log n)$，可以通过本题。