首先来看操作 $2$ ，可以发现这个操作将磁铁 $a$ 变成了一个环（因为利用操作 $2$ 可以做到首尾相连的效果）。因此我们考虑倍增。

再来看操作 $1$ ，这时就明了多了。事实上就是删除环上任意连续的一段。

最终问题就变成了：求字符串 $b$ 是否为环 $a$ 的子序列。

子序列：从序列中挑出任意个且任意一些元素，并从左往右排列的序列。

这个问题，可以利用双指针来求解。若 $b_i$ 可以匹配，则检查 $b_{i+1}$ 是否可以匹配 $\cdots\cdots$ 以此类推。

代码就不挂了，杜绝 $\texttt{Ctrl+C}$ 。