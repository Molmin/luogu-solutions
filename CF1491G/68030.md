这里是官方题解。

这道题分为两部分：

- 将置换环个数降为 $1$。考虑如何 $|S_1|+|S_2|$ 次操作完成两个置换环的交换。

我们先交换两个环上的任意一对元素。

然后，我们发现可以通过不断将第一个环上元素和被置换位置交换来将第一个置换环除被交换数位置之外的所有位置归位；同理第二个环也可以这样归位。

之后，将两个被交换位置换回去。

如下：

$[2,3,1,5,4] \rightarrow [-5,3,1,-2,4] \rightarrow [-4,3,1,-2,5] \rightarrow [-4,2,1,-3,5] \rightarrow [-4,2,3,-1,5]  \rightarrow [1,2,3,4,5]$

- 将最后一个置换环归位。我们要用至多 $|S|+1$ 步将它归位。

如果这个置换环长度大于 $2$，那么可以将这个置换环的前两个元素交换，然后顺次归位，特判掉最后三个位置，例如：（特判的步骤换了一种箭头表示）

$[3,5,2,1,4] \rightarrow [-2,5,-3,1,4] \rightarrow [-5,2,-3,1,4] \rightarrow [-4,2,-3,1,5] \Rightarrow [-4,2,-1,3,5] \Rightarrow [-3,2,-1,4,5] \Rightarrow [1,2,3,4,5]$

如果这个置换环长度等于 $2$，设其包含 $a,b$，那么我们可以找到另一个归位了的元素 $c$，并执行交换 $(a,c),(b,c),(a,c)$ 来将这两个元素交换。

至此，我们即可在 $n+1$ 次操作内解决这个问题。