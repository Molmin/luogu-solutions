## 思路
记一条路径在第二行经过了 $[l,r]$ 段，激活的区间价值和为 $f(l,r)$，那么这个路径的价值就是 $A_l-f(l,r)+B_r$，其中 $A_i,B_i$ 都可以通过每个格子的权值平凡预处理，时间复杂度 $O(n)$。

不难发现最优策略中，除了最后一个线段，其它线段都是走满的~~然后做完了~~，我们可以尝试先在每个线段都走满的情况下，对于每个 $r$ 求出 $F_r=\min\{A_l-f(l,r)\}$。

我们不难计算出从 $(1,1)$ 开始，走了若干个满的段到 $(2,x)$ 的费用，这里的转移就是 $f_x=\min\limits_{y=l}^r\{f_y\}+k$，这可以用线段树平凡解决，时间复杂度 $O(q\log n)$。

最后我们枚举最后一段，这里要解决的是 $\min\limits_{l\leq x\leq y\leq r}F_x+B_y$，这个也可以线段树做，时间复杂度 $O(q\log n)$。 