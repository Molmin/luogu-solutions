提供一个无脑二分+线段树/ ST 表做法。

首先看到这个题一定可以想到转化成寻找 $l$ 和 $r$ ，使得 $r - l + 1$ 最大且 $[l,r]$ 这个区间内所有种类属性值的最大值之和 $<= k$ 。

转化成这个样子之后就比较好做了

对于这种求最大区间长度的题我的做法是会采取二分长度的方法来解决

具体就是二分长度,然后在 $check$ 函数里面枚举 $l$ , 用 ST 表/线段树查询  $[l, r]$ 中的最大值,看看最大值之和是不是合法

整体复杂度 $O (nm \log n)$ 或 $O (nm \log^2 n)$ , 能过

一道水紫就这样切掉了

祝各位 csp rp++