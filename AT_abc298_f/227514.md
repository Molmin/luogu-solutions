显然对于一个选择方案 $(R,C)$ 来说，贡献就是：
$$v((R,C))=rsum(R)+csum(C)-w_{R,C}$$
其中 $rsum(x),csum(x)$ 分别表示行 $x$，列 $x$ 的权值和，$w_{x,y}$ 表示 $(x,y)$ 的权值。

无非就是 $w_{R,C}=0$ 和 $w_{R,C}=1$ 两种情况，而 $w_{R,C}=1$ 的情况只需要扫一遍即可，涉及到的内容可以使用 umap 维护。

对于 $w_{R,C}=0$ 的情况，枚举每个出现过的行 $r$，按 $csum$ 从大到小枚举每个出现过的列 $c$，当 $w_{r,c}=0$ 时，后面的的 $(r,\cdots)$ 决策一定更劣，于是直接跳出循环即可。

不难发现时间复杂度为 $\Theta(n)$。