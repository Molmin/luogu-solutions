~~刚刚在机房看 zhihu 被抓摆了，教练让我落实这道题并下午分享，好难w。~~

题意：给出一个 DAG，然后有源点和汇点，要求源点和汇点两两匹配，并且将他们连接在一起的路径不能有相交部分，配对后源点从小到大排序，对应出来的汇点的序列的逆序对数量如果是偶数就有 $1$ 的贡献，否则就有 $-1$ 的贡献。

我们先考虑找出源点和汇点，然后在 DAG 上 dp 求出每个源点到每个汇点的方案数，把这个丢进一个矩阵 $S$ 里。

然后考虑先忽略掉路径不能重复的限制条件，考虑假设现在汇点序列为 $T$，那么很明显的对答案的贡献为 $(-1)^{\sigma(T)}\prod_{i=1}^n S_{i,T_i}$，其中 $\sigma(T)$ 为序列 $T$ 的逆序对数量。

你发现排列 $T$ 是一个全排列，你再来看这个式子，你发现他像一个行列式求和对吧。

不对，因为还有相交的，但是相交的我们可以不去考虑他，如果路径相交意味着路径可替换，替换之后逆序对数量的奇偶性变化，大白话来讲，俩方案抵消了不产生贡献，所以相交的可以直接不考虑了。

所以直接行列式求和就做完了。