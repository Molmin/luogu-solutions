## 题意

> 给定一个含前导$0$数字串(本质是字符串但子串有数字意义),多次询问一个子串$S_{l,r}$的的所有子串中表示数字是给定质数$p$的倍数个数

## Solution

首先一个区间的所有子区间这种明显没有可加性(可合并性),只能增量

因此提前确定考虑莫队或在线

然后回顾要求子串表达数字是$p$的倍数,对$S_{x,y}\equiv 0\pmod p$即$\displaystyle \frac{(S_{x,|S|}-S_{y+1,|S|})}{10^{|S|-y}}\equiv 0\pmod p$

- 当$(10^{|S|-y},p)=1$时等价于$S_{x,|S|}\equiv S_{y+1,|S|}\pmod p$

  因此问题变为$\frac{[l,r]区间内有多少对数相同-(r-l+1)}{2}$莫队可做

- 否则$p=2,5$

考虑以第$i$位为结尾可以贡献为$i-(l-1)$拆成$\displaystyle f_i=\sum_{i=1}^n[$i可做结尾$]i,g_i=\sum_{i=1}^n[$i可做结尾$]\therefore ans_{l,r}=f_r-f_{l-1}-(l-1)(g_{r}-g_{l-1})$

注意一下$n+1$这个断点