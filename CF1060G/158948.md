让人愉悦的一道题，如果能自己想出来说明思维很好！

## 题意

数轴上初始时每个整点 $x$ 有一个标号为 $x$ 的球。有 $n$ 个洞，在 $a_1, a_2,\cdots, a_n$ 上。每一时刻位于洞上的球掉落，其余球左移到第一个没有球的整点上。

$q$ 次询问，问 $k_i$ 步后 $x_i$ 上的球标号为多少。

## 题解

我当然不可能自己想出来，看的是讨论区的题解。

发现 $a_i$ 的范围是特别大的，也就是说洞的位置隔得很远，但洞的个数在可接受范围内。

这提示我们研究与洞的个数有关的球的个数，考虑连续的 $n$ 个球，先不考虑询问什么的东西，只是看看球会怎么动。

如果我们选在 $a_1$ 前面的球肯定动都不会动，于是不妨取极远位置的球，设为 $[\infty,\infty+n)$，我们给他打上标记。

没遇到洞前显然都是每次往前移 $n$ 个球，遇到洞后可以感受到原本有标记的这些球在坑掉一些后还是连续的。

不妨假设当前有 $a$ 个存活的标记球，它们都是连续的，有 $a$ 个洞在最后一个标记球的前面，也就是可能坑掉球的洞个数。

我们可以归纳证明任意时刻都符合这个局面，考虑在某一时刻遇到了 $b$ 个洞，形如：

![](https://cdn.luogu.com.cn/upload/image_hosting/q4rye08f.png)

如图，当前连续标记的区间为最后一段黑色框，内部的红色为洞，图中蓝色为最后一个标记球的位置，如果后缀有一段被连续坑杀的可以在考虑这一轮坑杀行动之前直接忽略。

考察此轮之后最后标记球的位置，它一定向前移动了 $a$ 个位置。

而其他标记球还是连续的接在它前面，如图中绿色框，于是我们可以归纳出这一轮坑杀后剩下标记球的位置还是连续的。

再来看球和洞的数量：少了 $b$ 个洞，恰坑了 $b$ 个球，剩下的 $a-b$ 个球完全不受滑过的 $b$ 个洞的影响，红色框为少掉的 $b$ 个球对连续区间带来的影响。

这个图为了好看把前面的 $a-b$ 个洞放在了最前面，实际上是可能出现在绿色框以内的，但这是下一轮的事，并不对当前轮造成影响。

也就是说，这些原本有 $n$ 个的标记球，在同一轮中遇到 $b$ 个洞就会少 $b$ 个，剩下的在仍然相连的情况下完全越过这 $b$ 个洞。

由上述过程不难发现这些标记球的位置是恰巧不交且不漏的滑过了所有的位置直到第一个洞，于是我们可以考虑询问。

在我们滑过一个询问位置的时候找到对应的球，然后根据以上性质可以直接算出对应的位置，即可。