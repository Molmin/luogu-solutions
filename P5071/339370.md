Update 2020.4.18发现暴力分解SPFA了，更正。

修了下排版/kk

>在太阳西斜的这个世界里，置身天上之森。等这场战争结束之后，不归之人与望眼欲穿的众人， 人人本着正义之名，长存不灭的过去、逐渐消逝的未来。我回来了，纵使日薄西山，即便看不到未来，此时此刻的光辉，盼君勿忘。————世界上最幸福的女孩 珂朵莉

珂朵莉，最可爱了。

~~听说用这个号发题解不会被乱膜呢。~~

首先，思路应该很明确吧/kk

光是看到因数个数膜 $19260817$ 就能想到肯定是维护质因子&次数（其实就是离散化后维护计数器）。怎么快速分解质因数等下再说。

然后这玩意在两个数相乘的时候是每一项直接相加的，**可以合并**，于是乎想到分块（Ynoi嘛）/线段树。

但是仔细想想，两个数合并还好，一个数至多 $\log N$ 个素因子。**然鹅合并后就不一定了，原因在于值域巨大，内部质因子分散，也就是几次合并后再合并的代价会相当之大。**

一句话来说，极端数据下，分块和线段树都能被卡到暴力复杂度······

而且，求出计数器后还要遍历一遍算答案，复杂度爆炸/kk

那还有什么可以用的？

**基本只剩莫队了。**

好好想想，区间加区间会炸，但区间加单点确实可以正常 $\operatorname{O}(\log N)$ 诶，保证了可以较快的修改。

想想细节：怎么算答案？预处理逆元一除一乘就好了······

真·畅通无阻。

好了祝大家AC。

~~反正我没AC/kk~~

于是我们需要一些优化。

还记得分块/线段树的优势吗？区间合并快于一个个单点加区间。我们可以稍作结合（算法不能学死），一些出现频繁的素数直接维护前缀和（其实这里是做差了，不过反正可减）。

又要足够频繁又不能过多······

**这个界可以定 $<1000$**。

（$10^9=1000^3$ 也就是说每个数多出来的素因子至多两个）。

诶莫队转移变 $\operatorname O(1)$ 了耶。

总复杂度：$\operatorname O(n\sqrt{n})$

素因数分解暴力SPFA了······只能用大常数PR了/kk。

卡常无比······

代码不贴了，觉得讲的还算清楚，不理解的私信。

好了，大家一定能AC了吧！

再见/kk！