~~日推天天给我推这道神题，真以为我能做出来吗 qwq~~

做法真的牛逼啊，首先答案和怎么移动无关，对于一定的初态末态每种移动方式产生的能量都是一样的 .

考虑设一个势能函数使得每移动一次，势能的减少量等于答案的增加量 .

首先整个状态的势能就是每个点的势能之和，且发现势能函数关于维度独立且等价 .

于是令 $f(x)$ 表示一个维度上第 $x$ 位的势能，于是根据题目中给的移动方式，就有对于任意两个位置 $x_1<x_2$，有
$$f(x_1)+f(x_2)-f(x_1+1)-f(x_2-1)=x_2-x_1-1$$
移项，得 $f(x_1+1)-f(x_1)-x_1=f(x_2+1)-f(x_2)-x_2$ .

于是我们的势能函数 $f$ 只需满足 $f(x+1)-f(x)-x$ 是定值就完了 .

此时大家就都整的是 $f(x)=\dfrac{x^2+x}2$，同学们不要拘泥于已有的题解啊，$f(x)=\dfrac 12x^2+x$ 也行啊 .

于是一个点的势能就是 $\dfrac 12(x^2+y^2)+x+y$，答案就是初态势能减终态势能 .

实际操作的时候可以把 $\dfrac 12$ 先提出来，规避浮点数操作 .
```cpp
int n, m, x;
ll ans;
int main()
{
	scanf("%d%d", &n, &m);
	for (int i=1; i<=n; i++)
		for (int j=1; j<=m; j++)
			scanf("%d", &x), ans += x * (i * i + j * j + 2 * i + 2 * j);
	for (int i=1; i<=n; i++)
		for (int j=1; j<=m; j++)
			scanf("%d", &x), ans -= x * (i * i + j * j + 2 * i + 2 * j);
	printf("%lld\n", ans / 2);
	return 0;
}
```

参考 [第二篇题解](https://www.luogu.com.cn/blog/lin4xu/solution-p1861) .