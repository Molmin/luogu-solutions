- ``不知乘月几人归,落月摇情满江树。``

**[题意](https://www.luogu.com.cn/problem/AT2005)**
- 一开始有一个数列，每一次都让数列自己循环延伸到一个长度，求最后数列中每个数的出现次数。

**分析**
- 设 $f(i,j)$ 为第 $i$ 次操作后形成的数列前 $j$ 个数形成的每个数出现次数，很容易通过图形自相似的性质得到 $O(n^3)$ 的做法，当然，这是极其不优的。
- 你发现一个数被取模要么不变，要么至少减半，所以你设计了一个从后往前推的方法，每次用 $\text{map}$ 存储你需要的数和贡献数，然后每次从大到小取模。
- 你发现不成功的取模是 $O(n)$ 次的，所以成功的取模次数是数对数的总和的 $O(n\log w)$，总复杂度为 $O(n\log n\log w )$，[代码](https://www.luogu.com.cn/paste/0rbdsbys)。