## $\text{Polya}$ 计数原理

### 先规定一些东西

 下面所说的**方案**指的是一种染色方案，或者说是一种状态

 用 $D(g_i)$ 表示  $g_i$ 这种**置换**下不动的**方案**的总数

 用 $Z_i$ 表示 $i$ 这种**方案**下置换后不变的**置换集合**

 用 $E_i$ 表示与 $i$ 这种**方案**本质相同的方案的**方案集合**

### 然后就有下面这些定理

#### 定理一 :

 $|E_k| \times |Z_k| = |G|$ 

其中 $|G|$ 表示置换集合大小

翻译过来就是 : 一类本质相同的**方案个数**乘上这类方案下置换不变的**置换个数**等于**置换总数**

这个窝不会证, 求哪位教教我qwq, 不过我们老师给我举例了很多都是对的, 就先假定它是正确的吧

#### 定理二 :

 $N = \sum_{i = 1}^{L}|E_i|$ 

其中 $N$ 为所有的方案个数(可相同), $L$ 为本质不同的集合大小

这个比较显然, 总方案数等于所有**本质不同**的方案乘上这种方案的**重复次数**

#### 定理三 :

 $\sum_{k = 1}^{N}|Z_k| = \sum_{i = 1}^{|G|}D(g_i)$

所有方案下置换不变的**置换个数**, 等于所有置换下方案不变的**方案个数**

想一下, 这个好像真的是对哒

想象方案和置换连边, 构成一个二分图, 而式子左右其实都是边的个数, 当然相等啊

### 开始推一些东西

$$
\sum_{k = 1}^{N}|Z_i| = \sum_{i = 1}^{L}\sum_{j \in i}|Z_i|
$$

$$
\sum_{k = 1}^{N}|Z_i| = \sum_{i = 1}^{L}|E_i||Z_i|
$$

$$
\sum_{k = 1}^{N}|Z_i| = L \cdot |G|
$$

即 :

$$
L = \frac 1 {|G|} \sum_{k = 1}^{N}|Zi|
$$

又 :
$$
\because \sum_{k = 1}^{N}|Z_k| = \sum_{i = 1}^{|G|}D(g_i)
$$

$$
\therefore L = \frac 1 {|G|} \sum_{i = 1}^{|G|}D(g_i)
$$

### 结论

  $L = \frac 1 {|G|} \sum_{i = 1}^{|G|}D(g_i)$, 这就是 $\text{Burnside}$ 定理了

 也就是说, 我们知道了所有**置换下不动的方案**(这种置换的不动点)总数, 将它除以置换集合的大小, 就可以得到**本质不同**的方案数了

  而对于一类计数问题 :

  在长度为 $N$ 的环上染色, 有 $M$ 种颜色, 我们就有

  $L = \frac 1 {|G|} \sum_{i = 1}^{|G|}M^{C(g_i)}$

  其中 $C(g_i)$ 为置换 $g_i$ 的循环总数, 且$C(g_i) = \frac {N} {gcd(i, N)}$ ($gcd(i, N)$ 为一个循环的长度)

  解释 : 一种置换不变, 那么一个循环上的点颜色都必须相同, 而每一个循环的染色操作互不影响, 用乘法原理可得 $D(g_i) = M^{C(g_i)}$

  考虑枚举循环总数, 用**欧拉定理**就可以快速求出上式

  $L = \frac 1 {|G|} \sum_{i | N} \phi(N / i) \cdot M^i$

  对于 [P4980](https://www.luogu.org/problemnew/show/P4980)

  最后答案 $res = \frac 1 {|N|} \sum_{i | N} \phi(N / i) \cdot N^i$

#### [$\color {Deepskyblue} {Code}$](https://www.luogu.org/paste/up33qogs)