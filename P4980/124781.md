# 【模板】Polya定理
[题目传送门](https://www.luogu.com.cn/problem/P4980)
## 题目大意
给定$n$,求长度为$n$的环用$n$种颜色染出来不同的个数。
## 思路
看到其他博客都是用的$\text {Polya}$定理做的，不过，$\text {Polya}$定理的题怎么能用$\text {Polya}$做呢？这里提供一种思路简单结果相同的想法，来自于《具体数学》。

我们定义$N(n,m)$为长度为$n$的环用$m$种颜色染的方案数。那么，我们就知道:

$$nN(n,m)=\sum_{k} \sum_{a_{1,2,3,...,n}} [a_{1,2,3,...,n}=a_{k+1,k+2,...,k}]$$

因为两边都是算的重复的个数。

我们举个例子，比如$n=12,k=8$，就可以得到:

$$a_1a_2a_3a_4a_5a_6a_7a_8a_9a_{10}a_{11}a_{12}=a_9a_{10}a_{11}a_{12}a_1a_2a_3a_4a_5a_6a_7a_8$$

就可以得到:

$$a_1=a_9=a_5$$

$$a_2=a_{10}=a_6$$

$$a_3=a_{11}=a_7$$

$$a_4=a_{12}=a_8$$

于是，就有$m^4$中方法使得$n=12,k=8$时满足$a_{1,2,3,...,n}=a_{k+1,k+2,...,k}$。

我们考虑拓展。我们发现$kl$的膜$n$的剩余系就是:

$$\{0,d,2d,3d,...,n-d\}$$

其中$d=gcd(n,k)$。这个显然易证。

所以，我们就可以得到:

$$nN(n,m)=\sum_{k} m^{gcd (n,k)}$$

但是这个式子并不简单，我们可以考虑进一步简化:

$$nN(n,m)=\sum_{k} m^{gcd (n,k)}$$

$$=\sum_ {k} \sum_{d} m^d [d=gcd(n,k)]$$

$$=\sum_{d} m^d \sum_{d|k} 1$$

$$=\sum_{d} m^d \sum_{k=1}^{\frac{n}{d}} [gcd(d,k)=1]$$

$$=\sum_{d} m^d \varphi (\frac{n}{d})$$

$$\therefore N(n,m)=\frac{1}{n} \sum_{d} m^d \varphi (\frac{n}{d})$$

这道题的答案实际上就是$N(n,n)$，直接预处理一下$\varphi$就好了，每次$\Theta(\sqrt n)$解决。

代码很简单，这里就不给出了。