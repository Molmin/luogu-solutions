# 题目

[传送门](https://www.luogu.com.cn/problem/CF431D)

# 题解

由于题目要求的 $n$ 十分巨大（$n\le 10^{18}$），并且要求**恰好**有 $m$ 个数二进制下有 $k$ 个 $1$，考虑二分~~（先猜后证~~

但是如果要使用二分，需要证明单调性，我们记 $f(x)$ 为 $x+1$ 到 $2x$ 之间的数中，他们二进制表示下恰好有 $k$ 个 $1$ 的数字个数，如果有单调性，显然是 $f(x)\le f(x+1)$，如何证明？

由于 $f(x)$ 是区间 $[x+1,2x]$ 的个数，$f(x+1)$ 是区间 $[x+2,2x+2]$ 的个数，去除相同的部分，$f(x)$ 就剩下 $x+1$，而 $f(x+1)$ 剩下 $2x+1,2x+2$，由于 $x+1$ 与 $2x+2$ 的 $1$ 的个数相同（相当于左移一位），那么如果 $2x+1$ 满足条件，$f(x)=f(x+1)-1$，反之 $f(x)=f(x+1)$，也就是说，无论如何都有 $f(x)\le f(x+1)$，可证其单调性。

考虑目前二分到一个 $n$，我们如何计算 $f(n)$？考虑记 $g(n)$ 为 $[1,n]$ 中满足条件的数，那么 $f(n)=g(2n)-g(n)$，而 $g(n)$ 可以考虑使用数位 $DP$ 来做。

优化：其实 $g(x)$ 可以使用组合数进行优化，这样也是合理的。

# 代码

```cpp
https://www.cnblogs.com/Arextre/p/13474384.html
```

