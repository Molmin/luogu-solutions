看到询问次数接近 $n$，考虑将 $n$ 分成多组，每组都以较少的期望询问次数解决。

先询问一次全 `F`，接下来的询问就能确定若干个位置的 `T` 个数。考虑每次从答案未确定的问题集合中随 $4$ 个（如果集合大小 $< 4$ 就暴力），先问这 $4$ 个中 `T` 的个数，如果结果为 $0$ 或 $4$ 就说明全是 `F/T`。否则再问前两个，如果结果为 $0$ 或 $2$ 就说明都是 `F/T`；否则它们是 `TF` 或 `FT`，那我们得到了其中一个是另一个的取反，能解决一个。对于后两个 `T` 的个数可以通过前两次询问的结果算出，类似地分类讨论即可。

接下来我们计算期望次数（只考虑 `F` 和 `T` 等概率出现的情况，因为其中一个更多时期望次数显然更少）：

- $\frac{1}{8}$ 概率一次询问解决 $4$ 个。
- $\frac{1}{8}$ 概率两次询问解决 $4$ 个。
- $\frac{1}{2}$ 概率两次询问解决 $3$ 个。
- $\frac{1}{4}$ 概率两次询问解决 $2$ 个。

写个 `dp` 可以得出期望询问次数约为 $627$ 次，可以通过。

[code](https://codeforces.com/contest/1705/submission/188879346)