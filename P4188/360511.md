- 最直接的想法是，算出总覆盖长度，然后枚举去除每一条线段的贡献，所以这个问题就被分为了两个子问题。

- 对于第一个问题，考虑将线段按左端点升序排序，然后枚举每一段区间 $[ll,rr]$，记录右端点的最大值 $r$，如果目前这个线段右端点被覆盖过去，则这个线段没有贡献，因为线段的左端点已经按升序排列了。而如果 $r$ 没有覆盖掉这个区间右端点 $rr$ 的话，这个线段的贡献为 $rr-\max(ll,r)$。
- 再来看第二个问题，我们的目标是让第二个问题的答案尽量小，才能保证最终答案尽可能大。如果枚举每一个被删掉的区间，然后再算总贡献的话，效率是 $\mathcal{O}(n^2)$ 的，太拉了。考虑线性的做法。如果第 $i$ 个区间被第 $i-1$ 个区间全部包含，那么，删去第 $i$ 个区间后，总覆盖长度是不变的，也就是总覆盖长度减去了 $0$，所以这样答案为 $0$。再如果，第 $i+1$ 个区间和第 $i-1$ 个区间首尾相连，考虑第 $i$ 个区间的位置关系，如果第 $i$ 个区间包含了第 $i+1$ 个区间，则可以删去第 $i+1$ 个区间，答案为 $0$，而若第 $i$ 个区间，形象的说，被加在 $i-1$ 和 $i+1$ 这两个区间中间，则删去 $i$，答案也是 $0$。

- 对于余下的情况，第 $i$ 条线段的贡献就不是 $0$ 了。考虑 $i$ 真实的左右端点，右端点可能被 $i+1$ 的左端点覆盖掉，所以右端点为 $\min(a[i+1].l,a[i].r)$，同理，左端点也可能被 $i-1$ 的右端点覆盖掉，所以左端点为 $\max(a[i-1].r,a[i].l)$，这里两个作差，得到的是 $i$ 的单点覆盖。所有的 $i$ 取贡献最小的即可。

- PS：这道题做了两天，吐了吐了。