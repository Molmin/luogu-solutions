首先有一个性质：

对于两个序列 $a_1,a_2,...,a_n$ 和 $b_1,b_2,...,b_n$，若 $a$ 想通过一系列操作变为 $b$，记 $a$ 序列的前缀和为 $suma_i$，$b$ 序列的前缀和为 $sumb_i$，即 $suma_i = \sum\limits_{j=1}^i a_j$，$sumb_i = \sum\limits_{j=1}^i b_j$，则 $a$ 序列变为 $b$ 序列的最小操作次数为：

$$\sum\limits_{i=1}^{n-1} |suma_i - sumb_i|$$

可以这么理解，从前往后遍历，使它们逐个变为相等。首先要让 $a_1 = b_1$ 就要操作 $|a_1 - b_1|$ 次，和 $2$ 操作后 $a_1$ 变成了 $b_1$，$a_2$ 变成了 $a_2 + a_1 - b_1$，那么要让 $a_2 = b_2$ 就要和 $3$ 操作 $|a_2 + a_1 - b_1 - b_2|$ 次。最后一个元素不用操作。这样推下去就可以得到上面的式子。

然后就可以 dp。设 $f_{i,j,k}$ 为前 $i$ 个元素不升，当前枚举的元素变成了 $j$，和为 $k$ 的最小操作次数。转移时再枚举当前的元素 $l$，有转移方程 $f_{i,l,k} \gets \min(f_{i,l,k},f_{i-1,j,k-l} + |l - sum_i|)$，其中 $sum_i = \sum\limits_{j=1}^i a_j$。

注意到最后的序列的第 $i$ 个元素上界为 $\left\lfloor\dfrac{m}{i}\right\rfloor$，所以复杂度实际上大约是 $O(nm^2 \log m)$。

代码很简单，就不放了。