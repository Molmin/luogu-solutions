## 题意

同 CF1623A，但每一次机器人只有 $\frac{p}{100}$ 的几率清理，问清理掉细胞的期望步数是多少。

## 题解

设机器人现在的状态为 $x$，其中状态由所在的坐标及方向决定，下一步的状态为 $y$，且处于 $y$ 时能清理细胞。设若以 $x$ 状态为起点，期望步数为 $a$，以 $y$ 状态为起点，期望步数为 $b$。则 $a=(1-\frac{p}{100})(1+b)$。该式子含义为：处于 $b$ 状态时有 $1-\frac{p}{100}$ 的几率不能清理，所以 $a$ 即为 $b+1$ 乘以概率 $1-\frac{p}{100}$，因为从 $x$ 走到 $y$ 需要花费一步，所以要加一。

如果处于 $y$ 时不能清理细胞，则 $a=1+b$，因为此时不能清理的概率为 $1$。

机器人的行动存在周期，且周期中所有状态都不相同，~~（证明很简单，留给读者作课后作业）~~ 设周期中的状态分别为 $x_1,x_2,x_3,\cdots,x_T$,其中 $T$ 为周期长度，则对于一个状态 $x_i$ 对应的期望步数（设为 $a_i$ ）为 $a_i=\bar{p}_{i+1}(1+a_{i+1})$，其中 $\bar{p}_{i+1}$ 是 $x_{i+1}$ 不能清理细胞的概率，若 $x_{i+1}$ 与细胞处于同一列或者同一行则 $\bar{p}_{i+1}=1-\frac{p}{100}$，否则 $\bar{p}_{i+1}=1$。

之后可以得出方程组：

$\left\{\begin{matrix} a_1=\bar{p}_2(1+a_2)\\ a_2=\bar{p}_3(1+a_3)\\ a_3=\bar{p}_4(1+a_4)\\ \cdots 
\\ a_n=\bar{p}_1(1+a_1)\end{matrix}\right.$

合并后变成：

$a_1=\bar{p}_2(1+\bar{p}_3(1+\bar{p}_4(1+\bar{p}_5(1+\cdots \bar{p}_T(1+a_1)\cdots))))$

化简后只需要 DFS 枚举所有状态，就能轻易算出答案 $a_1$ 了。