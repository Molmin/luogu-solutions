## 约定

记两个金苹果的编号为 $x,y$。文中的 $\log$ 均上取整。

## 从暴力说起

注意到当两个金苹果在一个集合内时，交互库返回 $0$，否则返回 $1$。

我们考虑对于每个 $i$，都询问一次 $S_1=\{i\}$，不难发现我们至多询问 $n-1$ 次即可确定。

## 逐步分解

考虑如果我们知道了两个符合题设的集合 $S_1,S_2$，满足 $x\in S_1$，$y\in S_2$，那么，我们如何在 $2\times \log n$ 次询问内找出金苹果位置。

![1668516818768.png](https://img-kysic-1258722770.file.myqcloud.com/c664979af4c8fd1ea9fa194d3f76e3fa/c8c8760094c32.png)

我们先考虑 $S_1$，不难想到分治解决。具体的，如图所示，可以把他分成两份，分别标做灰和绿，并将 $S_2$ 标做蓝，每次询问绿色和灰色部分的并，若返回 $0$，则递归到绿色部分继续处理，否则递归到灰色部分继续处理。对于 $S_2$ 同理。

## 进一步的

怎么找到上述的集合 $S_1,S_2$ 呢，我们其实只需要构造一种分组方式把两个金苹果分到不同组。

我们考虑一个基本的结论：若 $x\neq y$，那么 $x,y$ 在二进制下至少有一位不同。

这是显然的，所以我们可以考虑进行 $\log n$ 次分组操作，其中第 $i$ 次将二进制下第 $i$ 位为 $0$ 的分到 $S_1$，其余分到 $S_2$。那么，不难发现，至少有一次询问的结果是 $1$。

## 再优化？

现在我们已经做到了 $3\times \log n$ 了，还能不能再优化？

让我们想想还有哪些信息没有用到，没错，我们在寻找集合 $S_1,S_2$ 的过程中只关心回答为 $1$ 的询问，事实上，如果我们考虑分析所有回答，不难发现每次回答的结果其实是 $x,y$ 当前位的异或值！因此我们只需要对较小的 $S_1,S_2$ 分治解决即可，至此，询问次数优化为 $\log n+\log \frac{n}{2}$。

## 证明

通过信息论可以证明 $\log n+\log \frac{n}{2}$ 是本题最坏情况下的询问下界。