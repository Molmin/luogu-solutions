如果划分的集合 $S1,S2$ 满足 $S1$ 和 $S2$ 中都恰有一个关键点，那么可以在 $\log(|S1|)$ 的时间找到 $S1$ 中的关键点。

将 $S1$ 均分为两集合 $S3,S4$，查询集合 $S3+S2$ 和 $S4$。若 $S3$ 中存在关键点，那么答案为 $0$；否则为 $2$。在 $S3$ 和 $S4$ 中定位关键点后，将不存在关键点的集合并到 $S2$ 中。

那么考虑求出集合 $S1,S2$ 满足$S1$ 和 $S2$ 中都恰有一个关键点。为了方便，设 $n=2^k$。

第一次操作将编号均分为两部分（$[1,n/2],(n/2,n]$）。取出第一份作为 $S1$，第二份作为 $S2$，进行查询。若满足条件则跳出，否则继续。

第二次操作将编号均分为四部分。取出第一、三份作为 $S1$，剩余的为 $S2$。以此类推。

显然，某次操作后如果仍不满足条件，那么说明两个关键点都在这次操作划分的某一部分中。

那么进行到最后一次操作，划分大小为 $1$，必然能成功地划分。

所以在某次成功地划分后，使用 $\log n$ 的时间找到 $S1$ 中的关键点。在找到这个关键点后，$S2$ 的关键点就存在于某次成功划分中 $S1$ 中的关键点存在部分的相邻位置。

那么 $S2$ 的大小仅为该划分部分的大小。使用 $\log |S2|$ 的时间找到 $S2$ 中的关键点。这里的时间加上划分操作的时间恰为 $\log n$。