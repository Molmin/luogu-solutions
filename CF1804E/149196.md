CF1804E。

把定 $a(i)$ 当做选边，留下选择的边，删去其他边，那么形成的图一定是一个内向基环树森林。

现在我们证明一定有一种答案满足以下条件：

1. 形成的基环树森林只有一棵树；
2. 这棵树的非环上点都直接连向环上点。

考虑调整法，假设我们找到了任意一组答案。若第一个条件不被满足，那么我们把两棵树的单独拎出来，既然它们能互相到达，那么事实上我们可以把它们的环合并成一个大环，证明是显然的。同理，合并成一棵树后，由于环上点能到达所有点，那么所有点也一定能直接连向环上点。

于是预处理 $f_{S}$ 表示点集 $S$ 的所有点的邻域的并是否为图的所有点。接下来我们从点 $1$ 开始枚举，然后用状压 dp 找出所有从 $1$ 开始回到 $1$ 的环，状态形如是否存在一条从枚举点出发的路径经过了点集 $S$ 且终点为 $x$，如果找到一个答案就退出，否则把当前结点删了，枚举下一个点继续找。复杂度是单次进行 $dp$ 时的 $n^22^n$。

然后这个时候就有人说了，主播主播，你这个 $n^22^n$ 这么拉，能过 $20$ 吗？别急。考虑之前的状态，我们直接把终点集合压起来统一转移，发现枚举一个新点后的转移就是集合求交，可以用位运算加速。由于 $n$ 才 $20$ 所以复杂度就变成 $n2^n$ 了。

注意题目中给的图是个无向图，没看清以为是有向做了一年。