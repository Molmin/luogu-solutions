提前发放，总不可能有人 3min 看完我的 blog 然后写完吧。

调了大半年的 E 没调出来，然后没空写 F 了，这里先写个口胡做法，明天打完模拟赛再写。

首先显然每个串对应在键盘上一个固定的子串。相当于给了你若干个子串，然后每个有个贡献的值。要求构造一个排列，求贡献值最大。

这个问题可以放到 ACAM 上解决。具体地，把转换后的子串建成 ACAM，然后在对应的点上记录贡献。然后令 $f_{i,j}$ 表示当前最后一个字符走到点 $i$，且 12 个字符的出现情况状压成了 $j$ 的最大贡献，然后暴力枚举儿子转移即可。时间复杂度为 $O(12\times2^{12}\sum|s|)$，空间复杂度为 $O(2^{12}\sum|s|)$。空间特别小，时间有 4s 的时限。

明天下午回来写。

upd：写了一下，记得 ACAM 空间要开两倍。

https://codeforces.com/contest/1739/submission/174053369