关于 MST，有一个性质，就是把原图的边权拆成很多个部分，然后分别做 MST，新得到的边的集合的 MST 还是原图的 MST。

那么我们就可以尝试着拆边集了。我们考虑点分治，这样可以不漏掉树上任意路径构成的边集，考虑求出经过当前分支中心 $u$ 所有路径对应的 MST，我们记 $v$ 距离 $u$ 的距离为 $d_v$，那么两个点 $i, j$ 所对应的边权即为 $(w_i + d_i) + (w_j + d_j)$，所以我们求出 $w_i + d_i$ 最小的点 $i$，然后其他点向 $i$ 连边即可，但这样我们会把一些不合法的路径加进去，但是我们在继续对子树进行分治时会得到一些更优的边，所以不用管。

点分治选出来的边是 $O(n\log n)$ 的，所以总的时间复杂度为 $O(n\log^2n)$。[Code](https://atcoder.jp/contests/cf17-final/submissions/43750858)