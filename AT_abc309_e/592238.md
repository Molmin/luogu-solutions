[传送门](https://www.luogu.com.cn/problem/AT_abc309_e)    
一眼。
## 题意
有 $n$ 个人，第 $i(i≥2)$ 个人的亲属是 $p_i$。     
这些人买了 $m$ 个保险，第 $i$ 份保险是 $x_i$ 买的，它可以使 $x_i$ 自己和它的下 $y_i$ 代受到保险。   
问你最后又多少人受到了保险。    
## 解法
先考虑朴素做法，即对每一个保险都跑一次 dfs。   
这种做法最坏明显为 $O(n^2)$，无法通过。     
我们发现，如果同样的人买了许多保险，那么我们的朴素做法就多算了很多步，实际上，我们只需要把 $y_i$ 最大的跑一次即可。    
那么我们仿照线段树上懒标记的思想，先把第 $i$ 个人的最大 $y_i$ 找出来，之后再进行一遍以根为起点的 dfs 即可。      
dfs 时我们要记录当前结点上，保险还对下多少代有效。   
时间复杂度为 $O(n)$，可以通过。       
[CODE](https://www.luogu.com.cn/paste/a5clltfq)