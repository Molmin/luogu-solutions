数学性质+DP

首先，我们会发现，编号为x的机器人的老师即为编号为x的因数的机器人（不包括x和1），于是，若机器人y与x有共同老师，当且仅当x,y不互质，因此编号为x的机器人独立数即为φ(x)。

接下来，考虑求出政客和军人的独立数。政客和军人满足一个性质，即：编号x的所有质因数指数都为1。若奇素数y与x互质，则若x为政客，xy为军人；若x为军人，xy为政客。并且，xy的独立数为x的独立数乘y-1（求φ的公式）。因此可以考虑DP求政客和军人的独立数。

欧拉函数φ满足重要性质，即x的因数的欧拉函数之和等于x，因此只需快速幂求m的值，再减去政客和军人，再减1（编号为1的机器人不是其他机器人的老师），即可求出学者。

注意：n=1要特判！否则WA94分。

简洁的代码：
```cpp
#include<cstdio>
const int q=10000;
int p[1009],e[1009],f[1009],g[1009];
int qp(int a,int b){//快速幂
	int r=1;
	while(b){
		if(b&1)r=r*a%q;
		a=a*a%q,b>>=1;
	}
	return r;
}
int main(){
	register int n,i,s=1;
	scanf("%d",&n);
	for(i=1;i<=n;++i)scanf("%d%d",p+i,e+i);
	if(n==1){//特判！
		if(p[1]==2)printf("%d\n%d\n%d",0,0,qp(2,e[1]));
		else printf("%d\n%d\n%d",0,p[1]-1,(qp(p[1],e[1])-p[1]+q)%q);
		return 0;
	}
	if(p[1]==2)f[2]=0,g[2]=p[2]-1;else f[2]=(p[1]-1)*(p[2]-1)%q,g[2]=(p[1]+p[2]-2)%q;
	for(i=3;i<=n;++i)f[i]=(f[i-1]+g[i-1]*(p[i]-1))%q,g[i]=((f[i-1]+1)*(p[i]-1)+g[i-1])%q;//DP，f为政客，g为军人，求军人时要把编号p[i]的机器人加上
	for(i=1;i<=n;++i)s=s*qp(p[i],e[i])%q;//求出m
	printf("%d\n%d\n%d",f[n],g[n],(s+q+q-f[n]-g[n]-1)%q);
	return 0;
}
```
