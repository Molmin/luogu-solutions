~~论出题人czy不会做自己的题~~

~~woc，这jb题写了我一下午！卡常，然后我因为对负数取模，挂了好几次！！！中间LOJ还挂了！~~

哇，又一次开拓眼界了。

首先，如果我们能对每种最终权值，求出生成树个数，那么我们取最大的就好。

咋算呢？位运算启发我们使用FWT。我们记$f[x][y][v]$表示只考虑权值为v的边的基尔霍夫矩阵，对于每个$x,y$，把第三维FWT一下。

然后，对于每个权值v，把它的基尔霍夫矩阵的行列式求出来，把这个新数组FWT回去就是我们要求的。

这里说的FWT是广义的FWT，如果这一位是|,&，就高维前/后缀和；是^就是FFT。