~~这题其实就是个Trie树板子题~~（逃

题目大意是给你若干个单词，以及一台打印机= =

你珂以对这个打印机进行3种操作：

①：在打印机末端添加一个字符(输出添加的单词)

 ②：删除打印机末端的单词(输出一个 '**-**' )

③：打印该单词(输出一个**P**）

要求你在**最少**的步骤内打印出所有单词并输出你的操作。

我们可以把这个打印机想象成一个大的字符串, ①操作就是在字符串末尾**添加**一个字符,②操作就是**删去**字符串末尾的一个字符,③操作就是打印当前的字符串。

这样这道题就看起来很简单了（其实代码也很简单0-0）
我们只需要在Trie树上遍历就可以了。但是题目要求的是最少的操作,所以我们要思考一下怎么去减少操作。

显然，所有单词都是要遍历一遍的，我们无法缩减这个次数，所以我们可以思考怎么减少删除次数。

根据题意我们可以知道：我们在打印完最后一个单词时可以直接输出结果结束程序，不用再去将打印机清空。
这样我们就可以想出一种方法：我们只需要将最长的单词放在最后去打印，这样我们就可以尽量减少删除次数了（因为单词最长所以删除次数也就最多）。

这个思路对吗？事实证明是对的。
所以我们只要对这些单词建树，并在输入的过程中找到最长的单词，在插入这个单词时，跑一遍dfs将从根节点（0号节点）到这个单词的末尾之间的路径（后面为了方便我自己称之为最长单词路径）上的节点都打上一个标记，遍历的时候优先去跑没有标记的节点。这样这道题就完成了。

CODE：


Trie建树基本操作：
```cpp
void ins(string a){
	int u=0;//为了方便根节点为0，从0开始插入
	for(int i=0;a[i];i++){//个人习惯这种字符串遍历方法
		int now=a[i]-'a';//根据情况决定减‘0’还是‘a’
		if(tr[u][now]==0) tr[u][now]=++cnt;
		le[tr[u][now]]=now+'a';//反向记录当前节点所存的字母
		u=tr[u][now];//更新当前位置，继续向下插入
	}
	p[u]=1;//打上结尾标记
}
```
建树过程中的dfs：
```cpp
void dfs(string a){
	int u=0;
	for(int i=0;a[i];i++){  // 将从最长单词路径上的节点全都打上标记 
		int now=a[i]-'a';
		k[tr[u][now]]=1;
		u=tr[u][now];
	}
}
```

遍历的话也是比较简单的：
```cpp
void solve(int now){   //now 为当前位置节点编号
	if(p[now]==1){    //如果是单词结尾 
		ans++;		 //已打印的单词数加一 
		ss+="P";	//直接打印，输出P 
	}	
	
	if(ans==n){	  //如果已经全部打印完了 
		cout<<ss.size()<<endl;  //输出操作步数 
		for(int i=0;ss[i];i++){
			cout<<ss[i]<<endl;  //输出操作顺序 
		}
	}
	 
	for(int i=0;i<26;i++){		//枚举26个字母看是否有路径 
		if(k[tr[now][i]]==0&&tr[now][i]!=0){  //如果存在该节点并且不是 最长的单词路径上的节点 
			
		//	system("pause");
			ss+=le[tr[now][i]];		//将当前字母添加入打印机 
			solve(tr[now][i]);		//继续向下遍历 
			ss+="-";				//遍历完后回溯时要将字母删除，所以输出 - 
		}
	}
	
	for(int i=0;i<26;i++){			//将有标记的节点放在最后去跑 
		if(k[tr[now][i]]==1&&tr[now][i]!=0){	//因为没有标记的节点在之前都已经遍历完，所以这里只需要遍历有标记的 
			ss+=le[tr[now][i]];				   //操作同上 
			solve(tr[now][i]);	
			ss+="-";							
		}
	}
	
}
```
这样这道题就算是完事了。


  AC代码：
[戳这里](https://www.luogu.com.cn/paste/7yrajunm)

**结语:**

这道题拿来练Trie挺好的，还有其他几道Trie的练手题：

[P2922](https://www.luogu.com.cn/problem/P2922)

                                              
[UVA11362](https://www.luogu.com.cn/problem/UVA11362)

[P3879](https://www.luogu.com.cn/problem/P3879)

**最后祝大家2020NOIP RP++**







