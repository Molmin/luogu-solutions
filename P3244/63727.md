这篇题解可能好理解一点？

设每个点入度是$d_i$，如果不加边，答案是
$$
\prod_{i=2}^nd_i
$$
意思是我们给每个点选一个父亲

然后我们加了一条边，最后如果还这么统计，那么有一些不合法的图是$y,\dots,x$形成了一个环，考虑把所有环的方案减掉。

考虑枚举环上的点集$S$，答案为

$$\sum_S\prod_{i\not=s}d_i$$

意思是环上的点钦定父亲，其他的点照旧统计

这个方案数可以dp，设$dp_i$表示$i,\dots,x$形成的环的答案

那么初始值有

$$dp_x=\prod_{i\not=x}d_i$$

然后每个点加入环的时候除上自己的入度，也就是

$$dp_u=\frac{\sum\limits_{(u,v)\in E}dp_v}{d_u}$$

然后这个dp直接在topo图上记搜就可以了