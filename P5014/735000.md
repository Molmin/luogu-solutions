把网格图补全，记第 $i$ 行第 $j$ 个点（标号从 $0$ 开始）的坐标为 $(i,j)$，记最后走到 $(i,j)$ 的路径数为 $f_{i,j}$。设 $u$ 号点的坐标为 $(x,y)$，则不合法路径翻转后对应一条走到 $(y-1,x+1)$ 的路径，故答案即为为 $f_{x,y}-f_{y-1,x+1}$。

考虑如何求 $f$：
$$f_{i,j}=f_{i-1,j-1}+f_{i-1,j}+f_{i,j-1}$$
$$F_i=(1+x)F_{i-1}+xF_i$$
$$F_i=\frac{1+x}{1-x}F_{i-1},F_0=\frac{1}{1-x}$$
$$F_i=\frac{1}{1-x}\cdot(\frac{1+x}{1-x})^i$$
很经典的短多项式快速幂，记 $H=\frac{1+x}{1-x},G=(\frac{1+x}{1-x})^i$，则
$$G=H^i$$
$$G'=iH^{i-1}H'$$
$$G'H=iGH'$$
$$\frac{1+x}{1-x}G'=\frac{2i}{(1-x)^2}G$$
$$(1-x^2)G'=2iG$$
观察两边 $n$ 次项系数可得
$$(n+1)g_{n+1}-(n-1)g_{n-1}=2ig_n$$
$$g_{n+1}=\frac{2ig_n+(n-1)g_{n-1}}{n+1}$$
易知 $g_0=1,g_1=2i$，$f$ 为 $g$ 的前缀和，递推即可求出单行 $f$ 值。

时间复杂度 $\mathcal{O}(T\sqrt{u})$。