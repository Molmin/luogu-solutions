把整个图向左推平，就成了一个网格图（半角）。

设走到第 $n$ 行 $m$ 列，枚举走斜边的次数 $d$，从 $n+m-d$ 中选 $d$ 步走斜边；剩下的可以看成走到第 $n-d$ 行 $m-d$ 列，只能横竖走的方案数。

考虑计算走到 $n$ 行 $m$ 列，只能横竖走的方案数：我们知道 $n=m$ 时，就是 Catalan 数列。  
类比这个式子，稍加思索就能发现答案是

$$\binom{n+m}{n}\frac{n-m+1}{n+1}$$

所以最终答案为

$$(n-m+1)\sum_{d=0}^m\frac{(n+m-d)!}{d!(n-d)!(m-d)!(n-d+1)}$$
直接计算就能 $\Theta(m)$ 解决，可以通过本题。

注意到这个和中的每一项，关于 $d$ 都为整式递推数列，所以前缀和也是整式递推数列，套用 [这个模板](https://www.luogu.com.cn/problem/P6115) 就可以将时间复杂度优化到 $\Theta(\sqrt m \log m)$。