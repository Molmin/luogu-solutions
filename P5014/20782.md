这道题。。和[原来的题目](https://www.luogu.org/problemnew/show/U49214)相比就是把点放在了不是左下角的地方。然而如果真正理解了之前给出的解法并且深入了解了卡特兰数，那么这道题也是变一下就可以的了。

[原来的题目的题解地址](https://www.luogu.org/blog/20782/solution4)(请手动翻到T3的位置)

依旧是老的配方，我们可以考虑枚举走横边的条数，然后考虑后一部分的走法。由于不是走到右下角，所以就不是标准的卡特兰数了。

关于卡特兰数的一个公式：

$$Catalan_n=\binom{2n}{n}-\binom{2n}{n-1}$$

如果知道了这个东西的来历，那么就非常好办了。

我们知道卡特兰数的一个作用是计算合法的括号序列的个数。这个可以转化成在笛卡尔坐标系的原点向上或者向右走，并且不越过直线$y=x$的方案数。

我们可以考虑先把穿过了直线$y=x$的方案算进去，然后最后再减掉。那么直接走的话就可以用组合数$\binom{2n}{n}$表示在$2n$步中选择$n$步走向上，其他走向右的方案数。显然我们还需要减掉一些多走了的。

可以考虑这样去思考：我们将第一次越过直线$y=x$后的所有走法全部换一下，就是向上变成向右，向右变成向上，这样的话就**一定**会有$n-1$步向上，$n+1$步向右。然后就肯定会走到$(n+1,n-1)$。走到这里的方案数就是$\binom{2n}{n-1}$(和上面的组合数是一样的意思)，也就是不合法的方案数。

然后用$\binom{2n}{n}-\binom{2n}{n-1}$得到了合法的方案。

仿照卡特兰数，我们可以考虑走$n$步向上，$m$步向右($n>m$)且不超过直线$y=x$的方案数。此处的$n$为询问点的层数减去走横向边的个数，$m$为询问点从左往右数是第几个减去走横向边的个数-1。这个转换可以思考一下。

然后按照之前的思路，这里的答案就变成了$\binom{n+m}{n}-\binom{n+m}{n-1}$。用这个去替换掉原来标程的$Catalan(n-i)$就好了。