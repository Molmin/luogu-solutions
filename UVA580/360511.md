# 递推

### 前言

$\text{Update 2020/12/17:}$ 修改了文章部分错误内容。

题目链接：[$\text{Link}$](https://www.luogu.com.cn/problem/UVA580)。

机房里老师刚刚讲完，这里就补一篇题解吧。

~~花了好久才研究明白。~~

### 题目描述

你有 $n$ 个盒子，第 $i$ 个盒子可以放铀或者铅，问至少有 $3$ 个放铀的盒子放一起的话，有多少种方法。

### 题目解析

设 $f_i$ 为 $i$ 个盒子合法放置的方案数。

记铀为 `U`，铅为 `L`。

对于放置第 $i$ 个盒子，有两种情况：


- 前 $i-1$ 个盒子已经合法了。

- 前 $i-1$ 个盒子不合法但是放上这个盒子就合法了。

----


先来看第一种情况，由于前 $i-1$ 个盒子已经合法，那么第 $i$ 个盒子既可以放 `U` 也可以放 `L`。有两种情况，所以总共有 $2f_{i-1}$ 种情况。

再来看第二种情况，要想让第 $i$ 个盒子一旦放上去就合法，那么前 $3$ 个盒子肯定是 `LUU`，既然 $i-3$ 至 $(i-1)$ 个盒子已经定下来了，而又需要前面这 $i-1$ 个盒子不合法，所以就是求编号为 $1$ 至 $i-4$ 的盒子不合法的情况，不难想到，不合法的方案数 $=$ 总方案数 $-$ 合法方案数，$i-4$ 个位置的总排列数为 $2^{i-4}$，合法方案数其实就是已经求出来的 $f_{i-4}$，就得到不合法方案数 $=$ $2^{i-4}-f_{i-4}$。

将两种方案加起来，就得到 $f_i$ 的状态转移方程：

$$f_i=2f_{i-1}+2^{i-4}-f_{i-4}$$

另外要边界条件：$f_3=1,f_4=3$。


时空复杂度：$O(n)$。


[$code$](https://paste.ubuntu.com/p/zNBbxHbrDm/)

$$\texttt{The End.by UF}$$