## 题目大意

给你平面上 $N$ 个点的坐标，问你有多少对点的欧几里得距离 $\leqslant K$，按字典序从小到大输出它们。

保证答案点对数不超过 $4\times10^5$。

## 题解

诡题。

平面分块，划分成 $K\times K$ 的正方形。

然后点 $(x,y)$ 属于正方形 $([x/K],[y/K])$。

假如一个点在的正方形为 $(a,b)$，则和这个点距离小于等于 $K$ 的点必然只会在 $(a+c,b+d),-1\le c,d\le 1$。

然后我们暴力枚举每个点以及以其正方形为中心的九宫格中的每个点判断是否合法。

输出即可。

接下来证明复杂度的正确性。

观察到一个正方形内的点是很容易满足条件的。我们设正方形内有 $x$ 个点，我们证明其有 $O(n^2)$ 个满足条件的点对。

我们将这个正方形划分成四个 $(K/2)\times(K/2)$ 的小正方形，观察到小正方形内的点对必然满足条件。我们设四个小正方形分别有 $a,b,c,d$ 个点。

我们有 $a+b+c+d=x$，不妨设 $a\ge b\ge c\ge d$，因此 $a\ge \frac{x}{4}$，所以至少有一个小正方形内有 $\frac{a(a-1)}{2}$。

所以是 $O(x^2)$ 的，带小常数。

设 $B_{i,j}$ 表示 $(i,j)$ 内的点数。那么我们有 $\sum_{i,j}B_{i,j}^2\le 400000\times C$。

我们匹配相邻九宫格的复杂度是 $B_pB_q$，显然其 $\le \max^2(B_p,B_q)$，因此总复杂度还是 $C\sum_{i,j}B_{i,j}^2$，也就是 $\le 400000C$。

重新考虑这个过程，发现只需要随便设一个比较合适的正方形大小，比如说 $\sqrt 2 K\times \sqrt 2K$ 之类的正方形大小，复杂度也是对的。