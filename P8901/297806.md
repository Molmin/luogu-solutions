- [原题链接](https://www.luogu.com.cn/problem/P8901)

- 赛时想法，有问题欢迎提出。

------------

首先不难发现每个房间的输赢互不干扰。接着便有第一个结论，对于一个拥有 $x$ 头奶牛的房间来说：$4 \mid x$ 则先手必胜，否则先手必败。此结论打表易得，证明的话考虑数学归纳，读者自证不难。

既然有这一点，那对于一个必胜的房间，玩家当然是想要快点胜利，反之若是必败的房间，则想能拖则拖。据此对于任意一个房间，双方都会有既定的最优策略，换句话说，每个房间赢家胜利所需的轮数是一定的。

而只要对每个房间求出轮数，就可以知道谁先获得胜利了。

接下来考虑如何求这个轮数，用 $f(x)$ 表示 $x$ 初始头奶牛的轮数，若 $4 \mid x$，$f(x)$ 则由最大满足 $x-y$ 为 $1$ 或者为质数的 $f(y)$ 转移而来，反之则由最小的满足 $x-y$ 是质数且 $4 \mid y$ 的 $f(y)$ 转移过来。

当然以上做法已经可以求解了，因为根据质数的稠密性，暴力找复杂度是没有问题的，于是问题解决。

[代码](https://www.luogu.com.cn/paste/bjlkpl36)