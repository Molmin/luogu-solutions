审题解的时候看见有个这题题解，瞄了一眼，看到一个『以两位为单位保存信息』，于是就感觉很会了！是好题。

首先，考虑将长度 $150$ 的序列每两位分一段，每一段若有一个位坏掉就都是 $0$（称之为坏段），否则以三进制存储信息。这样的话，最多能有 $40$ 个坏段，则只能表示出 $3^{35}$ 级别的数，显然无法通过。

考虑随机化：让 Anna 和 Bruno 都使用同一个随机排列来遍历数组。我采用的是标准库里的 `mt19937`，如果种子一样，生成的序列也一样。也可以直接打表出一个随机排列。

这样可以使一些坏段拥有两个坏位，就减少了坏段的数量。~~期望懒的算了~~，但是这样就可以获得 $90$ 分，通过 $L \le 38$ 的测试点。

考虑将坏段利用起来：如果一个坏段有一个好位，并且将这个好位置为 $1$ 时，它和 $X$ 当前三进制最低位的表示恰好相同，那么就可以利用上这个坏段表示三进制的一位。

~~期望还是懒的算了~~，但是这样就可以通过。因为是随机的顺序，所以 $K$ 一定时任何数据对它都是一样的，所以能反映出它正确率是很高的。

在代码实现中，三进制的表示为 $0 \to 10$、$1 \to 11$、$2 \to 01$。

[代码](https://qoj.ac/submission/100008)。