枚举询问串的断点 $i$。

要让 $p[1, i]$ 在 $s$ 中出现，$p[1, i]$ 应为 $s$ 某后缀的前缀，不难证明这样的后缀为 $sa$ 中的一段区间。

随着 $i$ 的增大，区间不断变小，使用双指针维护。

为了尽可能存在解，$a, b$ 应尽量靠前，因此 $a$ 选择 $sa[l, r]$ 中的最小值，预处理 ST 表以实现 $\mathcal O(1)$ 查询。

对于一个断点 $i$ 选定了 $[a, b]$，现在需要选定 $[c, d]$。

为了尽可能存在解，$c, d$ 应尽量靠后，将串翻转转化为上面的问题。

对于每一个端点做完决策后检查合法性，即是否有 $b \lt c$。

时间复杂度 $\mathcal O(nm)$。