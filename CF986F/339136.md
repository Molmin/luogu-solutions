转化为不同质因数能不能凑出来 $n$，证明不赘述

若 $k$ 质因数个数不超过 $1$，是平凡的

若 $k$ 质因数个数为 $2$，exgcd 算算即可，你甚至可以枚举大质因子的使用次数，然后利用小凯的疑惑那个上界可知使用次数估计也就根号级别，那 $50\sqrt{k}$ 说不定也能跑

若 $k$ 质因子个数超过 $3$，考虑最小的那两个乘起来不超过 $\sqrt{k}$，设其为 $p_1,p_2$，则只需要考虑 $p_1\times p_2-p_1-p_2$ 以内的这些数，那直接做背包就差不多了，当然乘个 $50$ 可能跑不了，但是可以 bitset 再除个 $w$，那就能跑了

若 $k$ 质因子个数为 $3$，设为 $p_1<p_2<p_3$，同样考虑小凯的疑惑的结论，只需要解决 $p_1\times p_2-p_1-p_2$ 以内的数。如果能对于每个 $k$ 枚举 $p_2,p_3$ 使用次数的话，记一下模 $p_1$ 下所有余数对应的最小的 $xp_2+yp_3$，就行了，但这玩意单次预处理复杂度 $k^{\frac{2}{3}}$，不是很行

那么设一个块长 $B$，枚举 $p_3$ 使用次数，再枚举 $p_2$ 使用次数除 $B$ 下取整，然后每次询问枚举 $p_2$ 使用次数模 $B$，如果取 $B=k^{\frac{1}{6}}$ 的话，有关 $B$ 的复杂度大概是 $Tk^{\frac{1}{6}}+50\sqrt{k}$，在算量上仍有差距，可以适当调大 $B$ 使得后面那项较小，基本可以通过（其实这玩意没啥常数，跑起来可快了）