这一题其实想通了就不是很难。

根据规律发现，$f(1),f(3),f(5),f(7),f(9),f(15)$ 等数字都满足条件。

然后可以证明出来，如果 $f(n)=n$，那么 $n$ 的二进制下一定是一个回文数。~~但是我不会证233~~。

然后考虑怎么统计答案。

题目范围：$m \leqslant 10^{100}$。

首先，我们记 $p(i)$ 为 $i$ 在二进制下的位数。

##  部分 $1$：

对于 $1 \leqslant p(i) < p(m)$ 的所有数，求回文数数量。如果一个正整数 $x$ 位数 $p(x) < p(m)$，固定二进制下两端的数字（定为 $1$），接下来 $p(x)$ 如果为奇数，回文数数量就是 $2^{\frac{x-1}{2}}$，如果 $p(x)$ 为偶数，回文数数量就是 $2^{\frac{x}{2}-1}$。

然后归纳一下，长度为 $r$ 的二进制数，回文数数量为 $2^ {\left\lfloor{\frac{r-1}{2}}\right\rfloor}$。

也就是，最后的回文数数量就是：

$$
\sum_{i=1}^{i<p(m)} 2^ {\left\lfloor{\frac{i-1}{2}}\right\rfloor}
$$

## 部分 $2$

既然算出了位数小于 $p(m)$ 的回文数数量，接下来考虑怎么算位数等于 $p(m)$ 的回文数数量。

考虑回文数具有对称性。

也就是说一个回文数的后半部分翻转过来，应该要和前半部分相同。

那么，将 $m$ 转成二进制，分成前后两个部分。

例如 $m=(1001001001011111)_2$

将它分成 $(10010010)_2$ 和 $(01011111)_2$，用高精度算出前面一个部分 **除去首位的 $1$** 所代表的二进制数。

如果一个数字转成二进制数字后和前半部分位数相同，并且小于前半部分的总和，那么这一个数字化成二进制后可以当成回文数字的前半部分，后半部分肯定可以找到相应部分。

也就是，这一个的贡献就是前半部分代表的数字(要除去首位的 $1$)的总和。

最后再考虑一下前半部分的一个总体和后半部分是否可以构成回文数即可。

