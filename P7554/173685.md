首先有满足题意的 $h$ 是一段前缀，我们要找到最后那个位置。

所以只有询问，不难想到使用莫队。由于插入和查询的次数不对等，所以可以再对值域分块，插入 $O(1)$，查询一次答案 $O(\sqrt n)$。

实现的时候就维护每个值上的元素个数以及每个值域块内的元素个数，查询先扫大块，找到一个块使得它左端点满足题意就从这个块右边暴力扫即可。

时间复杂度 $O(n\sqrt n)$。

[code](https://www.luogu.com.cn/paste/gzpz2v2d)

