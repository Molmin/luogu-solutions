这里提出一种**非正解**但在官方数据下能够通过的做法。

首先不难证明差分单谷，这一部分可以参考其它题解。

接下来不难想到按顺序搜索每种差分在两边放几个。可能很多人以为这个算法效率是很劣的，但实际上我们可以用一个简单的 dp 来计算这种算法的效率。

下面我们严格证明上述算法能够取得至少 $84$ 分。

记 $a_i$ 的最大值为 $m$，不妨设 $a_1=1$。设 $b_i=\sum_{j=1}^n [a_j=i]$，即 $b_i$ 表示权值为 $i$ 的差分个数，显然有 $\sum_{i=1}^{m-1} i\times b_i= m-1$。

在上述搜索算法中，显然 $0$ 一定在最中间因此无需考虑。因此上述算法的效率为 $O(\prod_{i=1}^{m-1} (b_i+1))$。

考虑 dp：设 $f_{i,j}$ 表示前 $i$ 种差分的权值，和为 $j$，即 $\sum_{k=1}^i k\times b_k=j$ 时，$\prod_{k=1}^i (b_k+1)$ 的最大值。

则转移为：

$$f_{i,j}=\max\limits_{k=0}^{\lfloor \frac{j}{i} \rfloor}\{f_{i-1,j-k\times i}\times (k+1)\}$$

初始化为 $f_{0,0}=1$，答案即为 $f_{m-1,m-1}$。

当 $m\le 50$ 时，$f_{m-1,m-1}\le 3600$。因此对于测试点 $1\sim 8,16\sim 18,23\sim 25$，效率为 $O(3600n)$，能够通过。

对于测试点 $9\sim 12$，不难证明最低效率为 $O(2^{20})$，能够通过。

对于测试点 $13\sim 15$，计算可得 $f_{m-1,m-1}\le 30000$，因此效率为 $O(30000n)$，也能够通过。

因此上述搜索至少能取得 $84$ 分，并且笔者在考场上实现的也是上述做法（包括用于计算效率的 dp），最终在官方数据下取得了 $100$ 分的好成绩。