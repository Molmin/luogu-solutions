几乎是对于 EI 的题解的人话翻译。

首先转为计算概率。这只需要最后乘上 $n!$。  
我们考虑一个在 $(0,1)^n$ 上均匀随机的实数序列 $a_1,a_2,\dots,a_n$，将其排出排名。我们知道两个实数相等的概率是 $0$，所以这是良定义的。  
然后根据强烈的对称性，我们知道所有 $n$ 阶排列也满足同样的分布。这就是说，我们考虑 $a_1,a_2,\dots,a_n$ 序列的一种排名的出现概率就等价于同种排列的出现概率。

考虑令 $a_0 = 0$，我们做其差分 $b_i = (a_i - a_{i-1}) \bmod 1$。由于 $a_i \in (0,1)$，我们知道可以通过 $b_i$ 序列唯一确定 $a_i$ 序列。  
同时，我们注意到 $b_i = a_i - a_{i-1} + [a_i < a_{i-1}]$。则可知 $\sum b_i = a_n + n-1-k$。由于我们知道 $n-1-k$ 必然是 $\sum b_i$ 的整数部分，所以实际上我们仅考虑 $b_i$ 序列的分布和其 $\sum b_i$ 即可对 $n-1-k$ 进行限制。

于是现在问题转化为计算 $b_1,b_2,\dots,b_n \in (0,1)^n$ 且 $\sum b_i \in (n-1-k,n-k)$ 的概率。  
我们可以差分为 $\sum b_i < n-k$ 和 $\sum b_i < n-1-k$。

然后接下来的一步或许会让大部分读者有些匪夷所思。我将尽我所能让您理解。  
形象地，假设我们给定 $n$ 个 $(0,1)$ 内的区间 $(l_i,r_i)$，问 $\forall i,b_i \in [l_i,r_i]$ 的概率。那自然是 $\prod \frac{r_i-l_i}{1-0} = \prod (r_i - l_i)$。  
我们发现，如果我们有办法用一个图像刻画出这个序列落在每一种可能性中是合法或非法，那么事实上最终的答案就是这个图形的「面积」（这也是我们选择 $(0,1)$ 的原因）。

接下来我们考虑用容斥来刻画这个图形的「面积」，这是为了去除 $b_i < 1$ 的限制。  
首先我们考虑 $b_i$ 完全没有上界，$\sum b_i < n-k$ 的「面积」。  
我们转为考虑 $s_i = \sum_{j \le i} b_j$ 的「面积」，如果不考虑大小关系，它其实就是 $(n-k)^n$。但是我们又要求 $b_i > 0$，因此 $s_i$ 必须是上升的，因此我们再除以 $n!$。  
对于某些 $b_i$ 被钦定 $\ge 1$，我们可以从总和中减去这些 $1$，然后就转为了前文的问题。  
总结一下就是
$$
\sum\limits_{i=0}^{n-k} (-1)^i \binom ni \frac{(n-k-i)^n}{n!}
$$

可以卷积解决。