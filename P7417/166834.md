好题。

首先很显然的是，题目给出的约束相当于 $1$ 到所有点经过奇数和偶数条边的最短路。我们的任务就是构造一张图，在 $1$ 到所有点奇偶最短路不变的情况下最小化边数。

首先先判掉两种简单情况，一个是原图为二分图，另一个是 $1$ 有自环。原图为二分图的情况答案为 $n-1$，即构造原图的最短路树。最短路树存在是因为最短路转移为 DAG（无负环）。$1$ 有自环的情况答案即为原图，显然构造不出更优的解。

我们考虑将一个点看做点对 $(x,y)$，满足 $x<y$，即奇偶最短路的较小值和较大值组成的二元组。我们发现要使得 $(x,y)$ 成立，要么存在 $(x-1,y-1)$ 向其连边，要么同时存在 $(x+1,y-1),(x-1,y+1)$ 向其连边。特别的，当 $y=x+1$ 时，$(x+1,y-1)$ 与 $(x,y)$ 等价（准确地说，$(x+1,y-1)$ 应当写作 $(y-1,x+1)$。

转移显然分为两类，其中一类可以无后效性地处理，另一部分无法避免后效性。那我们只能放弃 dp，考虑贪心。

对于当前状态 $(x,y)$，我们不仅要考虑当前状态，还要考虑 $(x-1,y+1)$ 带来的后效性。具体体现在 $(x+1,y-1)$ 每存在一条向 $(x+2,y-2)$ 连的边，就要有一条连向 $(x,y)$ 的边。这类边必须连，并且可以对于 $(x,y)$，需要付出的代价仅为 $1$，无疑是可以提前的。在存在 $(x-1,y-1)$ 的情况下，我们显然可以把剩余的点直接连上去，否则就只能向前向后连边，这样不但对后来有影响，并且代价为 $2$，优先级最低。

其实上面说代价为 $2$ 并不严谨，因为这条边可能会使 某个$(x+1,y-1)$ 代价降为 $1$，但这样平均一下是 $1.5$，仍然不优。

需要讨论的情况很多，建议思考完备再写代码。