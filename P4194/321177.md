本质上是要构造一个值域在 $[L,R]$ 的矩阵 $B$，对于每一行每一列，使得 行或列内 $|\sum A-\sum B|$ 的最大值最小。

这个最大值最小可以想到二分，由于 $A$ 完全已知，这样实际上限制了 $B$ 每一行每一列的和范围在 $[sum-mid,sum+mid]$ 之间，而每个格子的值在 $[L,R]$ 之间，考虑有源汇上下界可行流。

源点向表示行的点连边，上下界如上所述，表示列的点向汇点连边，上下界同理。其余两点之间连 $[L,R]$ 的边。

提一嘴有源汇上下界可行流怎么做。

基础是无源汇可行流，假定全都以下界为流量，建超级源点超级汇点，超级源点连流入更多的，超级汇点连流出更多的（实际上就代替了下界的网络），这样跑最大流，如果能流满超级源点流出的边，就说明是可行的。

而有源汇只需要让流量像无源汇一样转起来，于是汇点向源点连一条没有限制的边即可。（若要求一个可行流流量，那么这条边的流量即为所求）