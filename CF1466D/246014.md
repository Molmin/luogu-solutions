## CF1466D 【13th Labour of Heracles】

### 题意

+ $n$ 个点的树，每条边有一个颜色，每个点有一个点权 $a$；
+ 连通块的权值为子块上所有点的权值和；
+ 颜色为 $i$ 的同色子图为所有颜色为 $i$ 的边和与这些边相连的点组成的子图，权值为该同色子图的所有连通块中最大的权值；
+ 树的权值定义为所有同色子图的权值和；
+ 对于任意 $x\in[1,n)$，求当有 $x$ 种不同的颜色时，树可能的最大权值；
+ 多组数据，$n\le10^5,a_i\le10^9$。

### 做法

因为同色子图的权值仅仅和权值最大的连通块有关，所以容易想到同色子图一定要连通。否则，对于每个同色子图，一定可以把权值不是最高的连通块内的边改成已经存在的颜色，结果一定不会更劣。

现在每个点的贡献为与它相连的边的颜色种数乘该点的权值，最大的贡献为它的度数乘该点的权值。每多一个颜色，有且只有一个点的贡献再加上一次它的权值。

贪心地，选权值更大的点增加贡献一定不会更劣，当然前提是该点贡献未达到最大的贡献。