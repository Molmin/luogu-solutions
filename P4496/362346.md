补充一下这题一个关键基础结论的证明。（感觉它并不像其它题解说的那么显然）

首先发现题目中两个维度是相对独立的，所以不妨考虑一维的情况。

明确一下我们要证的命题：

> 一维数轴上有 $N$ 个旧点，它们的坐标用数列 $X$ 描述。你需要放置 $M$ 个新点。给定旧点与新点之间的权值矩阵 $A$ 和新点与新点之间的权值矩阵 $B$，某个点对产生的代价即为：两个点之间的距离乘上对应点对的权值。

> 试证明：对于任意的五元组 $(N,M,X,A,B)$，当所有点对的权值和最小时，对任意的新点，一定存在一个旧点与它坐标相同。

考虑数学归纳法。

如果某个新点的坐标不与任意一个旧点的坐标相同，则称这个新点为 "坏点"。称所有的旧点为 "好点"。

$M=1$ 的情况是显然的。

假设命题对 $M=k$ 成立。也就是说，如果 $k$ 个新点中存在一个坏点，这样的情况一定不优。考虑 $M=k+1$ 的情况。

首先我们知道，当前 $k$ 个新点的坐标确定时，第 $k+1$ 个新点的坐标一定和某个旧点或前面的新点的坐标相同。

假设前 $k$ 个新点中存在至少一个坏点，我们要证明这样一定不优。

分类讨论：

+ 第 $k+1$ 个新点的坐标和好点的坐标相同。

我们可以把第 $k+1$ 个新点和与它坐标相同的那个旧点合并，也就是说，将这个旧点对前 $k$ 个点的权值累加上第 $k+1$ 个新点对前 $k$ 个点的权值。

这样问题就转化为 $M=k$ 的情况，因为前 $k$ 个新点中至少有一个坏点，根据归纳假设，这样的情况一定不优。

+ 第 $k+1$ 个新点的坐标和坏点的坐标相同。

类似地，我们可以把第 $k+1$ 个新点和与它坐标相同的那个新点合并，把问题转化为 $M=k$ 的情况。

根据上述讨论可得，最优情况下，前 $k$ 个新点一定都是好点。又因为最优情况下， 第 $k+1$ 个新点的坐标和前面某个点的坐标相同，所以第 $k+1$ 个新点也是好点。命题对 $M=k+1$ 成立。

综上，命题得证。