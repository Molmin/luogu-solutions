先从 DP 考虑。以计划做状态不好，因为表示不了具体的感染人数。

发现关键在于两端，最后必然是 $1$ 这一端病毒没了，然后只会有病毒从另一边往 $1$ 扩散，$n$ 那一端同理。

所以 DP 就应该设计成 $f_i$ 表示使得 $[1,i]$ 中没有病毒的最小代价。注意这个 DP 不一定是按时间转移的，只要两段治疗计划拼的上就行。

从另一个角度考虑。可能会想到每天感染者的段会扩张。不如反过来，相当于每天之前的治疗计划会缩小，直到某次用新的计划和它拼接起来，直到最终拼成 $[1,n]$。

综合起来，我们的方案是：从 $1$ 这一端开始，每次拼接一段治疗计划直到拼到 $n$ 端，这样的话，每次拼完之后一定是 $[1,i]$ 的一段。

其实这玩意有点像最短路：推一下能知道 $i,j$ 能拼在一起的条件是 $r_i-l_j+1\ge |t_j-t_i|$，代价在点上。

大概是可以直接主席树优化建图的？

权在点上的最短路有一个性质：每个点最多被松弛一次。

拆开绝对值，以 $r_i-l_j+1\ge t_j-t_i\Rightarrow r_i+t_i+1\ge t_j+l_j$ 为例，按照 $t$ 为下标建立线段树，线段树上每个点维护 $t_j+l_j$ 的最小值，只要最小值 $\le r_i+t_i+1$ 就暴力递归松弛，松弛完最小值直接设为 $\inf$。时间复杂度 $O(n\log n)$。