怎么贪心[这篇题解](https://www.luogu.com.cn/blog/LaoMangnoblog/solution-cf1367f2)讲得很好，这里补充一下为什么

> 题面等价于选出一个单调递增的子序列，满足剩下的所有数要么比该子序列中最小的数小，要么比该子序列中最大的数大，求子序列最长长度。

。

显然，如果这样构造，只需要按顺序把没选中的数往前放或往后放即可。

假设我们选中了一个递增序列，但是夹着一个 $x$ 值域在这个序列中但没有被选中。设选中了 $y$ 个数小于 $x$，则需要把这 $y$ 个数都移到后面去，把 $x$ 前移，再把这 $y$ 个数往前移，总共需要 $2y+1$ 次操作。而直接选中所有大于 $x$ 的数显然只需要 $y+1 \le 2y+1$ 次操作。