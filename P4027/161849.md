设 $f(i)$ 为第 $i$ 天的最大钱数，$g_{1}(i)$ 为 A 券的第 $i$ 天能换的数量，$g_{2}(i)$ 则为 B 券。

转移可以解方程得：
$$
f(i)=\max\{f(i-1),a(i)g_{1}(j),b(i)g_{2}(j)\},j\in[1,i) \\
g_{1}(i)\frac{f(i)rate(i)}{a(i)rate(i)+b(i)} \\
g_{2}(i)=\frac{f(i)}{rate(i)\times a(i)+b(i)} \\
$$
两个 $g$ 都没啥问题，主要来看 $f(i)$。提一下可得：
$$
f(i)=\max\{b(i)\max_{j=1}^{i-1}\{\frac{a(i)}{b(i)}g_{1}(j)+g_{2}(j)\},f(i-1)\}
$$

斜率优化的形式，但斜率并无单调性。那个 $f(i-1)$ 可以最后来线性做，所以可以先不管。然后就是 li-chao tree 的板子。