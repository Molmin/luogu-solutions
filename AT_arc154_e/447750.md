对于排列 $q$，定义 $f(q)=\sum_{i<j,q_i>q_j}(j-i)$。给定排列 $p_{1\cdots n}$ 以及 $m$，执行 $m$ 次以下操作：

- 随机选择 $1\leq i\leq j\leq n$，翻转 $p_{i\cdots j}$。

对于 $\left(\frac{n(n+1)}{2}\right)^m$ 种可能操作，求最终的 $f(p)$ 之和 $\bmod 998244353$ 的值。

$n,m\leq 2\times 10^5$。

#### 如何求 $f(p)$

定义 $q_i$ 为 $p$ 的逆排列，注意 $q$ 和 $p$ 的对称性。

对于值为 $i$ 来拆贡献：$\sum_{i}(\sum_{j<i\land q_i<q_j}1-\sum_{j>i\land q_i>q_j}1)\times q_i$。交换 $i$ 与前一个元素，讨论得无论前一个数与它的大小关系，括号里的值总会减少 1。同样地，交换其与后一个元素，括号里的值总会增加 1。对于 $p_i=q_i=i$ 时，括号里的值是 0，则最终 $f(p)=\sum (q_i-i)q_i=\sum(i-p_i)i=\sum i^2-i\times p_i$。

#### 如何求 $\sum i\times p_i$

求出期望之后乘可能数就是和。于是转而求 $\sum i\times p_i$ 的期望，对称为 $\sum i\times q_i$，不妨求 $\sum i\times E(q_i)$，即每个 $p_x=i$ 的最终位置的期望。接下来是一个重要观察：

> 若 $x$ 被操作到且翻转到 $y$，则一定有同样概率的 $x$ 被翻转到了 $n-y+1$。

这是因为，$x$ 翻转到 $y$ 的方案数为 $\min\{x,n-x+1,y,n-y+1\}$，则翻转到 $n-y+1$ 显然方案数相同。也就是如果被某次操作包括，其对应位置的期望值一定是 $\frac{y+n-y+1}{2}=\frac{n+1}{2}$，与 $x$ 无关。

不妨设 $p=\frac{\binom{x}{2}+\binom{n-x+1}{2}}{\binom{n+1}{2}}$，即一次操作**不**包括位置 $x$ 的概率。则如果 $m$ 次操作里至少有一次包含了位置 $x$，则最终它的位置期望是 $\frac{n+1}{2}$。则初始位置为 $x$ 最终位置期望为 $p^m\times x+(1-p^m)\times \frac{n+1}{2}$。

至此，可以以 1log 的复杂度内计算出 $E(\sum i\times p_i)$，进而求出所需的和。