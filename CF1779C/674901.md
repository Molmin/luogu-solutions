令 $s_i$ 为 $\sum_{i=1}^i a_i$ 的值。

为了让 $s_k = \max_{i=1}^n s_i$，需要满足下面的两个条件：

+ $s_i\le s_k$，$i < k$。（条件 $1$）
+ $s_i \le s_k$，$i > k$。（条件 $2$）

对于条件 $1$，可以使用一个大根堆，每次选出最小值进行操作。

对于条件 $2$，可以使用一个小根堆，每次选出最大值进行操作。

容易发现时间复杂度是 $O(n\log n)$ 的。