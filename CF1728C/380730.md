好题。

我们发现，$f(x)\leq x$，其中等号成立当且仅当 $x=1$。所以我们发现 $a, b$ 中最大的数一定要做一次操作。又根据最后是排序比较，启发我们用两个堆，一个保存 $a$ 数列，一个保存 $b$ 数列。

每次在两个堆中各弹出一个值，有以下两种情况：

1. 堆顶相等，全部弹出，再做一遍。
1. 堆顶不等，对较大那个进行一次操作，累加答案。

因为上面的第二种情况时每次弹出的都有 $a, b$ 两数列共 $2n$ 个数的无法不操作就匹配的最大值，所以可以证明上面的步骤得到的答案是最优解。

代码：[178922985](https://codeforces.com/contest/1728/submission/178922985)。