## CF1539E 【Game with Cards】

### 题意

+ 有两个数 $b,c$，初始均为 $0$；
+ $n$ 次操作，第 $i$ 次把 $a_i$ 赋值给 $b$ 或 $c$，接着要满足 $l_{0,i}\le b\le r_{0,i},l_{1,i}\le c\le r_{1,i}$；
+ 判断是否有方案，有就输出；
+ $n\le10^5,a_i\le10^9$。

### 做法

把赋值给 $b$ 用 0 表示，赋值给 $c$ 用 1 表示。

假设一段极长的 0 位于 $[x,y]$，需要满足：
1. 任意 $x\le i\le y$，$l_{0,i}\le a_i\le r_{0,i}$；
2. 任意 $x\le i\le y$，$l_{1,i}\le a_{x-1}\le r_{1,i}$。

设 $dp_{0,i}$ 表示 $i$ 为一段极长 0 的末尾时，$[1,i]$ 能否满足条件。

发现能转移到 $dp_{0,i}$ 的所有 $j$ 的 $a_j$ 都互不相同，没有单调性，很难快速维护。

但是发现当 $x$ 相同的时候，$y$ 越小越容易满足单调性（两条限制均变少），可以考虑从后往前 DP。

设 $dp_{0,i}$ 表示 $i$ 为一段极长 0 的开头时，$[i,n]$ 能否满足条件。

记录最小的 $i$ 使 $dp_{0,i}=1$。动态维护是否满足转移的条件，满足即转移。