作为手写过 AES-128 加密的蒟蒻，对于有限域当然是非常了解的（毕竟 ASE-128 加密就是以 $n=256$ 时的有限域为基础的）。在下文中，我们称题目中给出的 $n$ 元有限域为 $GF(n)$。

首先有两个结论：如果 $n$ 可以表示为 $p^k$（$p$ 为质数）次方的形式，那么一定有一个有限域满足题目中的条件。

那么我们以 $n=256=2^8$ 举例，说明这个有限域的运算规则。

### 首先是加法：计算 27 + 253。

第一步，将这两个数表示为多项式形式：

$27=0x^7+0x^6+0x^5+1x^4+1x^3+0x^2+1x^1+1x^0$

$253=1x^7+1x^6+1x^5+1x^4+1x^3+1x^2+0x^1+1x^0$

第二步，加起来（注意系数要 $\bmod\ p$）：

$27 + 253$

$ = (0x^7+0x^6+0x^5+1x^4+1x^3+0x^2+1x^1+1x^0)+(1x^7+1x^6+1x^5+1x^4+1x^3+1x^2+0x^1+1x^0)$

$ = 1x^7+1x^6+1x^5+0x^4+0x^3+1x^2+1x^1+0x^0$

$ = 230$

### 第二是乘法：计算 25 * 73。

第一步，将这两个数表示为多项式形式：

$25=0x^7+0x^6+0x^5+1x^4+1x^3+0x^2+0x^1+1x^0$

$73=0x^7+1x^6+0x^5+0x^4+1x^3+0x^2+0x^1+1x^0$

第二步，将这两个多项式乘起来！（注意系数仍然要 $\bmod\ p$）

$(0x^7+0x^6+0x^5+1x^4+1x^3+0x^2+0x^1+1x^0)(0x^7+1x^6+0x^5+0x^4+1x^3+0x^2+0x^1+1x^0)$

$ = 0x^{14}+0x^{13}+0x^{12}+0x^{11}+1x^{10}+1x^9+0x^8+1x^7+0x^6+1x^5+1x^4+1x^3+0x^2+1x^1+0x^0$

我们发现这里，可能会出现次数高达 14 的项，这时我们也需要模一个东西，这个东西叫做**不可约多项式**。

不可约多项式说白了就是有限域中的素数，除了 $x ^ 0$ 和它自身之外没有能整除它的。

比如说 $GF(256)$ 中有一个不可约多项式是 $x^8+x^4+x^3+x^1+x^0$。

接下来我们把这个乘起来的多项式模 $x^8+x^4+x^3+x^1+x^0$，得到：

$25 * 73 = (0x^{14}+0x^{13}+0x^{12}+0x^{11}+1x^{10}+1x^9+0x^8+1x^7+0x^6+1x^5+1x^4+1x^3+0x^2+1x^1+0x^0) \bmod (x^8+x^4+x^3+x^1+x^0)$

$ = 1x^7+1x^6+1x^5+1x^4+0x^3+0x^2+0x^1+0x^0$

$ = 240$

搞清楚原理以后，我们就可以写一个结构体进行多项式的操作：[这里](https://www.luogu.com.cn/paste/isichg1o)，顺便加上了枚举和输出代码。

结果在[这里](https://www.luogu.com.cn/paste/w6ijlvqe)（略去了不用求的测试点）。

再结合我手写的结构体，就可以得到答案了。

附：本人写的代码效率极其低下，需要用提交答案才能过。