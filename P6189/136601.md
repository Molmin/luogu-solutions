由于数据范围达到 $n \le 10^5$，显然不能做普通的 $O(n^2)$ DP。显然正解是一个复杂度 $O(n)$ 多一点的递推。

因此猜测答案具有规律，我们可以用 [数的划分](https://www.luogu.com.cn/problem/P1025) 中的程序稍作修改得到小数据的答案值。前 $15$ 个为 $1, 1, 2, 3, 5, 7, 11, 15, 22, 30, 42, 56, 77, 101, 135$。肉眼看不出什么规律，考虑将其复制入一个				[神奇的网站](http://oeis.org)。

发现这是编号为 $A000041$ 的数列，我们找到 $\text{FORMULA}$ 这一项，

![](https://cdn.luogu.com.cn/upload/image_hosting/bkbtky0t.png)

发现里面大多数公式都是取近似值的，显然不能用。发现有一个 $a_(n)=a(n-1)-a(n-2)+a(n-5)+a(n-7)-a(n-12)-a(n-15)+\cdots =0$ 通过移项可以求出 $a(n)$ 的值。

那么这一串数 $1,2,5,7,12,15$ 又是什么呢，我们在百度上查一下，发现这是一个广义五边形数，它的计算是
![](https://bkimg.cdn.bcebos.com/pic/d833c895d143ad4b5b4f245389025aafa40f063b)

其中 $n$ 依序为 $0, 1, -1, 2, -2, 3, -3, 4 \cdots$。

那么第 $2i$ 项广义五边形数为 $\frac{i \times (i \times 3-1)}{2}$，第 $2i+1$ 项广义五边形数为 $\frac{i \times (i \times 3+1)}{2}$。

我们能得到一个这样的代码
```
for(int i=0;i<=n/2;i++){
		b[2*i]=i*(i*3-1)/2;
		b[2*i+1]=i*(i*3+1)/2;
	}
```

那么再代入上面那个公式 $a(n)=a(n-1)+a(n-2)-a(n-5)-a(n-7)+a(n-12)+a(n-15)-\cdots$

就能得到这样一个代码

```
for(int i=3;i<=n;i++){
		k=0;//从0开始也可以
		for(int j=2;b[j]<=i;j++){//因为在我们广义五边形数的求法中，可以看出实际是从2开始的，所以j从2开始循环，如果b[j]大于i那么数组越界，停止循环
			flag=k&2;//2的二进制为10 所以如果k%4的余数为0或1，flag就为0，就要+，否则则减
			if(!flag) a[i]=(a[i]+a[i-b[j]]+p)%p;
			else a[i]=(a[i]-a[i-b[j]]+p)%p;//按照上面得到的公式进行推
			k++;//推过一次k加一
		}
	}
```
核心思路和代码就在上面，总代码就不给了。