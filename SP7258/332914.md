SAM 经典题。

考虑建出 SAM，第 $k$ 小的子串其实就是自动机上从起点开始字典序第 $k$ 小的路径上的字符串。

因此可以考虑设 $f_i$ 表示从 $i$ 出发的不同路径个数，那么 $f_u = 1 +\sum \limits_{(u,v) \in \text{SAM}} f_v$，即 $f_v$ 的每条路径都能从 $u$ 出发到达，同时还有一条从 $u$ 不经过任何其他边的路径，即一条为 $u$ 的路径。

接着从起点开始，类似平衡树 $k$ 小值维护即可。复杂度线性。