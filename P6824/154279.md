「EZEC-4」可乐

这个题非常有意思，而且还有一些乱搞做法。

首先确定按位考虑的思路，而且从高位到低位去考虑。

假如说对于一个 $a_i$，我们将它与 $k$ 逐位比较，比较到了第 $j$ 位：

1. 如果说 $k$ 的第 $j$ 位是 1，$a_i$ 的第 $j$ 位是 1，那么显然， $x$ 的第 $j$ 位取 1 时，这一箱可乐我们一定能喝到，换句话说，只要 $x\in[tmp+2^j,tmp+2^{j+1})$，这箱可乐我们一定可以喝到（$tmp$ 是一个前提，在下面的分类讨论中会提到）。

2. 如果说 $k$ 的第 $j$ 位是 1，$a_i$ 的第 $j$ 位是 0，那么如果 $x$ 的第 $j$ 位取 0 时，这一箱可乐我们一定能喝到，换句话说，满足 $x\in[tmp,tmp+2^j)$。但如果 $x$ 的第 $j$ 位取 1 了呢？有可能在后面的位数中我们仍然可以喝到这箱可乐，所以我们假设这一位取 1，即 $tmp\leftarrow tmp+2^j$，再继续往后比较。

3. 如果说 $k$ 的第 $j$ 位是 0，$a_i$ 的第 $j$ 位是 1，那么 $x$ 的第 $j$ 位取 1 我们才有喝到这箱可乐的可能性，因此 $tmp\leftarrow tmp+2^j$，继续向后逐位比较。

4. 如果说 $k$ 的第 $j$ 位是 0，$a_i$ 的第 $j$ 位是 0，那么 $x$ 的第 $j$ 位取 0 我们才有喝到这箱可乐的可能性，$tmp$ 不需要再变动了。

那么，刚才提到的 $x$ 满足的条件我们应该如何使用？它的意思是说，处于这个区间的 $x$ 能喝到的可乐箱数加 1，是区间加法，而且最后只需要一次查询，不需要线段树或树状数组，我们可以用差分数组解决问题。

最后再将差分数组前缀和一下，我们就得到对于每个不同的 $x$ 能喝到的可乐箱数了，与 $ans$ 比较大小即可。

时间复杂度 $O(n\log k)$。

当然，还有一些神奇的做法，比如说，用 Trie 树来存储数，刚才的区间加法换为加上子树大小。本质上仍是按位比较，不过有着不同的思考方式。