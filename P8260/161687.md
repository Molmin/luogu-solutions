
复杂问题貌似 boruvka 严格比剩下俩厉害，因为所属关系每轮固定！

考虑 boruvka，相当于每次对于每个颜色，要找异色最小边。

如果 $x, y$ 中至少有一个不呈祖先关系是平凡的，可以枚举另一边，在树上 dfs 做到 $O(n)$，这样有可能数到祖先关系但默认成加法了，但没关系，因为 - 更小，会在数祖先关系的时候更新掉。

只需处理两个都呈祖先关系情况：
* 当前两个都是祖先，线段树（单点修改，区间查询）合并，$O(m \log n)$
* 当前一个祖先，一个儿子，按祖先维线段树（区间 $\text{chkMin}$，单点查询）合并，$O(m \log n)$
* 两个都是儿子，一个较劣但能接受的方法是，树剖把祖先拆成 log 个链的前缀，再使用区间 $\text{chkMin}$，单点查询的线段树，这样是 $O(m \log ^2 n)$，足矣通过。（应该能做到更优但较为复杂，例如可以先化为矩形 chkmin ，单点查询形式，然后一开始预处理那个（x 拆成 log 个区间）线段树结构，每个线段树（y 离散化后）位置按权值排序，然后每轮进去用线性并查集算出每个位置最优点值，还要定位离散化节点，把查询离线双指针，这样就 $O(m \log n)$ 一次，太复杂，好像不可实现。。）

总复杂度 $O(m \log ^3 n)$ 或 $O(m \log ^ 2n)$