以前在U群看到的做法，放在这好了

给定数列

$$a_n=\alpha\ a_{n-1}+\beta\ a_{n-2}$$

求$a_n\bmod p$

我们可以考虑解他的特征方程

$$x^2-\alpha x-\beta=0$$

两解分别为

$$x_1=\frac{\alpha+\sqrt{\alpha^2+4\beta}}{2},x_2=\frac{\alpha-\sqrt{\alpha^2+4\beta}}{2}$$

然后解一个二元一次方程就可以得到用$x_1,x_2$表示的通项公式

那么我们的问题就是怎么解决这个$x_1$和$x_2$

如果

$$(\frac{\alpha^2+4\beta}{p})=1$$

那么可以直接二次剩余求出啦

到这里为止其实我们已经解决了这道题本身，所以下面是如果把模数改成别的数的时候的做法

---

以下做法是U群的一群神仙给出的

如果不是二次剩余的话，我们就可以考虑扩个域

首先设集合$\mathbb{Z_p}$表示$\bmod p$的完系，然后显然它是个域

定义集合

$$S=\{a+b\sqrt{\alpha^2+4\beta}|a\in \mathbb{Z_p},b\in\mathbb{Z_p}\}$$

那么显然这也是一个域

然后我们会发现上面的那个东西完全可以在这个系里面算

所以自己实现一下这个域的四则运算（其实除法根本没必要），然后快速幂一下就可以了

注意到最后算出来的答案的根号部分系数显然为0，因为答案不可能是一个小数

所以我们就可以用一个快速幂解决它了。