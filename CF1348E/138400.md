不难想到一种方案：将两种颜色分别尽力搞掉，这样两种颜色剩的个数都会 $<m$，加起来就 $<2m$，于是答案下界是这种方案的答案，上界就是再加一。我们只需要判断加一能不能做到。

我们考虑将一种颜色通过同一棵树搞掉一些，使得剩下的个数 $\bmod m$ 是我们想要的。于是我们只需要算有哪些 $x\in[0,m)$ 可以作为被搞掉的个数 $\bmod m$。这个 $\mathrm O\!\left(nm^2\right)$ 随便 DP 就好了。