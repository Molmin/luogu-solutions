居然被 UVA 卡了时间。

## 题目大意
给定一张 $n$ 个节点 $m$ 条边的无向图，$q$ 次询问从第 $u$ 条边到第 $v$ 条边的必经点个数。

## 大体思路
先说一个一开始的思路。由于本题是边到边，很容易想到把边拆成一个点。

具体地，假设第 $i$ 条边为 $(u,v)$，则在另一张图 $G'$ 上连 $(u,i+n)$，$(i+n,v)$。这样子就转化成了点到点的必经点个数，方法与 P4320 相同。

我们对 $G'$ 建出圆方树，很容易发现必经点个数就是路径上是圆点且不是边拆出来的点的个数。比较暴力的方法是树剖与线段树维护，把原图上点对应的点权设为 $1$，其余均为 $0$，变成树上路径和。输出时可能要去掉两个端点。

需要注意的是，由于把边转化为点后，点的数量是 $n+m$ 量级，而 $n\le 10^4,m\le 10^5$，因此这种做法的时间复杂度 $O((n+m)\log n)$，严格意义下加上树剖其实还应该多一个 $\log$，在多组测试数据下寄了。

我们回过头来想，把边转化为点真的有必要吗？首先我们感性的想一下，由于答案肯定唯一，因此从任意位置出发答案相同，那么两条边的四个端点形成的组合中，我们让出发点无限逼近最差的情况得到的也是正确答案。换句话说，答案就是两组边的四个端点两两之间必经点个数的最大值。

为什么可以这样做呢？一个简要的证明如下：

1. 某条边 $E_i=(u,v)$ 的端点之一 $u$ 是必经点，那么如果我从 $u$ 出发，相当于一开始就在 $u$，$u$ 不会被计入答案，因此比正确答案少了一个点，所以必须从 $v$ 出发，而 $u$ 是必经点，意味着 $v$ 到另一条边 $E_j$ 的路径 $\delta(v,E_j)=(v,u)\cup\delta(u,E_j)$，$v$ 到 $E_j$ 的必经点个数为 $u$ 到 $E_j$ 的必经点个数 $+1$，多的这个点就是 $u$。另一条边同理。所以必经点个数最大值就是答案。

2. 某条边 $E_i=(u,v)$ 两个端点均不是到 $E_j$ 的必经点，即存在不相交的路径 $\delta(u,E_j),\delta(v,E_j)$。那么 $u$ 到 $E_j$ 就至少有两条不相交路径 $\delta(u,E_j),(u,v)\cup\delta(v,E_j)$，$u\to E_j$ 除了 $E_j$ 的端点外没有必经点，$v$ 同理。因此选必经点个数最大值也不劣，因为两者答案相同。

至此，我们完美的避免了边拆成点后树剖加线段树的复杂维护。

进一步，此时没有了边拆成的圆点的干扰，又由于圆方树上圆点与方点交错，故圆点个数也可以用树上路径长度除以 $2$ 加一得到。最后再去掉两个端点即可，复杂度 $O(n\log n)$。

代码中保留了线段树加树剖。

