先将序列 $a$ 排序，那么最后变成的数字只可能是 $a_n$ 或者是大于 $a_n$ 的第一个质数。

设跳到大于这个数的第一个质数是一步，那么考虑开一个桶维护每种长度所对应的步数，这个桶很小。

询问时判断 $c_2 / c_1$ 的大小，小于这个值的就暴跳，大于这个值的就用 $c_2$ 的代价跳。

用前缀和维护即可。当然如果最后一步是跳到 $a_n$ 的话就只能一步一步跳。

具体的实现细节见[代码](https://paste.ubuntu.com/p/qCHqW44SsB/)。