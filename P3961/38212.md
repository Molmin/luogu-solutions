我的思路是：

首先，将所有$n$个金子分为若干组，使得在一个组内所有金子都在一条直线上。可以证明，分组方案一定存在，且不同组的选取互不影响。在组内，我们将所有金子按照$x$坐标排序，于是在一个组内，要选后面的金子必须选其前面的所有金子。

设共有$tot$个组，第$i$组的大小为$cnt[i]$。我们定义$g[i][j]$，其中$g$是一个结构体变量，里面包含$w$、$t$两个变量，代表对于第$i$组，选前$j$个金子，需要的时间$t$以及价值$w$。$g$可以递推求得：

$g[i][j].t=g[i][j-1].t+a[k].t,$

$g[i][j].w=g[i][j-1].w+w[k].w,$其中$k$是第$i$组第$j$个金子。

特别地，我们定义$g[i][0]$代表在第$i$组中不取任何金子。

有了$g$以后，我们就可以有一个整体的状态$d[i][j]$，代表取只能在$i$组中取、花时间为$j$，可以获得的最大价值。我们可以利用$g$来求$d$，状态转移方程是：

$d[i][j]=max${$d[i-1][j-g[i][k].t]+g[i][k].w$}，其中满足$k<=cnt[i]$。于是问题得解。

在代码实现中，只需要将$a$整体排一遍序即可，这是因为，如果一个金子在组内排在前面，它在整体排序时也一定在前面。另外，注意在$d$数组中$dp$时，需要注意只有在$j-g[i][k].t>=0$时才能转移。以及在$dp$时不要忘了考虑$g[i][0]$，因为可以整个不取一组。

