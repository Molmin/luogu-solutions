为什么这题题解都是 $\Theta(k^2)$ 的暴力啊？  
这里给出一种时间复杂度 $\Theta(k + \log n)$ 的做法。

设

$$f_n=\sum_{i=1}^{n-1}i^ka^i$$

有如下定理：

> 存在关于 $n$ 的 $k$ 次多项式 $g_n$，满足 $f_n=a^ng_n-g_0$

可以用数学归纳法证明（别打我，我也没有更好的证法），这里就不再赘述。  

差分一下有
$$f_n-f_{n-1}=a^{n-1}(n-1)^k=a^{n-1}(ag_n-g_{n-1})$$
直接得出递推式
$$g_n=\frac{g_{n-1}+(n-1)^k}{a}$$


设 $g_0=x$，那么对于其它项，都能写成 $ux+v$ 的形式——也就是关于 $g_0$ 的一次函数。   
根据差分的基本定理，由于 $g_n$ 关于 $n$ 是 $k$ 次多项式，$g_{k+1}$ 在 $k+1$ 阶差分下为 $0$，即
$$\sum_{i=0}^{k+1}(-1)^i\binom{k+1}{i}g_{k+1-i}=0$$
现在睁大你的眼睛，前面我们说 $\{g_n\}_{n=0}^\infty$ 都可以表示为关于 $g_0$ 的一次函数。  
现在把上面那个式子算出来（$ug_0+v$ 的形式），那么就能得出 $g_0=-v/u$！  

要维护这个一次函数很简单，自己整个结构体就好了。

得出 $g_0$ 的实际值后，递推求出 $g_1,g_2,\dots,g_k$，就可以直接拉格朗日插值求出 $g_n$，然后就能算出 $f_n$ 了。

求 $i^k$ 的时候需要线性筛，插值需要线性求逆元，这样就可以实现严格 $\Theta(k+\log n)$ 的时间复杂度了。  


由于代码太丑，就不贴了。。qaq  
注意对 $k=0$ 和 $a=1$ 的情况要特判。

ps：这个做法不仅适用于第 $i$ 项是 $a^ii^k$，还可以是 $a^ib_i$。其中 $b_i$ 关于 $i$ 是个 $k$ 次多项式，但是需要多点求值，时间复杂度会变大为 $\Theta(k \log^2 k)$。

