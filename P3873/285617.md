题目已经描述的很清楚了，唯一要注意的是 $w$ 数组读入倒序，后面要处理一下。

切入正题：

本题是求递推式第 $m$ 项，我们直接根据题意模拟，可以打出 $O(nm)$ 暴力，即使开 O2 可以水过，但是这样不好玩。

于是我们用矩阵加速来做这道题。

状态矩阵由题意可知：

$\begin{bmatrix} 
	w_1 
\\  w_2
\\  w_3
\\  ...
\\  w_{n-1}
\\  w_n
\end{bmatrix}\quad$

进行一次乘法，将得到以下矩阵：

$\begin{bmatrix}  
   w_2
\\  w_3
\\  w_4
\\  ...
\\  w_n
\\  w_{n+1}
\end{bmatrix}\quad$

最后一行就是本题给的递推式：

$w_{n+1}=\sum_{i=1}^{n}a_i \times w_{n-i}$

再根据矩乘的定义，推导出转移矩阵：

$\begin{bmatrix} 
	0 & 1 & 0 & ... & 0
\\	0 & 0 & 1 & ... & 0
 \\  ...& ...&...&...&...
 \\	a_n & a_{n-1} & a_{n-2} & ... & a_1
\end{bmatrix}\quad$

为了方便读者调试，下面给出关键的构造矩阵的代码：(我把矩阵包装在结构体里了，所以略显怪异)

```cpp
void set1(){//转移矩阵
	memset(m,0,sizeof(m));
	for(int i=1;i<n;i++)m[i][i+1]=1;
	for(int i=1;i<=n;i++)m[n][i]=a[n-i+1];
}
void set2(){//初始状态
	memset(m,0,sizeof(m));
	for(int i=1;i<=n;i++)m[i][1]=w[n-i+1];
}
```
完结撒花

管理员同志审核题解辛苦了