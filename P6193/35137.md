首先，由于 $a_i$ 确定，所以一头牛开始和结束的位置构成的置换是确定的。置换 $\begin{pmatrix}p_1,p_2,p_3,\dots,p_n\\q_1,q_2,q_3,\dots,q_n\end{pmatrix}$ 表示将位置 $p_i$ 的数换到位置 $q_i$。   

然后，我们知道一个置换一定可以分解成若干循环节。循环节 $(r_1,r_2,r_3,\dots,r_m)$ 表示将 $r_1$ 换到 $r_2$ ，将 $r_2$ 换到 $r_3$ ，...，将 $r_m$ 换到 $r_1$ 。  

如 $\begin{pmatrix}1,2,3,4,5,6\\3,4,5,2,1,6\end{pmatrix}=(1,5,3)(2,4)(6)$。

容易发现，对于一个循环节，每个数至少要被换一次，那么我们选循环节内代价最小数换一遍一定最优。  

另外，由于各个循环节互不相关，仅在同一循环节内部互换一定最优.....吗？  

发现有一种特殊情况，即如果 **本循环节内**代价最小数 仍然代价过大，可以考虑先把 **整个数列中**的代价最小数 与 **本循环节内**代价最小数 互换，循环一整圈以后再换回来。   

代码很简单，就不贴了。