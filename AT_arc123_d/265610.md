我们首先可以钦定 $b_i \geq 0$ 且 $c_i \leq 0$ ，可以证明这个方案是一直合法的，如果 $ c_i > 0$ 则可以加到  $b_i$ 上去，反之亦然。

按照这个方案来算，我们发现 $\forall i \in [2,n]$ ，有 $b_i = b_{i-1}$ 或者 $c_i = c_{i-1}$ ，至于改变的是哪个，由 $a_i$ 与 $a_{i-1}$ 的大小关系决定。

此时答案就是关于 $b_1$ 的一个函数，因为 $b_i$ 可以 表示为 $b_1 + delta$ 产生，并且 $c_i$ 可以表示为 $c_1 + delta$ ，当 $i=1$ 时，$c_1=-b_1$，所以 $c_i$ 就可以表示为 $-b_1 + delta$ ，其绝对值也就是 $|b_1 - delta|$ 。所以答案就是一个 $\sum|b_1-p_i|$ 的形式，其中 $p_i$ 就是原先记录的 $a_i$ 和 $b_i$ ，答案的最小值也就是 $b_i = p_i$ 的中位数时的结果，带入即可。