首先把给的二维坐标系转化为一张有向图，$u$ -> $v$ 的边权 $P$ 就是从 $u$ 号点走到 $v$ 号点的概率。 方法很多，只要在 $\mathcal O(n^3)$之内处理出来即可。

考虑一个dp: $f_{i,x}$ 表示从 $x$ 走 $i$ 步走到终点 $t$ 的概率, 初值 $f_{0,t}=1$.
那么就有:
$$f_{i,x}=\sum_{y,(x,y)\in E} f_{i-1,y}*P_{x,y}$$

可以使用矩阵乘法优化。

假如当前询问终点为 $t$ , 要求步数为 $step$ , 现在要决定第一步从哪里开始，首先矩阵乘法处理出每个点走 $step-1$ 步走到 $t$ 的概率。

起始点按照题意必须是在 $S$ 中任意两点连线之间的。那么暴力处理出 $S$ 中所有可能的两点之间的连线，枚举每条线，再枚举线上的每个点，算出起点在这条线的概率，答案与其取max即可。

但是，为什么起点不能在这些线的交点上？很显然，如果起点在多条线上，答案就是起点单独在每条线上取个平均值，而一堆输的平均值显然小于其最大值，那么直接选概率最大的线显然最优。

还有矩阵乘法时的小 trick(套路). 直接矩阵快速幂时是 $\mathcal O(n^3logm)$的，对于200次询问显然爆炸。我们可以预处理出原矩阵的2的整次幂，对于每次询问，从中选出 $logn$ 个凑出原矩阵的$step-1$次幂。利用向量乘矩阵只需要 $n^2$ 复杂度的性质，用初始向量依次乘以这些矩阵，复杂度就降到了 $\mathcal O(n^2logn)$，可以接受。
