本文摘自[无向图连通性](https://www.luogu.com.cn/blog/zaczac/wu-xiang-tu-lian-tong-xing)。

------------


## 定义

* 割点：删了这个点使得连通图不连通了。
* 割边：删了这条边使得连通图不连通了。
* 点双联通：这个无向图中不存在割点
* 点双联通分量：一个无向图中的极大点双联通子图。

这里还提一下 Tarjan 算法中的一些定义：

按照 dfs 经过的边生成的树叫做 dfs 树，树上的边称为**树边**，其余的边称为**非树边**。

非树边里又有**前向边**、**后向边**和**横叉边**。
* 前向边： dfs 树上祖先指向子孙的边。
* 后向边： dfs 树上子孙指向祖先的边。
* 横叉边：非树边中不是前向和后向的边。即两颗不同子树的没有祖孙关系的点连的边。

* $dfn_u$ ：即 dfs 序中 $u$ 的编号，按照 dfs 树的前序遍历得到的编号。
* $low_u$ ：即 $u$ 节点及其子树经过 $1$ 条返祖边得到的最小编号节点。

其中横叉边是对于有向图而言的，无向图不存在横叉边。

## 点双连通分量

### 做法

* 性质 $1$：任意一个割点至少在两个点双连通分量内。

* 证明 $1$：首先，既然是割点，必定度大于等于 $2$，而左右两边的点双联通分量一定会包含他，因为这一个点删了不影响联通。

* 性质 $2$：除了根节点外，非割点最多只在一个点双连通分量内。

* 反证法，如果在多个点双联通分量内，那么其所处的点双连通分量必定可以合并成一个，而这就不符合点双联通分量的定义。

* 如果 $low_u \le dfn_u$，那么 $u$ 必定是一个点双联通分量的根节点，因为下面的点没法和其它点相连。而因此又能得出 $u$ 是割点。

好了，那么和有向图套路大同小异。

我们对于点 $u$ ，遍历邻接点 $v$ ，如果是树边，那么继续遍历，拿 $low_v$ 更新 $low_u$ ，并按性质 $3$ 判断（由于没有横叉边，所以这种情况下就可以知道其是一个点双联通分量）；是返祖边，直接拿 $dfn_v$ 更新 $low_u$。

因为中途我们会记录割点，所以最后记得判根节点的特殊情况。

### 代码

#### 割点

```cpp
void tarjan(int u, int fa){
	int cs = 0;
	low[u] = dfn[u] = ++tot;
	s[++tp] = u;
	E(i, u){
		int v = e[i].v;
		if(!dfn[v]){
			tarjan(v, u), cs++;
			low[u] = min(low[u], low[v]);
			if(low[v] >= dfn[u]) cut[u] = 1;
		}
		else if(v != fa)
			low[u] = min(low[u], dfn[v]);
	}
	if(fa == 0 && son < 2)
		cut[u] = 0;//根节点，且子树个数小于2
}
```