[$\tt CF802N$](/problem/CF802N)。

网络流，网络流，网络流。

首先比较显然的一个想法是流量用 $0,1$ 来代表每个点的选不选，然后

1. 源点连向每个 $i$，容量 $1$ 费用 $a_i$。
2. 每个 $i$ 连向汇点，容量 $1$ 费用 $b_i$。
3. 每对 $i\le j$ 都直接连边
4. 但是这样无法保证总流量是 $k$，所以在之前的那个汇点连容量 $k$ 的边向真正汇点，保证流量 $k$

但是这样边太多了（第 3 类边）网络流复杂度挂了，那我们尝试改进。

我们直接连 $i\to i+1$，$+\infty$ 流量 $0$ 费用（代替 3 类边）。这一步可以使得 $i$ 以前的 1 类边正常流到 $i+1$，2 类边可以正常离开。

那就做完了。