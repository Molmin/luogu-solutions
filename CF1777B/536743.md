## 题目大意

一个 $1,2,\dots,n-1,n$ 的排列 $p$，显然共有 $n!$ 种排法。现在要根据一个长度为 $n$ 的排列 $p$ 创造一个长度为 $2n$ 的序列 $a$，构造方法是将 $p$ 和它的反转拼在一起。现在要求所有 $n!$ 个排列经过这个构造生成的序列的逆序对数量的和模 $10^9+7$ 的值。

$\sum n\le10^5,t\le10^5$。

## 思路

一个一个枚举排列显然是不现实的。来找找规律。

从 $n=3$ 考虑，一共会有 $3!=3\times2\times1=6$ 种排列。

计算一下逆序对总和：

- `1,2,3`：反转得到 `1,2,3,3,2,1`，共有 $6$ 个逆序对。
- `1,3,2`：反转得到 `1,3,2,2,3,1`，共有 $6$ 个逆序对。
- `2,1,3`：反转得到 `2,1,3,3,1,2`，共有 $6$ 个逆序对。
- `2,3,1`：反转得到 `2,3,1,1,3,2`，共有 $6$ 个逆序对。
- `3,1,2`：反转得到 `3,1,2,2,1,3`，共有 $6$ 个逆序对。
- `3,2,1`：反转得到 `3,2,1,1,2,3`，共有 $6$ 个逆序对。

然后就会发现每种排列的逆序对数量都是一样的，所以答案就可以由某个序列的逆序对数量乘上 $n!$ 得到。

还没完，为啥是一样的呢？

首先，假设原排列的逆序对个数为 $m$ 个，那么新生成的反转序列的逆序对个数是多少个呢？因为没有相同的数，所以显然是 $\dfrac{n(n-1)}{2}-m$ 个。（因为长度为 $n$ 的排列一共只会有 $\dfrac{n(n-1)}{2}$ 个二元对。）

那么前半段和后半段的逆序对总和就是 $\dfrac{n(n-1)}{2}$ 个。

再考虑后面的半段和前面的半段之间生成的逆序对，显然对于后面的任意一个数 $x$，在前面都会有 $x-1$ 个数比它小。所以答案就会加上
$$\sum\limits^n_{i=1}(i-1)=\dfrac{n(n-1)}{2}$$

好，合并一下就得到了答案是 $n!n(n-1)\bmod (10^9+7)$。

时间复杂度 $\mathcal O\left(t+\sum n\right)$。

## 代码

极度精简 $20$ 行代码

```cpp
#include<iostream>
#include<cstdio>
using namespace std;
#define mod 1000000007
#define il inline
#define ll long long
ll t,n;
il ll frac(ll n) {
	ll ans=1;
	for(int i=2;i<=n;i++) ans=(ans*i)%mod;
	return ans;
}
int main() {
	scanf("%lld",&t);
	while(t--) {
		scanf("%lld",&n);
		printf("%lld\n",((n*(n-1))%mod*frac(n))%mod);
	}
	return 0;
}
```