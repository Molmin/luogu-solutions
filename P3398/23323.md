
是我校骄傲zzq学长的题耶，当然要来贡献一篇题解咯。

有一个非常清奇的思路，利用路径长度处理。结果发现和作者Mathison的思路一样。这里给出有一点点严谨的证明：

**命题：**

**树上两条路径 A-B C-D 有交点，当且仅当 A->B + C->D ≥ A->C + B->D（X->Y表示X到Y的最短路径长）**

~~证明：闭上眼睛，感受一下，啊，是对的。~~

**证明（口胡）：**

事实上手玩几次也就差不多发现规律了。

如果没有交点，那么A->C就是A->LCA(A,B)->LCA(C,D)->C，显然远了（两个祖先之间的路是白跑的）。B->D同理。

如果有交点/交段，设相交部分端点为P和Q，令：

A->B = A->P->Q->B

则

C->D = C->P->Q->D

或

C->D = C->Q->P->D

对于两种情况，分别有：

A->C = A->P->C , B->D = B->Q->D

或

A->C = A->P->Q->C , B->D = B->P->Q->D

两种情况都满足上面的式子。
