[luogu P4859 已经没有什么好害怕的了](https://www.luogu.com.cn/problem/P4859)

### 第一步
令 $h$ 为有多少组 $a>b$ 才能满足要求，易得 $h=\frac{n+k}{2}$

将 $a,b$ 按升序排列

### 第二步
考虑 dp

设 $l_i$ 为有多少个 $b_j<a_i$

$f_{i,j}$ 为选到第 $i$ 个数，有 $j$ 组 $a>b$ 的方案数

则有转移方程

$$f_{i,j}=f_{i-1,j}+(l_i-j+1)f_{i-1,j-1}$$

$(l_i-j+1)$ 是指将 $a_i$ 与一个严格小于 $a_i$ 的 $b_i$ 配对的方案数，本有 $l_i$ 种，但由于我们已经将 $a_i$ 排序，故对于之前的 $a>b$ 的组选择的 $b$，$a_i$ 也可以选择它，造成重复，故删去之前选的 $j-1$ 个数

边界：$f_{0,0}=1$

### 第三步

设 $g_i=(n-i)!f_{n,i}$，就是先配对 $i$ 组 $a>b$ 的，剩下的随便选。这样一定涵盖的所有的 $t$ 组 $a>b$ 的情况（ $t \geqslant i$），但是会有重复，具体地，设 $ans_i$ 为选 $i$ 组 $a>b$ 的方案数，则有

$$g_h=\sum_{i=h}^{n}C_i^h ans_i$$

二项式反演，得

$$ans_h=\sum_{i=h}^{n}(-1)^{i-h}C_i^h g_i$$

直接计算即可

### tips
- 为了快速计算组合数，可以预处理阶乘与之逆元
- $10^9+9$ 为质数，求逆时可以直接用 $a^{mod-1}$
- 可以 排序后 $O(n)$ 求出 $l_i$

相信读懂了的读者都可以自行写出代码，就不给了