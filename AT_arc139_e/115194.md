小清新多项式题。

首先特判掉 $n,m$ 都是偶数的情况，此时答案显然是 $2$。

否则，不妨假设一下二者之一成立，如果均不成立就交换 $n,m$：

- $n$ 是偶数、$m$ 是奇数。
- $n,m$ 均为偶数、且 $n\ge m$。

那么可以证明 $L=n·\lfloor\dfrac{m-1}{2}\rfloor$，并且要求每一行都有 $\lfloor\dfrac{m-1}{2}\rfloor$ 个黑格。

现在考虑怎样对其进行计数。由于每一行都不能填满，并且最多只会有一个白色连续段的长度 $\ge 2$，因此我们可以用这个白色连续段的位置来唯一表示这一行的染色方案，具体来说就是设 $a_i$ 表示第 $i$ 行唯一一个长度 $\ge 2$ 的连续段的开头位置的下标，那么一组 $\{a_i\}$ 就唯一对应一个染色方案，而稍加思考可以发现 $a_i$ 合法的充要条件是 $a_i-a_{i-1}\equiv\pm 1\pmod{m}$，也就是说我们要计算循环定义的、相邻两位之间的差等于正负一的序列个数。显然这等于 $[x^0](x+\dfrac{1}{x})^n\bmod(x^m-1)$。

由于 $n,m$ 之一比较小，因此考虑分 $n$ 小和 $m$ 小考虑：

- 如果 $n\le 10^5$，那么直接枚举选多少个 $x$ 用组合数算一算即可。
- 如果 $m\le 10^5$，直接多项式快速幂。

时间复杂度 $m\log n\log m$。