思维性极强的好题。

首先发现题目定义的这些量我们一个也不会高效的求。那么只能利用对称性整体考虑了。

我们以点为单位考虑。考虑点 $x$ 在第 $t$ 秒的结果。可以发现，$x$ 在第 $t$ 秒的权值就是其 $t$ 级儿子的原始权值异或和。其中定义 $x$ 为其自身的 $0$ 级儿子。

发现这种把 $2^n$ 种树情况加起来的方法具有高度对称性。设 $x$ 的子树深度为 $dep_x$。容易发现，由于对称性，对于 $x$ 子树的第 $k$ 层（$1\leq k\leq dep_x$），其在 $2^n$ 颗树中异或和为 $0$ 和 $1$ 的情况各占 $2^{n-1}$ 种情况。那么其贡献为 $2^{n-1}$。累加其贡献可得，点 $x$ 的权值对整体的贡献就是 $2^{n-1}\times dep_x$。也可以从数学期望的角度解释。 

那么，对于整棵树 $T$ 的答案就是 $2^{n-1}\times \sum\limits_{x\in T}dep_x$。树形 $dp$ 一下即可。复杂度 $O(n)$。[代码](https://codeforces.com/contest/1777/submission/210014970)。