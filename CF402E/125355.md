# 题目

[传送门](https://www.luogu.com.cn/problem/CF402E)

# 题解

~~想了半天没想出来~~

**首先需要注意题目中一个十分重要的条件，就是 $a_{i,j}\ge 0$，这个条件是我们做出这道题的关键**，而我们需要做的，是判断是否存在 $k$ 使得 $A^k$ 是一个严格正矩阵，即使其每一项都大于 $0$.

首先，利用 $a_{i,j}\ge 0$，我们将矩阵中所有大于 $0$ 的元素都看成 $1$，这样做为什么是对的？考虑矩阵乘法，假如有这样一个算式
$$
A\times B=C
$$
其中，$A$ 是 $n\times m$ 的矩阵，$B$ 是 $m\times k$ 的矩阵，那么这个算式写成一般形式就是
$$
c_{i,j}=\sum_{k=1}^ma_{i,t}\times b_{t,j}
$$
也就是说，我们只需知道 $A$ 的第 $i$ 行和 $B$ 的第 $j$ 列对位乘起来之后求和是否大于 $0$ 即可，对于这道题，所有的 $a_{i,j}\ge 0$，也就是说我们并不在意其值是多少，只要有$A$ 的第 $i$ 行和 $B$ 的第 $j$ 列对位的某一位恰好同时大于 $0$，那么结果的这一位就一定大于 $0$.

转换之后，$A^k$ 这个严格正矩阵其实就是一个全 $1$ 矩阵，而我们输入的矩阵无疑是一个 $01$ 矩阵。

由 $01$ 矩阵，我们可以想到邻接矩阵，对于某一个邻接矩阵 $D$，如果 $d_{i,j}=1$ 则表示 $i,j$ 间有一条边，将其拓展，**对于 $D^p$，如果 $d'_{u,v}>0$，则说明 $u,v$ 之间存在 $d'_{u,v}$ 条长度为 $p$ 的路径。**

将其放到我们的 $A$ 上面来，如果 $A^k$ 是严格正矩阵，则说明其所有点之间都存在长度为 $k$ 的路径，**既然存在路径，则说明其一定是联通的**，那么我们只需要看一看原图——也就是 $A$ 这个邻接矩阵反映的图是否是一个连通图即可。

最后方法很简单，在 $A$ 上跑一边 $tarjan$ 缩点，看是否只有一个 $scc$ 即可。

# 代码

```cpp
https://www.cnblogs.com/Arextre/p/13540163.html
```

