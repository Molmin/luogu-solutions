$|k-2x|$ 绝对值你解决不掉也不好拆，那么考虑找一个黑点的重心 $rt$，这样一定满足 $2x\le k$，所以可以直接拆掉。

于是每局这个 $rt$，现在形式变成了 $\sum (k-2x)$，也就是最小化 $\sum x$，那么每个点的贡献就是到根的边数，所以贪心按深度选就行。

那如果选的 $rt$ 不是重心呢？想必是没事的，因为如果实际上是 $2x-k$ 你算成了 $k-2x$，由于后者是一个负数，所以你得到的结果只会变小，不影响最大化的结果。

“按深度选”的时候如果跑一个 BFS 就是 $O(n^2)$，如果直接把深度 sort 一下就是 $O(n^2\log n)$，都能过。