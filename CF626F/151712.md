这道题虽然是个纯 dp，但是非常还是高级。

# 暴力
把所有数按大小放在数轴上，每一组的所有数字一定在以最小值为左端点，最大值为右端点的线段上（线段内的数不一定在这个组里）。把 $a_i$ 排序，每次考虑放第 i 大的数，它可以：成为一个线段的右端点（结束这个线段，贡献加 $a_i$）；成为左端点（开始一个线段，贡献减 $a_i$）；在一个还没结束的线段中间（不做贡献）；自己独自做一个线段（其实和上一个转移是一样的）。

设 $dp_{i,j,k}$ 表示放了前 i 个点，还有 j 条线段没有结束，当前贡献为 k 的方案数。转移方程：
$$ dp[i][j][k]+=
\left\{
\begin{aligned}
&dp[i-1][j+1][k-a[i]]*(j+1) \\
&dp[i-1][j-1][k+a[i]]\\
&dp[i-1][j][k]*(j+1)
\end{aligned}
\right.
$$


虽然 k 最后只会用到 $0 \sim K$，但是中间的贡献可以是 $-\sum a_i \sim \sum a_i$，太大了。

# 正解
所以我们转换计算贡献的方式，让贡献保持递增。可以发现：最大值减最小值等于这条线段的长度。考虑差分。每次放一个数时，就把所有还没有结束的线段的贡献加 $a_i-a_{i-1}$。

设 $x=a_i-a_{i-1}$。

转移方程：
$$ dp[i][j][k]+=
\left\{
\begin{aligned}
&dp[i-1][j-1][k-x*(j-1)]\\
&dp[i-1][j+1][j+1][k-x*(j+1)]*(j+1)\\
&dp[i-1][j][k-x*j]*(j+1)
\end{aligned}
\right.
$$
