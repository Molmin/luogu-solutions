## Problem

键盘上有三个按键：A 键，Caps Lock（大小写锁定切换）键和 Shift 键，给定三个正整数 $X,Y,Z$，分别代表的含义如下：

- 花费 $X$ 毫秒的时间按 A 键，此时若大小写锁定状态为大写则将显示 `A`，反之则显示 `a`。

- 花费 $Y$ 毫秒的时间同时按 Shift 键和 A 键，若此时大小写锁定状态为大写则会显示 `a`，反之则显示 `A`。

- 花费 $Z$ 毫秒的时间按 Caps Lock 键，若此时大小写锁定状态为大写则切换其为小写，反之亦然。

初始时大小写锁定状态为小写，给定一个字符串 $S$，问打出 $S$ 最少要多少毫秒。

$1\leq X,Y,Z\leq 10^9,1\leq |S|\leq 3\times 10^5$，$S$ 仅含 `a` 和 `A`。

## Solution

对于这种分阶段决策的问题很明显用动态规划求解。

**状态**：设 $f_{i,0/1}$ 为打出前 $i$ 个字符后大小写锁定状态为小写或大写的最短耗时。

**初始状态**：$f_{0,0}=0,f_{0,1}=Z$，其余全为极大值。

**决策**：

以 $S_i$ 为小写为例。

- 若打完当前字符后的状态为小写，则有一下几种可能：
- - 上次为小写，这次直接按 A 键：$f_{i-1,0}+X$。
- - 上次为大写，这次切换到小写后按 A 键：$f_{i-1,1}+Z+X$。

- 若打完当前字符后的状态为大写，则有以下几种可能：
- - 上次为小写，那么按 A 键之后切换到大写：$f_{i-1,0}+X+Z$。
- - 上次为大写，那么同时按 Shift 键和 A 键：$f_{i-1,1}+Y$。
- - 上次为大写，那么切换到小写后按 A 键，随后再切换到大写：$f_{i-1,1}+Z+X+Z$。

转移时对不同决策取最小值即可。

$S_i$ 为大写的时候把上面转移反过来就可以了。

**答案**：$\min(f_{|S|,0},f_{|S|,1})$。

时间复杂度 $\mathcal{O}(|S|)$。

## Code

```cpp
const int N = 3e5+5;
int X,Y,Z,n,f[N][2];
char s[N];
signed main(){
    memset(f,0x3f,sizeof(f));
    X=read(),Y=read(),Z=read();
    f[0][0]=0,f[0][1]=Z;
    scanf("%s",s+1);
    n=strlen(s+1);
    F(i,1,n){
        if (isupper(s[i])){
            f[i][1]=min(f[i-1][1]+X,f[i-1][0]+Z+X);
            f[i][0]=min(f[i-1][1]+X+Z,min(f[i-1][0]+Y,min(f[i-1][0]+2*Z+X,f[i-1][1]+Z+Y)));
        }
        else{
            f[i][0]=min(f[i-1][0]+X,f[i-1][1]+Z+X);
            f[i][1]=min(f[i-1][0]+X+Z,min(f[i-1][1]+Y,min(f[i-1][1]+2*Z+X,f[i-1][0]+Z+Y)));
        }
    }
    printf("%lld",min(f[n][0],f[n][1]));
    return 0;
}
```