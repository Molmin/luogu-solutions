## 题目描述

你需要用电脑打一串由 `a` 和 `A` 组成的字符串。你的键盘上有 $3$ 个按键，分别是 `a` 按键、`Shift` 按键，`Capslock` 按键。你可以执行以下操作任意次：

- 花 $x$ 毫秒时间按 `a` 按键。如果此时 `Capslock` 的指示灯是灭的，打印 `a`。否则打印 `A`。
- 花 $y$ 毫秒时间按 `a` + `Shift` 按键。如果此时 `Capslock` 的指示灯是灭的，打印 `A`。否则打印 `a`。
- 花 $z$ 毫秒时间按 `Capslock` 按键。如果此时 `Capslock` 的指示灯是灭的，则将指示灯变亮。否则变灭。

问最少需要花多少毫秒。

$1 \le x, y, z \le 10^9,\ 1 \le \left| S \right| \le 3 \times 10^5$

## 分析

考虑 `DP`。

显然状态中需要有一维表示当前正在打字的位置，其次还需要知道当前的 `Capslock` 的状态。所以设 $f_{i, 0/1}$ 表示打完前 $i$ 个字符，且打完后的状态为大写 / 小写所需要花的最少时间。显然答案为 $\min(f_{n, 0},f_{n,1})$，表示打完前 $n$ 个字符后状态为大写或小写所需要花的最少时间。

考虑边界。由于最开始时 `Capslock` 的状态为小写，所以前 $0$ 个字符打完后状态为大写的情况是不存在的。所以 $f_{0, 0} = +\infty$。

接下来考虑转移。转移过程相对繁琐，以下是递推式：

$$
f_{i, 0} = \left\{\begin{matrix}\min(f_{i - 1, 0} + \min(x, z + y + z), f_{i - 1, 1} + \min(z + x, y + z)) & (S_i = \texttt{'A'})\\\min(f_{i - 1, 0} + \min(y, z + x + z), f_{i - 1, 1} + \min(x + z, z + y)) & (S_i = \texttt{'a'})\end{matrix}\right.
$$
$$
f_{i, 1} = \left\{\begin{matrix}\min(f_{i - 1, 0} + \min(x + z, z + y), f_{i - 1, 1} + \min(y, z + x + z))  & (S_i = \texttt{'A'})\\\min(f_{i - 1, 0} + \min(z + x, y + z), f_{i - 1, 1} + \min(x, z + y + z))  & (S_i = \texttt{'a'})\end{matrix}\right.
$$

接下来分 $8$ 种情况分析。

- 大写 $\to \texttt{'A'} \to$ 大写：
  
  首先打完前 $i - 1$ 个字符后的状态为大写的最少时间为 $f_{i - 1, 0}$，先将答案加上。
  
  对于这种情况，可以直接按 `a` 打出 `A`。也可以先换成小写，再按 `Shift` + `a` 打出 `A`，再切换成大写。
  
  因此答案为 $f_{i - 1, 0} + \min(x, z + y + z)$。
- 小写 $\to \texttt{'A'} \to$ 大写：
  
  首先打完前 $i - 1$ 个字符后的状态为小写的最少时间为 $f_{i - 1, 1}$，先将答案加上。
  
  对于这种情况，可以先切换成大写，再直接按 `a` 打出 `A`。也可以先按 `Shift` + `a` 打出 `A`，再切换成大写。
  
  因此答案为 $f_{i - 1, 1} + \min(z + x, y + z)$。
- 大写 $\to \texttt{'a'} \to$ 大写：
  
  首先打完前 $i - 1$ 个字符后的状态为大写的最少时间为 $f_{i - 1, 0}$，先将答案加上。
  
  对于这种情况，可以直接按 `Shift` + `a` 打出 `a`。也可以先切换成小写，再直接按 `a` 打出 `a`，再切换成大写。
  
  因此答案为 $f_{i - 1, 0} + \min(y, z + x + z)$。
- 小写 $\to \texttt{'a'} \to$ 大写：
  
  首先打完前 $i - 1$ 个字符后的状态为小写的最少时间为 $f_{i - 1, 1}$，先将答案加上。
  
  对于这种情况，可以先直接按 `a` 打出 `a`，再切换成大写。也可以先切换成大写，再按 `Shift` + `a` 打出 `a`。
  
  因此答案为 $f_{i - 1, 1} + \min(x + z, z + y)$。
- 大写 $\to \texttt{'A'} \to$ 小写：
  
  首先打完前 $i - 1$ 个字符后的状态为大写的最少时间为 $f_{i - 1, 0}$，先将答案加上。
  
  对于这种情况，可以先直接按 `a` 打出 `A`，再切换成小写。也可以先切换成小写，再按 `Shift` + `a` 打出 `A`。
  
  因此答案为 $f_{i - 1, 0} + \min(x + z, z + y)$。
- 小写 $\to \texttt{'A'} \to$ 小写：
  
  首先打完前 $i - 1$ 个字符后的状态为小写的最少时间为 $f_{i - 1, 1}$，先将答案加上。
  
  对于这种情况，可以直接按 `Shift` + `a` 打出 `A`。也可以先切换成大写，再直接按 `a` 打出 `A`，再切换成小写。
  
  因此答案为 $f_{i - 1, 1} + \min(y, z + x + z)$。
- 大写 $\to \texttt{'a'} \to$ 小写：
  
  首先打完前 $i - 1$ 个字符后的状态为大写的最少时间为 $f_{i - 1, 0}$，先将答案加上。
  
  对于这种情况，可以先切换成小写，再直接按 `a` 打出 `a`。也可以先按 `Shift` + `a` 打出 `a`，再切换成小写。
  
  因此答案为 $f_{i - 1, 0} + \min(z + x, y + z)$。
- 小写 $\to \texttt{'a'} \to$ 小写：
  
  首先打完前 $i - 1$ 个字符后的状态为小写的最少时间为 $f_{i - 1, 1}$，先将答案加上。
  
  对于这种情况，可以直接按 `a` 打出 `a`。也可以先换成大写，再按 `Shift` + `a` 打出 `a`，再切换成小写。
  
  因此答案为 $f_{i - 1, 1} + \min(x, z + y + z)$。

转移过程十分复杂，需要耐心求解。

[$\text{Code}$](https://www.luogu.com.cn/paste/dbjn6a4p)
