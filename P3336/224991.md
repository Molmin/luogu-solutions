来个不一样的做法。（可能是假的，欢迎 Hack）

这个函数看起来像是若干个形如 $||X_i-x|-X_i|$ 拼起来的结果，于是可以做一些转换：

在 $(0,n)$ 中撒若干个点 $X$，$f(x)$ 表示 $x$ 与所有 $X$ 的距离最小值。$X$ 对应 $f(x)$ 的零点。

对于每一个 $f(x)=y$ 的限制，其可以视为：在 $(f(x)-y,f(x)+y)$ 上不能有 $X$，且 $f(x)-y$ 与 $f(x)+y$ 两个位置至少有一个 $X$。前一部分容易解决，后一部分视为一个图论问题，手玩一下能发现它成若干条在数轴上不交的链，对每条链进行 DP （状态：$f_{i,0/1}$ 表示当前位于 $i$，是否为零点的方案数，转移显然）然后乘起来就行。

$n$ 比较大，所以要离散化然后考虑与限制无关的点（$c$ 个）的贡献，这显然是 $2^c$。注意我们只考虑坐标为偶数的点，奇数点必定不为零点。

[Code](https://www.luogu.com.cn/paste/hjlx488j) ←改的模拟赛时代码，所以可能有亿些混乱