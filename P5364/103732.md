直接开门见山。

关注$N$范围高达$10^{18}$，又类似数学递推，考虑矩阵快速幂求解。

所以怎么求？

我们关注$N$的每个取值的结果的数学表示。

$N=1$时，$ans=1*1^K$

$N=2$时，$ans=1*1^K+1*2^K$

$N=3$时，$ans=2*1^K+1*2^K+1*3^K$

$N=4$时，$ans=4*1^K+2*2^K+1*3^K+1*4^K$

……

虽然有规律，可以写出通项，但矩阵递推的方法不明显。

考虑前缀和。

$N=1$时，$sum=1*1^K$

$N=2$时，$sum=2*1^K+1*2^K$

$N=3$时，$sum=4*1^K+2*2^K+1*3^K$

$N=4$时，$sum=8*1^K+4*2^K+2*3^K+1*4^K$

提出系数：

	1
	2 1
	4 2 1
	8 4 2 1
	……

可以发现递推的数学式：

$sum[N]=2sum[N-1]+N^K$

正确性可证明，此处不加赘述。

找出递推式之后，我们思考如何转化为矩阵。

发现$2sum[N-1]$较为好解决，难点在$(N-1)^K$转移到$N^K$。

先转换为$N^K$转移到$(N+1)^K$

二项式定理展开$(N+1)^K$。

有

$$
(N+1)^K = \tbinom{K}{0} N^K+ \tbinom{K}{1} N^{K-1}+ \tbinom{K}{2} N^{K-2}+...+ \tbinom{K}{K} N^0
$$

考虑存储当前$N$从$0$到$K$次方的值，然后在转移时根据$sum[N]=2sum[N-1]+N^K$导入$N^K$

同时利用提前存储好的杨辉三角进行次方的转移。

举出$K=3$时的转移矩阵：

	1 1 1 1 0
    0 1 2 3 0
    0 0 1 3 0
    0 0 0 1 1
    0 0 0 0 2
    
每次相乘时，左侧矩阵

$[N^0,N^1,N^2,N^3,sum[N-1]]$

相乘结果

$[N^0,N^0+N^1,N^0+2N^1+N^2,N^0+3N^1+3N^2+N^3,2sum[N-1]+N^3]$

得

$[(N+1)^0,(N+1)^1,(N+1)^2,(N+1)^3,sum[N]]$

递推得到完美解决。

矩阵快速幂即可。