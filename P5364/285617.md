题意简化

求数列 $f(x)=\sum_{i=1}^{x-1}f(i)+x^k$ 的第 $n$ 项。

化简柿子得 $f(x)=2 \times f(x-1)+x^k-(x-1)^k$

观察题目发现，$n$ 的范围限制了 $O(n^2)$ 模拟和 $O(n)$ 线性递推的做法。

考虑矩阵乘法。

我们设状态矩阵为：

$\begin{bmatrix} 
	f_x 
\\  x^k
\\  x^{k-1}
\\  x^{k-2}
\\  ...
\\  x^2
\\  x
\\  1
\end{bmatrix}\quad$

目标状态是：

$\begin{bmatrix} 
	f_{x+1} 
\\  (x+1)^k
\\  (x+1)^{k-1}
\\  (x+1)^{k-2}
\\  ...
\\  (x+1)^2
\\  x+1
\\  1
\end{bmatrix}\quad$

考虑转移

我们发现

$x^k$ 转移到 $(x+1)^k$ 是关键一步，要用到二项式系数。

于是我们通过杨辉三角预处理出所有要用到的二项式系数。

```cpp
yh[0][0]=1;
for(int i=0;i<k+1;i++){
	yh[i][0]=1;
	for(int j=1;j<=i;j++)yh[i][j]=(yh[i-1][j-1]+yh[i-1][j])%md;
}
```
注意：$yh[i][j] = C_{i}^j$

最后我们通过推导得出了状态转移矩阵：

$\begin{bmatrix} 
	2 & 0 & C_k^{k-1} & ... & C_k^0
\\	0 & C_k^k & C_k^{k-1} & ... & C_k^0
\\  0 & 0 & C_{k-1}^{k-1} & ... & C_{k-1}^0
 \\  ...& ...&...&...&...
 \\	0&0&0&...&1
\end{bmatrix}\quad$

这里给出关键构造矩阵的代码，方便各位读者调试：

```cpp
m[1][1]=2;
for(int i=2;i<=k+2;i++)m[1][i]=yh[k][i-2];
for(int i=1;i<=k;i++){
	for(int j=i;j<=k+1;j++)m[i+1][j+1]=yh[k-i+1][k-j+1];	
}
m[1][2]=0;
m[k+2][k+2]=1;
```
完结撒花

管理员同志审核题解辛苦了
