显然，任意 `#` 的连通块都可以用一次操作将其变为 `.`。因此，题目等价于要让黑格子的连通段数最少。

这个可以用双层 BFS 解决：外层用优先队列维护到每个格子的答案，内层用 BFS 找黑格子的连通块。时间复杂度是 $O(n^2\log n)$。

评测链接：https://atcoder.jp/contests/agc043/submissions/11070046