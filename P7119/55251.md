设当前反面朝上硬币数为 $k$ ，将所有反面的位置 $p_1,p_2,\dots,p_k$ 从小到大排序。

显然有 $k\le p_k$，所以一定存在一个 $i$ 使得 $p_{i-1}<k,p_i\ge k$。那么一开始翻硬币的过程一定是 $k,k+1\dots,p_i-1,p_i,p_i-1,\dots,k$。容易发现这样操作之后 $p_i$ 上的硬币变成了正面而其他硬币不变，问题就变为了 $k$ 减小 $1$ 后的情况。所以答案不可能是 $\texttt{never}$ 并且每个位置对答案的贡献形如 $2p_i-2j+1$。这可以拆成三部分分别计算求和，即
$$
2\sum_{i=1}^{k}p_i-2\sum_{i=1}^ki+k=2\sum_{i=1}^{k}p_i-k^2.
$$

用线段树维护 $p_i$ 之和以及 $k$ 即可。时间复杂度 $O\left(n+m\log n\right)$，空间复杂度 $O\left(n\right)$。