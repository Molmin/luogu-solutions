## 前言

出题人来一篇。

这道题主要是考查根号分治。赛时 std 复杂度假了没查出来，是我的锅/kk。现在数据加强了之后应该是卡掉了暴力和多一只 $\log$ 的做法。

## 正文

### Subtask 1

直接枚举 $k$，然后把那个堆建出来，暴力检查即可。

复杂度 $O(n^2 k)$。

### Subtask 2&3

考虑进行根号分治。

1. 对于叉数 $\leq \lceil \sqrt{n} \rceil$ 的，可以暴力的做，一共 $\sqrt{n}$ 种 $k$ 的取值，每次 $O(nk)$ 检查，则复杂度为 $O(nk \sqrt{n})$。

2. 对于叉数 $\gt \lceil \sqrt{n} \rceil$ 的，容易发现这个堆建出来只有两层。

	所以我们考虑对所有有儿子的点，对他的儿子进行检查。容易发现最多有 $\dfrac{n-\sqrt{n}}{\sqrt{n}}=\sqrt{n}$ 个点会被检查到。

	考虑怎么检查呢？我们只需要让儿子的参数的最大值小于等于当前节点的值就可以了。由于 bfs 序中，一个点的儿子的 bfs 序和下标的相对关系一样，是连续的，所以按照 bfs 序维护 $k$ 个 RMQ 即可。
    
这里就体现出 ST 表和线段树的区别了。

- 线段树只能做到 $O(\log n)$ 查询，复杂度为 $O(nk\sqrt{n}\log{n})$，只能通过 Subtask 2；

- ST 表预处理 $O(nk \log n)$，查询 $O(1)$，可以做到 $O(nk\sqrt{n})$，能够拿到满分。