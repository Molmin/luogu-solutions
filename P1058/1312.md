我们发现，知道了立方体的左下角，就可以把整个立体图就打出来。


考虑到如果有两个紧挨的立方体，下面的立方体会被上面的遮住，左面的立方体会被右面的遮住，后面的立方体会被前面的遮住，我们不妨从后往前、从左往右、从下往上枚举左下角打印。


我们可以事先推导一系列的公式来求出整个图的长宽和每行每列每个高度的立方体左下角的位置。






```cpp
#include <cstdio>
#include <algorithm>
using namespace std;
char c[1000][1000];
int g[100][100];
int i,j,k,m,n,h,w;
void printone(int x,int y)
{
    c[x][y]='+',c[x][y+1]='-',c[x][y+2]='-',c[x][y+3]='-',c[x][y+4]='+';
    c[x-1][y]='|',c[x-1][y+1]=' ',c[x-1][y+2]=' ',c[x-1][y+3]=' ',c[x-1][y+4]='|',c[x-1][y+5]='/';
    c[x-2][y]='|',c[x-2][y+1]=' ',c[x-2][y+2]=' ',c[x-2][y+3]=' ',c[x-2][y+4]='|',c[x-2][y+5]=' ',c[x-2][y+6]='+';
    c[x-3][y]='+',c[x-3][y+1]='-',c[x-3][y+2]='-',c[x-3][y+3]='-',c[x-3][y+4]='+',c[x-3][y+5]=' ',c[x-3][y+6]='|';
    c[x-4][y+1]='/',c[x-4][y+2]=' ',c[x-4][y+3]=' ',c[x-4][y+4]=' ',c[x-4][y+5]='/',c[x-4][y+6]='|';
    c[x-5][y+2]='+',c[x-5][y+3]='-',c[x-5][y+4]='-',c[x-5][y+5]='-',c[x-5][y+6]='+';
    return;
}
int main()
{
    scanf("%d%d",&n,&m);w=4*m+2*n+1;
    for (i=1;i<=n;i++) for (j=1;j<=m;j++) scanf("%d",&g[i][j]),h=max(h,2*(n-i+1)+g[i][j]*3+1);
    for (i=1;i<=h;i++) for (j=1;j<=w;j++) c[i][j]='.';
    for (i=1;i<=n;i++) for (j=1;j<=m;j++) for (k=1;k<=g[i][j];k++) printone(h-2*(n-i)-3*(k-1),2*(n-i)+4*(j-1)+1);
    for (i=1;i<=h;i++) { for (j=1;j<=w;j++) putchar(c[i][j]); puts(""); }
    return 0;
}
```