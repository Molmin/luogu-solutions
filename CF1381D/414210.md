下文中的 $\text{len}$ 均代指蛇的长度。

首先考虑蛇什么时候可以掉头。不难发现，蛇掉头的方式有且仅有一种：当且仅当蛇头的位置有两条相交的未被蛇身占据的长度至少为 $\text{len}$ 的链时，蛇可以先去其中一条链，再去另一条链以达到掉头的目的。如果不使用这种方法，蛇就会被自己的身体卡住。

接着考虑蛇头能否以正确的状态到达具有上述性质的节点。不难发现，当蛇的一端移动时，另一端能到达的节点会增加蛇移开节点的子树。因此，我们可以将蛇变成一个序列，用双指针维护蛇头能到达的节点。具体地，如果一个位置在双指针外，则它的子树均能被到达。

具体实现细节较多。时间复杂度 $\Theta(n)$。