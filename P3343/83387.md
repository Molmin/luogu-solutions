事实上，问题就是求出$i$条边连通图的个数。
做法很多,

考虑斯特林反演：
我们记$f_{s,j,k}$表示$s$加入了$j$条边有$k$个联通块的方案数。
$g_{s,j,k}$表示至少有$k$个联通块。

显然满足$g_{s,j,k}=\sum_{l}f_{s,j,l} \begin {Bmatrix} l \\k \end {Bmatrix}$
所以得到$f_{s,j,k}=\sum_{l}g_{s,j,l}(-1)^{l-k} \begin {bmatrix} l \\k \end {bmatrix}$


考虑$g$是可以先算出$h_{s,k,m}$表示我们将$s$划分成$m$块，每个块内部一共有$k$条边，显然$g_{s,j,m}=\sum_{k}h_{s,k,m}\binom{k}{j}$

这样转移就很方便了。
考虑此时$h_{s,j,k}$可以直接枚举当前和最小标号点的集合来转移。
但这个终究还是要枚举联通块个数，不太优秀。

注意到本题需要求出$f_{s,m,1}=\sum_{l}g_{s,m,l}(-1)^{l-1}(l-1)!$

容斥系数我们是可以弄到$dp$里面的：$f_{s,m,1}=\sum_{l}\sum_{k} h_{s,k,l} \binom{k}{m}(-1)^{l-1}(l-1)!$
此时我们可以$dp_{s,k}=\sum_{l}h_{s,k,l}(-1)^{l-1}(l-1)!$
这个转移除了最后一次特殊处理，其他的暴力枚举第$l$次加入的是哪个子集就行了。

复杂度是$3^n m$