注意到 $a$ 中最多只有 $10$ 个不同字符，所以可以考虑爆搜。

考虑对于这 $\le 10$ 种不同字符，每一种也就是放进集合 $Q$ 或者不放 $2$ 种可能，所以直接暴力。

问题就剩下计算了。不难发现如果 $a,b$ 下标相同的一段长度为 $k$ 的区间相等，则其中选择两个端点 $(l,r)$ 的情况数为 $\binom k2$，于是扫一遍计算就解决了。

叉人的时候看见了一个神奇 dp，差点以为搜会超时，算了一下复杂度也就 $O(2^p\times n)$（$p$ 是不同字符种类的数量，为 $10$），问题不大。

赛时代码：[Link](https://codeforces.com/contest/1778/submission/191576083)