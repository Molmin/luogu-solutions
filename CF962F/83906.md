### 前置芝士：

我们如下定义：

$\large\texttt{DFS树}$：对于无向连通图G，在dfs过程中与原点集构成的生成树即为DFS树。

$\large\texttt{返祖边}$：在一个由树边和非树边组成的集合$E$中，对于任意$u,v∈E$，都满足$u,v$为父子或子父的关系的边，称为返祖边。

$\large\texttt{简单环}$：不经过重复边的环。

那么可有性质：在$E$中，非树边均为返祖边。所以在问题处理时，**所有的边都在一个子树内**。



------------
### 简单环的研究：

如图：有两个简单环相交于链$4-5$上

![](https://cdn.luogu.com.cn/upload/pic/71111.png )

对于$1-4-5$，$0-4-5$都自成一个简单环。

但是显然，对于大环$0-1-4-5$也成为一个简单环。

换句话说，**对于两个相交的简单环，总是可以拓展成新的简单环。**

根据题意说明，我们发现，**要使一个边恰好在一个简单环内，那么对应的两个简单环不能相交，否则所在简单环数$++$**。

而根据返祖边的性质，**两个简单环的相交处一定在树上**，那么问题就转换成了边的覆盖。

也就是说，我们将统计**两个简单环是否相交**转换为**两个简单环中的某一部分是否相交**。在这里我们为了方便，默认为判断返祖边是否相交，其中返祖边集为简单环拆去非树边的一条链（环=链+边）。

那么思路就出来了，**对于每一个简单环，我们将它的返祖边覆盖在原图上**，最后总计没有被覆盖到的区域一定符合题意。

对于树上染色，使用树上差分进行染色。对于一条返祖边$u-v$进行差分，最后差分数组元素为$1$的即为未覆盖区域。

时间复杂度$O$($n+m$)。

代码就不给了，看[caoyang1123](https://cdn.luogu.com.cn/upload/pic/71111.png )的吧。
