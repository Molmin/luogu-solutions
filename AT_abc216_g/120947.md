# Solution

一眼差分约束。设前 $i$ 个数里面 `1` 的数量为 $pre_i$。

那么限制 $(l,r,x)$ 相当于 $pre_r-pre_{l-1} \ge x$。我们当然想要求 $pre$ 的值，越小越好，因此要求**最长路**。

> 为什么最小解要求最长路？比如以上的式子，你可以写成 $pre_r - x \ge pre_{l-1}$ 然后跑最短路。看似是对的，但是最短路要求每个点都必须有存在一个前驱使得不等式取等。这样肯定构造了一组合法解，但是事实上一个点的 $pre$ 也许可以继续往下压使得没有一个不等式取等。因此最短路不可以。但是如果你写成 $pre_{l-1}+x \le pre_r$ 求最长路，那么这个 $pre_r$ 取到的必定是它能取到的最小值，因为再小一点就可能不满足一个不等式了。而且，每个点都是可能取到的最小值，所以每个点都一定虽最优的（不会出现牺牲后面让前面更小来满足字典序更小的情况）。综上，**求差分约束最小解要用最长路**

还有一些限制，类似 $pre_i \ge pre_{i-1}$ 和 $pre_i \le pre_{i-1}+1$。

你想跑最长路，结果发现有正权边，不能用 Dijkstra，但是这题卡 SPFA（我记得日本人不卡算法来着）。那么想办法把它变为负权边。

考虑设 $pre'_i=pre_i-i$。那么最危险的第一个不等式可以化为 $pre'_r+r-pre'_{l-1}-l+1 \ge x$。也就是 $pre'_{l-1}+x-(r-l+1) \le pre'_r$。因为有解，所以 $r-l+1 \ge x$。所以边权都是负的。可以使用 Dijsktra 了。

[code](https://atcoder.jp/contests/abc216/submissions/43282717)