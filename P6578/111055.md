## 前言
重写了[去年写的垃圾](https://www.luogu.com.cn/blog/111055/old-p6578)，慎点，xxs 气味很重。

感觉之前写的东西太碎了，自己都没脸看了，所以还是看这篇短小精悍的东西吧。

如果你对某一步实现不是很懂，可以看看去年写的垃圾。
## 如果不带修怎么做
考虑不带修的情况，我们可以按照 $x$ 排序然后暴力加，用线段树维护区间信息，时间复杂度 $O(n\log n)$。
## 那带修呢
考虑带修的情况，我们发现这玩意非常恶心，于是直接询问分块，带修变成了记录时间戳，每次临时修改 $\sqrt n$ 个位置，我们还是可以直接按照 $t$ 排序。

但是这样使用线段树就显得 unbalanced 了，因为修改是 $O(n\sqrt n\log n)$ 查询是 $O(n\log n)$。

考虑使用一个分块代替这个申必的线段树，我们发现其实可以。

我们维护每个整段的两个端点，每次就只有加一个点的操作和临时加一些点的操作。

那其实就非常简单了，加点只有加连续段，拓展连续段和合并连续段的操作，临时的直接记录被修改的信息即可。