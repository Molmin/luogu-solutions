前置知识：根号平衡思想。

算法概述：对于一些特殊的操作 $f(a)$（$a$ 代表操作参数），分 $a$ 与 $\sqrt n$ 的大小关系，一半采用暴力，一半采用特殊手段，从而使两种复杂度都为 $O(n\sqrt n)$，总复杂度 $O(n\sqrt n)$。分块思想即从此衍生而来。

> 一共 $n$ 辆火车，每辆有两个参数 $x_i,y_i$
>
> 一共有 $m$ 天，每天会有一个事件：一辆火车 $k_i$ 开始使用，或一辆火车 $k_i$ 停止使用。
>
> 一辆火车 $k$ 在使用过程中会先工作 $x_k$ 天，再维修 $y_k$ 天，再工作 $x_k$ 天，如此往复，直至它被停止使用。停止使用的那一天被视作没有被使用。
>
> 对于 $1..m$ 中每一天，求这一天有多少火车在维修。

观察到火车的使用具有周期性和区间性，分类讨论：

- $x+y>\sqrt m$
  - 不会超过 $\sqrt m$ 个“工作、维修”周期，可以直接在差分序列上对维修区间的始末打标记
- $x+y\le \sqrt m$
  - 对于火车 $k$，什么样的天 $t$ 是维修日呢？$(t-s_k)\bmod (x_k+y_k)\ge x_k$ 时（$s_k$ 表示火车 $k$ 的开始使用日期）
  - 实时维护一个大小为 $\sqrt m$ 的数组 $f$，$f_{p,q}$ 表示第 $t≡q(\bmod p)$ 天有多少辆 $x+y=p$ 的火车在维修。
  - 研究第一排的式子，设 $v=(t-s_k)\bmod (x_k+y_k)\ge x_k$，则 $v≡t-s_k$，则 $t≡v+s_k$。
  - 于是对于每一次加入的火车，将 $f_{(v+s_k)\bmod p}++,v\in[x_k,x_k+y_k) $；在每一次结束时$--$；在每一天 $1\le t\le m$ 统计 $\sum _{i\le \sqrt m}f_{i,t\bmod i}$ 为这一天的答案。

【参考代码】[CF Submission](https://codeforces.com/problemset/submission/1580/130778035)
