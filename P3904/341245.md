**P3904 三只小猪 题解**

**[博客食用效果更佳](https://www.luogu.com.cn/blog/xrkRetaGRB/p3904-san-zhi-xiao-zhu-ti-xie)**

**题目链接：[P3904 三只小猪](https://www.luogu.com.cn/problem/P3904)**

这题和[P1655 小朋友的球](https://www.luogu.com.cn/problem/P1655)实在是太像了，它们的基本模型和所用的知识点都是一样的，甚至可以转化为同一道题，但那道题的数据范围大于这道题；并且那道题有多组数据，而这道题只有一组数据。。。。所以这样来说，这道题反而简单。~~但我很不明白，为什么那道题是绿题，这道是蓝？又一个恶评？~~

建议做了这道题的童鞋可以去做做小朋友的球。

**分析**

这是一个很典型的排列组合问题，完全可以放在高中数学里面的排列组合问题；这道题也是 12 种放球问题里面的一种（放球问题具体参见[放球问题—— by dbxxx 大佬](https://www.cnblogs.com/crab-in-the-northeast/p/ball-box-question.html)），然后如果想练放球问题，建议去做[十二重计数法](https://www.luogu.com.cn/problem/P5824)，但这道题数据范围太大，其中的第十个和第十二个都要用到多项式，所以我们出了一个数据范围只有 1000 的[十二重计数法【弱化版】](https://www.luogu.com.cn/problem/T188453)，可以方便您练习放球问题。

现在我们来看一下这道题。

大致题意：

将 $n$ 只小猪，分配到 $m$ 间**相同**的屋子里，问你总共有多少种方法。

如果学过**第二类斯特林数**的大佬们，一定可以一眼看出题目就是在让你求斯特林数。下面我来介绍一下第二类斯特林数（学过的神仙们可以跳过）。

**第二类斯特林数**

**定义**

第二类斯特林数又称**第二类 Stirling 数**，因为是数学家 James Stirling 提出的，所以用他的名字命名（不得不说他真的非常厉害）。

第二类 Stirling 数实际上是集合的一个拆分，表示将 $n$ 个不同的元素拆分成 $m$ 个集合的方案数，记为 $S(n,m)$ 或者 $\begin{Bmatrix}n\\ m\end{Bmatrix}$。

常常用于解决组合数学中几类放球模型。描述为：将 $n$ 个**不同**的球放入 $m$ 个**无差别**的盒子中，要求盒子非空，有几种方案？

**要注意：第二类斯特林数要求盒子是无区别的。**

**递推式**

我们可以从定义出发，考虑第 $n+1$ 个元素的情况。假设我们要讲第 $n+1$ 个元素分成分成 $m$ 个集合，则分析如下：

- 情况一：如果 $n$ 个元素构成了 $m-1$ 个集合，那么第   $n+1$ 个元素单独构成一个集合。方案数 $S(n,m-1)$，即：将 $n$ 个不同元素放入 $m-1$ 个不同元素的方案数。

- 情况二：如果 $n$ 个元素已经构成了 $m$ 个集合，将第 $n+1$ 个元素插入到任意一个集合。方案数：$m×S(n,m)$.

综合两种情况：

  $S(n+1,m)=S(n,m-1)+m×S(n,m)$
  


------------
好了，现在我们来回过头来看一下这道题。

我们很容易可以发现：
 
**这里的 $m$ 头猪相当于 $m$ 个小球，$n$ 个房子相当于 $n$ 个盒子！！**

所以问题就迎刃而解。

此题就想当于求第二类斯特林数。首先，我们可以开一个二维数组 $S(i,j)$ 来表示将 $i$ 头猪分配到 $j$ 个不同的房子中的方案数；再分别枚举 $i$ 和 $j$,通过上面推出来的递推方程稍稍转化一下来确定每一个 $S(i,j)$ 对应的值即可。

转化后的递推方程：

$S(i,j)=S(i-1,j-1)+j×S(i-1,j)$

那么最后的答案就是 $S(n,m)$。

**一些小坑点**

这道题的数据范围是:  $1≤n≤50$ , $0≤m≤50$。

如果直接套公式去写，肯定会 WA，亲测只有 70 分。所以要加上高精度。

最后还有一个坑点：当 $n<m$ 时，不存在可行的方案数，故要特判“0”。

代码如下：

```
//luoguP3904
#include<iostream>
#include<cmath>
using namespace std;
const int maxn=55;
int n,m;
string s[maxn][maxn];
string add(string a,string b)//高精度加法
{
	string ans;
	int l1=a.size(),l2=b.size();
	int lk=max(l1,l2);//选a和b里面长度最大的作为最终字符串长度
	int u[maxn*10]={0},v[maxn*10]={0};
	for(int i=0;i<l1;i++)u[l1-i-1]=a[i]-'0';
	for(int i=0;i<l2;i++)v[l2-i-1]=b[i]-'0';//字符串转数组
	for(int i=0;i<lk;i++)
	{
		u[i]+=v[i];
		u[i+1]+=u[i]/10;
		u[i]%=10;
	}//模拟加法运算
	if(u[lk])lk++;//当出现进位时，长度++
	for(int i=lk-1;i>=0;i--)ans+=u[i]+'0';//重新转成字符串
	return ans;
}
string mul(string a,int b)//高精a*单精b（大部分与加法相同，故不做注释）
{
	string ans;
	int l=a.size();
	int u[maxn*10]={0};
	for(int i=l-1;i>=0;i--)u[l-i-1]=a[i]-'0';
	int w=0;
	for(int i=0;i<l;i++)
	{
		u[i]=u[i]*b+w;
		w=u[i]/10;
		u[i]%=10;
	}
	while(w)u[l++]=w%10,w/=10;//注意这里与加法不同，是while循环而不是if特判，想一想为什么？
	for(int i=l-1;i>=0;i--)ans+=u[i]+'0';
	return ans;
}
int main()
{
	cin>>n>>m;
	for(int i=1;i<=n;i++)s[i][1]="1";//初始化
	for(int i=1;i<=n;i++)
	{
		s[i][i]="1";
		for(int j=2;j<=m;j++)
		{
			s[i][j]=add(s[i-1][j-1],mul(s[i-1][j],j));//递推方程
		}
	}
	if(n<m)cout<<"0"<<endl;//注意特判
	else cout<<s[n][m]<<endl;
	return 0;
}
```

AC记录：[100pts](https://www.luogu.com.cn/record/53807436)

完结撒花~~



------------
**另外这是本蒟蒻的第一篇题解，望大家多多支持，求管理员大大给过~~**

