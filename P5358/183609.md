#### 题意简述

给定一个长度为 $n$ 的操作数列 $a$，初始时 $a$ 中的所有元素均为 $0$，给定若干次操作，每次操作形如单点赋值，整体加，整体乘，整体赋值，单点询问或询问所有元素的和。

为了减少读入输出量，将只输入 $q$ 个标准操作以及 $t$ 组正整数 $(a_i,b_i)$，表示你需要进行 $qt$ 次操作，其中第 $\Big((i-1)q+j\Big)$ 次操作为第 $\Big((a_i+jb_i)\bmod q+1\Big)$ 个给定的标准操作，且最终你只需要输出最终答案对 $P=10^7+19$ 取模后的值即可。

对于 $50\%$ 的数据，满足 $n\le5\times10^5$，$t\le5$；  
对于全部数据，满足 $n\le10^9$，$q\le10^5$，$t\le100$ 且至少存在一次询问操作。

#### 题目解法

显然，采用任何对数复杂度的数据结构来解决这个问题都是不现实的，这提示我们需要采用**线性算法**来解决这个问题。

看到“整体加”，“整体乘”，“整体赋值”等字眼，让我们不禁想到**维护一个统一的变换**。

在本题中，我们可以将这个变换设置为 $ax+b$，则整体加，整体乘，整体赋值都可以轻松处理。

考虑单点赋值的处理，比较暴力的想法是对于每一个元素维护一个最近更新时间的时间戳，但更为精妙的方法是对于假设每一个位置的时间戳均为 $0$，根据修改后的值 $y$ **逆推出最开始的值 $x$**。

具体地，我们有 $ax+b=y$，所以只需让最开始的 $x$ 为 $\dfrac{y-b}{a}$ 即可，这可以用一个**哈希表**来维护。

为了让 $a$ 不为 $0$，我们需要让初始和区间赋值后的 $a$ 为任意非 $0$ 整数，但是，有一种特殊情况是当整体乘上 $0$ 的时候，此时 $a$ 和 $b$ 都会变成 $0$。我们发现这种情况与区间赋值为 $0$ 类似，只需让 $a=1$，$b=0$ 即可。

最后考虑查询操作，单点查询是简单的，整体询问相当于求 $\sum\limits_{i=1}^{n}(ax_i+b)=a\sum\limits_{i=1}^{n}x_i+bn$ 的值，可以在修改 $x$ 的过程中顺便维护 $\sum\limits_{i=1}^{n}x_i$ 的变化量，最终时间复杂度为 $\mathcal{O}(qt)$。

#### 总结

类似线段树的，整体的操作修改也可以使用懒标记解决，并且在过程中维护一些特殊位的信息时不一定需要维护这个过程中的切入时间戳，抑或是通过下传标记等方式来解决，而是可以通过逆推初始时的情况来解决问题，维护特殊位的信息可以采取哈希表等方式进行维护。