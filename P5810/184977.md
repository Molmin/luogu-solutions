$\ \ \ \ \ \ \ $对于这道题，我们定义 $dp_i$ 为打 $i$ 个字符所需要的最小时间。

$\ \ \ \ \ \ \ $我们很容易得到 dp 方程：

![](https://cdn.luogu.com.cn/upload/image_hosting/vc5d15mk.png)

$\ \ \ \ \ \ \ $但是我们的 dp 是 $O(n^2)$ 的。于是我们考虑优化。

$\ \ \ \ \ \ \ $由于我没有找到优化的点，于是考虑打表。我们的暴力 dp 就派上用上了。

```cpp
#include<cstdio>
#include<algorithm>
#include<cstring>
using namespace std;
int dp[40005];
int main(){
	freopen("Output.txt","w",stdout);
	printf("1 ");
	dp[1]=1;
	for(int i=2;i<=40000;++i)
	{
		dp[i]=dp[i-1]+1;
		for(int j=1;j<=i-1;++j)
		{
			if(i%j)	dp[i]=min(dp[i],dp[j]+(i/j)*2+5);
			else	dp[i]=min(dp[i],dp[j]+(i/j-1)*2+5);
		}
		printf("%d ",dp[i]);
	}
	return 0;
}
```

$\ \ \ \ \ \ \ $可以看见这是我们初始的表。但是表的长度是 120000，代码过长。[表在这里](https://www.luogu.com.cn/paste/4wyie471)。

$\ \ \ \ \ \ \ $考虑压缩表的长度。发现有很长一段都是相等的，并且 $n=40000$ 时，答案为 76，答案随着 $n$ 增大而增大。

$\ \ \ \ \ \ \ $我们现在把答案相等的一段集在一起，打一个表。

```cpp
#include<cstdio>
#include<algorithm>
#include<cstring>
using namespace std;
int a[40005];
int main(){
	freopen("Output.txt","r",stdin); 
	int n=40000;
	for(int i=1;i<=n;++i)	scanf("%d",&a[i]);
	freopen("watch.txt","w",stdout);
	printf("int ans[][2]={{0,0}");
	for(int i=1;i<=76;++i)
	{
		printf(",{");
		int l=0,r=0;
		for(int j=1;j<=n;++j)
		{
			if(l && a[j]!=i)
			{
				r=j-1;
				break;
			}
			if(a[j]==i && !l)	l=j;
		}
		if(r==0)	r=40000;
		printf("%d,%d",l,r);
		putchar('}');
	}
	puts("};");
	return 0;
}
```

$\ \ \ \ \ \ \ $我们现在得到了这样的一个表。现在我们可以通过这个表，找到 $n$ 所在的区间，输出答案了。

```cpp
#include<cstdio>
int ans[][2]={{0,0},{1,1},{2,2},{3,3},{4,4},{5,5},{6,6},{7,7},{8,8},{9,9},{10,10},{11,11},{12,12},{13,13},{14,15},{16,18},{19,21},{22,24},{25,28},{29,32},{33,36},{37,40},{41,45},{46,50},{51,55},{56,63},{64,72},{73,84},{85,96},{97,112},{113,128},{129,144},{145,160},{161,180},{181,200},{201,225},{226,252},{253,288},{289,336},{337,384},{385,448},{449,512},{513,576},{577,640},{641,720},{721,800},{801,900},{901,1008},{1009,1152},{1153,1344},{1345,1536},{1537,1792},{1793,2048},{2049,2304},{2305,2560},{2561,2880},{2881,3200},{3201,3600},{3601,4032},{4033,4608},{4609,5376},{5377,6144},{6145,7168},{7169,8192},{8193,9216},{9217,10240},{10241,11520},{11521,12800},{12801,14400},{14401,16128},{16129,18432},{18433,21504},{21505,24576},{24577,28672},{28673,32768},{32769,36864},{36865,40000}};
int main(){
	int n;
	scanf("%d",&n);
	if(n==0)	return puts("0")&0;
	for(int i=1;i<=76;++i)
	{
		if(ans[i][0]<=n && n<=ans[i][1])
		{
			printf("%d",i);
			return 0;
		}
	}
	return 0;
}
```