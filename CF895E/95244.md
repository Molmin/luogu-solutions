考虑 $1$ 操作对 $2$ 操作的影响。根据期望线性性质，计算区间期望和其实就是计算区间内每一个数的期望值。那么 $1$ 操作过后，以 $[L_1,R_1]$ 为例，$E(x_i)=\dfrac{R_1-L_1}{R_1-L_1+1}E(x_i)+\dfrac{1}{(R_1-L_1+1)(R_2-L_2+1)} \sum_{k\in[L_2,R_2]}E(x_k)$。所以维护区间和，支持区间乘、区间加即可。