题是挺简单，但是这个构造看上去挺典。

首先无解的条件是 $k$ 是偶数或者 $k=n$，判掉即可。

考虑 $k=1$，就是一个经典的格雷码问题，分治构造一下即可，具体来说考虑求解 $n$ 的答案，我们求出 $n-1$ 的答案，首尾翻转一下并将每一项加上 $2^{n-1}$ 后拼接在原序列后面即可。

$k=n-1$ 的情况也是类似的，构造 $k=1$ 的格雷码序列，将序列中第偶数项全部 flip 一下即可，由于 $n$ 是偶数（否则 $k$ 就是偶数无解了），所以 flip 后序列中所有数仍然两两互不相同。

接下来考虑 $n-1>k$ 的情况，我们还是归纳构造，每次将 $n$ 减一，直到 $k=n-1$，而这个归纳方法也是容易的——求出 $n-1,k$ 时的序列 $a'$，再找到一位 $b$ 满足 $a'$ 开头和结尾元素第 $b$ 位互不相同，然后构造序列 $a''_i=a'_i\oplus 2^b\oplus 2^{n-1}$，取 $a=a'+a''$ 即可。