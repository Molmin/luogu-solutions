### 题目分析：

我们先将衣服以品质为第一关键字降序排序，以价格为第二关键字升序排序。我们直接模拟题意，时间复杂度达到 $O(nm)$，显然过不了。

我们不妨将人拥有的钱从大到小排序，现在我们只需要考虑每一个物品对整体的贡献，记当前衣服的价格为 $c_i$，当前人们有 $v_j$ 的钱。我们找出所有 $v_j\ge c_i$ 的人，将其钱减去 $c_i$，并将其能够购买的衣服 $+1$。不难发现，这种权值区间修改，查询集合权值的问题，我们可以使用平衡树来维护。

但我们还能发现，若当前一个人拥有 $c_i+1$ 的钱，另一个人拥有 $c_i-1$ 的钱。前者会买，后者不会买，他们拥有钱的多少相对大小发生了改变。也就是平衡树它所拥有的性质会被破坏掉。

解决这一问题的办法，我们可以对 $v_i\in[1,c_i)$ 的人不做操作，$v_i\in[c_i,2c_i)$ 的人暴力修改，$v_i\in[2c_i,+\infty)$ 的人打标记修改。由于一个数被暴力修改的次数不会超过 $\log v$ 次，所以时间复杂度为 $O((n+m)\log n\log v)$，可以通过本题。