01trie

根据异或的性质，我们可以通过前缀异或快速求出 $l\sim r$ 的异或和，假设 $s_i$ 表示前 $i$ 个数中的异或和，那么 $s_r\oplus s_{l-1}$ 就是 $\bigoplus_{i=l}^{r} a_i$

一个常用的思路，固定住一端，通过求符合条件的另一端达到计数的目的。

很自然的想到固定住 $r$，通过求符合条件的 $l$ 的数量，就可以求出答案。

现在讲问题转化为如何快速求符合条件的 $l$ 的数量。

考虑建一棵有关 $s_i$ 的 trie，通过检索字典树来进行快速求解。

由于字典树是 01 的形式呈现，不妨把 $k$ 也拆成二进制的形式，从高位到低位枚举。

思考一个小问题，如何判断一个数大于等于 $k$，如果在高位的二进制中，有一位 $k$ 比这个数小，那么后面的数无论是什么，都是这个数大于 $k$，当然前提是前面的数都要一样。

接着字典树说，我们假设当前已经找到了第 $i$ 位，数 $r$ 二进制的第 $i$ 位为 $c_1$，$k$ 的为 $c_2$，前面的都是相同的。

如果 $c_2=0$，那么如果字典树中存在与 $c_1\oplus 1$ 的节点，那么肯定接下来的全部都会大于 $k$，因此答案加上 $sz_{nxt_{p,c_1\oplus 1}}$，然后检索反方向。

否则的话只能检索 $c_1\oplus 1$。

最后检索完毕时，因为可以大于等于，所以还要加上 $sz_p$。

空间该开多大呢？这也是字典树中一个常见的问题，注意到有 $n\le 10^6$ 个数，每个数至多有 $31$ 位，所以开位数乘上数的个数即可。