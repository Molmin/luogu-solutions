这道题其实也不是很难，就是要用$NTT$而已……

首先考虑定义$f_i$表示钦定$i$种颜色出现了恰好$S$次，别的颜色随便选的方案数（钦定的不一样就算不一样）。$g_i$表示有恰好$i$种颜色出现了恰好$S$次，那么容斥一下有$g_i=\sum_{j=i}^{min(m,n/s)}{(-1)^{j-i}*C_j^i*f_j}$

考虑化简这个式子

$ \begin{aligned}
g_i & = \sum_{j=i}^{min(m,n/s)}{(-1)^{j-i}*C_j^i*f_j}\\
& = \sum_{j=i}^{min(m,n/s)}{(-1)^{j-i}*\frac{j!}{i!*(j-i)!}*f_j}\\
& = \sum_{j=i}^{min(m,n/s)}{\frac{1}{i!}*\frac{(-1)^{j-i}}{(j-i)!}*f_j*j!}\\
\end{aligned} $

所以有$g_i*i!=\sum_{j=i}^{min(m,n/s)}{\frac{(-1)^{j-i}}{(j-i)!}*f_j*j!}$，注意到后面这个东西是可以使用一些手法来卷积的，所以只需要把$f_i$表示成比较好求的形式求出来，套个$NTT$就做完了。

下面来考虑表示$f_i$。首先我们可先把钦定的颜色每种内部的$S$个看作相同，互相之间不同，未钦定的其他颜色全部看作相同，那么这就是一个可重集的全排列问题，那么钦定$i$个的方案为$\frac{n!}{(s!)^i*(n-i*s)!}$。之后考虑如何表示$f_i$。首先，钦定时有$C_m^i$种方法，之后那$n-i*s$个位置每个又有$m-i$种选法，所以$f_i=C_m^i*\frac{n!}{(s!)^i*(n-i*s)!}*(m-i)^{n-i*s}$。所以就做完了。

可能有人不知道一些手法是什么，我还是最后说一下。

令$a_j=f_j*j!$，$b_j=\frac{(-1)^j}{j!}$，$k=min(m,n/s)$。那么显然$g_i*i!=\sum_{j=i}^{k}{b_{j-i}*a_j}$。

考虑换个写法，$g_i*i!=\sum_{j=0}^{k-i}{b_j*a_{j+i}}$

令$c_i=a_{k-i}$，则$g_i*i!=\sum_{j=0}^{k-i}{b_j*c_{k-i-j}}$，这样就可以卷积了。