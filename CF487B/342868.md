# 题解

- $s,l$ 如题，设$\{a_i\}$ 为原数组，$dp_i$ 为第 $i$ 位时最少的分段数，则 $dp$ 方程为：

$$dp_i=\min\{dp_j+1\}(j\in[1,i-l],\max\{a_k(k\in[j,i])\}-\min\{a_k(k\in[j,i]\}\le s)$$

- 显然可以发现，后面的 $\max\{a_k(k\in[j,i])\}-\min\{a_k(k\in[j,i]\}$ 可以用 $ST$ 表来维护，时间复杂度 $O(n\log n)$，十分简单就不详讲。

- 但是即使用了 $ST$ 表，$dp$ 状态转移时间复杂度仍为 $O(n^2)$。我们可以用一个变量，记录下最右侧的分割点，每次从这个分割点的答案往右找，由于这个分割点会不断往右，所以时间复杂度很低，接近 $O(n)$。

- 最后当转移不到 $n$ 时，输出 $-1$ 即可。

- 最终时间复杂度为 $O(n\log n+n)$。