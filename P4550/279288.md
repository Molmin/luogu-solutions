一道基础的期望dp而已，不过这两年noip好像有考期望的趋势，所以过来巩固一下。

期望简单来说，就是概率乘权值。比如我有一个骰子，摇到每一个面的概率都是$\frac{1}{6}$，权值分别为$1,2,3,4,5,6$,那么我摇骰子的期望值就是$\frac{1}{6}*1+\frac{1}{6}*2+\frac{1}{6}*3+\frac{1}{6}*4+\frac{1}{6}*5+\frac{1}{6}*6=3.5$

我摇骰子的期望值就是$3.5$（虽然不明白骰子六个面都是整数为什么有人期望着摇出来个$3.5$

本题也是一样，我们考虑设计$dp[i]$表示已经有了$i$张邮票，买到剩下所有$n-i$张邮票的期望次数。

下一次买的情况有买到新的和没买到新的，概率分别为$\frac{n-i}{n},\frac{i}{n}$，权值分别为$dp[i+1]+1,dp[i]+1$,并且显然有$dp[n]=0$，我们就可以列出方程。

$dp[i]=\frac{n-i}{n}*(dp[i+1]+1)+\frac{i}{n}*(dp[i]+1)$

这里的$dp$是购买次数，化简后我们就可以得到另一个美观的式子。简述化简过程就是展开右式，再把两个含$dp[i]$的合并然后同除就好了，最终得到。

$dp[i]=dp[i+1]+\frac{n}{n-i}$

然后我们考虑价格。用相似的办法设计一个$f[i]$表示已经有了$i$张邮票买到剩下所有邮票的期望价格，显然$f[n]=0$，相似的考虑买到与没买到，我们有

$f[i]=\frac{n-i}{n}*(f[i+1]+dp[i+1]+1)+\frac{i}{n}*(dp[i]+f[i]+1)$

我来给大家解释一下这个式子，有些同学可能会疑惑为什么会出现先前的购买次数。因为你买了这张邮票后，剩下的每张邮票都会贵1元，剩下的还要买$dp[i]$次，所以就要把这部分钱也加进去。

整理后，我们会得到另一个式子，过程类似，这里不再赘述。

$f[i]=\frac{i}{n-i}*dp[i]+f[i+1]+dp[i+1]+\frac{n}{n-i}$

代码中注意精度，不要混淆int 与 double

AC代码

```cpp
#include<bits/stdc++.h>
#define ri register int
using namespace std;
int n;
double dp1[10010],dp2[10010];
int main()
{
	scanf("%d",&n);
	dp1[n]=dp2[n]=0;
	for(ri i=n-1;i>=0;i--)
	{
		dp1[i]=dp1[i+1]+(double)n/(double)(n-i);
		dp2[i]=(double)i/(double)(n-i)*dp1[i]+dp2[i+1]+dp1[i+1]+(double)n/(double)(n-i);
	}
	printf("%.2lf",dp2[0]);
}
```
