注意此题其中 $1 \sim n1$ 和 $n1+1 \sim n1+n2$ 是两个分别的连通块，然后我们要在这两个连通块连一条边，使得 $1$ 和 $n1+n2$ 的距离最长，那么此时我们就可以对于 $1$ 和 $n1+n2$ 跑两次最短路，最后我们对于每个答案的最大值和，在这两个结束的位置连边，答案就是最大值和 $+1$。

[代码](https://atcoder.jp/contests/abc309/submissions/43374046)