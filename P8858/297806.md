- [原题链接](https://www.luogu.com.cn/problem/P8858)

- 赛时想法，可能较繁。

------------

首先你需要发现结论：答案 $ans$ 的取值为：$2 \leq ans \leq 4$。

下给出证明：

- 若答案为 $1$，折线就必须沿着边缘走，不可能将所有点均分。

- 考虑对任意情况构造折点为 $4$ 的方案：将所有点按 $x$ 为第一关键字，$y$ 为第二关键字从小到大排序，找到第 $\frac{n}{2}$ 个点所在列，从 $(0,0)$ 出发，向右走到这一列与前一列之间，向上走，直到这一列上面的点加上之前列的点恰好 $\frac{n}{2}$ 个，继续向右恰好穿过这一列，然后向上走到边界再向右至终点。不难发现这样构造一定能行。

接下来考虑每种答案各是什么情况：

- 不难发现当答案为 $2$ 时，一定是竖着一条线将点集均分，或者是横着一条线将点集均分，那朴素判断是否存在一行（一列），使得这一行（列）以前的所有行（列）中，恰好有 $\frac{n}{2}$ 个点即可。

- 同样地，考虑答案为 $3$ 时，一定是一条折线将左上角或右下角割去 $\frac{n}{2}$ 个点，那即判断是否存在一对 $X,Y$ ，使得满足 $ X \leq x $ 且 $ y \leq Y$ 的 $(x,y)$ 恰好 $\frac{n}{2}$ 个，或者满足 $ x \leq X $ 且 $ Y \leq y$ 的 $(x,y)$ 恰好 $\frac{n}{2}$ 个。求法也比较简单，以第一种为例，从大到小枚举 $X$，对于每一个 $X$，求出最小的 $Y$ 使得满足条件的点大于 $\frac{n}{2}$，判断是否取等就行了，朴素做 $n^2$，发现当 $X$ 变化时 $Y$ 具有单调性，双指针加树状数组判断即可。

- 剩余的情况答案则为 $4$。

时间复杂度 $O(n \log n)$。

[代码](https://www.luogu.com.cn/paste/x5kje5np)

完结撒花~

