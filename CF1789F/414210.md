哼哼哼，啊啊啊啊啊。（记得加句号。）

捏麻麻，被这题狠狠地创死了。

## 正文

考虑最朴素的暴力，枚举 $T'$ 出现了 $k$ 次，暴力枚举 $k-1$ 个分割点跑 LCS，时间复杂度 $\Theta(n^{2k-1})$，只能跑过 $k\leq 3$。

考虑另一个暴力。将 $S$ 划分为长度为 $\frac{n}{k}$ 的段，则 $T'$ 一定为至少一个段的子序列，对于每一段，枚举 $T'$ 后贪心匹配，时间复杂度为 $\Theta(2^{\frac{n}{k}}kn)$，可以跑过 $k \geq 5$。

$k$ 等于 $4$ 怎么办呢？我们发现，对于任何 $k=4$ 的串 $S$，一定可以在 $k=2$ 的时候找到 $S=2T'_2=2(T'_4+T'_4)$ 从而被统计入答案，因此无需单独考虑。题就做完了。

## 后记
![](https://cdn.luogu.com.cn/upload/image_hosting/etux2wl0.png)