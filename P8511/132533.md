**P8511**

y1s1，我最开始真没开出来这个补信息全局支配点的套路。

一个平凡的做法是直接在 $\text{dfn}$ 序上分治，挪动一下两端的指针就行了，时间复杂度 $\text O(\text n \log ^ \text 2 \text n)$。

考虑一个更简单的想法：我们先求出全局的答案，设两个点为 $\text A,\text B$，显然非 $\text A,\text B$ 祖先的节点答案都将是全局答案。

然后我们从根节点跑到 $\text A$ 和 $\text B$，每次暴力加入子树补信息更新答案即可。

信息的维护用 $\text{Trie}$ 即可，时间复杂度 $\text O(\text n \log \text n)$。