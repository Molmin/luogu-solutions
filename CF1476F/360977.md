难度虚高，建议评 蓝 / 紫。

对于此类覆盖所有点的问题，设计状态时不难想到以一个前缀的编号覆盖一段前缀，因此我们可以设 $f_i$ 表示前 $i$ 个灯笼能覆盖的最远前缀到了第 $f_i$ 个灯笼。转移可以考虑将 $i$ 朝左和 $i$ 朝右分开考虑。

1. 当 $i$ 朝右时，若 $f_{i-1} \ge i$，则 $f_i=\max(f_{i-1},i+p_i)$，若 $f_{i-1} < i$，则 $f_i=f_{i-1}$ 。
2. 当 $i$ 朝左时，我们可以发现，只要将前缀覆盖到 $i-p_i$ 的位置，设 $j$ 为第一个满足 $f_j \ge i-p_i$ 的位置，则 $j+1$ 到 $i-1$ 的位置都能向右，所以此时 $f_i=\max_{k=j+1}^{i-1} k+p_k$。可以二分出 $j$，接着用线段树或 ST 表查出 $j+1$ 到 $i-1$ 中的最大值。

是个典题，但实现时可能需要注意一些细节。

[Code](https://codeforces.com/contest/1476/submission/210231547)