注意到对于任意一个点，它满足条件当且仅当，若以它为根的话，那么没有颜色相同的祖先后代对。

那么很自然的想到换根，实时维护当前颜色相同的祖先后代对个数（注意要开 `ll`）。

首先求出初始值。我们考虑换一次根这个值会有什么变化。

考虑所有点对。如果点对在老根和新根的子树中的同一个的话，那关系显然不变。然后如果是不同的，并且两个都不是老根或新根，那显然也不变。于是只需要考虑新根子树对老根的贡献和老根子树对新根的贡献即可。这个只需要一开始离散化一下，装个桶，然后在 dfs 序上二分即可。

复杂度线对。有时候研究线性做法也是没啥意义的。