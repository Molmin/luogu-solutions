先确立一个根。我们要判断以每一个点开始的所有路径是否存在重复值。那么可以 dfs：

1. 往下爬

这部分很好做，直接进行一次自下而上的 dfs 即可，$u$ 如果可行，就需要在 $u$ 的子树中的所有值都和 $u$ 的值不一样（可以用 dfs 序实现），而且满足 $fa[v]=u$ 的所有 $v$ 也需要可行。如果可以那么称之为 $1$ 类可行。

2. 往上跑后往下爬

这部分也不难，直接进行一次自上而下的 dfs 即可。$u$ 如果可行，就需要 $u$ 和 $fa[u]$ 在除去 $u$ 的子树的大树上的值是唯一的，$fa[u]$ 需要可行，而且 $fa[u]$ 的子树的子节点（除去 $u$）也需要 $1$ 类可行，如果满足这些条件（当然需要 $1$ 类可行），就可以了。