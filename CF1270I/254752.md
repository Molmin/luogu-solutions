推一波 Anton 题。记 $n=2^k$。

我们先考虑所有输入的 $a_{i,j}$ 都是 $0,1$ 的情况。我们把题目中的矩阵视为 $\bmod (x^n-1),(y^n-1)$，并且系数在 $\mathbb{F}_2$ 中的 的二元多项式。注意这里 $x^n-1,y^n-1$ 中的逗号其实表示每一项系数依次对 $x^n-1$ 和 $y^n-1$ 取模，也就是题目中的循环卷积。

稍作转换会发现题目会给一个 二元多项式 $B$，其中 $1$ 的个数最多 $99$，求一个多项式 $C$ 使得 $BC=A$。（在模 $(x^n-1),(y^n-1)$ 意义下）

考虑求出 $B$ 的逆。然而这里有一个非常巧妙的观察：$B^n$ 在模意义下为 $1$。这是因为对于 $\mathbb{F}_2$ 中的多项式 $P(x,y)$ 有 $P^2(x,y)=P(x^2,y^2)$。这样由于 $n$ 是 $2$ 的幂，$P^n(x,y)=P(x^n,y^n)=t=1$，其中最后一个等号用到了我们的多项式对于 $x^n-1,y^n-1$ 取模以及条件中的 $t$ 为奇数。

这样 $B$ 的逆就是 $B^{n-1}$。我们依次计算 $B,B^2,B^4,\cdots,B^{\frac{n}{2}}$（只用每一次把 $x^ay^b$ 的系数变成 $x^{2a \bmod n}y^{2b \bmod n}$ 的系数）并一个个暴力乘上 $A$（每一次都只会有 $t$ 个非零系数，复杂度正确）。

当然现在 $A$ 的每一维都是可以 $\text{xor}$ 的整数，也可以视为独立的向量。因此将上述算法中所有乘法中加法的步骤改成 $\text{xor}$ 即可。