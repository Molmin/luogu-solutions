### UVA12099 书架 The Bookcase

是[P2160](https://www.luogu.com.cn/problem/P2160)的双倍经验，只需要在这题的代码外面套上一个循环 $T$ 次即可，时间充裕，不过记得要多测每次初始化数组。

我们先考虑最笨的做法（开一个7维数组存储，具体实现方法略，记忆化搜索/dp均可），像这样：

```cpp
f[i][w1][w2][w3][h1][h2][h3]
```

表示的是，此时该放第 $i$ 本书，各层宽度是 $w_1, w_2, w_3$，高度是 $h_1, h_2, h_3$ 的最小书柜尺寸的状态。空间会炸，不过我们大概找到了转移方法，接下来只要压维就好了。

首先发现这些书的宽度和是一定的，即 $w_1+w_2+w_3$ 是定值，于是可以干掉 $w_3$，代成目前到了第 $i$ 本书的总宽度减去 $w_1$ 和 $w_2$。

接下来不用一些技巧是没有办法把 $h_1, h_2, h_3$ 压掉的。我们知道对于每一层（第 $i$ 层），影响 $h_1$（或 $h_2$，$h_3$）的永远只有最高的那本书，于是可以将所有书从高到低排序，就不用考虑高度的变化了。

最后，注意到 $f[i][w1][w2]$ 只和 $f[i-1][...][...]$ 相关，因此可以把第一维（$i$）压成0/1的滚动数组，代码中 $prev$ 和 $curr$ 就实现了这个。

至此，我们把 $f$ 数组的空间压到了可接受的 $2 \times 2100 \times 2100$（第一项滚动数组是0/1，$w1$ 和 $w2$ 最大不超过 $n \cdot t_i$，也就是 $70 \times 30=2100$）。