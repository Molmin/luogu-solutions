$b_i$ 为 $a_i$ 的倍数且 $b_i$ 互不相同，形成匹配。

考虑每个 $a_i$ 作为左部点向它的所有右部点倍数连边，每个右部点向汇点连容量 $1$，费用为其数值的边。最小费用最大流即为所求。

因为 $a_i$ 只会连向不超过 $n$ 倍其大小，所以总边数和点数均为 $\mathcal{O}(n ^ 2)$。

注意到费用仅在右部点流向汇时产生，所以我们从小到大枚举权值，每次连对应费用的边，然后检查 $S\to T$ 是否有增广路。若有，则该权值在匹配内，否则不在。时间复杂度 $\mathcal{O}(n ^ 4)$，但是可以通过。[代码](https://codeforces.com/contest/1728/submission/193013712)。

事实上，如果没有增广路，不要清空每个点是否被访问。加边时更新 `visit` 数组并检查是否存在增广路，即可做到 $\mathcal{O}(n ^ 3)$。

然后它被 [卡常](https://codeforces.com/contest/1728/submission/193024668) 了，因为链式前向星有点慢。我们发现它被全 $1$ 数据卡掉了，加一个判断相同 $a$ 的优化即可 [通过](https://codeforces.com/contest/1728/submission/193026341)。直接使用匈牙利也可以通过，在这种比较稠密的图上寻找增广路，dfs 比 bfs 更优秀一点（其实是在较多 $a$ 相同的数据下表现良好）。[代码](https://codeforces.com/problemset/submission/1728/193028180)。