因数论能力太菜，来机房时先来一道数论题练练手。

光思考时间就已经快 $30\text{min}$ 了，写代码又是因为不会这个不会那个的浪费了 $2\text{h}$。

这题有两个限制，一个是 $\gcd\limits_{i\in S}a_i\not=1$，另一个是 $\gcd(a_{x\not\in S},\gcd\limits_{i\in S}a_i)=1$。

假设我们确定了 $\gcd\limits_{i\in S}a_i=v$ 的个数，那么我们其实只需要知道在 $a$ 序列中与 $v$ 互质的个数即可。

设 $f(x)$ 为 $\gcd\limits_{i\in S}a_i=x$ 的个数，$g(x)$ 为在 $a$ 序列中与 $x$ 互质的个数，那么容易得到答案为：

$$\sum f(i)g(i)$$

其中 $g(i)$ 的求法非常简单（~~但我就是不会做~~），只需要先求出 $i$ 在 $a$ 序列中出现了多少次，再用**狄利克雷后缀和**求出 $i$ 的倍数在 $a$ 序列中从出现了多少次，最后用**狄利克雷前缀和**和**莫比乌斯反演**求出 $g(i)$。

$f(i)$ 的求法更为简单了，首先根据之前求出的 $i$ 的倍数的个数可以得出 $\gcd|i$ 的方案数为 $2^{i\text{的倍数的个数}}-1$，最后做**倒狄利克雷后缀和**即可。

~~一道题聚集了三种狄利克雷前缀和及其拓展可还行。~~

时间复杂度：$O(n+a_i\log\log a_i)$