每部电影的下载时间肯定会算满，唯一可以节省时间的地方在于同时观看和下载电影。我们先将观看电影的时间也算上，即令初始答案为 $n + \sum a_i$。

考虑观看顺序 $b_1, b_2, \cdots, b_n$。如果 $a_{b_i} + a_{b_{i + 1}}\leq m$，则代价减少 $1$。我们希望找到排列 $b$ 使得这样的 $i$ 尽量多。

将 $a$ 从小到大排序，假设有 $k$ 对这样的 $i$，选择最小的 $k + 1$ 个数构造 $k + 1, 1, k, 2, \cdots$ 是最优的，它保证了相邻两个数之和的 $\max$ 最小。二分检查即可。

简化二分过程，可以双指针做到除排序外 $\mathcal{O}(n)$。[代码](https://codeforces.com/contest/1765/submission/185238200)。