首先二分答案，将问题转化为可行性问题，对于一个$mid$值，只需要判断“是否存在$(a,b)$，使所有妖怪的战斗力均$<=mid$”。如果存在，说明答案不大于$mid$。如果不存在，说明答案不小于$mid$。

对于一个妖怪，设它的$atk$为$x$，$dnf$为$y$。则它在环境$(a,b)$下的最大攻击力是$x+y*a/b$。最大防御力是$y+x*b/a$。于是可得它在环境$(a,b)$下的战斗力是$x+y+x*(b/a)+y*(a/b)$。

由上式可以发现，一个妖怪在环境$(a,b)$下的战斗力只与$x$、$y$和$(a/b)$的值相关。设$t=b/a$，则战斗力可以化为$x+y+x*t+y*(1/t)$。因为$x$、$y$都是给定的固定值，所以$x$、$y$都可以看做是常数，而能改变战斗力的变量只有正实数$t$。

接下来，我们考虑$t$应该如何取值才能使战斗力不大于$mid$。根据上式，有

$x*(b/a) + y*(a/b) + x + y <= mid$

即 $x*t + y*(1/t) <= mid-x-y$

由于$t$为正数，所以 $x*t^2 - (mid-x-y)*t + y <=0$。

设$d=mid-x-y$，则 $x*t^2 - d*t + y <=0$

注意到这是一个关于$t$的一元二次不等式。所以可以根据求根公式得到解集。

$\delta = d^2 - 4*y*x$

$t_1 = (d-\sqrt{\delta})/(2*x)$

$t_2 = (d+\sqrt{\delta})/(2*x)$

$t_1 <= t <= t_2$

所以我们分别针对$n$个妖怪求出$t$的取值范围，这$n$个取值范围如果存在交集，证明存在$(a,b)$使所有妖怪的战斗力均$<=mid$。

效率为$O(n*log_2{max(atk,dnf)})$

这种方法具体实现时，需要注意常数。