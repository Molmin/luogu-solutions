**不用求逆序对的方法也可以做。**

逆序对指，设一个数列中有A和B两个元素，如果A的值大于B的值，且A的下标小于B的下标，称A和B为一对逆序对。

首先观察样例得知，如果数列中出现过j - 1，那么就会出现逆序对。具体出现多少呢？设当j增加1时，如果i点的值不变，那么称作一次修改。因为j在不断提高，所以j - 1也在不断提高，因此后来修改的值，肯定大于前面修改的值，并且小于没被修改过的值。不难得出，每一次修改，都会增加1 ~ i - 1中没被修改过的数量个逆序对。

所以我们只需要求出在当前j时，如果j - 1这个值出现过，答案就累加1 ~ i - 1中没被修改过的数量（i为j - 1这个值在原数列中的位置），问题就是求1 ~ i - 1中有多少个没被修改过的呢？暴力肯定是不行的，n ^ 2会炸，所以考虑线段树维护，具体参见代码。

全文 + 代码：https://www.cnblogs.com/qqq1112/p/13117572.html