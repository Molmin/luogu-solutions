[题目链接](https://www.luogu.com.cn/problem/CF1646D)

## 题目大意

给定一棵树，你需要给树的每一个节点确定一个正整数权值 $w_i$。一个节点的 $u$ 的贡献就是 

$$
[w_u=\sum_{(u,v)}w_v]
$$

构造一种方案使得所有节点贡献总和最大，在最大的情况下，最小化 $\sum w$ 的值。

## 思路

先想一想树上相邻的两个点是否都可能造成 $1$ 的贡献。

答案是肯定的，但是只有一种情况就是

```
2
1 2
```

这组数据。

我们对这组数据进行特判之后，剩下的数据就有了一个特殊的性质——**相邻两个点至多只会有一个点造成贡献。**

接下来考虑树形 $dp$。默认以 $1$ 为根。

- 设 $f_{i,0}$ 表示 $i$ 造成 $1$ 的贡献的时候 $i$ 的子树内最多可以造成多少贡献。
- 设 $f_{i,1}$ 表示 $i$ 造成 $0$ 的贡献的时候 $i$ 的子树内最多可以造成多少贡献。
- 设 $g_{i,0}$ 表示在满足 $f_{i,0}$ 最大的情况下，$i$ 的子树中所有节点权值总和的最小值。
- 设 $g_{i,1}$ 表示在满足 $f_{i,1}$ 最大的情况下，$i$ 的子树中所有节点权值总和的最小值。

转移比较显然。

对于 $f_{i,0}$：

$$
f_{i,0}=\sum_{j \in son_i} f_{j,1} 
$$

对于 $f_{i,1}$：

$$
f_{i,1}=\sum_{j \in son_i} \max\{f_{j,0},f_{j,1}\}
$$

对于 $g$ 的转移讨论一下即可。

接下来考虑怎么给点确定权值。

我们计 $du_x$ 表示与 $x$ 相连的点的数量。

- 如果要 $x$ 产生 $1$ 的贡献，$w_x \leftarrow du_x$。
- 否则 $w_x \leftarrow 1$。

最后根据求出来的 $f,g$ 递归求解方案即可。

[评测记录](https://codeforces.live/problemset/submission/1646/148380498)