## $\text{Description}$
你有一个字符串 $S$ 和一个字符串数组 $[t_1, t_2, \ldots, t_k]$.  
串 $t_i$ 仅包含 $a$ 和 $n$ 的小写字母；$S$ 中仅包含 $a$ 到 $n$ 以内的小写字母和不超过 $14$ 个问号.

每一个字符串 $t_i$ 有一个整数花费 $c_i$.一个字符串 $T$ 的价值计算公式为 $\displaystyle \sum_{i = 1} ^ k F(T, t_i) \cdot c_i$，其中 $F(T, t_i)$   
表示字符串 $t_i$ 在 $T$ 中的出现次数。举例来说，$F(\texttt{aaabaaa}, \texttt{aa}) = 4$.

你需要用 $a$ 到 $n$ 以内的小写字母来替换 $S$ 中的问号，每个小写字母只能替换一个位置。请求出所能得到的 $S$ 的最大价值.
## $\text{Solution}$
不难想到 AC 自动机.  
设计 $dp_{s,i}$ 表示字母选取状态为 $s$ ，在自动机跑到 $i$ 结点，的最大价值.  
由于问号极其稀疏，预处理出每个结点 $x$ 从上一个问号到下一个问号在 AC 自动机上走到的位置和获得的价值，直接转移即可.  
时间复杂度 $O(14\times 2^{14}\sum|s|)$.