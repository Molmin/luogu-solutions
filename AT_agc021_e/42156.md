枚举喂的红、蓝球个数 $R,B$，$R<B$ 或 $R\ge B+n$ 是简单的。当 $B\ {\color{red} <}\ R<B+n$ 时，一定存在一种喂球方式，一些变色龙**恰好按顺序吃了一个红球、一个蓝球**，另外一些变色龙红球比蓝球恰好多 $1$。

> 证明：设任意一种合法分配方式为 $A$。假如 $A$ 中有一个变色龙红 - 蓝大于等于 $2$，把这个红球分配给任意一个红 - 蓝等于 $0$ 的龙（显然一定存在这个龙）。假如 $A$ 中有一个变色龙红 - 蓝等于 $0$ 且吃了大于 $1$ 对，那取出最靠后的 `RB` 子序列分给另外一个红 - 蓝等于 $1$ 的龙。

这样，红球比蓝球恰好多 $1$ 的变色龙有 $(R-B)$ 只，红蓝相等的有 $n-(R-B)$ 只。一个喂球序列合法，当且仅当能取出 $n-(R-B)$ 个不交子序列 `RB`。

> 证明：先证充分，先取出这些子序列，剩余 $R-n+R-B=2R-n-B$ 个红球、$B-n+R-B=R-n$ 个蓝球，剩余的球中红 - 蓝等于 $R-B$ 且每只红球比蓝球恰好多 $1$ 的变色龙恰需要一个红 - 蓝，可以分配。再证必要，若取不出来就不能满足红蓝相等的有 $n-(R-B)$ 只。

能取出 $n-(R-B)$ 个不交子序列 `RB`，当且仅当任意前缀 `B` 比 `R` 多的数量不超过 $B-n+(R-B)=R-n$ 个。

> 能取出 $K$ 个不交子序列 `RB`，当且仅当任意前缀 `B` 比 `R` 多的数量不超过 $B-K$ 个。
>
> 证明：先证必要，假如某一个前缀里 `B` 比 `R` 多的数量超过 $B-K$ 个，这 $B-K+1$ 个 `B` 再也无法配对，那可能配对的总数 $\le B-(B-K+1)=K-1$，不可能取出 $K$ 对了。再证充分，相当于证明
>
> > 只要任意前缀 `B` 比 `R` 多的数量不超过 $B-K$ 个，就能取出 $K$ 个不交子序列 `RB`。
>
> 考虑证明逆否命题
>
> > 只要不能取出 $K$ 个不交子序列 `RB`，就存在一个前缀 `B` 比 `R` 多的数量超过 $B-K$ 个。
>
> 把能取出的所有 `RB` 删掉，最终一定形如 `BB...BRR...R`，其中 `B` 的数量大于 $B-K$，因此取这段前缀就得证。

接下来就是不碰线的路径计数问题。

还有一种情况：$R=B$，此时第一条证明中

> 假如 $A$ 中有一个变色龙红 - 蓝等于 $0$ 且吃了大于 $1$ 对，那取出最靠后的 `RB` 子序列分给另外一个红 - 蓝等于 $1$ 的龙。

这句话就不成立了。但注意到 $R=B$ 时最后一个喂的一定是蓝球，把这个球删掉变为 $R=B+1$ 的情况，就可以套用上述分析了。