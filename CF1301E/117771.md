看到题目里这个 $\text{logo}$ 的重点应该是这个正方形的中心。

取出这个中心之后四个角就是四个等大的正方形。

所以我们现在要想办法求出以 $(x,y)$ 为右下角的红色正方形边长的最大值（其它的颜色类似）。

先求出 $u_{i,j}$ 表示 $(i,j)$ 向上能延伸多少个红格，$l_{i,j}$ 表示 $(i,j)$ 往左能延伸多少个红格。

在 $O(n^2)$ 时间内有一车求法，就不说了。

记 $v_{i,j}$ 表示以 $(i,j)$ 为右下角的红色正方形边长的最大值。

从左往右，上到下扫一遍所有格子，求 ${v_{i,j}}$。

* 如果 $(i,j)$ 不为红色，显然 $v_{i,j}=0$。

* 否则 $v_{i,j}=\min \{v_{i-1,j-1}+1,l_{i,j},u_{i,j} \}$。

也同样可以在 $O(n^2)$ 内求出 $v$ 数组。

对四个颜色都做一遍类似的操作之后，就可以求出每个中心点最大的 $\text{logo}$ 边长了。

对于每个询问，二分答案。

现在 $\text{check}$ 一个答案 $x$，如果 $x$ 满足要求，那么可以确定 $\text{logo}$ 中心点的范围，查询在范围内的中心点有没有边长 $\ge x$ 的即可。

用前缀和数组 $f_{s,i,j}$ 表示矩形 $(1,1,i,j)$ 内有多少中心点的 $v \ge s$。

可以 $O(n^3)$ 处理出 $f$ 数组， $O(q \log n)$ 时间处理询问。

总复杂度 $O(n^3)$。

Tip ： 开 $f$ 数组的时候记得把 $s$ 那一维开成 $250$，否则会寄。