对于两个位置 $u,v~(|u-v|=k)$，考虑在什么情况下 $v$ 会对 $u$ 产生贡献。

在删除序列中要求 $v$ 要在所有在 $u,v$ 之间的其他数前面。

容易发现这样的序列有 $\dfrac{n!}{k+1}$ 个（简单理解就是 $u$ 到 $v$ 这 $k+1$ 个数中 $v$ 必须放在首位）。

同样方法可以算出 $u>v$ 时的贡献。

然后就是优化这一坨东西。前缀和一下预处理出 $\sum\limits_{i=1}^n\dfrac 1 i$，然后就做完了。

[代码评测记录](https://atcoder.jp/contests/agc028/submissions/26055923)