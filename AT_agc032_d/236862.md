我觉得这个D比最近某些场次的AB简单的多。。。

考虑这个操作的本质，就是把一个数字往后插入，耗费 $A$ 的代价；把一个数字往前插入，耗费 $B$ 的代价。

那显然一个数最多操作一次，不操作的部分一定单调递增，那我们直接 DP 那个不操作的部分就好了。

设 $f_{i,j}$ 表示当前处理到第 $i$ 个数，留下的最后一个数为 $j$ 的最小代价。

$f_{i,j}=\begin{cases}f_{i-1,j}+A&a_i>j\\f_{i-1,j}+B&a_i<j\\f_{i-1,k} \space (k<a_i)&a_i=j\end{cases}$

直接转移即可，时间复杂度 $O(n^2)$。

用一个线段树做区间加区间求 $\min$ 还可以做到 $O(n \log n)$。