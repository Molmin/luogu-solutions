画了两张图，可能会比较好理解。并且对其他题解含糊不清的地方做了解释。

首先要用到 [随机红包](https://www.luogu.com.cn/problem/P6130) 的结论，即 $n$ 个和为 $1$ 的数，第 $k$ 小值的期望是 $\dfrac 1n\sum\limits_{j=1}^k \dfrac 1{n-j+1}$。证明需要积分。

然后有一个神仙的转化，把切的每一刀染成红色，旋转 120° 染成绿色，旋转 -120° 染成蓝色，那么 **固定第一刀切的位置，取第一刀的红色、绿色之间的部分（包括端点），这部分里面异色刀间距离最小值就是答案。**

可以看下图：

![](https://cdn.luogu.com.cn/upload/image_hosting/lh9p03t6.png)

把问题放在线段上，就是：有 $n-1$ 个点均匀随机撒在长度为 $\dfrac 13$ 的线段上，每个点随机染红绿蓝色，线段两端固定是一端红一端绿。求端点异色最短线段期望长度。

显然异色线段一定存在于两个相邻点之间。枚举异色线段是 $n$ 条线段中第 $K$ 长的的，这要求所有前 $K-1$ 短的线段两端颜色都相同，那么中间 $n-1$ 个点中，有 $n-1-(K-1)$ 个点颜色没有受限制。概率是 $\dfrac{3^{n-1-(K-1)}}{3^{n-1}}=3^{1-K}$；并且要求前 $K$ 短的线段线段两端颜色不都相同。综上，这种情况的概率是 $3^{1-K}-3^{-K}[K\ne n]$，因为第 $n$ 短的线段两端颜色一定不同。

所以答案是下式，容易变形至 $O(n)$。
$$
\dfrac 13\sum_{K=1}^n(3^{1-K}-3^{-K}[K\ne n])\dfrac 1n\sum_{i=1}^K \dfrac 1{n-i+1}
$$