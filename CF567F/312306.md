## 题目描述

[题目传送门](https://www.luogu.com.cn/problem/CF567F)

## 思路简述

我们容易发现，因为序列是满足单峰性质的，所以对于区间 $[l,r]$, 当前最小值 $v$ 的分布只有 $3$ 种情况：

1. $l$，$l+1$
2. $l$，$r$
3. $r-1$，$r$

所以我们不难发现，如果我们从小到大填进数字，每次剩下来的没填数字的区间一定是连续的，也就是只可能有一个区间没有填进数字。

设 $f(l,r)$ 表示从小到大填数，现在要填完 $[l,r]$ 这段区间的所有方案数（此时未填数字是唯一确定的），我们每次可以用 $f(l+2,r)$，$f(l+1,r-1)$，$f(l,r-2)$ 去更新 $f(l,r)$。

现在我们问题就剩下如何判断当前转移是否合法了。

高妙的判法其他题解已经讲过了，这里介绍一个简单粗暴的判法。

其实它的限制跟差分约束类似，所以我们可以每次判断暴力建边，因为边权非正，所以我们可以跑 tarjan 判断：

1. 如果有大小超过 $2$ 的环，那么 pass。
1. 如果有负环那么 pass。

虽然跑得偏慢，但是复杂度正确可以通过此题，并且好写。

## 代码展示

~~喜提最劣解。~~

[click here](https://www.luogu.com.cn/paste/xnzbauff)

