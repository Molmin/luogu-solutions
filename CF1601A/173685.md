考虑每一位是独立的，设二进制下第 $i$ 位为 $1$ 的有 $c_i$ 个，则答案为非零的 $\gcd\{c_i\}$ 的所有因子。

特殊的，若序列全为 $0$，则答案为 $1$ 到 $n$ 的所有数。

因为显然每一步只能消掉恰好 $0$ 或 $k$ 个第 $i$ 位上的 $1$，只有 $k|c_i$ 才能恰好消完。时间复杂度 $O(n\log a_i)$。

[code](https://codeforces.com/contest/1601/submission/132992117)。