[题目链接](https://www.spoj.com/problems/TTOP/)

这个题可以暴力猜答案，不过有一个（稍麻烦的）正经做法。先考虑给定树的形态，如何计算合法的排列数。

设根节点有 $k$ 个儿子，第 $i$ 个儿子上的子树大小为 $a_i$，排列方案数为 $f_i$，则整棵树的排列数为

$$\binom{n-1}{a_1,\cdots,a_k}\prod_{i=1}^kf_i$$
前面的那个多重组合数，就是 $k$ 个排列，每个排列内部相对顺序不变，合成一个排列的方案数。

那么设 $p_n$ 为**全部** $n$ 个点的有标号有根树的合法排列数之和（即答案的 $n$ 倍），可以得到：

$$p_n=n\sum_{k=0}^\infty \frac{1}{k!}\sum_{a_1+\cdots+a_k=n-1}\binom{n-1}{a_1,\cdots,a_k}^2\prod_{i=1}^kp_{a_i}$$
至于多乘的那个组合数，是要分配节点编号。可以发现这东西和有标号有根树的计数很像。

设
$$P(x)=\sum_{k=0}^\infty \frac{p_kx^k}{k!^2}$$
可以把之前的递推关系写为
$$\frac{p_n}{n!(n-1)!}=[x^n]x\text e^{P(x)}$$
也就是 $P'(x)=\text e^{P(x)}$，容易解出 $P(x)=-\ln(1-x)$，即
$$p_n=n!^2 [x^n]P(x)=n!(n-1)!$$
于是最终答案为 $(n-1)!^2$。