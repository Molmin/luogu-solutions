## 官方题解

首先最后一个操作可以求个gcd直接求个约数个数

然后就是怎么维护lcm和gcd

我们可以线段树维护

然后对于每个数记录它的质因数的次数

然后合并就lcm取max，gcd取min，就好了

这样可以解决每次模数不同的问题

时间复杂度$O(nlog^2n)$

以上算法无法通过本题，除非你复杂度~~O(wys)~~

我们注意一个很有趣的地方，所有数字都在[1,100]之间

我们发现100以内质数只有25个，并且：

$2^7=128>100$

$3^5=243>100$

$5^3=125>100$

$7^3=343>100$

$11^2=121>100$

......

2,3需要三个二进制位记录

5,7需要两个二进制位记录

其他质数都只用一个二进制位记录

3*2+2*2+1*21=31

记录所有质数的次数只需要31位，刚好1个int就够

然后取min和max都可以用位运算优化

以上步骤可以将合并的复杂度优化至O(1)

时间复杂度$O(nlogn)$

这样可以通过本题

其实还有一种算法可以过，由于我数据的特殊性qwq

这个题是不是也很良心呀qwq

@ _rqy 这位dalao有另一种做法可以过