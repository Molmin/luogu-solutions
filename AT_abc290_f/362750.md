好题力荐！！！！！！！！111

考虑数列中 $1$ 的数量即为叶子个数 $k$，而考虑一条链，两端一定是叶子，剩下的叶子直接挂在链上，类似一条蜈蚣。所以我们可以得到在直径上的点的最大数量是 $n-k+2$，于是直径就是 $n-k+1$。

因为树有 $n-1$ 条边，每条边 $2$ 个端点，所以能构造出树的度数序列一定满足 $\sum X_i=2n-2$。于是我们使用插板法可以得到这样一个式子：

$$ans=\sum_{k=1}^n\binom{n}{k}\binom{n-3}{n-k-1}(n-k+1)$$

考虑把后面那个东西拆出来，得到

$$\sum_{k=1}^n\binom{n}{k}\binom{n-3}{n-k-1}(n-k-1)+2\sum_{k=1}^n\binom{n}{k}\binom{n-3}{n-k-1}$$

也就是

$$(n-3)\sum_{k=1}^n\binom{n}{k}\binom{n-4}{n-k-2}+2\sum_{k=1}^n\binom{n}{k}\binom{n-3}{n-k-1}$$

显然的范德蒙德卷积，于是得到最终答案

$$(n-3)\binom{2n-4}{n-2}+2\binom{2n-3}{n-1}$$

预处理阶乘及逆元，复杂度 $\Theta(n+q)$。