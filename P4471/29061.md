首先第一感觉是把每个单词反转后建trie树

我们称trie上的单词结尾节点为关键点

称一个节点的儿子中的关键点为该点的关键儿子

那么题意就是要选尽量多的合法关键点

我们考虑答案中两个相邻的字符串

可以发现他们的关键点一定是父子或兄弟关系

并且可以发现

如果选择了一个关键点以及他的一个关键儿子

那么应该贪心的把该点的所有关键儿子选完

并且该点最多只有两个儿子的子树中的其他关键点会被选取

如果选择了该点的两个儿子的子树中的其他关键点就不能选择该点的父亲

否则可以选择父亲

到这里就可以考虑答案长什么样了

我们发现我们答案选出来的节点一定是树上的一条关键节点的链并上该链上所有节点的关键儿子

于是这题就变成了树上最大链权问题

提高组的树形dp