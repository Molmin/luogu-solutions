# 题目传送门

[[ABC283E] Don't Isolate Elements](https://www.luogu.com.cn/problem/AT_abc283_e)

# 思路

我写完这道题才发现我是个小丑，我一看题解，发现大家都用的是 DP，但**没有人**的代码超过百行（）。

我是直接暴力 DP 做的，自然地，我们看到这种题一般会想到设 $dp_i$ 为前 $i$ 行的最小步数。

但是题目的要求矩阵中任意一个元素都**不被孤立**，而孤立的条件是四面的元素性质不同，所以这至少是个三维 DP，设 $dp_{i,j(j\in[0,1]),k(k\in[0,1])}$ 表示前 $i$ 行中，第 $i$ 行是否翻转和第 $i-1$ 行是否翻转，若不能使矩阵合法，则当前记为 $-1$。

在猜转移方程前，我们要先给出两个**命题**：

命题一：对于 $\forall i$ 满足 $1\le i\le n$，若 $dp_{i,j(j\in[0,1]),k(k\in[0,1])}=-1$，则通过这个状态得到的下一个状态也是 $-1$。

证明：因为当前的状态不合法，所以由不合法的状态延申下去的下一个状态必然不合法。

命题二：对于 $i=1$，$dp_{i,j(j\in[0,1]),k(k\in[0,1])}$ 必然合法。

证明：因为我们设计状态时只考虑 $i$ 行及以前的行，而单独一行不能满足孤立一个元素的条件，于是命题得证。

于是：

$$dp_{1,0,0}=dp_{1,0,1}=0$$

$$dp_{1,1,0}=dp_{1,1,1}=1$$

状态转移方程就是**暴力匹配**，**暴力判断**，**暴力取优**。

如果 $i=2$，那一共要转移 $2\times 2=4$ 种情况。

如果 $2<i\le n$，那一共要转移 $2\times 2\times 2=8$ 种情况。

记得最后还要判断最后一行是否合法。

如果像我一样暴力写的话，就会写 $233$ 行（）。

# Code

放代码了。

## 非压行代码

[这里](https://www.luogu.com.cn/paste/a00b653w)