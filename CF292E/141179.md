线段树+差分。

用 $k_i$ 表示此时的 $b_i$ 的值为 $a_{k_i}$，如果 $k_i=0$ 则说明 $b_i$ 还没有被变过。那么显然对于一次修改操作，只要让 $k_y =x,k_{y+1}=x+1…k_{y+k-1}=x+k-1$ 就可以了。

但是如何维护这个 $k$ 呢？我们可以考虑差分。那么很显然，对于一次修改操作，那么 $k$ 的差分数据 $c$ 就会进行如下操作：$c_y = x - k_{y - 1},c_{y + 1} = c_{y + 2} = … = c_{ y + k - 1 } = 1, c_{ y + k } = k_{ y + k } - ( x + k - 1)$ ，用线段树维护这个 $c$ 就可以了。那么，$k$ 也就很容易求出来了。

[code](https://www.luogu.com.cn/paste/e5o5b8kj)。