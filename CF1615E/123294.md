[CF1615E Purple Crayon](https://www.luogu.com.cn/problem/CF1615E)

考虑在某个节点涂上红色，则它的所有祖先都不能涂黄色。

考虑给 $r$ 个节点涂上红色，有 $c$ 个节点可以涂蓝色，则分值为 $\min\limits_{b = 0} ^ c \{(n - r - b) (r - b)\}$。显然 R 希望 $c$ 越小越好，这样 B 的决策严格变少，对 R 来说一定不劣。

考虑选 $r$ 个节点，它们到根的链覆盖最多节点，这是经典长链剖分贪心。选最长的 $r$ 个长链即可。

从 $0$ 到 $k$ 枚举 $r$，对每个 $r$ 求出对应的 $c$，然后求二次函数 $(n - r - b)(r - b)$ 在 $b\in [0, c]$ 的最小值，再将所有最小值求最大值即可。

实际上，当 $r$ 小于重链条数 $d$ 且 $r < k$ 时，增加 $r$ 一定不劣。考虑 $r = z + 1$ 相较于 $r = z$ 增加了一条重链，则 $r = z$ 时 B 总可以将该重链涂蓝，这样 $r = z$ 时 $n - r - b$ 相较于 $r = z + 1$ 不变，但 $b$ 变大，则 $(n - r - b)(r - b)$ 变小，对 R 不优。

因此，当 $k\leq d$ 时，直接令 $r = k$ 算出 $c$，然后枚举 $b$ 求 $\min\{(n - k - b)(k - b)\}$。当 $k > d$ 时，从 $k$ 开始枚举 $r$，此时 $c = 0$，所以求 $\max \{(n - r) r\}$。

时间复杂度容易 $\mathcal{O}(n)$。[代码](https://codeforces.com/contest/1615/submission/182197422)。