为什么大家的题解这么长，是我假了吗？

一个显然的构造是，把所有合法的限制全部加上，这样能筛掉尽可能多别的解，而保留这三个解，然后用某种方法 Check 是否恰好只有三个解，但这样边的总数是 $\mathcal O(n^2)$ 的，无法通过。

考虑在此情况下 $(v_{1,i},v_{2,i},v_{3,i})$ 完全相同的点必然连了完全相同的边，所以一个等价的构造是把相同的 $(v_{1,i},v_{2,i},v_{3,i})$ 找个代表元全部连上双向边，表示它们之间 $x_i$ 的值永远相同，然后再在代表元之间满连边就好了。

总共的边数不会超过 $2(n+(2^3)^2)$，非常轻松。

还有一个问题是如何 Check 是否只有恰好三个解，注意到我们已经连了一大堆等价关系，所以只需暴力枚举 $2^8$ 种代表元的取值，然后判断一下是否只有三种取值满足限制就好了。

[代码写的比较暴躁，谨慎参考](https://www.luogu.com.cn/paste/v007o9kz)。