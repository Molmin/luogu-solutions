~~一开始又猜错结论了，以为 $n\ge 3$ 第二问答案肯定是 $-1$，又是根据错误的数据猜结论的一天（~~

首先第一问很容易，由于数据保证合法，因此可以随便钦定一个点为 $0$，并以任意顺序钦定它们为 $2^0,2^1,2^2,\cdots,2^{n-1}$。然后 BFS 一遍即可，每次 BFS 时取出一个点 $x$ 并将其所有邻居的编号设为该点编号与该邻居编号的 or。

难点在于第二问，手动构造 $n=4$ 时我们有这样一个感觉，就是 $n$ 如果可以表示成 $2^k$ 的形式，那么第二问答案就不是 $-1$。否则第二问答案就是 $-1$。碰到这样形式的题我们可以很自然地想到**归纳构造**，具体来说 $n=1$ 的构造是很 trivial 的，而假设 $res_k$ 为当 $n=2^m$ 时，点 $k$ 的颜色，那么考虑根据 $res_k$ 构造出 $res’_k$ 表示当 $n=2^{m+1}$ 时，点 $k$ 的颜色。稍加思考可以得到：
$$
res'_k=2^{m}·(\text{popcount}(\lfloor\frac{k}{2^m}\rfloor)\bmod 2)+(res_{\lfloor\frac{k}{2^m}\rfloor}+res_{k\bmod 2^m})\bmod 2^{m}
$$
为什么这样归纳构造出来的颜色序列符合要求？首先对于我们称所有 $\lfloor\dfrac{k}{2^m}\rfloor$ 相同的 $k$ 为“同一块”，那么每个点的所有邻居中，恰好有 $2^m$ 个与其在同一块，另外 $2^m$ 个与其不在同一块中，显然与其在同一块的点，它们的 $2^{m}·(\text{popcount}(\lfloor\frac{k}{2^m}\rfloor)\bmod 2)$ 与 $res_{\lfloor\frac{k}{2^m}\rfloor}$ 都是相同的，根据 $n=2^m$ 的构造可知所有邻居的 $res_{k\bmod 2^m}$ 都是不同的，因此与其在同一块中的邻居的颜色不会重复，而对于不在同一块之间的邻居，由于它的邻居与其异或起来一定是 $2$ 的幂，且由于这些邻居与其不在同一块中，因此对于所有符合该要求的邻居 $k’$，都有 $\text{popcount}(\lfloor\frac{k’}{2^m}\rfloor)\bmod 2\ne \text{popcount}(\lfloor\frac{k}{2^m}\rfloor)$，且 $k’\equiv k\pmod{2^m}$，因此所有这样的邻居的 $2^{m}·(\text{popcount}(\lfloor\frac{k}{2^m}\rfloor)\bmod 2)$ 与 $res_{k\bmod 2^m}$ 都是相同的，唯一不同的肯定是 $res_{\lfloor\frac{k}{2^m}\rfloor}$，而如果我们把每一块缩成一个点，那得到的肯定是一个 $n=2^m$ 的图，因此这些邻居的 $res_{\lfloor\frac{k}{2^m}\rfloor}$ 也互不相同。又因为对于与 $k$ 在同一块与与 $k$ 不在同一块的邻居，它们之间的 $\lfloor\dfrac{k}{2^m}\rfloor$ 的奇偶性必定完全不同，因此它们必然一类全部 $<2^m$，一类全部 $\ge 2^m$，不存在重复的情况。