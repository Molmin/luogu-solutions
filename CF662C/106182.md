CF662C Binary Table 题解。

算是一个更容易清楚的做法（？）

显然 $n$ 那维压缩成一个二进制数；

那就相当于 $m$ 个 $n$ 位二进制数（称为原数），可以翻转所有数中的某一位，也可以翻转一个数。

考虑设置一个 $n$ 位二进制数，$0$ 表示不集体翻转某一位，$1$ 表示要。称此数为模式数。

可以得到的关系是：原数 xor 模式数 = $S$，而答案即为 ${\rm popcount}(S)$。

由于我们需要对于每个模式数分别统计答案，因此变换关系式，可以得到：原数 xor $S$ = 模式数。

那么设置两个数组，$a_i$ 表示原数为 $i$ 的有多少个，$b_i={\rm popcount}(i)$。做对称差卷积即可。

得到的数组中 $i$ 位置存放模式串为 $i$ 的答案。

有个问题，这样没有处理原数翻转的情况。

重定义 $b_i=min({\rm popcount}(i),{\rm popcount}((2^n-1) \oplus i))$ 即可。

时间复杂度 $O(n\cdot 2^n)$。