其实模板题不用卡得这么紧吧，只要复杂度不对的算法过不去就行了。

这里提供一种 $O(n)$ 但被卡常的做法，说优势的话除了好想啥也没有，劣势就是性质少了许多，不太能扩展，不过做模板够了。

> 如果在考场碰到 $\mathrm{Lyndon}$ 分解模板但是忘了 $\mathrm{Duval}$ 算法怎么办？

首先回忆一下 $\mathrm{Lyndon}$ 分解存在性：

> 如果串 $u$ 与 $v$ 都是 $\mathrm{Lyndon}$ 串且 $u<v$，则 $uv$ 也是 $\mathrm{Lyndon}$ 串。
>
> 初始令 $m=|S|$ 并且 $A_i=S[i]$，然后每次不断找到 $A_i<A_{i+1}$ 并且合并为一个串，最后一定能使得所有的 $A_i\ge A_{i+1}$。

为了使我们的算法有序进行，我们从后往前不断找到第一个 $A_i<A_{i+1}$ 并且合并为一个串。

先不考虑判断两个子串大小的复杂度，发现至多只会进行 $O(n)$ 次合并，故复杂度 $O(n)$。

只差判断两个子串大小了，由于我不会后缀数组，于是我用了后缀自动机。

正常跑反串把后缀自动机建出来，然后用 $O(n)-O(1)$ 最近公共祖先拿出来，对于两个子串我们可以 $O(1)$ 的求出它们的 $LCP$。

由于与合并相同，至多只会判断 $O(n)$ 次，故复杂度仍为 $O(n)$。

不会真的有人要看[被卡常](https://www.luogu.com.cn/record/64153141)的[代码](https://www.luogu.com.cn/paste/l14ys87r)吧？

注：由于普通的后缀自动机会被卡，代码实现的是 $O(n\times \log{26})$ 的后缀自动机，然后还是被卡了就没办法了。

 _附：为什么被卡了？_ 
 
 _以下偷换一下概念，用 $O(A)-O(B)$ 代表空间复杂度为 $A$，时间复杂度为 $B$。_ 
 
 _由于字符集大小，后缀自动机其实是 $O(n\times \log{26})-O(n\times \log{26})$ 或是 $O(n26)-O(n)$ 的。_ 
 
 _而且光是算法常数差不多就有 $5$ 倍了。_ 