高明的数数题。

考虑打一个暴力。

```
For(i, 1, n) For(j, 1, (1 << 20) - 1)
	f[j & a[i]] += f[j];

```

暴力是个背包，正确性显然故从略。

容易发现这是个 and 卷积的形式。

于是考虑 fwt。

暴力 fwt 就是考虑把每个 $a_i$ 单点的变化值 $fwt(a_i)$ 求出来暴力乘一遍最后 fwt 回去。发现屁用没有。

但是这玩意性质非常优秀。我们发现这个东西每一位要么是 $1$ 要么是 $0$，在当前位是 $1$ 的时候对应位的 $f$ 值会翻倍，否则不会翻倍。那么把每一个 $fwt(a_i)$ 对应位加起来然后 2 的幂次方一下就可以了。

考虑到 and 卷积 fwt 的本质是高维后缀和，所以可以把一堆东西拼起来做一遍 fwt，等价于做一堆 fwt 之后加起来。复杂度 $O(n \log n)$。

比较令人头秃的一件事是边界问题。

我们考虑每次会多算一个空集。所以减一个 1。十分合理。

代码极其好写。不贴了。

关于这个题 CF 只有 2400 这档事，可能是因为他的想法可能性比较单一吧。你列出这个式子不 fwt 应该没什么办法了。