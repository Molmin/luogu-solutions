你就对一个维度做莫队。

然后相当于带修区间数颜色。

这个是 well-known 的，维护 $pre_i$ 表示前面第一个与其相等的数的下标。

然后就是求区间中 $pre<l$ 的数量。

你考虑怎么维护 $pre$ 的变化。

这个是套路，用只删除的莫队维护 $pre$ 和 $nxt$ 即可。

删除的时候就撤销自身贡献，然后把 $nxt_i$ 的 $pre$ 改成 $pre_i$。这个就是更改 $O(1)$ 个 $pre$。

然后求区间中 $pre<l$ 的数量显然就是动态二维数点。

二维分块即可。可以看 rdiq 那个题。

P.S. 这个 $pre$ 的性质很好，几乎不重（对于二维分块来讲），但可能出现 $0$ 的情况，这个可以另外写个分块维护。

时间复杂度 $O(n\sqrt m+m\sqrt n)$

新的 Ynoi 惯例好像是不放代码。