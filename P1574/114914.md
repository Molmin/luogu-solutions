#### Description

> 给定 $N$，求不超过 $N$ 的最大反素数。      
> 教练版本：$N \le 10^{18}$，100ms 下文按此版本

#### Solution

首先回观反素数的定义，不难发现题目可以转化为求不超过 $N$ 的约数最多的数，如果有多个的话，要取最小的，因为如果存在 $n_1,n_2$ 的约数个数一样多，$n_1>n_2$，那么 $g(n_1)=g(n_2)$，$n_2$ 就不是反素数了。

假设满足要求的数为 $n$，我们将其标准分解：

$$n=p_1^{a_1}p_2^{a_2}\cdots p_k^{a_k}$$

约数个数 $R$ 即为：

$$R=\prod\limits_{i=1}^n (a_i+1)$$

那么 $R$ 一样的两个数，怎么取最小呢？肯定是取下标 $p_i$ 最小的。因此可以考虑从 $2$ 开始枚举，我们看见已经给定范围了（$N \le 10^{18}$），因此考虑第一个质数 $p'$ 使得所有小于等于 $p'$ 的质数乘积大于等于 $10^{18}$ 即可。

利用计算器可得 $p'=47$。

然后在枚举过程中，也不需要从 $1$ 枚举到 $n$，对于每个质数 $t$，他都对应着一个上限 $t'$ 使得 $t^{t'} \ge 10^{18}$。

另外根据小学奥数，如果要给两个质数 $p_1,p_2$ 分配指数 $a_1,a_2$（$p_1<p_2$，$a_1<a_2$），那么不难发现：

$$p_1^{a_1}p_2^{a_2} \ge p_1^{a_2}p_2^{a_2}$$

因此给较小的质数分配较大的指数，具体地：

$$a_1\ge a_2 \ge \cdots\ge a_k$$

结合上面的上限说明，我们发现 $62$ 就是那个上界，因此我们考虑上界剪枝，从 $[1,47]$ 枚举，dfs 函数上传一个指数上界，从 $1$ 枚举到指数上界即可，接下来枚举中得到的指数就可以作为新的一个指数上界。

然后加一些零碎的剪枝（比如判断是否超从乘法改成除法）即可。