观察题目，不难发现一个性质：所有数的和在加减过程中是不变的。

那么就说明：答案在所有数和 $sum$ 的因数中。

根据数据范围，又不难发现，$sum\le500\times10^6=5\times10^8$。

所以枚举 $sum$ 的因数，时间复杂度 $O(\sqrt{sum})$。

那有如何判断此时枚举到的因数 $x$ 能否成为答案呢？

可以采用贪心的策略，先将所有数模 $x$ 后排序，使用双指针，前面的数减，后面的数加，再统计总步数有没有超过 $k$ 即可。

代码：[Code](https://atcoder.jp/contests/abc136/submissions/43067449)。