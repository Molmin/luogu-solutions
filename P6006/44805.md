### P.S.
提供一个其他题解没有的做法。  
感谢 @[\_DXL\_](https://www.luogu.com.cn/user/98618 "巨佬") 提供此题的思路。  
题目还善意地提醒了我们没有低于 $O(n^2)$ 的做法，真是凉心出题人（
### Description.
给定一个长度为 $N$ 序列 $\{a_k\}$，有 $Q$ 次询问。  
每次询问查询 $[L,R]$ 求有多少个无序三元组 $L\le i,j,k\le R$，满足 $a_i+a_j+a_k=0$。  
（ $i,j,k$ 互不相同
### Solution.
首先，我们考虑一个弱化版：求无序二元组 $1\le i,j\le n$ 满足 $a_i+a_j=0$。  
~~水死了，但是再水也得讲啊。。。~~  
首先，因为它是无序二元组，所以我们钦定 $i<j$，上面的式子可以化成 $a_j=-a_i$。  
所以我们遍历一遍所有数，每次查询之前有多少个数是当前这个数的相反数。  
具体实现可以直接开桶，注意因为有负数必须要值域平移。  
![](https://cdn.luogu.com.cn/upload/image_hosting/iy59r7tg.png "ZK AK IOI!")  

然后，我们来考虑原题。  
初题人善意地提醒了我们没有 $O(n^2)$ 以下的做法。  
说明正解应该是 $O(n^2)$ 的预处理，以及 $O(1)$ 的回答。  
同时，我们也可以钦定三元组 $i,j,k$ 中，$i<j<k$。  
我们思考如何把这题转化成为上面的弱化版，@[\_DXL\_](https://www.luogu.com.cn/user/98618 "巨佬") 此时提供了思路。  
我们考虑把上面的式子转化成为 $(a_j+\frac{a_i}{2})+(a_k+\frac{a_i}{2})=0$  
然后我们固定 $i$ ，直接枚举所有的 $i<j,k$，对它作弱化版。  
因为最后答案并没有固定 $i$，所以我们需要再对区间的左端点进行前缀和。  
同时，因为上面的 $\frac{a_i}{2}$ 并不一定是整数，所以我们需要对所有 $a_i$ 翻倍，这样显然是对的。  
然后这题就做完了，完结撒花，具体见代码。  
### Code.
![](https://cdn.luogu.com.cn/upload/image_hosting/zv5a3lzf.png "ZK txdy yyds")