#### 题目大意

给出一个正整数 $n$，然后给出 $n$ 个 $A$ 类 $n$ 维向量以及 $n$ 个 $B$ 类 $n$ 维向量，保证 $A$ 类向量之间线性无关。现在需要给每个 $A$ 类向量都从 $B$ 类向量中选择一个备用向量，要求该向量被备用向量替换之后，形成的新的 $n$ 个 $A$ 类向量之间仍然线性无关。任意两个 $A$ 类向量的备用向量都不能相同。请求出是否有解，在有解的情况下求字典序最小的方案。

#### 题解

问题的实质是求出任意两个 $A,B$ 类向量之间能否替换，如果可以就连边，最后跑一个最小字典序的二分图匹配即可。

对于这个题目，因为求的匹配必须是完美匹配，那么就可以先求出一个普通的完美匹配，然后强制让某个点跟一个字典序更小的点匹配，这样子操作的话会造成左右各一个点失配。然后把这个失配点再增广一次，如果可以增广，那么增广之后仍然形成了一个完美匹配，证明这次修改是合法的，否则就不合法。最终就可以求得一个最小字典序的完美匹配。

那么现在就只需要考虑前一个问题。因为 $A$ 类向量之间是线性无关的，所以使用 $A$ 类向量可以唯一表示任意的一个 $n$ 维向量，当然其中也包括所有的 $B$ 类向量。

考虑对于一个 $B$ 类向量 $B_i$，它等于 $k_1A_1+k_2A_2...+k_nA_n$。那么 $B_i$ 可以替换 $A_j$ 当且仅当 $k_j\not=0$。

证明如下：若 $k_j=0$，那么用 $B_i$ 替换 $A_j$ 后，$B_i$ 仍然可以被剩下的向量表示，那么就不是线性无关的，与题意不符。若 $k_j\not= 0$，那么在 $A$ 类向量中删去 $A_j$ 后，剩下的向量无法表示 $B_i$。且通过移项，有 $k_1A_1+k_2A_2+...+k_nA_n-B_i=k_jA_j$，即 $A_j$ 可以被新的 $A$ 类向量表示，那么对于之前 $A$ 类向量表示的任意一个 $n$ 维向量，新的 $A$ 类向量也可以表示，只要把 $k_jA_j$ 按比例换成 $k_1A_1+k_2A_2+...+k_nA_n-B_i$ 即可，故新的 $A$ 类向量是线性无关的。

现在就只需要求怎么用 $A$ 类向量去表示每个 $B$ 类向量了。

我们可以把 $A$ 类向量放到一个矩阵里面去，然后用这个矩阵乘上一个系数矩阵得到一个 $B$ 类向量构成的矩阵。

一般的，我们习惯于把向量竖着放，设系数矩阵为 $R$，$A=[A_1,A_2...A_n]$，$B=[B_1,B_2...B_n]$，那么有 $A\times R=B$。显然， $R$ 的每个列向量 $R_i$ 就是用 $A$ 类向量表示 $B_i$ 的各项系数。

考虑怎么求，因为有 $A\times R=B$，那么可以不断左乘初等矩阵，设其为 $E_1...E_m$，使得 $E_1\times...\times E_m\times A=I$，那么就有 $E_1\times...\times E_m\times A\times R=I\times R=R=E_1\times...\times E_m\times B$。就可以求得 $R$。

说得通俗一点，左乘一个初等矩阵相当于是初等行变换，那么实际上就是把 $A$ 用初等行变换变成 $I$，与此同时把所有对 $A$ 的操作也用到 $B$ 上，就可以得到最终的 $R$。

最终可以在 $O(N^3)$ 的时间复杂度内解决这个问题。