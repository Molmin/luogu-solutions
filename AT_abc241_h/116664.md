Update 2023.05.12 通过代码挂错了，现已修改。

容斥是平凡的，每种排均选小于等于 $b_i$ 张显然不好算，不如钦定某些排强制大于 $b_i$。

接下来就是算把 $x$ 分成 $\sum_{i=1}^nx_i$ 式子 $\prod_{i=1}^na_i^{x_i}$ 之和。

不会生成函数，考虑先朴素 $dp_{i,j}$ 表示目前考虑了 $1\sim i$ 的 $x_i$，其和为 $j$ 的权值和。不难发现转移可以考虑在 $x_k$ 上加一满足 $k\ge i$。

不难发现转移容易写成矩阵形式。复杂度 $O(2^nn^3\log m)$ 大约为 $1.7\times10^{10}$。稍微卡常，对矩阵快速幂部分进行简单预处理，增加访问连续，避免过多取模即可通过。（实际上是 $\frac{1}{12}$ 的常数）

[通过代码。](https://atcoder.jp/contests/abc241/submissions/39472506)