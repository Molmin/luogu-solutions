对于没有出现的数字可以分为两类

$1$.自己原来所在的位置已经被其他数占据,那么这个数就可以随便放

$2$.自己原来的位置还没有被其他数放

我们可以假设这两个数共有$s$个，有$a$个数可以随便放，那没就有$s-a$个数就要错排。

考虑容斥：所有数随便排的方案减去至少有一个数放在原来位置加上至少两个数放在原来位置……

答案即为$s!-\sum\limits_{i=1}^{s-a}(-1)^i\binom{s-a}{i}(s-i)!$