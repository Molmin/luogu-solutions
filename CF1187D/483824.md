- 题意

给定长度为 $n$ 的序列 $a$ 和 $b$。你每次可以选择 $a$ 的一个子段从小到大排序。你可以进行任意次操作。问能否使 $a$ 与 $b$ 完全相等（对应位置上的元素相等）。

- 解法

首先显然等价于 swapcheck（对于一对相邻的逆序对交换）。先判掉元素不一样的，然后离散化为排列（如果相同数字前者更小）。

引理：答案为 `YES` 当且仅当不存在 $x<y$ 使得 $a$ 中 $x$ 在 $y$ 前但 $b$ 中 $x$ 在 $y$ 后。

证明：必要性显然。用反证法证充分性。若不存在，我们证明要么已经 $a$ 和 $b$ 一样了，要么可以再 swapcheck 一次。显然，如果 $a$ 和 $b$ 不一样，那么必定存在 $a$ 中 $x$ 在 $y$ 后且 $b$ 中 $x$ 在 $y$ 前。假如 $x,y$ 在 $a$ 中不相邻，设之间有 $u$。（形如 $y\cdots u\cdots x$）若 $u<x$，则 $b$ 中为 $u\cdots x\cdots y$，范围可以进一步缩小到 $x'=u,y'=y$，$u>y$ 同理，否则 $y>u$ 且 $u>x$，根据 $u$ 的位置一定有范围更小的。综上，范围可以不断减小直到相邻，也就是说一定可以 swapcheck 一次。swapcheck 会让逆序对数量不断变小，所以一定会达到 $a$ 与 $b$ 相同的情况。

设 $a$ 逆排列为 $u$，$b$ 逆为 $v$。于是就判断是否存在 $\begin{cases}x<y\\u_x<u_y\\v_x>v_y\end{cases}$。这是简单的三维偏序题。CDQ 分治即可。