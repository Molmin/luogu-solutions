# 题目

[传送门](https://www.luogu.com.cn/problem/CF111C)

# 题解

首先我们可以将题目转化：在一个 $n\times m$ 的矩阵中，设立尽可能少的特殊点使得整个矩阵全部被覆盖，其中每个特殊点可以覆盖的区域为它自己以及上下左右的格子

意识到 $n,m$ 互相交换，对于答案不影响，那么我们钦定 $n$ 是较大的那个

由 $1\le m\le n \le 40$ 且 $1\le n\times m\le 40$，显然有 $m\le 6$

先分析每一列的覆盖，有三个部分

1. 它会被本来就在这一列上的特殊点覆盖，每个特殊点可以覆盖它自己所处的格子和上下的格子；
2. 它会被左边一列（前提是要有）的特殊点覆盖对应的一个格子；
3. 它会被右边一列（前提是要有）的特殊点覆盖对应的一个格子；

那么，我们有比较暴力的做法：设 $f[i][j][k][l]$ 为我们推到了第 $i$ 列，前一列的特殊点状态为 $j$，后一列状态为 $l$，自己本身这一列状态为 $k$ 的将 $1$ 到 $i$ 列全部格子覆盖完时，能剩下的最多的格子数，那么显然有
$$
f[i][j][k][l]=\max\{f[i-1][t][j][k]+\text{count}(k)\}
$$
且必须保证 $t,j,k$ 可以将 $i-1$ 这一列覆盖完，且 $j,k,l$ 可以将 $i$ 这一列覆盖完，显然有 $1\le t,j,k,l\le 2^6$，复杂度大概在 $\mathcal O(2^6\times 2^6\times 2^6\times n\times 2^6\times 2^6)$ 左右，其中状态有 $2^6\times 2^6\times 2^6\times n$ 而转移是 $\mathcal O(2^6\times 2^6)$，因为我们要枚举 $t,l$

如果按照极限情况，时间复杂度在 $\mathcal O(42949672960)$ 左右，可以称得上很完美的自闭了......

考虑如何进行优化？我们的状态设计，是暴力地记录了第 $i$ 列，以及 $i-1$ 和 $i+1$ 列的放置情况，而在转移中，我们重复考虑了 $t,j,k$ 能否将 $i-1$ 列覆盖完，为什么说重复，因为我们 $f[i-1][...]$ 定义上保证将 $1$ 到 $i-1$ 列全部覆盖完，但是我们在转移中又重复判断，因而说是重复考虑。

考虑对这种重复考虑的情况进行优化，我们实际上只需要记录两列，即 $i$ 和 $i-1$ 列的情况，定义 $f[i][j][k]$ 为推到第 $i$ 列，第 $i-1$ 列放置情况为 $j$，第 $i$ 列放置情况为 $k$ 时能剩下的最多的格子，那么有转移
$$
f[i][j][k]=\max\{f[i-1][t][j]+\text{count}(k)\}
$$
需要保证 $t,j,k$ 可以将第 $i$ 列覆盖完。

这样，我们就省掉重复考虑的情况，时间复杂度 $\mathcal O(2^6\times 2^6\times n\times 2^6)$，极限情况下为 $\mathcal O(10485760)$

# 代码

```cpp
https://www.cnblogs.com/Arextre/p/13442266.html
```

