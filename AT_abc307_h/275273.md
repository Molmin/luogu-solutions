一开始看错题了，看了好久才发现就是个板子。。。

这个东西本质上是循环移位，我们考虑在 $S$ 前后各添加 $W - 1$ 个 `.`，例如 $W = 5, S = \texttt{ABC}$ 时，添加后 $S = \texttt{....ABC....}$。此时我们发现 $S$ 的每个长度为 $W$ 的子串一一对应一个显示在公告板上的串。那么这就是一个**带通配符字符串匹配**问题。

接下来直接套 [P4173 残缺的字符串](https://www.luogu.com.cn/problem/P4173)即可。展开讲的话，设 $n = |s|, m = |t|$，并且 $t$ 要匹配 $s$。那我们把通配符的值设成 $0$ 后，设 $f_i = \sum\limits_{j = 1}^m t_j (s_{i - m + j} - t_j)^2$，那么 $s_{i - m + 1 \sim i}$ 能匹配 $t$ 当且仅当 $f_i = 0$。把平方拆开，就是若干个减法卷积。考虑翻转 $t$，做加法卷积即可。

时间复杂度是 $O(n \log n)$，带一个巨大常数。

这题用 NTT 会有些难受，因为 $f_i$ 能达到 $5 \times 10^9$，为了保证正确性必须要写双模数（我写的双模数还 T 了），FFT 比 NTT 快很多（可能是我 NTT 的实现劣了），所以我使用的是 FFT。

[code](https://atcoder.jp/contests/abc307/submissions/42981235)