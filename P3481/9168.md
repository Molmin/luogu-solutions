用p(l,r)表示区间[l,r]的最长前缀的右端点，

s(l,r)表示后缀的左端点。

用hash(l,r)表示区间[l,r]的状态。

那么hash(l,r)必须包含hash(l,p(l,r)),hash(s(l,r),r),以及W(l,r)。

考虑到hash(s(l,r),r)已经包含W(s(l,r),r)的状态，

我们只用新加入(s(l,r),r)少掉的那个状态即可。

假设包含x个元素。

那么p(l,r)就是以l为左端点，包含了x-1个元素且右边是第x个元素的右端点。

s(l,r)同理。

所以就可以dp了。

由于数字范围是[1,100],所以最多只有n\*100个状态。

再滚动数组优化空间即可。
