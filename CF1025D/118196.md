这题可以出到 $1.5 \times 10^3$ 的，怎么没人写 $O(n^3/\omega)$ 的题解啊。

传统的做法是注意到有一个显然的 $O(n^3)$ 状态 $O(n)$ 转移的区间 dp，随后发现其中有一维状态不是必要记的，于是就优化到了 $O(n^2)$ 状态。但是到了这一步还是有优化空间，因为这时候状态都是一个 `bool` 变量，可以尝试压位做到 $O(n/\omega)$ 转移。

具体的，预处理与每个数不互质的下标集合，然后再在 dp 的过程中动态维护当位置 $i$ 作为左/右端点时，可以作为对应的右/左端点的位置的集合，[码](https://codeforces.com/contest/1025/submission/151374042)。