~~不要问我为什么做这种水题~~

首先直接建 PAM，平凡的有 $O(n)$ 种本质不同的回文串。

对于这道题来说每个本质相同的回文串贡献相同，我们只需要求出一个的贡献再乘上个数即可。

如果每个串暴力 KMP 复杂度就炸了，因为每个串长度可能 $O(n)$，比如给你全 `a` 串。

我们没利用到什么？这些回文串都出自于原串，于是我们对原串做一遍 KMP，然后用仿佛是 SAM 的技巧：

在原串随便找一个 endpos 位置取出一个串来算贡献，那么就是求一个区间内的贡献，前缀和即可。

细节：

- 只取奇数长度回文串，题目要求。

- 这道题卡空间，不支持非基于势能的写法，空间是 $O(26n)$ 的，基于势能的空间才是 $O(n)$。（当然你要写 Hash 表才是标准的 $O(n)$）

- 对 $2^{32}$ 取模，既不是 `long long`，也不是 `unsigned long long`，是 `unsigned int`。

总结：有 PAM 就可以不动脑做的题。

[代码](https://www.luogu.com.cn/paste/13rtxqyy)