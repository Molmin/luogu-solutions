## 前置知识

笛卡尔定理与初中代数

## 分析

首先刚看到题的时候很明显就会往几何的方向去想，但能不能想到这个非常偏的定理是个问题。这个定理一看就可以成为这道题的背景，想到这个定理这道题就完成了一半。

笛卡尔定理：

> 若平面上四个半径为r1、r2、r3、r4的圆两两相切于不同点，则其半径满足以下结论
$$(\sum\limits_{i=1}^{4}\dfrac{1}{r_i})^2 = 2 \sum\limits_{i=1}^{4}\dfrac{1}{r_i^2}$$
> 其中，如果外切半径取正，内切半径取负

接下来，因为第一个圆得同时与 $G$ 和 $P$ 相切，所以第一个圆的圆心必须在 $G$ 和 $P$ 的圆心连线上，所以半径就是 $R - r$。

所以我们就得到了前三个圆的半径，就可以开始应用笛卡尔定理了。

假设第 $i$ 个圆的半径为 $1 / r_{i+2}$（这么写是为了让 $G$ 与 $P$ 不必单独拿出来分类讨论），$r_1 = 1 / R$，$r_2 = 1 / r$，那么有：

$$(-r_1 + r_{k-2} + r_2 + r_k) ^ 2 = 2(r_{2}^2 + r_{k-2}^2 + r_{1}^2 + r_k^2)$$

然后就开始化简了：

$$r_k^2 - 2(r_{1} + r_{k - 2} + r_{2})r_k + 2(r_{1}^2 + r_{k - 2}^2 + r_{2}^2) - (r_{1} + r_{k - 2} + r_{2})^2 = 0$$

爆算求 $\Delta$：

$$\begin{aligned}\Delta &= 4(r_{1} + r_{k - 2} + r_{2}) ^ 2 + 4(r_{1} + r_{k - 2} + r_{2})^2 - 8(r_{1}^2 + r_{k - 2}^2 + r_{2}^2)\\
&=16(r_{1}r_{k - 2} + r_{k - 2}r_{2} + r_{1}r_{2})\end{aligned}$$

解得两个解的形式就是 $\dfrac{2(r_{1}+r_{k-2}+r_{2}) \pm \sqrt{16(r_{1}r_{k - 2} + r_{k - 2}r_{2} + r_{1}r_{2})}}{2}$

看起来非常的阴间。所以不能爆算


发现两个解之和就是 $2(r_{1}+r_{k-2}+r_{2})$。

接下来是非常巧的一步：因为两个解和知道了，而已经有一个解（$r_{k - 2}$）知道了，所以另外一个解也可以知道！

所以，$r_k = 2(r_{1}+r_{k-2}+r_{2}) - r_{k-2}$

最后递推 $n - 1$ 次即可。

## 代码

```cpp
#include <bits/stdc++.h> 
#define lld long long 
using namespace std;
int n;
int R, r;
double r1, r2, r3;
int T;
int main() {
	scanf("%d", &T);
	for (; T --; ) {
		scanf("%d%d%d", &R, &r, &n);
		r1 = 1.0 / (R - r);
		r2 = -1.0 / R + 1.0 / r + 1.0 / (R - r);
		for (int i = 2; i <= n; ++ i)
			r3 = r1, r1 = r2, r2 = (-1.0 / R + 1.0 / r + r1) * 2 - r3;
		printf("%lf\n", 1.0 / r2);
	}
	return 0;
}

```