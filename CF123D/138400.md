这个题感觉还算有点意思。是个远古场的 2300，感觉无论如何现在评的话也得有 2400 吧。

看到关于要区分本质不同字符串的，想到 SA，在排好序的后缀数组上遍历搞事情。

我们考虑枚举贡献子串的长度。那么显然 $hi$ 数组上连续 $\geq len$ 表示连续一段相等的这么长的子串。于是可以在每个位置将它放进要割裂这个位置的那个 `vector` 里，从小到大枚举 $len$，用一个 `set` 维护相等段同时维护总贡献即可。注意把 $n-len+2\sim n$ 这些无效的减掉。