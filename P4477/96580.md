~~题目意思比较难描述，但是易懂…~~

我们考虑到这是一个匹配问题，转换一下。

由于题目说了是 $a_i + c_j \leq z$ ， $i$ 和 $j$ 有一条边，那么发现 $a_i$ 不变，我们就可以给 $a_i$ 排序，然后因为数值是有单调性的，如果 $a_i + c_j \leq z$ ，那么 $a_k(1 \leq k\leq i)+ c_j \leq z$。

那么我们想一个这个问题的转化: 给你 $n$ 个位置 $m$ 个物品，每个位置仅仅能放一个物品，第 $i$ 个物品有一个限制，只能放到 $[1,p_i]$ 里面，求最多能放多少个物品。

容易证明，如果用 **不基于排序** 的做法做出这个转化版问题，就可以带上莫队做出这个原问题。


我们想，假设你能放 $k$ 个物品，采用最优策略。

那么你 $p_i$ 一定是选前 $k$ 大的，依次放到 $1…k$。

第 $k$ 大的放在位置 $1$，那么显然 $p_k \geq 1$

第 $k-1$ 大的放在位置 $2$，那么 $p_{k-1}\geq 2$

……

第 $k + x - 1$ 大的物品放在位置 $x$ ，那么 $p_{k+x-1}\geq x$

也就是说 $p_x + x - 1 \geq k$

而 $x$ 指的是区间第 $x$ 大，就是有多少个数比他要大，而你可以通过线段树，对于每个 $p_i$ ，区间加 $[1,p_i]$

由于 $k$ 要满足所有条件，所以要取最小值。

[code](https://www.cnblogs.com/Isaunoya/p/12459233.html)