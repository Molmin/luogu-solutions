2200 的 CF DS 题我居然没胡出来。

$ans(i, j)$ 表示值为 $[1, i]$ 的在左边，$[i + 1, n]$ 在右边，并且将初始序列划分为 $[1, j]$ 和 $[j + 1, n]$ 的代价。

对于 $i = 0$，最后左边没有任何元素，那就要将原序列下标为 $[1, j]$ 的都转移一遍，故 $ans(0, j) = \sum_{k = 1}^j a_k$。

考虑从 $ans(i - 1)$ 转移到 $ans(i)$，设 $p$ 为 $i$ 在原序列中的位置。

* 对于 $p \gt j$，本来 $i$ 被划分到了右边，即 $[j + 1, n]$，现在要将 $i$ 移动到左边，故 $ans(i, j) = ans(i - 1, j) + a_p$
* 对于 $p \le j$，本来 $i$ 被划分到了左边，即 $[1, j]$，在计算 $i - 1$ 时 $i$ 被移动到右边，现在要将 $i$ 移回来，故 $ans(i, j) = ans(i - 1, j) - a_p$

于是对于每一个 $i$，$ans(i, j)$ 都可以从 $ans(i - 1, j)$ 转移过来，而转移的形式又是区间加减，可以使用线段树优化转移。