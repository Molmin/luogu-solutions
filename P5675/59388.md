[转载：这里是供题人的题解](https://www.cnblogs.com/LanrTabe/p/10329145.html)

首先题目里那个什么【古老的游戏】其实就是[Nim游戏](https://www.luogu.com.cn/problem/P2197)了。

Nim游戏的结论就是如果各堆石子数异或和为$0$那么先手必败，否则先手必胜。

也就是说我们只要使Alice不能通过一次在某指定的堆中的操作使剩余的石子满足各堆数目异或和为$0$就行了。

考虑到每堆石子都是独立的，所以只要枚举哪堆石子是被指定的再求和就行了。

对于每堆石子，我们只要当它不存在，然后考虑到每堆石子数和石子堆数都极少，所以就只要进行一个暴力dp递推处理出除掉这堆石子后前$i$堆中选一些使异或和为$j$的方案数就行了。

然后我们考虑一下哪些情况会使Alice有机会获胜。显然如果对于选定的这堆石子有其他堆石子的异或和小于这堆石子数时，Alice必可以进行一次操作使这堆石子剩余数量和其他堆石子的异或和相等，即使所有堆石子异或和为$0$。于是Alice可以获胜。

所以我们只要对于每堆石子计算其他石子中选出一些使异或和不小于这堆石子个数的方案数再求和就可以了。

Code在供题人的题解里有了，就不放了。