[题目链接](https://www.luogu.com.cn/problem/SP26916)

这个题一直没题解，不过有人需要看，就简单写一下。

****

首先可以将答案用生成函数描述：
$$a_n=[x^n] \frac{x^j}{1-bx^j-cx^k}$$
设 $m=n-j$，只需要求 $[x^m](1-(bx^j+cx^k))^{-1}$ 即可，这可以暴力展开为：

$$\sum_{i=0}^\infty [x^m](bx^j+cx^k)^i$$
显然对于每个 $i$，二项式展开后至多有一项是 $m$ 次的。那我们可以换个角度考虑，枚举 $cx^k$ 这一项的次数 $t$，再对应解出正整数 $r$，使得 $tk+rj=m$（若不存在则跳过）。这一项对答案的贡献就是：
$$\binom{t+r}{t}b^rc^t$$
由于 $1000000037 = 421 \times 563 \times 4219$，计算二项式系数可以用 Lucas 定理来做，然后暴力枚举 $t$ 计算答案即可。

每组数据的时间复杂度是 $\Theta( (m/k)\log m)$。