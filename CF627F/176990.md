容易观察到一次操作是将 $0$ 移动到一个相邻的节点上，而且操作可逆转。

所以对于不加边的情况方案是唯一的，直接模拟一下看看是不是相等的就好。

对于加一条边来说，我们先将 $0$ 移动到目标位置，观察一下这种状态下他的答案长什么样子。

因为操作是可逆的，所以对于 $0$ 出去再回来的话，他能改变的只有在加一条边形成的环上的点，而改变的方式则是先拿出一个点来，剩下的点转一下，再把拿出来的这个点塞回去。

那么我们可以找到需要改变的这个环，如果需要改变的点形不成一条路径，那么答案为 $-1$。

形成环的话我们找到这个环一开始被拿出来的那个点，这个时候路径就确定了，求最优解只需要把和开始时 $0$ 向终点移动时的路径相反的部分减掉就可以了，复杂度 $O(n)$。

代码：[link](https://www.luogu.com.cn/paste/r8l42oac)