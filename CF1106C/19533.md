补充一下 Anguei 老师的题解：$$(a+b)^2=a^2+b^2+2ab$$

即答案$$\frac{1}{2} \sum_{i = 1}^{n} (b_i + c_i)^2=\frac{1}{2} \sum_{i = 1}^{n} (b_i^2 + c_i^2+2b_ic_i)$$

又因为 $a^2,b^2$ 在无论 $a,b$ 如何排列的情况下，都是相等的，所以最终影响答案的**只是：**$2ab$ 这一项。

设$z_1, z_2, \dots, z_{\frac{n}{2}}$ 以及 $z_{\frac{n}{2} + 1}, z_{{\frac{n}{2}} + 2}, \dots, z_n$ 分别为原数组分开后的两个单调增的排列。

再设数组 $x$ 为 后半部分的任意一个排列。

那么我们需要的结果$$S=z_1x_1+z_2x_2+\dots+z_{\frac{n}{2}}x_{\frac{n}{2}}\text{ (1)}$$

全排列有 $(\frac{n}{2})!$ 个，显然有最大值和最小值。

考虑 $(1)$ 式，若 $x_1 \neq y_1$（注：这里 $y$ 只是原 $z$ 数组的后半部分，为了书写方便笔者暂时用 $y$ 数组来替代），则显然有某 $x_k =y_1(k > 1), x_1 > x_k$。

那么将 $(1)$ 式中的 $x_1$ 与 $x_k$ 对调，则设
$$S'=z_1x_k + \dots + z_kx_1 + \dots + z_{\frac{n}{2}}x_{\frac{n}{2}}$$

易证 $$S'-S \ge 0 \text{（两式相减提取公因式即可）}$$

类似地，我们可以经过有限步的调整，得到：**原始最小值为反序和**。

**拓展：请读者自行证明：原式最大值为顺序和。（提示：证明方法类似）**