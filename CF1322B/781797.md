## 简单题意

求 $ \bigoplus_{i=1}^n \bigoplus_{j=i+1}^n (a_i+a_j) $ 。

## 思路

- 首先由于考虑将每个数改为二进制，考虑每一位对答案的贡献。

- 由于只有一种运算异或,所以答案 $ans=\sum_{i=0}^{+\infty}(cnt_i \bmod 2)2^i$ 。 

- 我们对第 $i$ 位考虑，那么能对第 $i$ 为做贡献的只有前 $i$ 位，设第 $j$ 个数的前 $i$ 位为 $b_j$ ，则 $b_j=a_j \bmod 2^{i+1}$ 。

- 我们接着考虑这一位能作贡献当且仅当这一位上为 $1$ ,那么能在第 $i$ 位上为 $1$ ,有两种情况：

  1.第 $i$ 位上不进位。那么 $b_i+b_j \in [2^i,2^{i+1}-1]$ 。

  2.第 $i$ 位上不进位。那么 $b_i+b_j \in [2^{i+1}+2^i,2^{i+2}-2]$ 。注意这里的右边界是减 $2$ ，因为第 $i$ 位发生进位后认为 $1$ ,那么前 $i-1$ 位也一定向前进位了。

- 那么最后第 $i$ 位上为 $1$ ，当且仅当 $cnt_1+cnt_2$ 为奇数。

- 现在问题转化为给定 $n$ 个数，选择两个互不相同的数，使两数之和在一个区间内。问这样的数对有多少个。

  - 直接将原数组从小到大排序，维护一个双指针。
  - 从后往前扫，找到每个数对应的合法区间 $[l,r]$ 。同时若第 $i$ 个数在这个区间内，应将其减去。
  - 最后由于每个合法数对会算两遍，所以还要除二。