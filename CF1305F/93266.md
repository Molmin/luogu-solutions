[题目传送门](https://www.luogu.com.cn/problem/CF1305F)

妙妙题！

首先答案显然不会超过奇数个数。

然后考虑答案上界最多为 $n$，所以至少有一半数至多被操作一次。

这个模型你肯定考虑质因数分解，但是 $a_i \le 10^{12}$，直接分解就寄了。

然后你会发现你不能对 $n$ 个数都分解，只能分解一小部分。

但是发现你只需要找到至多被操作一次的数 $x$，它只会变成 $x$ 或 $x-1$ 或 $x+1$，然后你对这三个数分解一下质因数，然后暴力匹配即可。

所以问题是怎么找到这样的数。

注意到这样的数在序列里至少有一半，所以你直接暴力随机个几十次你大概率就找到这样的数了。

假设你随机 $k$ 次，你不过的概率就是 $\dfrac{1}{2^k}$，然后你取个 $k=30$ 是不是就过了。

当然 $a_i \le 10^{12}$，所以处理质因数的时候最好写得好看点。比如埃氏筛。

做完了。

