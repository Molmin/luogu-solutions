我们基本上是要求计算格点对的个数（x1，y1），（x2，y2），其中X1 < X2，Y1 < Y2 ，且在N×N的方格中，在每一列有间隔的点。此外，当x轴的横坐标增加，对应的列减少或保持相同的终点。



线性扫描X2。对于每个X2，有一些可接受的区间[L，R]作为Y2的值。不去计算可接受的三元组数（X1，Y1，Y2），我们将计算X1＜X2，Y1 < Y2且L≤Y2≤R的三元组数目，并从三元组总数减去这个数。



注意如果Y2＜L，那么Y1＜L，因此对于区间端点的单调性，（x1，y1）它本身是一个不可接受的点。因此我们可以完全不考虑Y2≥l。



我们必须计算两个量：



1）所有（x1，y1）中，X1＜X2，Y1 < Y2 ≤R的总数。



2）所有不可接受的（x1，y1）中，X1＜X2，Y1 < Y2 ≤R的总数。



第一个量可以用一个简单的公式来计算。对于计算第二个量，我们把它分为两个量：y1＜R的总和，和y1≥R的总和.



如果Y1＜R，那么（x1，y1）对于所有X1＜X2都是一个不可接受的点，所以计算这一个量又有一个简单的封闭形式的公式。我们把我们的注意力放到Y1≥R.对于每个Y，有一些left（y）使得（x，y）是不可接受的当且仅当X≤left（Y）。对于Y1≥R，这个界不大于X2。所以不可接受的（X1，Y1）集合， 其中X1＜X2实际上对于X2是独立的。所以我们可以预先计算left（y）的前缀和和Y⋅left（Y）的前缀和，并在我们的扫描中，对于每个X2，我们可以计算（Y1≥R）的情况的前缀和。