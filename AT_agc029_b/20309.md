这题太阴了，我一直 WA WA WA，拍了 30 分钟才出错...如果是现场我已经心态爆炸了。

这场 C 的细节也恶心的要死，感觉 D 比 BC 好 A 多了...

第一反应当然是图的匹配问题，肯定不是，我们要找性质。

因为我比较菜，初中数学都忘光了，所以我自闭了 15 分钟才发现：如果把权值相同的点缩成一个点，那么这是一棵树。证明还是比较简单的，因为一个数 $x$ 最多只能和前面的一个数拼成 $2$ 的幂。

那么树的匹配就是从叶子开始贪心，结束了？

不不不，$2^i$ 还可以和自己匹配，怎么办？

手玩一个数据“$2\ 2\ 2\ 6\ 6\ 6$”就可以发现，$2$ 个数的贡献最多是 $1$，那么能和其他数匹配一定更优。那么先匹配，剩下来的再两两匹配即可。

结束了？

大多数人的 dfs 直接以最小的节点为根开始，这样就~~歪打正着地~~ AC 了。然而我当时偷懒直接按照输入顺序开始，然后就 WA 了，？？？这是为什么？

冷静了 1 个小时，我找到了 hack 数据...$34\ 30\ 2\ 2$。如果从 $34$ 开始 dfs 那么就出事了...意会一下发现必须要以可以自己匹配的特殊点为根...所以就以最小的为根即可......

~~这个故事告诉我们比赛其实是很靠运气的。~~

时间复杂度 $O(n\log_2 n)$，因为还要离散化。



------------


事实上如果从无脑贪心而不是匹配入手你就不需要想这么多了。显然一个数 $x$ 最多只能和前面的一个数拼成 $2$ 的幂，所以就...

这是因为树匹配的本质就 tm 是贪心，想树匹配反而更麻烦了...