群友把这题当了胡策的签到题，脑洞不够大没把大家都在说的直接容斥的正确性想出来，所以我写了个高维后缀差分，它也是对的。

----

先考虑求出对于每个字符串的集合 $T$ 求出**至少**满足这个集合中字符串的限制的答案总数 $f(T)$，这个好做，直接看看哪些位上被确定必须选某个字符即可。另外设一个**恰好**满足 $S$ 中限制的答案总数为 $g(S)$，则 $f(T) = \displaystyle\sum_{T \subset S}g(S)$ 即为所有 $T$ 的超集 $S$ 的恰好的答案之和，其实就是说 $f$ 是 $g$ 的子集后缀和，本质上是个高维后缀和，做一下它的逆运算即可得到 $g$ 数组，具体实现就是做一遍 $\operatorname{and}$ 卷积的 idmt。

最后答案即为 $\displaystyle\sum_{\operatorname{popcount(S)} = k}g(S)$。