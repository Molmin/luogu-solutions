起来先建模

首先我们手膜一下，发现如果 $a-2,a-2-2,a-2-2+k=a$

那么实际上你就删除了个寂寞

$x\rightarrow x-2,x\rightarrow x+k$

看得就很像一个图

于是我们建个图，连边 $x\rightarrow x-2,x\rightarrow x+k$

然后有解的条件无非就是无环

无环了我们就按拓扑排序的方式一个个删，有环删了多少圈也删不掉

但是我们可以知道，在图上计数是非常麻烦的，解决方法无非就是转化为树上问题，转化为$\text{DAG}$上问题，发现某些性质简化图从而实现计数。

那么看来看去，前两者都是不太可行的，但是这个图本身就很有特点。

首先，分类讨论
### $2|K$
这个好弄，因为奇偶是分离的。

那么合法的方案，就是不要连续选$K/2+1$个。

否则容易发现有一个环嘛。

这个就从图上问题变成序列上问题，而且用dp轻松解决。

设$f[i][j]$表示目前选到$i$，最后连续选了$j$个

$$f[i][j]=f[i-1][j-1]+\sum_1^{i-1} f[k][0]$$

因为奇偶分离，答案就是$(\sum f[N/2])\times(\sum f[\lceil N/2\rceil])$
### $2\not|K$
这个就比较麻烦

首先奇偶是有联系的，但是联系并非毫无特点。

显然我们可以先把奇偶分开来，各放一边。

对于一个结点，从对面（即不同奇偶）来的边，至多两条。

一条$x-k\rightarrow x$，一条$x\rightarrow x+k$

这个是性质。

我们可以继续考虑dp，当然要考虑如何dp。

那么就要考虑dp的依据。

依据不就是没有环嘛。

但是你会发现没有环这个限制条件，还不够具体，如果我们只是考虑没有环，难不成我们要把所有的点的状态记下来？

考虑如果一个一个点从小到大考虑。

首先dp嘛，通过设计状态，我们可以不关注与最后一个点无关的环（在该状态前就已经保证），也不需要关注这个点后面会形成的环（在该状态后会保证）。

那么就要考虑，与该点有关的，由这个点前面的点，组成的环有什么特点。

因为最大值就到这个点，所以这个环从这个点出发，从这个点结束。

那对于x，可能的环就是：$x,x-2,x-4...y-k,y,y-2,y-4...x-k,x$

其中y与x不同奇偶，形成了类似于8字形的环

那么这个环的特点有什么

首先，满足我们探究的要求的环是不唯一的，也就是y有多个。

其次，环的大小是唯一的，大小为$k+2$（想想为什么）

沿用我们上一个类型的思路，大小唯一的环，要不形成环，只需要满足，不连续选择$k+2$个点。

可是环的形态不唯一啊，不可能每一种形态都记录大小啊。

那我只在乎最大环就好了嘛。

只要最大值都小于$k+2$，就一定满足。

当然这个设计还不够优秀。

我们要一个一个点加入吗？

其实未必，我们可以考虑奇偶两个点一起加入，也就是左边和右边的点一起加入。一次加入一层点。

然后我们对环的判断，是基于以x为最大的奇或偶数进行的。

如果要把所有可能都考虑到，我们就不能12，34，56为一对地加点，因为有可能出现加入新的点后，一些状态没有考虑到。

所以要$x,x+k$为一对加点，也就是保证以x为最大的奇或偶数的所有的环，在这一步都考虑过了。

然后就可以设计$\text{dp}$了。

设$f[i][j][k]$表示遍历到第$i$层，以$i$层左侧点开始，最长的链长度为$j$（也就是判最有可能形成环的链），右侧已经连续选了$k$个点。

注意点的分布是先只有右侧的点，然后都有，然后只有左侧的点。

都不选
$f[i][0][0]=\sum f[i-1][j][k]$

只选左侧
$f[i][j][0]=\sum f[i-1][j-1][k]$

只选右侧
$f[i][0][k]=\sum f[i-1][j][k-1]$

都选
$f[i][max(j,k)][k]=\sum f[i-1][j-1][k-1]$

