## CF960E：



提供一种简洁易懂的写法。

可简化为树上黑白染色。

首先想到树形DP，如果是棵有根树，状态转移方程如下：
$$
{f[x][0]=f[y][1]+siz[y] \times a[x]}
$$

$$
f[x][1]=f[y][0]-siz[y]\times a[x]
$$

记 $siz[x]$ 表示子树大小，$f[x][0/1]$ 表示当前点颜色为 $0/1$ 时的答案。

因为对于子树中每个点都会有一条路径，所以每新加入一个点 $x$，贡献为 $siz[x]\times a[x]\times (-1)^{0/1}$。

现在就有了一个 $O(n^2)$ 的做法。

考虑换根。

设 $g[x][0/1]$ 表示以当前点 $x$ 为根时的答案。

就是减去父节点对以当前点为起点的路径的贡献，再加上当前点应产生的贡献。

转移方程如下：
$$
g[y][0]=g[x][1]+siz[y]\times a[x]+(n-siz[y])\times a[y]
$$

$$
g[y][1]=g[x][0]-siz[y]\times a[x]-(n-siz[y])\times a[y]
$$

时间复杂度 $O(n)$。

[code](https://codeforces.com/contest/960/submission/176151017)