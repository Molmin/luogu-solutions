简单题。

考虑对于某个棋子，每个点 $x$ 是否需要到达。

设结点深度为 $d_x$ 。

结论：

1. $x$ 子树内存在这个棋子需要达到的点，那么必须到达。

2. $x$ 子树内另一个棋子最深的需要达到的点为 $y$，若 $d_y-d_x > D - 1$ 那么必须到达。

所以直接一遍 dfs 搜出每个子树内两个棋子分别最深的深度就可以了。

假设每个点都要被两个棋子到达，则 $ans = 4(n-1)$ ；

对于每个棋子，每不必达到一个非 $1$ 号结点的点，则对答案贡献为 $-2$ 。

时间复杂度：$O(n)$ 。

[代码](https://codeforces.com/contest/1774/submission/185683299)