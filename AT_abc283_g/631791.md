## $\text{Statement}$

对于一个非负整数序列 $a = (a_1, a_2, \dots, a_n)$，我们定义其的异或是一个非负整数 $X$，使得对于任意非负整数 $j$ 有 $X$ 二进制的第 $j$ 位为 $1$ 当且仅当 $a$ 中有奇数个元素满足二进制的第 $j$ 位为 $1$。

给定一个 $n$ 长度序列 $A = (A_1, A_2, \dots, A_n)$。令 $\{s_1, s_2, \dots, s_k\}\ (s_1 < s_2 < \cdots < s_k)$ 为 $A$ 的所有可空子序列的异或组成的集合。注意子序列不一定连续。

再给定两个整数 $l, r$，请输出 $s_l, s_l + 1,\dots, s_r$。

$1\le n \le 2\times 10^5, \ 0\le A_i < 2^{60},\ 1\le l \le r \le k, \ r - l \le 2\times 10^5$。

## $\text{Solution}$

重写题意如下：
给定 $\mathbb F_2^{60}$ 空间内的 $n$ 个向量，你需要求出它们的张成中第 $[l,r]$ 小的元素。

首先考虑第 $k$ 小如何求得。

我们求出该张成的一组异或线性基 $L$，满足任意一维只存在一个向量在这一维取 $1$。由于张成中任意向量 $\textbf u$ 都可以被唯一地表示为线性基中一组向量的异或，$L$ 中任意一个子集都可以不重不漏地构成原张成中一个向量。

记 $L$ 的大小为 $x$，$L$ 中第 $0\le i < x$ 小的元素为 $L_i$，$k$ 在二进制下的第 $i$ 位为 $k_i$。不难发现第 $k$ 小即为
$$\bigoplus _{i = 0}^{x-1} k_i \times L_i$$

其中 $\bigoplus$ 表示异或。

随后考虑如何由第 $k$ 小生成第 $k + 1$ 小。

将 $k$ 与 $k + 1$ 写作二进制后可以发现，$+1$ 使得 $k$ 最后的一段 $1$ 变为了 $0$，最低的 $0$ 变成了 $1$。记 $k$ 中最低的 $0$ 位于第 $p$ 位，我们只需要将原先的答案异或 $\bigoplus_{0\le i\le p} L_i$ 即可得到 $+1$ 后的答案。这点可以通过预处理 $L_i$ 的前缀异或值在 $O(1)$ 的复杂度内完成。

总时间复杂度为 $O(n\log n + (r - l))$，其中线性基的大小为 $O(\log n)$。

[Submission](https://atcoder.jp/contests/abc283/submissions/37532674).