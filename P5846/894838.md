显然要考虑树形 DP。

1. 设 $\mathit{f}_{i,j}$ 表示子树 $i$ 选了 $j$ 个的最小代价。发现转移时的 $cost$ 没法转移。

2. 设 $\mathit{dp}_{i,j,k}$ 表示子树 $i$ 选了 $k$ 个距离 $i$ 最近的伐木场是 $j$ 的最小代价。不方便处理 $i$ 是不是被选中的情况。

3. 设 $\mathit{f}_{i,j,k,0/1}$ 表示的是 $i$ 是不是建立的伐木场，其他对应第三种情况。

首先，计算两点距离可以树上差分，由于我们这里要计算的两点距离都在一条链上.

对于 $i$ 不选，枚举当前已经选择了多少个，此时对于最近节点也必然为  $j$，所以要从 $\mathit{dp}_{v,j}$，
状态转移。

对于 $i$ 选，这里 $v$ 最近的就是 $x$ 了。

考虑对当前节点 $\operatorname{dp}$，
完后的处理过程，将某些 $\operatorname{dp}$
状态完全计算掉，对于需要把木头运到 $j$ 
的要把代价计算上。