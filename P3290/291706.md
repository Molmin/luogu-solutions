# P3290 题解
这是一道非常经典的轮廓线$dp$题目，但是洛谷还给了一个$KMP$的标签，某种程度上是一种提示orz。 

****
好的，回归正题。我们来对$d$拍$p$：  
这个问题相当于是求**不包含的方案数**。$so$：  

我们定$dp_{i,j,status,x,y}$~~拗口地~~表示：在$ij$位置，$i$行的$ij$和第一个模板匹配到了$x$，和第二个模板匹配到了$y$，$status($简称为$S)$是轮廓线状态(每个位置作为末尾是否能匹配串$1$）  

$dp_{i,j,S,x,y},dp_{i,j+1,S1,x',y'}$（$x'$和$y'$是加入新的一列后的匹配长度）两者之间怎么转移？

不难看出，前两维，也就是$dp_{i,j}$这个是可以滚动的，并且$x',y'$**可以通过$KMP$预计算**（$wow$标签真神）。

每行初始状态（累加）  
即$dp_{i-1,m-1,S,*,*}->dp_{i,0,S,0,0}$  

然后，如果$S\&(2^j-c)==1\ \&\&\ y==c$，那么这种情况就是两个都匹配上了，不转移。

那么读者还可以思考一下这个问题：  
$S1$更新位置怎么计算？ 

# 至于代码
大佬[hsfzLZH1](https://www.luogu.com.cn/user/43486)的代码非常好，可以去看$Ta$的，这里只是提供一个思路$+$分析。