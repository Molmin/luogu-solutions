想不到我这个蒟蒻居然能发一波题解。。

融合了某位大佬的精华思想。。在此鸣谢 @whbwhb

既然题目是斐波那契 那一定是跟斐波那契有点点关系的。。。

首先根据题意模拟建树的话 用O（n）建图貌似能过70分

但是一看数据 10^12 说明建图做法是不可取的

那么。。一定有什么数学关系

首先 写个斐波那契出来 证明到达10^12个点 最多需要f（60）左右

然后根据题意大概画个图

凑活看一下

1  2  3  4  5  6  7  8  9  10  11  12  //找对应父节点

2
3
4  5
6  7  8

9  10 11 12 13

14 15 16 17 18 19 20 21

22 23 24 25 26 27 28 29 30 31 32 33 34

……
不难看出对于每一个确切的点 可以通过预处理的斐波那契得到他的父节点

即每层点是从f（i-1）到f（i）的 差值即为当前层的父节点

然后可以用类似lca的想法一层层跳 因为层数最多60 所以在线处理不会超时

至于代码我就不粘了（不会告诉你我是9:40开始写的然后爆零了）

这个思想蛮好理解的 自己写写递归或者用循环都可以过

处理小技巧：如果想两个点一起跳的话 可以标记一下走过的点 第一个跳到的被标记过的父节点时即为最近公共祖先

这样代码比较简洁 比lca逐层处理好写一点
