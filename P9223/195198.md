## 前言

出题人来一篇。

这道题的目的主要是想考查位运算关于“拆位算贡献”的小 trick 的使用。感觉这个 trick 在一些题目中比较常用，也比较有意义，就放上来了。

## 正文

### Subtask 1

直接暴力枚举 $n,m$，算答案即可。

### Subtask 2

首先一个套路就是，对于所有的二进制相关的题，可以拆位算贡献。

枚举当前的位数 $k$（从低位到高位）。

假设 $1 \sim n$ 这一位是 $0$ 的个数是 $c_0$，是 $1$ 的个数是 $c_1$。

假设 $1 \sim m$ 这一位是 $0$ 的个数是 $d_0$，是 $1$ 的个数是 $d_1$。

则我们任选一个 $c_0$ 的，乘上一个 $d_1$ 的，就会产生 $2^k$ 的贡献。同理，任选一个 $c_1$ 的，乘上一个 $d_0$ 的，也会产生 $2^k$ 的贡献。

所以这一位的贡献就是 $c_1 \times d_0 + c_0 \times d_1$。

那么我们拆位，按位枚举 $1 \sim n$ 和 $1 \sim m$ 算一下 $c_0,c_1,d_0,d_1$ 的数量，统计贡献即可。

注意由于 $T$ 比较大，所以可以从 $1$ 到 $10^6$ 预处理一遍，到时候的贡献就可以直接算了。

复杂度 $O(n \log n+T)$。

### Subtask 3

容易发现这个时候，除了 $n$ 和 $m$ 的最高位，每一位要么全 $0$，要么 $0/1$ 等分。

因此 $c_0=c_1=n/2$，$d_0=d_1=m/2$。

直接算即可。复杂度 $O(T \log n)$。

### Subtask 4

考虑第 $k$ 位，显然一个长度为 $2^{k+1}$ 次方的段可以让 $0$ 和 $1$ 等分。因此可以先拆出若干个段，剩下的长度肯定小于一段。

考虑分类讨论。显然如果剩下的长度 $L \leq 2^k$，则这一位剩下的只有 $0$，否则会有 $L-2^k$ 个 $1$。

对 $n$ 和 $m$ 分别计算一下，乘起来即可。

复杂度 $O(T \log n)$。