这好像也可以说是线段树维护区间最长连续上升的模板题。。。我们用斜率来表示高度，用一个线段树来维护某个区间内的高度最大值和最长连续上升。修改高度的时候只需要普通的线段树更新就好了，但是我们需要更新最长的长度，考虑一个区间[l,r],它的lc和rc的信息都是已知的，那么就是求rc这个区间内大于Max[lc]的连续上升的数的个数。
现在我们开始递归修改，记h为Max[lc]。
1、若右区间的左子区间最大值大于等于h,那么它的右子区间的个数就可以直接求出来，继续递归lc的左子区间即可。
2、若右区间的左子区间最大值小于h，那么他的左子区间的贡献必定为0，所以继续递归右子区间即可。
总的时间复杂度$O(n*\log^2n)$(比我的分块不知道快了多少。。。)

[代码在我的博客里](https://blog.csdn.net/ylsoi/article/details/80085896)