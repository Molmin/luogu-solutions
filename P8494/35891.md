考虑类二分答案的过程。

首先容易花 $n$ 次操作算出种类。

记共有 $n$ 只昆虫，$c$ 个种类的最小步数为 $F(n,c)$。

枚举一个答案 $ans$，接下来 $O(n)$ check 它：贪心往机器不断加昆虫使得基数恰好不多于 $ans$。记第 $i$ 种昆虫有 $a_i$ 只，此时每种昆虫被加入了 $\min(a_i,ans)$ 只。

于是有这样的策略：

1. 如果机器内昆虫数为 $c\times ans$，那么就递归到没加入的昆虫的一侧即 $F(n-c\times ans,c)$。

1. 否则递归到被加入的昆虫一侧，即 $F(c\times ans,c)$。

取 $ans=\dfrac{n}{c}$，毛估估一下 $F(n,c)$ 不超过 $2n$。

调调参就能过。