## 题意

定义「神串」为所有出现的字符的数量相等的字符串，给定 $n,m,k$，要求构造一个仅由 $\tt l,r$ 构成的字符串 $s$，满足：

- $\text{length}(s)=n$；
- 「神串」$p$ 是 $s$ 的**子串**，则所有 $p$ 中，$\max\{\text{length}(p)\}=m$；
- $s$ 中的连续字符长度不得超过 $k$。

$1\le k\le 10^5$，$4\le m\le n\le 10^5$。

## 解法

无法令人理解的 adhoc 题，不知道为什么可以放在 2A，想出来之前感觉黄，想出来后代码实现红。感觉放在某本教材的例题供读者思考可能比较不错。

既然是 adhoc，那么我们来详细谈谈想到正解的过程。

___

我们先考虑如何构造出 $p$，显然 $p$ 的左右具有对称性，所以我们把 $p$ 置于 $s$ 的开头。需要最小化连续字符长度，那么我们重复 $0.5\cdot m$ 次 $\texttt{rl}$ 即可完成任务。

### Subtask 1 & 2

- $n=m$ 时我们已经完成任务；
- $k=1$ 时，我们有 $n-m\le 1$，证明显然，于是在后面直接补 $\texttt r$ 即可。

### Subtask 3

$k\ge3$ 的情况，考虑到我们不能出现除了 $p$ 外的其他「神串」，于是考虑让 $\tt l,r$ 中的某个字母出现次数远远大于另外一个，于是考虑后面跟个 $\texttt{ll}$。这样字符出现的次数 $c_\texttt l>c_\texttt r$，可以完成。

由于有 $k$ 的限制，我们无法继续添加 $\texttt l$ 来保证优势，所以考虑增加 $\texttt r$。然后我们需要迅速靠 $\texttt l$ 挽回局面。

所以考虑输出 $p$ 后循环构造 $\texttt{llr}$，发现一定符合条件。

至此我们解决了 $k\ge 3$ 的情况，那么 $k=2$ 显然会是一个瓶颈。

### Subtask 4

随机考虑一组 $k=2$，例如在此条件下 $n=10,m=4$，我们依照上述方法（即 $p$ 后三字母循环）随意构造一个 $s$：

$$
\texttt{r}\texttt{\color{#F07C82}lrllrr}\texttt{lrr}
$$

上面粉色部分是一个「神串」，且长度为 $6>4$（当然还有更长的，但没必要指出）。

构造几个后我们发现，这样的情况均发生与 $p$ 的后段与后面循环节的前段。

考虑破坏 $p$ 的后段，最后决定将 $p$ 的最后两个字符改为 $\texttt{lr}$。

这样我们可以在 $p$ 的后面仿照 Sub 3 的解法在后面循环构造 $\texttt{llr}$，容易发现这样和 Sub 3 是等价的。

有的读者可能会问，为什么我们不在开始就采用这样的方法？原因是显然的，因为 $p$ 的末尾也是 $\texttt l$。

这样我们就解决了 $k=2$ 的情况，容易发现这对 $k\ge 2$ 是普适的。

___

至此我们解决了本题的所有情况，读者不难看出部分分对正解的引导作用。

## 思考

读者不妨考虑一下本题的 SPJ 的重要组成部分，即下面的子问题：

>给定字符串 $s(1\le |s|\le 10^5)$，求出其中最长的「神串」子串 $p$ 的长度。

容易发现以空间换时间的 $O(n)$ 解法是显然的，即每次统计 $c_\texttt l-c_\texttt r$ 并将其下标插入桶中，每次查询求得最大值即可。

___

想掌握 adhoc 题的话，你还没关注蓝的 Ad-hoc 练习计划吗。

[指路](https://www.luogu.com.cn/blog/YakumoRanqwq/)。