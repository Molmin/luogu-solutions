### 这里给出一种会 $T$ 但是能过的暴力 $dp$ 做法

### [link](https://www.luogu.com.cn/problem/P2536)

考虑 $f[i][j]=0/1$ 表示模板串前 $i$ 位，比对串前 $j$ 位能否匹配

记模板串第 $i$ 位为 $a_i,$ 比对串第 $j$ 位为 $b_j\ ($下标从$1$开始$)$ 

接下来分情况讨论

- $a_i=*$

$$f[i][j]\ |=\ f[i-1][k]\ (k\in[0,j])$$

```latex
|=就是存在一个f[i-1][k]为1则f[i][j]为1，否则为0
```
由于 $b_{k+1}...b_{j}$ 都可以被一个$*$ 匹配，$k=j$ 即不填

- $a_i=?$

$$f[i][j]=f[i-1][j-1]$$

- $a_i=A/C/T/G$

$$f[i][j]=f[i-1][j-1]\ (a_i=b_j)$$

答案即 $f[len_a][len_b]$

$*$ 的操作只要边循环边或就行

发现 $f$ 的转移只和上一行有关，于是滚动数组优化

复杂度$\mathcal{O(n*len_a*len_b)}$

能过题但是复杂度不优，仅供参考

[code](https://www.luogu.com.cn/paste/bipwfeg2)

我代码合并了连续的 $*,$ 不知道不写能不能过