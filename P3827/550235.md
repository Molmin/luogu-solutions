do，御坂前来贡献另一种做法。

为方便，把凸包拆成上下凸壳分别维护。

预先求出最外面 $\max k+1$ 层凸壳~~剥洋葱~~。一次查询相当于给定一层凸壳与 $O(k)$ 个外层凸壳的连续片段，问构成它们的点集的并的凸壳面积。

考虑向点集中从内到外依次加入每层的凸壳片段，并实时维护这个凸壳。注意到外层的一定包着内层的，故待插入片段与当前凸壳的外公切线一定过此片段的左右两端点。只需将当前凸壳上两切点之间的部分换成该片段。这和动态凸壳的插入单点实现起来几乎是一样的。

使用的数据结构要求支持区间提取、回退。平衡树和动态开点线段树理论上均可。

时间复杂度 $O(nk+(n+\sum k)\log n)$。

[巨丑代码](https://www.luogu.com.cn/paste/ef1754fj)