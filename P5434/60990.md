### 题意

求 $n$ 个点的有标号荒漠数量。

$\texttt{Data Range:}1\leq n\leq 10^5$。

### 题解

不知道之前为啥脑抽了交了个神笔题解上去，重写了一发。

首先先考虑如何数有标号无根仙人掌，荒漠计数的话直接 $\exp$ 一发就 OK 了。

设有标号有根仙人掌的 EGF 为 $F(x)$，则考虑将圆方树建出来并且钦定一个根，分类讨论一下与根相邻的点的类型：

- 如果是圆点则可以直接断掉这条边，对应的 GF 为 $F(x)$。

- 如果是方点，设在仙人掌上对应 $i+1$ 个点的环，则需要将这个环全部断掉，对应的 GF 为 $\dfrac{F^i(x)}{2}$。

至于这里为啥要除以 $2$ 的话，其实是因为如果直接断环的话让连通块再拼起来正反都会算一遍，所以得除掉。

同时，由于圆点和方点可以自由组合，所以得到：

$$\exp\left(F(x)+\frac{1}{2}\sum_{i\geq 2}F^i(x)\right)$$

简单化简一下

$$\exp\left(F(x)+\frac{F^2(x)}{2-2F(x)}\right)$$

由于需要考虑根而上面的过程并没有，所以加上这个根的贡献得到

$$F(x)=x\exp\left(F(x)+\frac{F^2(x)}{2-2F(x)}\right)$$

牛迭即可，其中可以记录中间结果方便计算，计算结果就不给出了。（因为实在太难算）

由于这里考虑的是有根仙人掌，对于无根仙人掌的话，$k$ 次项需要乘上 $\dfrac{1}{k}$ 才能得到 EGF，最后 exp 一下即可。