学文化课回来的第一场 vp。

最后十五分钟把 E 写出来了，然后家里网络差，调试没删，题目里有 $i_p < i_{p+1}$ 这种奇怪限制，没过。在比赛结束前用洛谷交上去过了，但是在 vp 里不算。

## 题解

首先一个集合 $S$ 的 $\rm gcd$ 可以用 $\min-\max$ 反演转化为 $\operatorname{lcm}$，这样就可以做到 $2^{|S|}-1$ 次操作表示 $\gcd$ 了。

注意到一个数只有不超过 $8$ 种质因子，所以从 $S$ 中随便选一个数 $x$，对于 $x$ 的每种质因子找包含这个质因子次数最少的元素加进来，即可用不超过 $9$ 个元素表示整个集合的 $\gcd$。

结论：原问题的答案是 $(\gcd_{i} a_i)^2 \prod_{i} \frac{\gcd_{j \neq i} a_j}{\gcd_{j} a_j}$（对于每个质因数考虑一下就可以发现其正确性）

$\frac{\gcd_{j \neq i} a_j}{\gcd_{j} a_j} \neq 1$ 的 $i$ 只有不超过 $8$ 个（证明和上面比较类似，不再赘述），所以对于非 $1$ 的 $i$ 暴力即可。

[代码](https://codeforces.com/contest/1687/submission/161356722)。比 std 更好写，复杂度也更好，在出题人的数据中最多只用了 $2164$ 次操作（显然每次操作不会用超过 $9$ 个元素）。

时间复杂度也好得多，是 $\Theta(n \log A + \omega(A)(n\omega(A)+ \sqrt{A}))$（这个 $\sqrt{A}$ 是质因数分解的，可以做到 $A^{\frac{1}{4}}$ 因此 $A$ 甚至可以 $10^{18}$）。