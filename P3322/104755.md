刚看见题面有点蒙感觉除了暴搜什么都不会做。

没想到正解是搜索...

只要有一种操作不同就算不同方案，而对于一个方案，其内部顺序对结果无影响，所以求出一种后其全排列均合法，ans+=A（tot,tot）;

因为有上面这个性质所以从1搜到n，表示第i种操作的进行。

暴搜：暴力枚举端点进行交换。注意for循环中i+=长度,而不是i+=1,因为前提是先划分在选着换，不读题会很惨。T30

剪枝：一个特点：对于每种操作找出非连续序列个数如果大于2一定不合法，等于0就直接搜而不能再去换，因为这样会使顺序混乱一定不合法。

解释+具体操作：在搜第i种操作时假设小区间长度是y那么划分成Y/2个区间，每个里有两个小区间，查看它们是否是连续序列。因为下一次小区间长度就是y*2,所以

这次操作后不会有机会对其内部更改。以后就不会合法，这也是为什么非连续等于0后不能换的原因，因为换了内部一定不再合法。

count==0,直接搜下一种，==1看是否交换后合法，是搜下，否return，==2有四种情况其中1，3和2，4判断条件同而23，14不同。

tot记录使用的操作种类数。

 

骚操作：枚举换区间改成线段树。