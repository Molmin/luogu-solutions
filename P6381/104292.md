### 一些 BF 的代码解释：

1. 每次 topo 只是对权值为 $w$ 和 $f_w$ 的边进行（权值默认已进行质因数分解转化），而且图要根据这些边重新建，因为以前 topo 的图留下的边不能存在，因此还要把邻接表 head 和边的编号 cnt 清零。

1. 建图时 $+n$ 是为了防止连续经过 $w$ 或 $f_w$ 的边，所以对于两种边，一种是起点 $+n$，一种是终点 $+n$，这样跑 DAGdp 时就会交错经过两种边。

1. DAGdp 的初始化，把零入度点加入队列时入度赋值为正无穷，是防止它作为其他边的起点时重复把它加入队列。

1. topo 最后要清零，这里BF写的有些多余了，只用这样：

```cpp
dp[e.v]=0;
in[e.v]=in[e.u+n]=0;
head[e.u+n]=0;
```

另一半同理，只是记得 $+n$ 的点变成终点 v。

注意每条边的起点入度也要清零因为有些被赋值成正无穷了。。。

质因数分解就不说了，就是注意算 $f_i$ 时 $>lim$ （边权 w 上限）就要 return，否则送你爆 long long。

对于用了快速幂的玩家，请注意快速幂里面特判有一堆细节，这里不再赘述~~因为没几个人像我这样傻的用快速幂~~

小贴士：不用 xxs 直接枚举来分解质因数也能过，虽然计算量按理会达到 $1.8 \times 10^8$ 左右。

~~自己代码就不贴了，丑死了~~
