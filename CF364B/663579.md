
~~我倒看看是代码先不`UKE`，还是题解先通过。~~

我们考虑一个事情：一个总价值为 $a$ 的状态一定可以以一次操作的时间转移到任意一个总价值介于 $a+1$ 与 $a+d$ 之间的状态（闭区间）。因为除去两者相同的部分后，价值差不变。

所以我们每次向一个可以达到的价值最大的的状态转移就好了。

所有可以达到的状态从一开始跑一遍01背包。

时间主要花费在01背包上，时间复杂度 $\mathcal{O}(nm^2)$。（$m$ 表示单个物品价值的值域）

[AC代码](https://codeforces.com/contest/364/submission/177617412)
