CF1043F Make It One

题意：给定 $n$ 个数，要求在其中选择 $x$ 个数使它们的 $gcd$ 为 $1$，求 $x$ 的最小值，数据范围：$n\leq 300000,a_i\leq 300000$  

$300000$ 之内的质因数最多只有 $6$ 个，答案每加一个，从质因子集合里一定去除掉一个数，可以从 $gcd$ 的组合意义上考虑，指的是几个数标准分解后交的部分，$gcd$ 为 $1$ 也就说明这几个数质因子没有交集，而且要保证最小所以包含在原先几个数并的集合内的数一定可以不选，选和不选没什么区别，所以加进来的新数一定会从全集里再取掉一部分

但是答案最多是 $7$ 个，因为我们在质因子最多的情况下可考虑的质因子有 $7$ 个，要求无交，可以从七个质因子的积中每次去掉一个，这样每个数都少一个质因子，七个数无交

答案很小可以枚举，枚举选 $k$ 个数，然后容斥，设 $f[i]$ 为选 $k$ 个数，$gcd$ 为 $i$ 的方案数，如果 $f[1]\not=0$ 那就合法，$f[i]=\binom{cnt_i}k-\sum_{ij\leq a_{max}}f(ij)$，$cnt_i$ 是这 $n$ 个数里面有多少个是 $i$ 的倍数，理解就是从 $gcd$ 为 $i$ 和 $i$ 的倍数的方案里减掉 $gcd$ 是 $i$ 的倍数的方案数，这样就只剩下 $gcd$ 为 $i$ 的方案了  