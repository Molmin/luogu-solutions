# [BJOI 2019]奥术神杖

[题目链接](https://loj.ac/problem/3089)

挺套路的一道题。

## 题目叙述

给你一个大字符串，其中有数字和字符"."，"."处可以填任意数字。有$n$个小字符串，每个小字符串有一个价值，设一共匹配了$c$个小字符串（不同位置匹配，或者不同字符串匹配都算不同的匹配），每个匹配上的小字符串的价值为$v_i$。那么大字符串的价值为$\Pi_{i=1}^cv_i$开$c$次更好。构造一个大字符串，使得价值最大，求这个字符串。

## 题解

首先看到乘积形式，我们可以想到通过两边同时取$log$的形式变成了几个数相加的形式。然后可以发现这就变成了一个$01$分数规划的问题，即匹配到一个字符串就会获得一定的价值，求平均价值最高。二分平均价值，然后在```AC```自动机上$dp$即可（具体就是匹配一个字符串得到一定价值，求最大价值）。

## 代码

[code](https://loj.ac/submission/728103)

**注意该用double的用double！！！另外有小数据就开始调试，不要瞪着代码看！因为调试实际上没有那么麻烦。**

## 知识点
+ 如果是出现乘积形式的 $Ans$=$c$次根号下${\sqrt{\Pi_{i=1}^na_i}}$，我们可以两边同时取对数，得到$ln\ Ans=\frac{1}{c}\sum_{i=1}^cln\ a_i$。可以化为形式$\sum_{i=1}^c ln\ a_i-ln\ Ans$。
+ 记住这次这个$ac$自动机上$dp$的简单模型（其实记不记无所谓）。
+ 注意当前这个节点的状态包含的其他状态（就是$fail$指针所指向的）。