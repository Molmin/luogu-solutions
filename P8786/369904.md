原本不想写题解的，但是因为自己脑子不太好使然后细节挂了所以打算写篇题解警告自己脑子有问题。再加上我的方法和那篇题解不太一样（虽然本质差不多）就交了供跟我方法一样的人参考。



------------


这道题有个相当显然的状态，同时也是更省空间的方法。

令 $dp_{i,j,k}$ 表示遇到了 $i$ 次店，且遇到了 $j$ 次花，当前酒量为 $k$ 的方案数。那么答案就是 $dp_{n,m-1,1}$ ，这个是因为最后一个 **必须** 选花。两位四川女队就挂在了这里。

初始状态是 $dp_{0,0,2}=1$，即一开始李白有 $2$ 斗酒。

转移方程就是 $dp_{i,jk}=dp_{i-1,j,k \times 2}+dp_{i,j-1,k+1}$，这就相当于我当前这步是店还是花，如果是花的话那么他就可以从 $dp_{i,j-1,k+1}$ 转移过来，店就是从 $dp_{i-1,j,k \times 2}$ 转移过来。注意这里要判断一下能不能从店转移过来，如果当前酒量是奇数的话那么其实是不可以从店转移过来的，因为店是翻倍。

我们枚举 $k$ 的时候只需要枚举到 $100$ 就可以了，因为李白最多只经过 $100$ 次花。

最后注意一下，我们经过的店的数量其实是达到 $0$ 的，因为初始值是 $2$ 。同理花的数量也可以是 $0$ 。

```cpp
	dp[0][0][2]=1;
	for(int i=0;i<=n;i++){
		for(int j=0;j<=m;j++){
			for(int k=0;k<=100;k++){
				if(j>0 and k%2==0 and i>0)dp[i][j][k]+=dp[i-1][j][k/2]+dp[i][j-1][k+1];
				else if(j>0) dp[i][j][k]+=dp[i][j-1][k+1];
				else if(k%2==0 and i>0) dp[i][j][k]=dp[i-1][j][k/2];
				dp[i][j][k]%=mod;
			}
		}
	}
	cout<<dp[n][m-1][1]%mod<<"\n";
```