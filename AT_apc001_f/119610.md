## 标签：

$状压dp，转换$

## 来源：

$AT \ 3913$

## 题意

给你一棵树，每次可以将一条路径上的所有边异或上任意

一个数$x$,最后使所有的边都变成$0$，求最小操作次数。

范围：$n\leq 100000,a_i \leq 15$

# $Solution:$

这道题的转换，似乎第一步就没想到。我们将每个点的点权

赋为连向它所有边的异或和。于是我们发现，每次异或上一

条路径，$u->v$，修改的只是点权$u,v$,也就是只让这两个

点异或上了$x$.那么现在这个问题已经与树无关了。问题变成

从$n$个点中每次选出两个点，异或上同一个数$x$，最后使得，

所有数变成$0$的最小操作次数。为什么可以这样，我们可以

发现，最后的结果一定是所有点权变为$0$，我们发现每次异

或上两个数，对于异或和来说，其实这两个数是相互抵消的。

所以如果一个数列有解当且仅当异或和为$0$。我们考虑一个数

列如果有多个重复元素，贪心的来说，我们必然会让相同的

两两配对，所以现在最多也就剩下$15$个数，我们可以考虑状

压。对于任意个集合我们考虑它的操作下界为元素个数$-1$.

我们现在考虑状态转移。

我有一个绝妙的解释方法。对于每一次异或，我们可以看作

每次将两个数连了一条边，那么我们如果每次让最小的和次

小的异或在一起，那么我们可以保证这样的上界一定是$n-1$

次的，这样一定可以，因为异或和为$0$。于是我们开始考虑

可不可以分成两个或更多的集合，使得更多的集合之间各没

有连边那么我们这样一定可以使答案更优，于是我们设
$dp_s$

表示$s$这个状态最优的操作次数，其实我们只需要最多把它

分成两个考虑就就行了，因为更多的都会被考虑进来。就是

$$dp_s=min(dp_s,dp_{v}+dp_{t})$$

其中集合$v$与集合$t$交集为空，并集为$s$

然后可以转移的条件就是$s,v,t$元素的异或和为$0$
