看似是神题，其实是简单题。

首先看到这个交换位置 $i$ 和 $a_i$ 的规则就眼前一亮，这不是经典套路嘛？

果断建图，对于两个序列分别建出两张图，其中连有向边 $i\to a_i$，表示数 $i$ 必须要去数 $a_i$ 那里。此时显然就形成了若干个环。先考虑一张图，根据经典套路，其答案是 $n-\text{环的个数}$。其意义是从每个环中选出一个点不操作，因为其它的点操作后这个点就自动归位了。

那么现在是两个图同时操作。仍然考虑最多选出多少个点不操作。但是有条件：每个环最多选出一个点不操作。也就是说，对于每个点 $i$，设其在两图中分别属于环 $A_i,B_i$，那么选了点 $i$ 就不能在 $A_i,B_i$ 中选其它点了。

这明显是一个二分图匹配的结构。对于每个 $i$，将 $A_i$ 向 $B_i$ 连边。然后求出最大匹配，这些就是不用动的点。把其它点的编号输出即可。由于数据范围小，故直接使用 $O(n^2)$ 的匈牙利算法即可。

注意考虑重边问题，我们只匹配了一条，其它的得输出。我的做法是开个 map 记录一下边的出现次数。[代码](https://codeforces.com/contest/1783/submission/209711232)。