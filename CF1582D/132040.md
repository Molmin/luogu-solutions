## 题意：

给出一个长度为 $n$ 的 $a$ 数组，你需要构造一个长度为 $n$ 的 $b$ 数组，使得 $\sum{a_ib_i}=0$ ，其中 $n \le 10^4,a_i \le 10^5 $  ，你构造出的 $b$ 数组必须满足 $\sum|b_i| \le 10^9$ ，容易发现一定有解。

## Sol

似乎和官解很不一样呢。

题目中最关键的一句话是“容易发现一定有解”，那么我们必须要找出一种满足所有限制的通法，这看似很难，但让我们一步步来分析。

首先，我们拿到题目的第一个问题是 $a_i$ 不为 $0$ 这一条件怎么用，这很容易让我们想到一种构造方法，如果 $a_i$ 不等于 $0$ ，那么只要对 $a_i$ 两两分组，设第 $i$ 组中的数为 $p_i,q_i$ ，只需要将对应的 $b$ 赋成 $\dfrac{\text{lcm}(p_{i},q_i)}{p_i}$，$\dfrac{\text{lcm}(p_i,q_i)}{q_i}$，容易发现这样构造可以满足 $\sum|b_i| \le 10^9$ 的限制。

但是这样遗留下了一个问题，如果 $n$ 为奇数，那也就是说最后会剩下一个孤立点，我们肯定是要把这个孤立点合并进某一组中，方便起见，我们令 $a_{2i-1},a_{2i}$ 分做一组，将这个孤立点 $a_n$ 分进 $a_{n-2},a_{n-1}$ 这一组中。

不妨设 $x=a_{n-2} ,y=a_{n-1},z=a_{n}$ ，我们要解决的问题本质上是解一个三元一次方程 $ax+by+cz=0$ （**$a,b,c$ 为未知数，不是数组的名字**），我们需要构造一组解使得 $\sum|b_i| \le 10^9$ 的条件依然满足。

接下来有两种情况：

- 若 $x$ 不等于 $y$ ，那么直接令 $a=-z,b=z,c=x-y$，容易验证这一定合法。

- 若 $x$ 等于 $y$ ，模仿上面的思路，我们记 $s1=\dfrac{\text{lcm}(x,z)}{x},s2=\dfrac{\text{lcm}(x,z)}{z}$

	我们现在可以确定 $s2$ 可以为 $c$ ，并且不难发现这样一定是最优的，那么我们现在要解决的问题变成 :
    
    解方程 $ax+by+\text{lcm}(x,z)=0$ 并构造一组可行解。
    
    接下来又有两种情况（事实上可以化归成一种，但严谨起见，还是列出来）：
    
    + $s1 < 0$，此时很直接的我们想到将 $a$ 赋成 $-1$，$b$ 赋成 $s1+1$ 即可解决问题，很不幸，这是错的，形如 `-1 -1 -1 -1 -1` 这种数据可以卡掉它，所以我们还需要对 $s1=-1$ 的情况加入一个特判。
    
    + $s1 > 0$，此时可以将 $a$ 赋成 $1$ ，$b$ 赋成 $s1-1$ ，类似的还是要判 $s1=1$ 的情况。
    
 另外注意你很有可能因为某一些奇怪的越界或是 $int$ 类型的特性造成奇奇怪怪的错误，测一下`5
10000 9999 10000 10000 -9999` 这组数据应该可以查出来。

最后，如果你想要严谨的分析为什么 $\sum|b_i| \le 10^9$ 在任意条件下一定满足，你可以列几个比较复杂的不等式，但在这里不做赘述，感性理解即可。

当然，这是一道很有意思的构造题，方法很小清新，但是需要严谨的分类讨论 ，是近期 CF 出的最好的一道 2D 之一，~~相信可以给逐梦于OI之路上的你，提供一个有力的援助~~，会让你收获 $3-6$ 发罚时不等的好成绩。

相信你如果看懂了上文，代码也不难写出。

```cpp
#include<bits/stdc++.h>
#define MAXN 300010
#define int long long
using namespace std;
int T,n,a[MAXN+5];
int gcd(int x,int y){return (!y)?(x):gcd(y,x%y);}
int lcm(int x,int y){return x*y/gcd(x,y);}
signed main(){
	scanf("%lld",&T);
	while(T--){
		scanf("%lld",&n);
		for(int i=1;i<=n;i++) scanf("%lld",&a[i]);
		if(n%2==0){
			for(int i=1;i<=n;i+=2)
				printf("%lld %lld ",lcm(a[i],a[i+1])/a[i],-lcm(a[i],a[i+1])/a[i+1]);
			puts(""); continue;
		}for(int i=1;i<=n-3;i+=2) printf("%lld %lld ",lcm(a[i],a[i+1])/a[i],-lcm(a[i],a[i+1])/a[i+1]);
		int x=a[n-2],y=a[n-1],z=a[n];
		if(x!=y) printf("%lld %lld %lld\n",-z,z,x-y);
		else{
			int aandb=lcm(x,z)/x,ansc=lcm(x,z)/z;
			if(aandb<0){
				if(aandb==-1) printf("1 -2 ");
				else printf("-1 %lld ",aandb+1);
			}else{
				if(aandb==1) printf("-1 2 ");
				else printf("1 %lld ",aandb-1);
			}printf("%lld\n",-ansc);
		}
	}return 0;
}/*
7
-1 -1 -1 -1 -1 -1 -1
5
10000 9999 10000 10000 -9999
*/
```
