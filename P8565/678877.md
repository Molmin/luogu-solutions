[题目传送门](https://www.luogu.com.cn/problem/P8565)

好题。

发现数列 $a$ 增长的特别快，项数最多时是 $a_1 = a_2 = \cdots = a_{100}$，但这样也只会有一百多项就可以超过 $10^{18}$。

可以考虑搜索，因为搜索树会比较稀疏，函数 $\texttt{dfs(val, cur)}$ 表示凑出 $x$ 还需要 $val$，现在在考虑 $cur$。

但光是搜索肯定不能过这道题，考虑优化。

首先，使用记忆化省去重复的搜索，可以用一个 $map$ 来存储。

然后，可以进行可行性剪枝，如果以后再怎么凑都不行，直接剪枝，可以用前缀和优化一下。

但是这样也只有 $30$ 分。

可以改变一下搜索的顺序，因为先考虑小元素的话，会有较多的无用的搜索，且小元素较灵活，更容易凑到 $x$，故可以从大到小的考虑。

这样就可以过了。

注意：判断能否返回时是 $mp[cur].conut(val)$，而不是 $mp[cur][val]$，否则会超时。因为如果这样判断的话，会直接额外开一个节点，对每一层都是如此，但第一次搜索时会额外开 $2^{dep - 1}$ 个节点，会使后面的搜索查询越来越慢（尽管迟早也要开，等于这样使常数变大了不少）。

时间复杂度：$\mathcal{O}$（可过）

[评测记录](https://www.luogu.com.cn/record/100137871)