lxl 神仙的做法。

考虑到我们一个左括号和一个右括号是可以抵消的，例如：

```((()((``` 抵消后会变为 ```(((((```

```)))()(((``` 抵消后会变为 ```)))(((```

容易发现是一段连续的右括号加上一段连续的左括号。

于是我们可以维护一下右括号和左括号的个数。

查询就是左边一段括号的个数除以二（如果是奇数就要再加一），右边同理。

看一看操作

```Replace``` 操作显然可以 ```FHQ-Treap``` 取出这一段然后打标记即可。

```Swap``` 操作显然也是可以取出这一段打标记旋转。

```Invert``` 就有点麻烦了，我们可以把两种情况下（取反前和取反后）的状态都存一下，到时候直接交换即可。

注意标记下放顺序，先取反再旋转再覆盖。

其他都是平衡树模板。