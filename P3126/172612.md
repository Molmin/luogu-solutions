## 题解-P3126 USACO15OPEN 回文的路径

### 双倍经验:[戳这里](https://www.luogu.org/problemnew/show/CF570E)

### 题目意思：
让你求出图中有多少条回文路径。

### $DP$
* 状态：$f[s][i][j][k][p]$表示走了$s$步，$A$在$(i,j)$位置，$B$在$(k,p)$位置的方案数。

但是显然这样设计状态会时空双爆，于是我们要优化状态

* 优秀的状态：$f[s][x][y]$表示走了$s$步，$A$在$x$行，$B$在$y$行的方案数（然后再把$s$滚掉）

**为什么这样的设计是正确的的呢？**

因为我们知道了在哪一行以及走的步数是可以计算出在哪一列的。

* 转移：$f[v][i][j]=(f[v][i][j]+$
$f[v$^$1][i-1][j+1]+f[v$^$1][i-1][j]+f[v$^$1][i][j+1]+f[v$^$1][i][j])$

这个转移很好想的吧，因为它可以从上/下-左/右转移过来

* 统计答案：

因为$(n+m)$&$1$不一定为$0$所以要分类讨论，

对于$(n+m)$为奇数的情况答案为 $∑(f[v][i][i]+f[v][i][i+1])$

否则为$∑(f[v][i][i])$

