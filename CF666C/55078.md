好题不火系列

首先我们 ob 出一个结论就是最终答案与当前是哪些字符无关。

这玩意很好理解，你对字符集建立一个双射就行。

然后考虑暴力 dp。定义 $m$ 为副串 $t$ 长度，$n$ 为主串 $s$ 长度。

设 $f_{i,\ j}$：当前 $s$ 填了前 $i$ 位，里面最长的一个子序列到了 $t$ 第 $j$ 位的方案数。

那么有 $f_{i,\ j} =25\cdot f_{i-1,\ j} + f_{i-1,\ j-1}$。第一个是放一个不等于 $t$ 第 $j$ 位的，第二个是放一个等于 $t$ 第 $j$ 位的。

然后你发现这玩意在 $j = m$ 的时候不成立。得把那个 $25$ 改成 $26$ 。

然后你眉头一皱发现这个玩意十分玄妙。

这好像是可以直接拆开进行组合数的。

考虑 $f_{n,\ m}$ 的组合意义。

找到 $s_1 - s_n$ 中任意 $m$ 个位置作为 $t_1 - t_m$。

两个字符中间不能有相同于这右边的字符的字符。

再枚举一手最后一个数的位置，因为后边要 * 26。

答案就是 $ans=\sum\limits_{i=m}^{n}C_{i-1}^{m-1}26^{n-i}25^{i-m}$。

最后发现不同的 $m$ 只有 $\sqrt{100000}$ 种。记忆化即可。

其实 dp 的过程也就是这么一个过程。

这个题还是很妙的。


