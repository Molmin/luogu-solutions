感恩出题人自己卡自己，让抽象复杂度飘过去了。

下面认为 $n,q,V$ 同阶。

一看题解区全都是一些各种套娃做法，这里提供一种思考起来清新，跑起来截止到现在是最优解的做法。

看到取模，根号分治大概逃不掉的，对于 $k<v$ 的数，我们考虑建立线段树来做 $\text{rmq}$ 问题，时间复杂度 $O(nv+q \log n)$；

对于 $k \ge v$ 的数，因为取模就相当于是减去 $xk$，因此 $x \le \dfrac n v$，然后每次查询就可以枚举 $x$，变成了 $\dfrac n v$ 次查询区间非严格后继。

这个问题可以先二区间并（俗称猫树），变成了 $O(n \log n)$ 次的加一个数和 $q \dfrac n v$ 次查询后继，可以自由选择数据结构（压位 $\text{Trie}$，多层分块 **可能** 都可以接受），我选择的的是压位 $\text{Trie}$，此时时间复杂度是 $O(nv + q\log n + q\dfrac n v \dfrac {\log n} {\log w})$，此时取 $v = \sqrt {n \dfrac{\log n}{\log w}}$，时间复杂度为 $O(n \sqrt{n \dfrac{\log n} {\log w}})$。