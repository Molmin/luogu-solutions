由于每个天平都要平衡，且较小的天平先调整后就不用再考虑，所以我们可以使用 dfs 递归的调整每个天平。

对于一个天平，若左右大小分别为 $a,b$，那么调整后的大小为 $2\times \max\{a,b\}$。

设 $f_i$ 表示将 $i$ 天平内的天平调整好后的大小，那么 $f_x=2\times\max\{f_{a_i},f_{b_i}\}$（$a_i,b_i$ 分别为天平 $i$ 的两端），最终答案即为 $f_1$，注意特判天平一端为单个砝码的情况。

最终 $f_i$ 一定可以表示为 $x\times 2^k$ 的形式，其中 $1\le x\le 10^9,0\le k\le n$，这个数字可能非常大，但是我们可以用一个二元组 $(x_i,k_i)$ 表示 $f_i$。

在比较 $f_i$ 和 $f_j$ 的大小时（不妨设 $k_i\ge k_j$），若 $k_i-k_j>30$，由于 $10^9<2^{30}$，由 $k$ 造成的差距无法用 $x$ 来弥补，故可以直接确定 $f_i,f_j$ 的大小关系；否则可以将 $f_i,f_j$ 分别除以 $2^{k_j}$，再比较 $x_i\times 2^{k_i-k_j}$ 和 $x_j$ 的关系，由于 $k_i-k_j\le30$，这两个数都是在 long long 范围内的，可以直接比较。

最后输出答案时先输出 $x_1$ 的二进制表示，再输出 $k_1$ 个 $0$ 即可。