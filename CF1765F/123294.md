挺趣味的一道题，让我对线性组合产生了新的理解。

考虑两种试剂 $i, j$ 以及对应体积 $a_i, a_j$，则浓度为 $a_ix_i + a_jx_j$，价格为 $a_ic_i + a_jc_j$。不妨 $x_i \geq x_j$，设给定浓度 $x\in [x_i, x_j]$，得方程组 $\begin{cases} a_i + a_j = 1 \\ a_ix_i + a_jx_j = x \end{cases}$，解得 $\begin{cases} a_i = \frac {x - x_j} {x_i - x_j} \\ a_j = \frac {x_i - x} {x_i - x_j} \end{cases}$。再乘上价格作为系数，可以发现价格是关于浓度的线性函数，且当浓度为 $x_i$ 时，价格为 $c_i$，当浓度为 $x_j$ 时，价格为 $c_j$。

将每种试剂 $(x_i, c_i)$ 视为平面上的点 $P_i$，则 $i, j$ 组合出的试剂落在线段 $P_iP_j$ 上，而浓度为 $x$ 时的价格即横坐标为 $x$ 时对应纵坐标 $c$ 的值。期望值即 $c$ 在 $[x_j, x_i]$ 上的积分，即线段和横坐标围成的梯形面积 $g(j, i) = \frac {(c_i + c_j)(x_i - x_j)} 2$。

进一步地，当存在多种试剂时， 它们组合出的试剂在这些试剂对应的点的凸包上，而我们只关心上凸包的积分。这是一个经典结论，但我不太会证：**若干个点的权重之和为 $1$ 的线性组合形成的区域为这些点的凸包**。2022 杭电多校第四场 08 也用到了这个结论。

将所有试剂按 $x$ 从小到大排序，设 $f_i$ 表示选择第 $i$ 种试剂时，在前 $1\sim i$ 种试剂中的答案，则有转移 $f_i = -w_i + \max(0, \max_{j = 1} ^ {i - 1} f_j + g(j, i))$。转移下凸一定是不优的，对答案没有影响。

时间复杂度 $\mathcal{O}(n ^ 2)$。[代码](https://codeforces.com/contest/1765/submission/185246598)。