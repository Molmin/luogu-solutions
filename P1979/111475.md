感觉这题实在是妙哉，妙在如何去掉冗余状态。

首先我们可以发现除了空位和特殊位其他都是本质相同的，所以容易设出状态$f_{i,j,x,y}$表示使特殊位坐标为$(i,j)$，空位坐标为$(x,y)$的最少时间，该$dp$可以使用$dfs$或$bfs$转移，时间复杂度为$O(n^2m^2)$。
过不了，我们可以想怎么去掉冗余状态。只有当空位在特殊位的上下左右时，特殊位才能移动，而空位是可以随意移动的，那当空位在特殊位上下左右时，我们随意把空位移走肯定是不优的。那我们就不把它移走，空位的坐标只可能在四个地方，那就是特殊位的上下左右。

故状态变为$f_{i,j,k},k\in[0,3]$，$k$表示空位所在方向。

初始状态可以先用$bfs$预处理出。这样状态之间的转移代价并不相等，所以我们不能再使用$bfs$转移，由于转移边较少，使用$spfa$转移，可以做到接近$O(nm)$的复杂度。

博客内食用更佳：[P1979 [NOIP2013 提高组] 华容道](https://blog.csdn.net/Z_Y_S_/article/details/112728446)