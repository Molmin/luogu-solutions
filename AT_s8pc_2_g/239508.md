[AT1890 道とN個のAtCoder社](https://www.luogu.com.cn/problem/AT1890)（道路和 $N$ 个 AtCoder 公司）

### 题目大意
给定 $n$ 个点的坐标，求此 $n$ 个点之间最多可以获得的不相交的线段数。

### 实现
由于 $n$ 个点之间可以连接最多 $\dfrac{n(n-1)}{2}$ 条线段，所以我们只需要判断两条线段是否相交就可以利用贪心算法求得答案。

### 核心思路
所以此题的核心就是判断两条线段是否相交。

已知平面上有四点 $A(x_A,y_A)$，$B(x_B,y_B)$，$C(x_C,y_C)$，$D(x_D,y_D)$，求出使命题 $p$：“线段 $AB$ 和线段 $CD$ 相交”的充要条件（$A$，$B$，$C$，$D$ 中任意 $3$ 点不共线，且满足 $x_A\leq x_B$，$x_C\leq x_D$）。

解：设直线 $AB$ 为 $Ax+By+C=0$，$CD$ 为 $ax+by+c=0$。

①若 $x_A=x_B=x_1$（$x_C=x_D=x^{\prime}_{1}$ 时同理），不妨设 $y_A<y_B$（或 $y_C<y_D$），此时直线 $AB$ 垂直于 $x$ 轴，那么线段 $AB$ 可表示为

$$x=x_0, \ y\in\left[\ y_A\ ,\ y_B\ \right]$$

（即 $A=1$，$B=0$，$C=-x_0$）

②若 $x_A\not=x_B$（$x_C\not=x_D$ 时同理），将 $A$，$B$ 两点坐标代入，易得 $A=y_A-y_B$，$B=x_B-x_A$，$C=x_Ay_B-x_By_A$。那么线段 $AB$ 即可表示为

$$(y_A-y_B)x+(x_B-x_A)y+x_Ay_B-x_By_A=0, \ x\in\left[\ x_A\ ,\ x_B\ \right]$$

所以我们就可以得到直线 $AB$ 和 $CD$ 的解析式。

我们知道，当 $\dfrac{A}{a}=\dfrac{B}{b}\not=\dfrac{C}{c}$ 时，两条直线互相平行，所以，命题 $p$ 的一个充分条件是 $Ab\not=Ba$。

当 $Ab\not=Ba$ 时，容易算出交点坐标为

$$\left(\ \dfrac{Bc-Cb}{Ab-Ba}\ ,\ \dfrac{Ca-Ac}{Ab-Ba}\right)$$

令 $x_0=\dfrac{Bc-Cb}{Ab-Ba}$，$y_0=\dfrac{Ca-Ac}{Ab-Ba}$，由于给出的是线段，所以我们只需要判断点 $(x_0,y_0)$ 是否在线段 $AB$ 和 $CD$ 上即可。

令 $Ax+By+C=0$ 的定义域为 $I$，值域为 $D$，此时，若 $x_0\in I$ 且 $y_0\in D$（注意：由于线段首尾相接不属于相交，故判断时要令交点坐标值不等于任一边界值），则点 $(x_0,y_0)$ 在线段 $AB$ 上（$CD$ 同理）。

若交点在线段 $AB$ 上，也在线段 $CD$ 上，则线段 $AB$ 和 $CD$ 相交。

### 注意事项
利用贪心求解时，先穷举 $\dfrac{n(n-1)}{2}$ 条线段，再计算出每条线段分别和哪几条线段相交。删除线段直到任意两条线段之间都没有交点。每次删除线段时，永远删除交点个数最多的一条。

The end.