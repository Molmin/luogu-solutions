[题目传送门](https://www.luogu.com.cn/problem/P9408)

建议降黄。

这里只讲不降序列的做法，不升序列同理。

容易想到枚举最大值，令 $f_{i, j}$ 表示前 $i$ 个数变为不降序列且第 $i$ 个数为 $j$ 的最小操作次数。

先考虑暴力转移：$f_{i,j} = f_{i - 1, k} + \text{chg}(a_i, j)$，其中 $\text{chg}(i, j)$ 表示 $i$ 到 $j$ 的最少操作次数。这样是 $\mathcal{O}(nV^2)$ 的，但能过，应该是因为有一个 $\frac{1}{2}$ 的常数。

考虑优化。

发现 $\text{chg}(a_i, j)$ 是不变的，处理出 $lst_j$ 表示第 $i - 1$ 个小于等于 $j$ 时，操作的最少次数，这样就可以 $\mathcal{O}(1)$ 转移了。

应该要加读入优化，但 ios 也能过。

[评测记录](https://www.luogu.com.cn/record/112579570)

感觉部分分没什么用？