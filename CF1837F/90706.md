赛时卡 E 了，~~看成输入排名~~，因此没看 F，亏。

先离散化。

在 **原序列** $a$ 中枚举分割点 $t$，钦定第一个人只在 $[1,t]$ 中选数，第二个人只在 $[t+1,n]$ 中选。

假设第一个人选 $x$ 个，那么第二个人选 $k-x$ 个。

那么第一个人的最小值 $A$ 等于 $[1,t]$ 中的 **前 $x$ 小的数的和**，第二个人的最小值 $B$ 等于 $[t+1,n]$ 中的 **前 $k-x$ 小的数的和**。

此时答案为 $\max(A,B)$。

当我们增加 $x$ 时，$A$ 会上升，$B$ 会下降，$A-B$ 具有单调性。看成函数的话，两个图像的交点即为 $\max(A,B)$ 的最小值，此时 $A-B$ 最接近 0。

因此假设我们能快速得到 $A$ 和 $B$，我们就可以对 $A-B$ 二分出最接近 0 的位置。这部分是 $O(\log n)$。

接下来考虑如何快速得到 $A$ 和 $B$。

使用两棵 **权值线段树**，第一棵存当前 $[1,t]$ 中的数，第二棵存 $[t+1,n]$ 中的数。每个节点记录一下它代表的区间中数的个数和它们的和，这样前后缀的前 $x$ 小值的和可以在这两棵树上 $O(\log n)$ 查询。

移动 $t$ 到 $t+1$ 时，只需在第一棵树中加入一个 $a_{t+1}$ 并在第二棵中删除一个 $a_{t+1}$ 即可。

总复杂度 $O(n\log^2n)$，不用卡常。