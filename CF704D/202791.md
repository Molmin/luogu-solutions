我们首先将坐标离散化，并将 $x$ 和 $y$ 看作点 $(x, y)$ 的两个元素，之后就可以不用考虑坐标系了。

我们对离散化后的横纵坐标新建一个点，分别记为 $idx_i$，$idy_i$，并记录原坐标系中每个点的编号为 $id_i$。

考虑网络流，建立源点向每个 $id_i$ 连边，容量约束为 $1$，建立汇点，每个 $idx_i$ 和 $idy_i$ 向汇点连边，容量约束可通过简单计算得出上下界。

这个时候我们可能想要将 $id_i$ 拆点来表达选择红点还是蓝点，并分别连向 $idx_i$ 和 $idy_i$ 来约束 $id_i$ 的选择，但是发现其实不需要拆点，因为 $idx_i$ 和 $idy_i$ 的约束条件只需要对红点蓝点中的一个约束即可同时约束红点蓝点，因此我们对 $id_i$ 向它对应的横坐标编号连边，容量约束为 $1$，费用是红点费用；$id_i$ 向它对应的纵坐标编号连边，容量约束为 $1$，费用是蓝点费用，然后跑有源汇上下界最小费用可行流即可。

可能没讲清楚，放张第一个样例的图，没把费用画在图上，编号 $1$ ~ $5$ 是 $id_i$，$6$ ~ $8$ 是 $idx_i$，$9$ ~ $11$ 是 $idy_i$。

![](https://cdn.luogu.com.cn/upload/image_hosting/re9pxdbl.png)

代码：[https://codeforces.com/problemset/submission/704/196758425](https://codeforces.com/problemset/submission/704/196758425)