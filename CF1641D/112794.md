一道思路比较奇怪的题，有点难想。

下面记 $S_i=\{a_{i,1},...,a_{i,m}\}$。

先将所有元素按 $w$ 升序排序。考虑从小到大对每个 $i$ 计算出最小的 $p_i$ 使得 $S_i,S_{p_i}$ 无交，最后在所有 $w_i+w_{p_i}$ 中取最小值即可。此外，如果确定这样的 $p_i$ 一定比某个 $p_j(j<i)$ 大，我们也可以放弃计算 $p_i$（因为这样的 $w_i+w_{p_i}$ 一定不优）。考虑从小到大枚举 $i$，初始时令 $p_i=p_{i-1}$（初始条件可设为 $p_0=n+1$），然后不断缩小 $p_i$，直到 $[1,p_i-1]$ 中所有集合都和 $S_i$ 有交为止。这个做法类似于尺取法。

接下来要考虑的问题是：怎么快速判断某个 $[1,j]$ 中的集合是否全部和 $S_i$ 有交。直接判定似乎有些困难，考虑利用容斥原理来计数有多少个 $S_k(k\in [1,j])$ 使得 $S_k,S_j$ 有交。对每个 $k$，我们把 $S_k$ 的所有子集插入一个大集合中，奇数大小的子集权值标为 $+1$，偶数大小的标为 $-1$。可以发现，$S_i$ 的所有子集的权值之和就是 $S_i$ 和 $S_{1...j}$ 中有交的集合数量，判断其是否等于 $j$ 即可。

维护大集合时可以采用 Trie 来维护。总时间复杂度 $O(nm2^m)$。
