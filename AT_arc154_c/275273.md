被这题干爆了![](//图.tk/6)

考虑把 $a, b$ 两个环，值相等的元素压缩成一块。这样一次操作就是，选择两个相邻的块，把左边块长度减 $1$，右边块长度加 $1$。

特判 $a, b$ 所有块长都是 $1$ 的情况，这种情况不能操作。

排除掉上面的情况，我们断言：有解的充要条件是，存在某一种 $a$ 的顺序，使得 $b$ 是它的子序列。

充分性：因为存在长度 $> 1$ 的块，所以块的位置可以随意移动，只要保持相对位置不变即可。

必要性：考虑证明它的逆否命题。如果不是子序列，那 $a$ 不可能凭空中间冒出一个块使得有解，因为只能扩充或压缩块。

然后这个东西朴素 $O(n^2)$ 判定即可。

[code](https://atcoder.jp/contests/arc154/submissions/42874503)