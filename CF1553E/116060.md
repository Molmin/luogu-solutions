## **题意：**

给定一个长度为 $n$ 的目标排列 $p$ 和一个整数 $m$ ，并且你有一个初始排列 $[1,2,...,n]$ 。

现在请你求出所有满足以下条件的整数 $k(0\le k\le n-1)$ ： 

将初始排列**向右**循环位移 $k$ 次后，得到排列 $a$ ，把 $a$ 的元素进行**不超过** $m$ 次交换，使得 $a = p$ 。

 ## **数据范围：**

- 本题有多组数据。
- 对于每组数据 $3\le n \le 3\times 10^5 , 0 \le m \le \frac{n}{3}$ 。
- 对于所有数据，保证每组数据的 $n$ 的和不超过 $3 \times 10^5$ 。

## **思路：**

首先，我们第一反应大概率是枚举每一个 $k$ ，然后快速判断行不行，我们先按照这个思路走下去。

如果我们确定一个 $k$ ，假设初始排列向右循环位移 $k$ 次后，与目标排列 $p$ 的**对应位置上**相同的数字的个数为 $cnt$ 个，因为我们最多交换 $m$ 次，所以我们最多改变 $2\cdot m$ 个位置，所以不难看出：若 $cnt<n-2\cdot m$ ，$k$ 肯定不满足。

所以如果 $k$  满足条件 ，那么 $cnt$ 必须大于等于 $n-2\cdot m$ ，又因为 $m\le \frac{n}{3}$ ，所以 $cnt \ge n - \frac{2\cdot n}{3} = \frac{n}{3}$ 恒成立，至此，我们得到一个显然的结论，满足条件的 $k$ 不会超过 $3$ 个，题目一下子就明朗了起来。

那这样，我们只需要考虑如何快速判断一个排列 $a$ 最少需要交换多少次换到目标排列 $p$ 。我们只需要把 $a_i$ 向 $p_i$ 连一条无向边，最后用 $n$ 减去联通块个数就是最小的交换次数。

至此，本题完结，时间复杂度 $O(n)$ 。



