首先说结论：暴力遍历可过。

为什么？

因为说了假设答案超过 $10^6$ 次方，就输出 $10^6$ 即可。

我们考虑：每遍历到一个点，答案都会加 $1$。

接下来遍历其他点时，如果这个点在路径里面，则不遍历。

那么我们分析势能。

每次遍历一个点，花费是遍历它的出度，贡献是 $1$。

而题目规定一个点的出度不超过 $10$。

也就是说最劣情况下 $10$ 花费得到 $1$ 贡献。

而我们只需要 $10^6$ 的贡献。

因此最大花费为 $10^7$。

所以暴力遍历可过。

代码就不放了，写暴力都会吧？