一句话题解：在某个连通块内操作当且仅当连通块内节点编号最高位 $1$ 位置相同，因此可以证明存在让每个点都一旦在这里放下，都无法移动的构造方案，对树黑白染色，编号二进制分组构造即可。

----

题目给的三个限制条件，前两个都是好理解的，只有第三个相对隐蔽一点，需要我们仔细发掘一下。

**引理：能够在两个相邻节点中发生移动，当且仅当两个节点编号最高位 $1$ 的位置相同。**

证明：前半句显然，后半句当 $u$ 和 $v$ 的节点编号最高位 $1$ 位置相同时，$u \oplus v$ 的这一位上不是 $1$，因此一定满足 $u \oplus v \le \min\{u, v\}$，并且只有这种情况满足条件，因为如果不同，$u \oplus v$ 结果的最高位就会由两数中较大的那一个确定，这时较小的在那一位上没有 $1$。

这样，根据引理 1，问题就转化为了将树划分为若干个连通块，可以在这些连通块内操作，最大化必胜态点数。

但是，单纯连通块的性质的话做这个貌似还是比较困难，其实有更强的性质，我们注意到原图是一棵树。

**事实 1：$2^{k - 1} - 1 > \lfloor\dfrac{2^k - 1}{2}\rfloor$，$k$ 为任意正整数。**

**推论：在二分图上本题模型存在每个点都无法再移动的构造方案。**

证明：将二分图黑白染色，设二分图总点数为 $n$，$k$ 为满足 $n < 2^x$ 的最小的 $x$，即 $n$ 的二进制最高位 $1$ 位置，则黑点和白点中数目较小的一个一定不大于 $\lfloor\dfrac{2^k - 1}{2}\rfloor$，而 $1 \sim n$ 中二进制最高位低于 $k$ 的数有恰好 $2^{k - 1} - 1$，我们知道一个数存在唯一的二进制表示，因此一定能用这些数把较小的这一种点的个数表示出来。

**事实 2：树是二分图，** 黑白染色法易证。

由推论和事实 2 即得题解开头所述解法的正确性。