## Solution

题目大意 : 从 $n$ 个字符串中选出几个 , 按**原有顺序**拼在一起 . 问能否组成一个回文串 .

选择这 $n$ 个字符串 , 共有 $2^n$ 种方法 , 直接枚举显然不可取 . 但因为每个字符串的长度不超过 $3$ 我们有这样一个直觉 : 如果有答案不会太长 . 

当存在一个字符串是回文串时 , 一定符合条件 . 如果是 $2$ 个字符串 , 也好判断 .

> 判断方法 : 这样一定是 $2$ 长度或 $3$ 长度 . 对于每一个字符串 , 配对它的前一半 . 
>
> 当长度为 $2$ 时 , 寻找是否有 $2$ 长度的字符串与之相反或 $3$ 长度的前 $2$ 个字符与之相反  .
>
> 当长度为 $3$ 时 , 寻找是否有 $3$ 长度的字符串与之相反或 $2$ 长度的与之后 $2$ 个字符相反  .
>
> 更加直观的 , 当我们发现 $ab$ 时 , 判断是否有  $ba$ 或 $bac$ ; 当我们发现 $abc$ 时 , 判断是否有 $cba$ 或 $cb$ . 显然可以用  `map` 轻松维护 .

如果有答案 , 是否一定存在长度为 $2$ 个字符串的回文呢 ? 答案是肯定的 . 假设有多个长度的回文串 , 那么组成这个回文串的第一个和最后一个字符串一定可以构成回文 .

> 证明 : 显然 , 第一个和最后一个字符串都不是长度为 $1$ 的 . 否则这个串单独即可构成回文 .
> - 当第一个为 $2$ , 最后一个为 $2$ 时 , 一定是 $ab$ 与 $ba$ 的形式 , 拼在一起满足回文要求 ;
> - 当第一个为 $2$ , 最后一个为 $3$ 时 , 一定是 $ab$ 与 $cba$ 的形式 , 拼在一起满足回文要求 ;
> - 当第一个为 $3$ , 最后一个为 $2$ 时 , 一定是 $abc$ 与 $ba$ 的形式 , 拼在一起满足回文要求 ;
> - 当第一个为 $3$ , 最后一个为 $3$ 时 , 一定是 $abc$ 与 $cba$ 的形式 , 拼在一起满足回文要求 ;

> 综上 , 一定满足要求 .

那么就可以直接执行上述算法了 .

[code](https://codeforces.com/contest/1629/submission/143762102)