**费用流**

首先，可以将 $1$ 点设为源点，然后拆点，中间连流量为 $2$，费用为 $1$ 的边。然后将 $n$ 点设为汇点，然后拆点，中间连流量为 $2$，费用为 $1$ 的边，其余的点拆点后中间连流量为 $1$，费用为 $1$ 的边，其余边流量为 $1$，费用为 $0$。

建完网络流之后，直接跑一遍最大流就可以了。

**双向动态规划**

我们设 $dp[i][j]$ 表示左边的人到i号城市时和右边的人到j号城市时所走过的总城市数目。
因为有对称性，所以显然有 $dp[i][j] = dp[j][i]$。

初始条件：$dp[1][1] = 1$。

在枚举路径的时候，由于每条边只会被用一次，所以有转移方程：
$dp[i][j] = dp[j][i] = \max(dp[i][k] + 1)$。

