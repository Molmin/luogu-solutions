MCOI R3 A 官方题解

#### Description

求有多少个正方形内的点使得其于正方形的顶点相连分成的四个三角形面积比为 $a:b:c:d$。

$1 \le a,b,c,d \le 10^{18}$。

#### Solution

本题分为四种情况。

- 第一种答案为 $1$ 的情况（前 $20\%$ 的情况）

显而易见，选择的点只能为正方形两个对角线的交点。


- 第二种答案为 $8$ 的情况

我们分析对于所有数据的情况，比如看下面这张图片：

![](https://cdn.luogu.com.cn/upload/image_hosting/pchkth3j.png)

（假设 $S_{\triangle APD}=a,S_{\triangle CPB}=b,S_{\triangle DPC} = c,S_{\triangle APB} = d$）

易得，只有在 $a+b=c+d$ 的情况下，才能满足有解。

简证：

假设 $P$ 到 $DA$ 的垂线长度为 $h_1$，到 $CB$ 的垂线长度为 $h_2$，到 $CD$ 的垂线长度为 $h_3$，到 $AB$ 的垂线长度为 $h_4$，正方形边长为 $k$，那么 $a=\dfrac{1}{2}h_1k,b=\dfrac{1}{2}h_2k,c=\dfrac{1}{2}h_3k,d=\dfrac{1}{2}h_4k$，$a+b=\dfrac{1}{2}(h_1+h_2)k=\dfrac{1}{2}k^2,c+d=\dfrac{1}{2}(h_3+h_4)k=\dfrac{1}{2}k^2$，$a+b=c+d$，得证。

（从这个结论中还可以得到 $a+b=c+d=\dfrac{1}{2} S_{\square ABCD}$，但貌似对于解本题并没有什么用（）

接下来，我们来分析一下对于普通情况满足 $a+b=c+d$ 的点的个数。（以下 $(a,b,c,d)$ 代表的是左边为 $a$，右边为 $b$，上面为 $c$，下面为 $d$）

- $(a,b,c,d)$
- $(a,b,d,c)$
- $(b,a,c,d)$
- $(b,a,d,c)$
- $(c,d,a,b)$
- $(c,d,b,a)$
- $(d,c,a,b)$
- $(d,c,b,a)$

一共有 $8$ 种。

- 第三种答案为 $0$ 的情况

不满足 $a+b=c+d$ 的情况。

- 第四种答案为 $4$ 的情况

当 $a,b,c,d$ 中有两个或三个数相等时，答案为 $4$。

原因很简单，当 $a,b,c,d$ 中有两个或三个数相等时，可以尝试把相等的数都替换成一个数再带回上面的列举结果中，会发现，有 $4$ 组重复的解，所以答案是 $4$。

注意，在特判第四种情况的时候要有一个前提，即在第二种情况提到过的：

> 易得，只有在 $a+b=c+d$ 的情况下，才能满足有解。

最后，注意一下特判的顺序即可。