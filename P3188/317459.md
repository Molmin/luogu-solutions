## 分组处理出泛化物品

因为所有物品的体积都可以表示成 $a\times 2^b$ ，所有考虑按 $2^b$ 将物品分组，每组组内做一个 $01$ 背包之后合并泛化物品。

具体地：令 $f[i][j]$ 为所有体积为 $a\times 2^i$ 的物品中选出**体积小于等于** $j\times 2^i$ 的物品的最大价值。

## 利用二进制的性质合并泛化物品

一个重要的性质：$\sum_{j=0}^{i-1}2^j=2^{i}-1$ ，即 $\sum_{j=0}^{i-1}2^j < 2^i$ 。

因此我们考虑这么设计状态： 

$g[i][j]$ 为考虑前 $i$ 组物品，且选出的物品**体积小于等于** $j\times 2^i+ m \text{\&} (1<<(i-1))$ 的最大价值。

转移时考虑第 $i$ 组物品选多少：

$$
g[i][j]=\min_k(f[i][j-k]+g[i-1][2\times k+[m >> (i-1)\text{\&}1]])
$$

若 $W$ 的最高位为 $m$ ，那么答案即 $g[m][1]$ 。 

为什么这么设计状态？这么设计状态的好处是什么？

因为 $\sum_{j=0}^{i-1}2^j < 2^i$ ，且对于每一个 $2^k$ 其能表示的体积的上限为 $10n$ ，那么对于 $0...i-1$ 组能表示的体积的上限为 $10n\sum_{j=0}^{i-1}2^j$ 小于第 $i$ 组能表示的物品的体积上限 $10n\times 2^i$ 。

即：前 $i-1$ 组能表示出的物品体积上限与第 $i$ 组能表示出的体积上限在渐进意义下一致（均为 $O(an)$ 级别）。

设 $W$ 的二进制一共有 $m$ 位，那么这么去 $\text{DP}$ 实际的状态数为 $O(man)$ 级别。