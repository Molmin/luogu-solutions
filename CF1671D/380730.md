定义 $f(a)$ 为数列 $a$ 的分数。

我们发现我们没办法在插入时减小原数列的分数，所以我们考虑能不能把增加的分数变得最小。我们发现数列可以像如下这样插：

$$\color{red}a_x=l,\;\color{black}l,\;l+1,\;l+2,\;l+3,\;\cdots,\;\color{purple}r-1,\;r,\;\color{blue}a_{x+1} = r$$

这样就把 $[l,r]$ 数列消掉了。

我们来看一下消最后的情况：**只有可能有两种区间没被消掉：$[1,w_1]$ 和 $[w_2,x]$。**
- 证明：假设有 $[l_1,r_1]$ 没被消掉，并且存在 $a,b$，使得 $[a, l_1-1]$ 和 $[r_1+1, b]$ 都被消掉了，则必然原来的数列存在 $x,y$ 使得 $a_x=a,a_{x+1}=l_1-1$ 和 $a_y=r_1+1, a_{y+1} = b$，但照这样 $[l_1, r_1]$ 也已经被消掉了，矛盾。

所以我们有两种可能的情况安插首尾区间：

- 安插在 $a$ 数列的首尾，分数只算一遍。

- 安插在 $a$ 数列的中间，且（设安插的位置在 $a_i$ 和 $a_{i+1}$ 之间）$a_i$ 和 $a_{i+1}$ 之一离 $1$ 或 $x$ 最近。

两种情况都更新一遍就行了。**注意特判一种情况，即 $x\le a_i$，这样 $[w_2,x]$ 区间算是消掉了！就算 $x\notin [a_{i-1}, a_i]$，也要把这个贡献算给 $[1,w_1]$ 的区间，否则会重复算。**

代码：[187998833](https://codeforces.com/contest/1671/submission/187998833)