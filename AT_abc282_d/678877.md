[题目传送门](https://www.luogu.com.cn/problem/AT_abc282_d)

如果这个图不是二分图，输出 $0$ 即可。

正难则反，可以用总数减去不能相互连边的数量。

如果不考虑二分图的限制，显然答案应该是 $n\times(n-1)$。

如果这是一个二分图，那么它的每一个连通块都将是二分图。

那么这个连通块的左部点间不能互相连边，右部点同理。

设该连通块左部点有 $x$ 个，右部点有 $y$ 个，那么答案就应减去 $x\times(x-1)+y\times(y-1)$。

对每一个连通块都减一遍即可。

[评测记录](https://www.luogu.com.cn/record/97992931)