讲述一种很好理解，调试很快，不同于目前题解区的做法。

时间复杂度：$O(n \log n)$。

贪心策略：从后往前，填能填的最大的数。

证明别人已经讲得很清楚了，我也不再赘述。

一般的做法是二分，但是我们考虑建立数组 `ne`，令 `ne[i]` 表示 $i$ 之前第一个没有被占位的位置，这个定义看上去是不是很像并查集呢？

我们考虑每一次使用类似于并查集的方法维护 `ne`，代码自然呼之欲出了。

细节：

1. 每一次维护勤用 `find` 函数，防止神秘错误。
2. 无解还可能是 $b$ 数组中有重复的数。
3. $b$ 数组的大小是 $\frac{n}{2}$。

### [代码](https://codeforces.com/contest/1759/submission/212915843)

后记：有生之年第一次干掉了 `div3` 的最后一题。