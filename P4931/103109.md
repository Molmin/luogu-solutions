虚假的黑题…………

其实就是个略微加了一些难度的错排板子（真的略微）。

首先考虑将问题分成$k$对正确的排列，和剩下$n-k$对完全错排。答案显然就是把这两部分给乘起来。

先看$k$对正确的部分。这部分对于给定的$n$，$k$来说是可以分成这么几步来算的：1，选出$k$排座位->$C_n^k$；2，选出$k$对狗男女，考虑相对顺序->$A_n^k$；考虑每排座位的两个人之间互换位置->$2^k$。把这几部分乘起来就得到了结果：$C_n^k*A_n^k*2^k$

之后考虑计算这道题里的错排部分。设$f_i$表示$i$对人的方案数。

假设现在在考虑$n$对人的错排。首先先选出来一对错误的人（考虑顺序，并且坐在第一排），显然有$2n*(2n-2)$种选法。之后考虑这两个人的另一半会是什么情况：1，这俩人坐在一起了->问题变为$n-2$对人错排;2，这俩人没在一起->问题变为$n-1$对人的错排。

因为第一种情况另外的那两人可以在后面$n-1$排里随便选，所以有$2*(n-1)*f_{n-2}$种方案；第二种就只有一种，所以是$f_{n-1}$种方案。

所以转移就是$f_n=2n*(2n-2)*(f_{n-1}+2*(n-1)*f_{n-2})$。

对于一个询问$n$，$k$，输出$C_n^k*A_n^k*2^k*f_{n-k}$即可。预处理一下阶乘，阶乘逆元，$2$的次幂和$f$数组之后就是$O(1)$输出了。