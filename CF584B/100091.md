# 题解

~~数论题做起来脑阔真的痛QWQ~~

## 1.题意

定义每三个只能为$1$,$2$或$3$且所有元素和**不为6**的数为一个集合，问当有$n$个这样的集合时有一个及以上集合合法的不同可能性。

## 2.分析

先讨论$n=1$的情况。

我们知道，取三个数，每个数可以是$1$,$2$或$3$，则每个数都有$\large C_{3}^{1} = 3$种可能。那取三个数，就有$\large (C_{3}^{1})^{3}=3^{3}=3 \times 3 \times 3=27$种可能。但又因为要至少一个集合合法，即至少一个集合的所有元素和大于$6$，又因为现在只有一个集合，那就必须让现在的集合合法。那我们就需要扣除元素和等于$6$的可能。而等于$6$的可能，我们是可以枚举的，即：

1. $1+2+3=6$	
2. $1+3+2=6$
3. $2+1+3=6$
4. $2+3+1=6$
5. $3+1+2=6$
6. $3+2+1=6$
7. $2+2+2=6$

枚举得，元素和为$6$的可能性为$7$种。所以，当前符合要求的可能性为：
$27-7=20$，即$n=1$时答案为$20$。

在分析了$n=1$的情况后，我们再进一步分析$n>1$的情况。

当$n>1$时，由题意得，我们只需使其中一个集合合法即可。那可能性就应该是所有可能(不管合不合法)与所有集合都不合法的可能的差。用数学表达式即为：

$\large ((C_{3}^{1})^{3})^{n}-7^{n}=27^{n}-7^{n}$种可能。

公式推出来了，代码也就好写了。

由于这里的$n$是小于$10^{5}$的，所以用$O(n)$的算法也能过。但是，我在这里还是分别介绍一下$O(n)$,$O(logn)$与$O(1)$的算法。

## 3. 代码

1. 时间复杂度：$O(n)$； 空间复杂度：$O(1)$

这个算法很朴素，我们只需用循环或$pow$函数解决，我也不再多讲。

### code:

$pow$函数

```cpp
#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
int n,p;
int main(){
	cin>>n;
	p=int(pow(27,n))%mod;
	p=(p-int(pow(7,n))%mod+mod)%mod;
	cout<<p;
	return 0;
}
```
循环

```cpp
#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
int n,p1=1,p2=1;
int main(){
	cin>>n;
	for(int i=1;i<=n;i++){
		p1=(p1*27)%mod;
		p2=(p2*7)%mod;
	}
	cout<<(p1%mod-p2%mod+mod)%mod;
	return 0;
}
```

2. 时间复杂度：$O(logn)$； 空间复杂度：$O(1)$

这个算法即为我们经常提到的**快速幂**。

快速幂的原理简单说，就是将$\large x^{y}$ 拆解成很多个$x$的$2$的次方的次方......算了，我也解释的不是太清楚，你们就看[【模板】快速幂||取余运算](https://www.luogu.com.cn/problem/P1226)这里的题解吧，他们讲的比我清楚。

### code:

```cpp
#include<bits/stdc++.h>
#define mod 1000000007
using namespace std;
inline long long q_pow(long long k,long long p){
	long long cnt=k,ans=1,m=p;
	while(m>0){
		if(m%2==1)ans=(ans*cnt)%mod;
		cnt=(cnt*cnt)%mod;
		m/=2;
	}
	return ans%mod;
}
long long n;
int main(void){
	cin>>n;
	cout<<(q_pow(27,n)%mod-q_pow(7,n)%mod+mod)%mod;
	return 0;
}

```
3. 时间复杂度：$O(1)$； 空间复杂度：$O(n)$


没错，$O(1)$的算法，就是**打表**。

打表过程中，你只需要吧程序挂着，~~自己去颓废~~直到算出$1$到$10^{5}$的答案，再新建一个代码，把结果放进数组即可。这里我就不放表了，表生成器就是前面的代码。

## 4.AC

[AC #3](https://www.luogu.com.cn/record/28575722)


------------


好了，题解结束了，大家再见！