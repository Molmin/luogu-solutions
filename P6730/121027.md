这是一个考场上的做法。

首先这道题目和幂次有关，我们又看到了“保证 $p=q^k$” 自然就可以想到取 $\mod p$ 的原根 $g$，再设 $a_i\equiv q^ig^t\pmod p$，然后就可以用这个在 $O(n^2)$ 时间内算出全部幂次关系（即 $\exists m,a_i^m\equiv a_j\pmod p$），建出一张有向图。

那么比如样例中的 $(1,3,4,6)$ 我们就会建出这样的一张图：
```
3->1
3->4
3->6
4->1
6->1
```
假设小 M 是欧皇，那么小 M 问一个数当且仅当向他连边的都没有被选中，但是这个数被选中了，假设我们数出对 $a_i$ 向他连边的数一共有 $\deg i$ 个，那么它的贡献就是 $2^{n-\deg i}$ 个。

然后就过了？笑死，第二个样例都过不掉。（虽然大样例过了）

事实上我们注意到可能存在一些 SCC，然后本题的 SCC 一定是完全图（显然），那么我们跑个 tarjan 然后缩点为 DAG 就可以了，注意对于强连通分量内的点还要乘上一个 $2^{|SCC|}-1$。

~~然后我考场上花了三个小时调前面的算法，意识到还要缩点后原地躺平~~

代码不想写了。