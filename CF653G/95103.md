早年间模拟赛原题，忽然发现了（

显然每个质因子都是 $|x-x_i|$，根据结论 $x$ 应该选中位数，不妨设当有偶数个数时中位数是靠后的那个。那么排序过后系数就和 $x_i$ 无关了，我们只需要求出每个位置所对应的系数。

我们设 $f_i$ 为 $x_i$ 的系数，那么考虑有哪些部分在 $i-1\rightarrow i$ 的时候会发生变化（运用范德蒙德卷积）：

- 子序列长度是偶数，$i-1$ 刚好在中位数左边一个，注意系数由 -1 变成 1，要乘 2： 

$$
2\cdot\sum_{j}\binom{i-2}{j}\binom{n-i}{j}=2\cdot \sum_j\binom{i-2}{j}\binom{n-i}{n-i-j}=2\binom{n-2}{n-i}

$$

- 子序列长度是奇数，$i$ 成为了中位数：

$$\sum_j\binom{i-2}{j-1}\binom{n-i}{j}=\binom{n-2}{n-i-1}$$

- 子序列长度是奇数，$i-1$ 是中位数：

$$\sum_j\binom{j-2}{j}\binom{n-i}{j-1}=\binom{n-2}{n-i+1}$$

可以在 $O(n)$ 的时间内递推 $f_i$，之后给每个质因子排序乘一个系数就行了。