看到题解里大部分人都说：只选一条边，但是没有证明为什么这样做是对的

这里给出我花了一晚上想出的一个比较容易理解的证明方法，希望能给做此题的小伙伴一点帮助吧


------------
## 题目大意

找到一个连通子图使得点权和除以边权和最大

## 解法

答案一定来自密度最大的两节点链，所以读边时扫点求值，维护最大即可

## 解法证明

**在以下数学证明中，我们用$t$表示这个最大值**

### 证明一：证明环中一定包含一条链比它优

其实乍一看，链就一定比环优，现在我们尝试证明它：

![](https://img2020.cnblogs.com/blog/1924188/202007/1924188-20200715152450612-1589604178.png)

那么在这个简单环中，我们设置以下四个变量来表示环和链的$t$值

用 $t_{abc}$ 来表示环的 $t$ 值，有 $t_{abc}=\frac{a+b+c}{x+y+z}$

用 $t_{ab}$ 表示两节点链 $ab$ 的 $t$ 值，有 $t_{ab}=\frac{a+b}{x}$

用 $t_{bc}$ 表示两节点链 $bc$ 的 $t$ 值，有 $t_{bc}=\frac{b+c}{y}$

用 $t_{ac}$ 表示两节点链链 $ac$ 的 $t$ 值，有 $t_{ac}=\frac{a+c}{z}$

**开始证明**

首先，不妨设 $t_{ab}\geq t_{bc}\geq t_{ac}$，（PS：如果不满足，交换顺序即可，不影响证明的正确性）

那么化简 $t_{ab}$，$t_{bc}$，$t_{ac}$ 得到了一个包含三个不等式的不等式组：

$
\begin{cases}
ay+by\geq bx+cx\\
bz+cz\geq ay+cy\\
az+bz\geq ax+cx\\
\end{cases}
$

因为 $t_{ab}\geq t_{bc}\geq t_{ac}$，只需要证明 $t_{ab}>t_{abc}$ ，即可说明每一个环本身中，至少存在一个两节点链比这个环更优

设左式为 $left$ ，右式为 $right$，设：

$$left=t_{ab}=\frac{a+b}{x},right=t_{abc}=\frac{a+b+c}{x+y+z}$$

$1、$同时乘以：$x(x+y+z)$ 

$$left=(a+b)(x+y+z),right=x(a+b+c)$$

$2、$同时减去：$x(a+b)$ 

$$ left=(y+z)(a+b),right=cx $$

$3、$化简一步：

$$left=ay+by+az+bz,right=cx $$

$4、$根据上面的不等式组：

$$ay+by+az+bz\geq bx+cx+ax+cx=2cx+ax+bx$$

$5、$又因为 $a,b,c,x,y,z$ 均为正数，所以推出：

$$2cx+ax+bx>cx$$

$6、$推出：$left>right$，即 ：

$$t_{ab}>t_{abc}$$

综上所述：每一个环本身中，至少存在一个两节点链比这个环更优

**证毕**

那么得到了这样一个结果——每一个环本身中，至少存在一个两节点链比这个环更优。现在，我们就不用考虑环的情况了

既然我们可以证明环和链之间的大小关系，进一步思考：链和链之间的大小关系可不可以证明呢？

### 证明二：证明长链中一定包含一个短链比它优以及结论推广

让我们从最短的链证起，请看图：

![](https://img2020.cnblogs.com/blog/1924188/202007/1924188-20200715160517399-1347253465.png)

**开始证明：**

在这个三个节点组成的链中，我们设置以下三个变量来表示两个短链和一个长链的$t$值

用$t_{abc}$表示长链的$t$值，有$t_{abc}=\frac{a+b+c}{x+y}$

用$t_{ab}$表示短链$ab$的$t$值，有$t_{ab}=\frac{a+b}{x}$

用$t_{bc}$表示短链$bc$的$t$值，有$t_{bc}=\frac{b+c}{y}$

首先，不妨设：$t_{ab}\geq t_{bc}$（PS：如果不满足，依旧交换即可，不影响证明的正确性）

那么化简这个式子，得到一个不等式：

$$ay+by\geq bx+cx$$

因为：$t_{ab}\geq t_{bc}$，只需证$t_{ab}>t_{abc}$，即可说明在任意一三节点个长链本身中，至少存在一个两节点短链比这个长链更优

设左式为 $left$ ，右式为 $right$，且：

$$left=t_{ab}=\frac{a+b}{x},right=t_{abc}=\frac{a+b+c}{x+y}$$

$1、$同时乘以：$x(x+y)$

$$left=(a+b)(x+y),right=x(a+b+c)$$

$2、$同时减去：$x(a+b)$ 

$$left=y(a+b),right=cx$$

$3、$化简一步：

$$left=ay+by,right=cx$$

$4、$根据上面推出的不等式：$ay+by\geq bx+cx$，且 $x,y,a,b,c$ 均为正数，有$bx>0$，所以推出

$$ay+by>cx$$

$5、$推出：$left>right$，即：

$$t_{ab}>t_{abc}$$

综上所述：在任意一三节点个长链本身中，至少存在一个两节点短链比这个长链更优

但是还没有完，我们还需要得知长度为$n$的长度为$2$的链谁更优一些

$n$节点链可以看成是$n-2$的链再连上两个点构成的（如下图）

![](https://cdn.luogu.com.cn/upload/image_hosting/kbu57x17.png)

而前面$n-2$长度的链可以用点权和比边权和算出它的$t$来，这时把这整个链看成是点权是$t$的节点，问题就又转化成两节点和三节点谁优了。

另外，对于其他形状的子图来说，同样适用刚才说的“缩点”法。只要缩成两、三节点链，我们就可以用结论证明啦！

**证毕**

综上，最优的解一定是一条两节点链，所以贪心求解

代码很简单，就不放了