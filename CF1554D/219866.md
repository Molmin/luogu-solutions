## CF1554D Diane 题解

题意是构造一个长度为 $n$ 的字符串 $s$，使得 $s$ 的每个非空子字符串在 $s$ 中出现奇数次。

不妨将长度分为奇数和偶数讨论。

若长度为偶数，假设 $s$ 全部为`a`，先考虑只把其中一个`a`换成`b`，比如`aabaaaaa`，易得`b`左右两边的两个子串长度为一奇一偶。设这两个`a`串中，较短的长度为 $x$，较长的长度为 $y$，则如果 $y-x$ 的值为 $3$ 或以上（比如上例），则长度为 $y-1$ 的子串必出现 $2$ 次。所以，$x$ 与 $y$ 必是相邻自然数。

$$\begin{cases} x=\left\lfloor\frac{n-1}{2}\right\rfloor \\ y=\left\lfloor\frac{n-1}{2}\right\rfloor+1 \end{cases}$$

------------

若长度为奇数，同样设 $s$ 全部为`a`，先考虑只把其中一个`a`换成`b`，但是这时`b`左右两边的两个子串长度为两奇或两偶。这样就不太妙了，因为较短的那个`a`串必在 $s$ 中出现偶数次。

所以考虑换掉两个字母。只能把一个`a`换成`b`，再挑一个`a`换成`c`。此时 $s$ 中的`a`被拆成了三段，设这三个`a`串长度为 $x,y,z$，奇偶情况为三奇或一奇二偶。

- 如果为三奇，那坏事了，`aa`必出现偶数次。有人说`abaca`不是可以？这个可以，但另外的不行。

- 如果为一奇二偶，不妨设 $x$ 是奇数，$y$ 和 $z$ 都是偶数。首先 $y\ne z$，那既然这样，假设 $y<z$，长度为 $z-1$ 的子串岂不是要出现 $2$ 次了？所以 $x=z-1$。这里有一个绝妙的构造方法：

$$\begin{cases} x=\left\lfloor\frac{n-2}{2}\right\rfloor \\ y=0 \\ z=\left\lfloor\frac{n-2}{2}\right\rfloor+1 \end{cases}$$