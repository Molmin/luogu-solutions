在考虑维护最小公约数的查询问题时，辗转相除法非常好用。

首先这道题的矩阵是 $10^5\times 10^5$ 的，这显然无法维护，而且矩阵是二维的，每一项都与 $a,b$ 两个数组有关，这不好维护。

如果我们可以通过变换使得查询可以拆成对于这两个数组的分别查询就好了。

我们考虑进行辗转相减法，将数组变成一个差分的形式，我们发现答案变成了对于 $a,b$ 查询的形式，这就易于查询了，式子如下： 

$$
\gcd(a_{l_1}+b_{r_1},\gcd_{i={l_1+1}}^{l_2}(a_{i}-a_{i-1}),\gcd_{i={r_1+1}}^{r_2}(b_{i}-b_{i-1}))
$$

我们可以考虑用各种数据结构来维护，比较推荐线段树，因为最小公约数有结合律，但是没有可加性，所以树状数组就不太好搞。

直觉上时间复杂度是 $O(n\log ^2 n)$ 的，但是仔细分析由于你线段树向上合并应该是越来越快的，感性上其实会接近 $O(n\log n)$。