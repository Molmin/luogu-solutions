#### Description

> 给定一个长为 $n$ 的序列 $a_i$，给定 $q$ 次询问，每次询问给定 $x$，求有多少组数对 $(l,r)$ 使得 $\gcd(a_l,a_{l+1},\cdots,a_r)=x$。

#### Solution

ST 表好题。

首先，我们先回答对于这道题引申出的两个问题：

1. 如何用 ST 表求解多次询问的区间 $\gcd$？这个应该比较简单，我们可以直接将求最值转化成求 $\gcd$，即下面这个式子是求多次询问的区间 $\max$ 的状态转移方程：

$$dp_{i,k} = \max(dp_{i,k-1}, dp_{i + 2^{k-1},k - 1})$$

我们可以直接将 $\max$ 替换成 $\gcd$，即：

$$dp_{i,k} = \gcd(dp_{i,k-1}, dp_{i + 2^{k-1},k - 1})$$

最后询问输出的时候也只需把 $\max$ 替换成 $\gcd$ 即可，原因很简单，因为 $\gcd$ 的性质和 $\max$ 相差无几，将一个区间拆分为互相重合的两段分别求解再用 $\gcd$ 连接也是可行的。

2. 一个长为 $n$ 的序列最多能有多少个不同的 $\gcd$？答案是 $n \log n$。

因此，我们可以先把这个序列的所有区间 $\gcd$ 用 ST 表预处理到 $dp$ 数组里，然后定义 $cnt_i$ 为截止到 $a_i$ 的答案，那么我们可以往右去寻找一个最大的 $l$ 使得 $\gcd(a_l,a_{l+1},\cdots,a_i)=a_i$，这个过程可以二分，然后再往前从 $l-1$ 开始继续寻找，然后不断的二分，替换答案，就可以预处理 $cnt_i$ 了。

因为 $\gcd$ 可能会很大，因此可以尝试用 map 处理 $cnt_i$。

最后对于 $q$ 组询问，每次输出 $cnt_x$ 即可。