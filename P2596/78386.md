## 看到题解里没有无指针Treap的，来一篇无指针Treap的题解

~~这个题也是万年调不出系列~~

### 1. 对于操作一

$\text{窝们可以对与每一本数按照从上到下从大到小赋一个权值，那么为了方便操作} $

$\text{一二窝们可以在权值之前预留N个空位，同样的在后面预留N个空位，记top和} $

$\text{bottom表示当前的第一个权值和最后一个权值，那么把一本书放到最顶上，转} $

$\text{化为找到当前这个节点的值，在Treap里删掉，然后把这个节点以top-1的权值} $

$\text{加入平衡树，然后top- -。这样就操作一就完啦QAQ} $


### 2. 对于操作二

$\text{与操作一一样的操作，相应的把bottom++就行了。} $

### 3. 对于操作三

~~最毒瘤的操作~~

$\text{窝们首先可以找到编号为x的书在Treap中的权值是多少，记为fx} $

$\text{以T=1为例} $

$\text{窝们可以在平衡树中找到fx的后继，然后窝们可以定义一个数组inv[fx]=x} $

$\text{即表示权值为fx的编号为x。}$

$\text{这样我们就把x和它的后继的编号交换一下就行了。} $

$\text{T=-1的时候就找到前驱然后就跟T=1一样的操作了} $

$\text{T=0时，直接跳过就好了。} $

### 4. 对于操作四

$\text{找到编号x的权值fx,然后在Treap中统计fx的排名} $

### 5. 对于操作五

$\text{找到Treap中前x的数的编号就行了。} $

### 大家最想看的来了 
[代码戳这里](https://paste.ubuntu.com/p/JxHyQ6Xvzx/)

$\text{下面附赠几组数据} $

```
data1.in
8 8
1 2 3 4 5 6 7 8
Insert 4 -1
Bottom 7
Query 7
Ask 6
Top 4
Ask 3
Bottom 5
Top 4

data1.out
8
5
3

data1.in
10 2
2 4 3 8 1 10 6 9 7 5
Insert 4 1
Query 4

data1.out
3

```
