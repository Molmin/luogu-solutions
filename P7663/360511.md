题解一血，纪念一下。

考虑设：

- $up[i,j]$ 为点 $(i,j)$ 正上方最近的苹果树的行号。

- $low[i,j]$ 为点 $(i,j)$ 正下方下面最近的苹果树的行号。

那我们在询问 $(x,y)$ 最近点的距离时，我们考虑在枚举第 $y$ 行的所有点 $j$，则答案为 $\min_{j=1}^m(\operatorname{dis}[(up[x,j],y),(x,y)],\operatorname{dis}([low[x,j],y),(x,y)])$

再考虑预处理 $up$ 和 $low$，我们可以枚举每一列，对于第 $j$ 列，我们从上到下更新 $up$，从下到上更新 $low$，至于怎么更新，我们记一个上次的苹果树的行号，遇到一个苹果树立刻更新，对于每个 $up$ 和 $low$ 都更新为标记的值。

别忘，每询问一次，也需要更新加入的这个点所在的这一列的所有点的 $up$ 和 $down$ 值。

然后一道水蓝就做完了。