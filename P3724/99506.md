看到大家都在打 map/hash，我流下了长长的眼泪。

首先可以将五种操作转化成两种操作：攻击操作和回血操作。

于是随便 dp 一下计算出在不死掉的情况下最多能怼大佬多少次。

于是问题转化成对于每个大佬，是否能通过若干次攻击把它干掉。

显然是要拆成 $s1+s2+k$，其中 $s1,s2\in A$，$A$ 集合表示所有包含的质因子在 $100$ 以内且小于 $10^8$ 的数构成的集合。

爆搜一下，发现 $|A|$ 大约为九十多万。

然后 dp 一下，设 $f_i$ 表示达到 $i$ 的伤害的最小代价。

显然数组可能会爆炸，于是需要用双指针弄一弄。

具体双指针方法：先把所有的数排序，然后维护两个指针，根据单调性可得一次的复杂度是 $O(|A|)$ 的。

然后对于每次询问操作，同样双指针算一下答案即可。

一个小小的优化：可以发现 $97$ 这个质数基本是没有用的，可以特判掉。

然后跑了 rk1 了（截止至2021-10-19）