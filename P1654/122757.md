### 思路：通过二项式定理求出高次期望

显然，对于一次期望我们有 $x_{i}=(x_{i-1}+1)*P_{i}$。

然后进行二次推导。

$(x_{i}+1)^{2}= x_{i}^2+2x+1$

发现我们 $x_{i}^2$ 可以通过$x_{i}$得到，从而计算出每个点为成功时的期望。

```cpp 
for(int i = 1 ; i <= n ; i ++) { //a为x b为x^2
	a[i] = (a[i - 1] + 1) * p[i];
	b[i] = (b[i - 1] + 2 * a[i - 1] + 1) * p[i];
}
```

这个代码看起来很对 ~~(反正我一开始觉得很对)~~ 。

但是他却忽略了一点。

**我们是在求 $ 1\to n$ 的总期望，只求一个点必然会错。** 

思考一下，我们的 $1\to n$  其实是通过第 $n$ 个点成功或者不成功两种情况得来的。

所以我们只需要将不成功时的贡献加上即可。

```cpp
b[i] = (b[i - 1] + 2 * a[i - 1] + 1) * p[i] + b[i - 1] * (1 - p[i]);
```

化简得。

```cpp
b[i] = b[i - 1] + (2 * a[i - 1] + 1) * p[i];
```

### 思考：如果我们要求 $3$ 次以上的期望呢？

我们可以通过二项式定理一次一次的向上推。

例如这样（$3$ 次）：

```cpp 
for(int i = 1 ; i <= n ; i ++) {
	a[i] = (a[i - 1] + 1) * p[i];
	b[i] = (b[i - 1] + 2 * a[i - 1] + 1) * p[i];
	c[i] = c[i - 1] + (b[i - 1] * 3 + a[i - 1] * 3 + 1) * p[i];
}
```
这里需要注意一下的是 $b$ 数组也就是 $x^{2}$ 表示的是这个点成功的期望。

我们只需要对我们所需要的次数进行上一步成功和上一步不成功的期望累和。

化简后看起来就像是个 $\sum_{i=1}^{n} x_{i}^{3}$ 的形式啦。

这样问题就被我们完美解决啦！