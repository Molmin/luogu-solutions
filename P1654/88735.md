记打到第$i$个点的期望得分为$f_i$,记打到第$i$个点的期望长度为$d1_i$,期望长度的平方为$d2_i$。(之所以要分开统计是因为$E(l^2)$和$E(l)^2$显然不相等,不能用$d1_i^2$代替$d2_i$)  
考虑每个点的贡献:如果打中了,原来长度为$x$,现在应该变为$x+1$,得分变化为$(x+1)^3-x^3=3x^2+3x+1$。  
那么$f_i=(f_{i-1}+3d2_{i-1}+3d1_{i-1}+1)p_i$  
维护$d1$:很显然:$d1_i=(d1_{i-1}+1)p_i$  
$d_2$的维护:如果在当前打中,之前的连续长度(实际值)为$x$，则有$(x+1)^2-x^2=2x+1$。用期望维护就是$d2_{i}=(d2_{i-1}+2d1_{i-1}+1)p_i$  
```cpp
#include <cstdio>

using namespace std;

int main() {
	int n;
	double d1=0,d2=0,pi,sco=0;
	scanf("%d", &n);
	while(n--) {
		scanf("%lf", &pi);
		sco+=(3*d2+3*d1+1)*pi;
		d2=(d2+d1*2+1)*pi;
		d1=(d1+1)*pi;
	}
	printf("%.1lf\n", sco);
	return 0;	
}
```