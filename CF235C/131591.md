## 后缀数组这么没排面的吗？这个题都没有 SA 题解？

题意略。

循环同构，按照套路我们把每个 $x_i$ 倍长后得到 $y_i$ 顺次连接，再与 $S$ 连接起来建立后缀数组。

倍长后每个可能的循环同构就成为了 $y_i$ 的长为 $|x_i|$  的子串。如何判断它们是否循环同构？只要查询 $lcp$ 是否大于等于 $|x_i|$ 就可以了。那么我们可以按照后缀排序从前往后扫一遍后缀数组，记录每个 $y_i$ 上次出现的位置，当再遇到 $y_i$ 的子串时，判断是否是一个新的循环同构。如果是的话再统计在 $S$ 中的出现次数。这也是后缀数组的基本操作：预先把后缀数组上每个是 $S$ 的某一字符开头的位置 $+1$ ，查询时两边二分得出与该串 $lcp$ 大于等于 $|x_i|$ 的后缀数组上的区间，再查询区间和就可以了。这就是简单的前缀和相减。

时空复杂度均为 $O(n\log n)$ 。