给一个 $\mathcal O(n \sqrt n \log n)$ 的做法。

首先式子很好推：对于每一个质因子，答案为这个质因子从 $0$ 到它的出现次数次方的和，乘以将这个质因数除干净之后的数的因数个数。

考虑求出对于每个质因数的答案。

首先第一项 $\prod \limits _{i=0} ^{\alpha _i} p^i$，其中 $\alpha _i$ 表示质因数 $p$ 的出现次数。

考虑合并指数，为 $\frac {\alpha _i (\alpha _i -1)}{2} \bmod 10^9 + 6$，可以 $O(1)$ 不除法的计算。

重点在第二项，算出除干净一个质因数之后的因数个数。

我们当然可以 $\mathcal O(n^2)$ 的暴力求解，但是会 T 掉。

我们要找到一个不是 $\mathcal O(n)$ 量级的，而且影响答案的数据。

考虑一个质因数的出现次数，发现这是 $\mathcal O(\sqrt n)$ 量级的。而且，答案本质上就是只和出现次数有关。

好了，我们对于每一个出现次数预处理，用 `u_map` 查询它的答案。

复杂度严格 $\mathcal (n \sqrt n \log n)$。$\log$ 来自快速幂。