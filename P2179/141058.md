**本题解着重于理解掌握拉格朗日乘数法的应用！！**

# 题意
在满足 $\sum_{i=1}^{n} {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )^2} \le E_{U} $ 的条件下，
使得 $\sum_{i=1}^{n} {\frac{s_{i}}{v{i}} } $ 最小，
其中 $k_{i},s_{i},v_{i}{}'$ 为给定的常数，未知量就是 $v_{i}$。

# 分析

其实学过拉格朗日乘数法的已经能看出来了，求这种多元函数的极值，有了给定的约束条件，直接拉乘就可以了。

那么**拉格朗日乘数法**是什么呢？

首先你得学会导数([传送门](http://www.gaosan.com/gaokao/244831.html)），只需要记住几个基本函数的求导法则就行了，比如幂函数，指数函数，对数函数，$sin$，$cos$，再学会函数加和、乘积、作比的求导法则，基本够用了。

其实从高等数学的角度来讲，~~我不会~~，如果好奇可以去[这里](https://zhuanlan.zhihu.com/p/449683167)。

 所以从通俗角度来讲，我们只需要掌握套路，知道这个东西可以求极值就行了。

 那么套路是什么呢？

首先题中给出了**约束条件**，也就是未知量的一个等式，在本题中，我们可以贪心的想：

我们消耗的体力越多，肯定跑的越快，也就是那个式子越小。

所以我们不妨令约束条件为 $\sum_{i=1}^{n} {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )^2} = E_{U}$。

接下来引出拉格朗日乘数法最核心的部分：

 我们要求上面式子的极值，就要引入一个 $\lambda $，

然后得到这样的一个函数：

$\sum_{i=1}^{n} {\frac{s_{i}}{v{i}} }  + \lambda (\sum_{i=1}^{n} {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )^2} - E_{U})$

观察一下是怎么得来的？

首先把要求极值的式子抄过来，再写一个 $\lambda$，再用它乘上约束条件的量都移项到左边的样子。

接下来我们要对这个函数中的每一个变量，也就是我们要求的 $v_{i}$ 和 $\lambda$，求**偏导**。

“偏导是什么？我不会啊啊啊！！！”

“不，你会！”

偏导其实就是只考虑**当前一个**变量，把其他所有的**无关变量**以及原有的常量**统一**认为是**常量**，然后求导。

所以我们推导理解一下：

对于 $v_{i}$：

首先忽略与他无关的常数式子，得到:

${\frac{s_{i}}{v_{i}} }  + \lambda \times {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )^2}$

此时进行求导，可以得到:

$-\frac{s_{i}}{v_{i}^ {2}}  + 2\times \lambda \times {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )}$

注意这里有个小技巧就是 

如果 $f(x) = (x + b)^2$ 那么 $ f{}'(x) = 2(x + b)$，手推一下就知道了。

接下来对 $\lambda$ 求导就没什么了，把系数抄下来就OK:

$\sum_{i=1}^{n} {k_{i} \times s_{i} \times (v_{i} - v_{i}{}' )^2} - E_{U}$

众所周知，函数求极值在导函数的零点处取得，所以我们要让所有的 $v_{i}$ 还有 $\lambda$ 都使得他们的导函数为 $0$，也就是说我们所求的式子的极值，在我们求偏导得出的所有式子同时为 $0$ 时取得。

接下来考虑怎么求：

首先我们发现，直接找每一个 $v_{i}$，如同我们脱裤子放屁，是不可行的。

我们看看对 $v_{i}$ 导数的式子可以得到什么？

$2\times \lambda \times {k_{i} \times {v_{i}^2} \times (v_{i} - v_{i}{}' )} = 1$ 

非常滴amazing啊，这不反比例吗？

当然不全是，至少我们肯定能看出来随着 $\lambda$ 递增，$v_{i}$ 肯定递减，且这个时候的 $v_{i}$ 最便于确定。

好！那就二分 $\lambda$ 吧！

然后在二分答案的时候，在里面二分 $v_{i}$ 就好了，因为内外都有单调性，都可以二分，这样我们肯定能逼近到所有方程都为 $0$ 也就是取到极值的时候啦。

代码部分，其实和之前的神犇好像都差不多啦，重在理解学习！

[代码在这里~](https://www.luogu.com.cn/paste/qj9q4e0a)

管理大大求过qwq。