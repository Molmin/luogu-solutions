## 思路
注意到最优交换策略一定是将这个序列拆成若干段，每段 $a,b$ 组成的可重集相等，然后每段通过 $|S|-1$ 次操作还原。

于是 F1 就是叫你构造使得段数最大值最小，F2 就是让你判断最大值是否取到最小。

段数最大值最小可以通过出现次数最多的那个数来做，不难证明答案即为每个数出现次数的最大值，我们只需要设计一种方案让它取到。

假设现在有 $a_1$ 个 $1$，$a_2$ 个 $2$，以此类推，记 $a_1\geq a_2\geq\cdots$，一种策略就是每次先把 $a_i\neq 0$ 的全取出来一个，循环位移一位，不难证明这样的构造需要至少分成 $a_1$ 段。

对于 F2，我们考虑 F1 中每段的末尾都一定是 $i\to 1$，我们可以抓住这一点，考虑所有连向 $1$ 的边。手模可以发现，可以分成 $a_1$ 段当且仅当去掉所有连向 $1$ 的边之后图是 DAG。