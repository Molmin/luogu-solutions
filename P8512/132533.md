自己的题是问的全局颜色段，但是其实也差不多做法。

你可以发现进行一次全局的所有操作颜色段数量是 $O(n + m)$ 的。

我们可以在扫描线的时候对每个颜色段维护颜色与它们被哪个操作影响。

则一个颜色段可被记为 $(l,r,x,col)$，其中 $col$ 为颜色，$x$ 是属于的第几个操作。

用树状数组实现可 $O(n \log n)$。

其实挺基础的，感觉不如问颜色段。