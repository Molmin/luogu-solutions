首先先讲一下我错误的网络流建模。

借鉴 HNOI2013 切糕的模型。对于每个人建一排 $n+1$ 个点，在第 $j$ 个点与第 $j+1$ 个点之间连权为 $\max(j-a_i,0)$ 的边。这样对于每组限制 $x,y$，我们新建两个虚点 $p_1,p_2$，$p_1$ 与汇点相连当且仅当  $(x,b_x),(y,b_y)$ 均与汇点相连，$p_2$ 与汇点相连当且仅当 $(x,b_y),(y,b_x)$ 均与汇点相连。这容易做到，但是这里我们要求 $p_1,p_2$ 至少一者与 $T$ 相连，也就是说如果二者均与 $S$ 相连那么就 GG 了，这个代价很难刻画，因此从这个角度思考是没有前途的。

接下来考虑正解，首先对于每组限制 $(x,y)$，我们肯定需要将 $a_x,a_y$ 都变为至少 $\min(b_x,b_y)$，如果不够就直接加上对应的代价即可。此时我们扔掉已经符合要求的限制，这样所有有效限制都满足如下条件：

- $a_x,a_y$ 中一者满足 $a_x\ge b_x$。

于是我们将所有怪物分为两类：$a_x<b_x$ 和 $a_x\ge b_x$。

对于前者，我们只用一个点刻画其贡献，如果这个点与 $S$ 相连表明这个 $a_x$ 不增加，否则表明我们花费 $b_x-a_x$ 的贡献使 $a_x\ge b_x$。

对于后者，我们使用切糕的模型，建一排 $100$ 个点，其中 $(x,i)$ 与 $S$ 相连意味着我们至少令 $a_x$ 增加了 $i$。

这样对于每组限制 $(x,y)$，不妨设 $a_x<b_x$，那么这个限制等价于：如果 $x$ 与 $S$ 相连，$(y,\max(b_x,b_y)-a_y)$ 与 $T$ 相连就不合法。

这样我们可以得到一个很显然的建图方法：

- 对于每个一类怪物，连边 $(S,x,b_x-a_x)$
- 对于每个二类怪物和 $1\le i\le 100$，连边 $((x,i),T,1)$，对于 $2\le i\le 100$，连边 $((x,i),(x,i-1),\infty)$。
- 对于每组限制，连边 $(x,(y,\max(b_x,b_y)-a_y),\infty)$。

然后跑最小割即可。