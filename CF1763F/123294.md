这题是不是有点裸？题目给的性质乱七八糟，完全没用。

建出圆方树，则 $a, b$ 之间涉及到的所有点双即 $a, b$ 在圆方树简单路径上的所有方点。

对于 $a, b$ 路径上的一个点双，如果其不为两点一边即割边，则删去其中任意一条边 $a, b$ 仍相互可达。因此，对于所有点双，若其为两点一边，则给其对应方点赋值 $0$，否则赋点双内部边的条数作为权值，则询问 $a, b$ 的答案即 $a, b$ 在圆方树上的简单路径上的所有方点的权值之和。

视 $n, m, q$ 同级，时间复杂度 $\mathcal{O}(n\log n)$。[代码](https://codeforces.com/contest/1763/submission/186095525)。