## [题意](https://blog.csdn.net/BeNoble_/article/details/79855890)

给定平面上的$N$个点$,$其中有一些是红的$,$其他是蓝的

现在让你找一对平行线$,$在满足在平行线之间没有蓝点$,$并且平行线不经过任何一个点的情况下$,$使得被夹在平行线之间的红色点个数最多

给出的点没有三点共线的情况$,$平行线可以不平行坐标轴

---

## 题解

做一条垂直于平行线的线$,$然后把所有点排序后都投影到这条线上形成一个序列

那么考虑在序列上我们要求的就是最长全红子串了

这个可以用线段树直接维护$;$考虑到平行线的角度会变

那么答案就是我们把这条垂线在旋转$180^\circ$的过程中所有投影序列的答案的最大值

我们显然不能直接去旋转$,$考虑要怎么样投影序列才会发生变化

![这里写图片描述](https://img-blog.csdn.net/20180408173509394?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JlTm9ibGVf/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

投影序列是$\{1,2,3,4\}$,那么颜色序列就是$1001,$答案是$1$

![这里写图片描述](https://img-blog.csdn.net/20180408174445827?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JlTm9ibGVf/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

当投影线是$L1$时投影序列是$\{1,2,3,4\}$

当投影线是$L2$时投影序列是$\{1,2,4,3\}$

也就是说当投影线的斜率从小于两点连线垂线$(Lx)$斜率到大于他的过程中这两个点在投影序列上的位置会互换

因为垂线的斜率和原直线的斜率是一一对应的$,$那么我们可以直接按照两点之间的连线的斜率排序

那么旋转投影线每次就可以直接旋转到下一个垂线的位置

即使有两点投影位置相同也没关系$,$因为我们可以微调一下

注意对于所有斜率相同的直线我们需要一次性在线段树上处理完

因为总共有$n^2$条线$,$所以会发生$n^2$次交换$,$所以复杂度是$O(n^2\log n)$的

>$Hint:$

>连线的方向和转动的方向要一致(需要脑补一下)

>斜率判等的精度要高一点