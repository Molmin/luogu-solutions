注意到如果存在两条边权相同的边直接相连（不妨设为 $(x, y)$ 和 $(y, z)$ ），我们可以将它们缩成一条 $(x, z)$，并将上面两条边删掉。

因为确定了新边的方向，我们便可以选定上述两条边的方向使两者作用效果相同。

无法缩边时任一点显然最多两条邻接边。那么只能是环或者链，比较容易贪心解决。

时间复杂度 $O(n)$