考虑 DP，钦定第 $1$ 天休息，设 $f_i$ 为考虑了前 $i$ 天，第 $i$ 天休息的最大生产力，那么有边界条件、转移：

$$f_1=0$$

$$f_i=\max_{j=1}^{i-1}f_j+w(j-i-1)$$

其中 $w(i)$ 表示连续 $i$ 天工作的生产力，显然可以用前缀和 $O(1)$ 求出。

则答案为 $\max_{i=1}^nf_i+w(n-i)$。