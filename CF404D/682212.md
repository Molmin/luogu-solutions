# CF404D Minesweeper 1D

蒟蒻发的第二篇题解。

[See on Luogu Blog](https://ryanli66699.blog.luogu.org/ti-xie-cf404d-minesweeper-1d-ti-xie)

**题意**

------------

   给定一个串，由 `0` ，`1` ，`2` ， `*` ，`?` 组成。求将 `?` 替换成其他字符中的任意一个，使原串合法的方案数。将  `*` 视为雷，数字就是数字，合法为扫雷地图的合法性。

PS：数字 $i$ 表示以 $i$ 为中心的九宫格中只有  $i$ 个雷。如 `2*` 是非法的，而 `*2*` 是合法的。

**分析**

---

一看见这种类型的题，您能想到啥？不错不错，一眼看上去就是动规！

**题解**


------------



先来个动规数组数组 $d_{n,5}$ 。

通过了解题意很显然的发现：

- $d_{i,0}$——$i$ 位有雷，$i-1$、$i+1$ 随便。
 
- $d_{i,1}$——$i$ 位没雷，$i-1$、$i+1$ 没雷。
 
- $d_{i,2}$——$i$ 位没雷，$i-1$ 没雷、$i+1$ 有雷。
 
- $d_{i,3}$——$i$ 位没雷，$i-1$ 有雷、$i+1$ 没雷。
 
- $d_{i,4}$——$i$ 位没雷，$i-1$、$i+1$ 有雷。
 
**开始转移**
 
令 $s$ 为字符串，初始化——
 


 $d_{0,1} = 1 $：方便对于第 1 位**没有**雷的情况进行转移！
 
$d_{0,2} = 1 $：方便对于第 1 位**有雷**的情况进行转移！
 
---

 _转移核心代码：_ （**详细推演过程见注释**） 

```cpp
#define mod 1e9 + 7//取模数
 
if (s[i] == '*')// 如果s[i]是雷时

    d[i][0] = ( ( d[i-1][2] + d[i-1][4] ) % mod + d[i-1][0] ) % mod;

if (s[i] == '0')//s[i-1] != '*' && s[i+1] != '*' 。（d[i][1] . d[i][3] 情况）

    d[i][1] = ( d[i-1][1] + d[i-1][3] ) % mod;

if (s[i] == '1')//两种情况，一种s[i-1] == '*'，一种s[i-1] != '*'，综上分析出下列代码

    d[i][2] = ( d[i-1][1] + d[i-1][3] ) % mod;
    d[i][3] = d[i-1][0];

if (s[i] == '2')//s[i-1] == '*' && s[i+1] == '*' 。（d[i][4]情况 ）

    d[i][4] = d[i-1][0]
```

对于我来说，转移公式还是蛮好推出来的。其他代码我就不展示了，希望大家养成自己写代码的习惯，去攻克这道题！






