
后悔开题顺序为什么是 231 ？？？？

发现对于一个点生成的子楼梯边界就是它右边和下面的方块个数之和 $+1$。

~~根据小学表面积简易算法，~~ 考虑维护阶梯的右下分界线，竖线为 $1$，横线为 $0$。

问题变成找到以 $1$ 开头，以 $0$ 结尾长度为 $q+1$ 的串。

思考 $q$ 是总体因子的性质。

发现当楼梯不为空时，保证有解。

考虑反证，假设当前楼梯边界格数为 $9$，**不能出现**边界数为 $q$ 的情况（$q$ 是 $9$ 的非 $9$ 因子）。

`1--------0`

于是可以肯定第一个 $1$ 后面的第 $q$ 位为 $1$，如此类推。

假设 $q=3$，于是有

`1--1--1--0`

所以，最后还是会出现边界数为 $3$ 的情况，$q$ 同理。

这个的启发就大了。

发现可以直接从第 $1+kq$ 位找寻答案，其中 $k\ge 0$，**注意下文的第 $i$ 位定义为第 $1+(i-1)q$ 位**。

考虑从后往前找，如果倒数第二位为 $1$，那么有解；否则考虑倒数第三位。

优化查找过程，二分就行了。

考虑判定，记当前二分到了第 $x$ 位，如果第 $x$ 位为 $1$，那么不管他左边是否有满足的，他的右边一定有满足的；否则，他的左边一定有满足的。

回到修改，线段树维护每一个 $1$ 与下一个 $1$ 之间 $0$ 的个数。

对于前缀以及后缀修改，简单维护。

对于撤销操作，经典可持久化。

时间应该是双 `log` 的。




