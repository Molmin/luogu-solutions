### difficulty - 2500

### [problem link](https://www.luogu.com.cn/problem/CF1658D2)

### [code](https://codeforces.com/contest/1658/submission/189485916)

提供一种不用字典树的做法，但可能实际上跑的并不是最快。

说句闲话：在 cf 上找 interactive 标签做了这道题，做完了才发现根本不是交互题。。。

进入正题：关于异或运算有一个很常用的性质：$(2k) \operatorname{xor}{(2k+1)}=1$。而这两个数之间也可以用异或 $1$ 互相转化。

在这道题里还有一个性质：对于一对数字 $2k$ 和 $2k+1$，它们在异或了某一个值 $x$ 之后，一定还能“配对”，即变成 $2m$ 和 $2m+1$，只是相对顺序可能会改变。

这说明什么？我们从初始情况开始考虑：如果 $[l,r]$ 这 $r-l+1$ 个原始的数中存在没有“配对”的数字，即 $l$ 为奇数时的 $l$ 或 $r$ 为偶数时的 $r$，则这个（些）数字最后肯定还是没有“配对”的，所以我们可以再找出 $a_i$ 中没有“配对”的数字，进行暴力验证（最多验证 $2$ 组就能得到正确答案）。

而如果 $l$ 为偶数且 $r$ 为奇数，所有数字都配对了，你会发现 $x$ 的最后一位的取值 $0/1$ 是无所谓的，它只会改变最后配对的数字的相对顺序。举个例子吧，可能有点抽象（加括号的是配对的数字）：

$l=4,r=7,\{a_n\}=(0,1),(2,3)$

若取 $x=4$，$\{b_n\}=(4,5),(6,7)$；

若取 $x=5$，$\{b_n\}=(5,4),(7,6)$。

因此，我们可以把基数乘以 $2$，把 $[l,r]$ 和 $\{a_n\}$ 中的偶数取出来除以 $2$，用上述的方法递归求解 $x$ 的高位。问题规模缩小到了 $1/2$。

时间复杂度 $\mathcal{O}(n\log n)$。