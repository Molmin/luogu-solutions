注意到只有区间赋值，因此一个询问的值只会有两种：$0$，或者前面所有操作下的答案。

证明考虑只有最后一次对该位置（交换位置之前的位置，如果交换了的话）的赋值是有用的，此前的操作全删都不改变结果，但删了这个之后就会是 $0$。

所以先求出每次询问所依赖的修改和最后的非零值，然后考虑查询。

查询相当于一个二维偏序，要求 $l$ 小于所依赖的修改的序号， $r$ 大于这个询问的序号，因为显然所依赖的修改的序号小于这个询问的序号。离线排序即可。