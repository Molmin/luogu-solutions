此blog参考@ So_what 巨佬的题解 orz

### 给52分的前排提醒：

@ xiaofulll 巨佬提醒您：记得在Tarjan后去重边，否则方案数会最长链的数量会受到影响

### 题意简化（~~这题的题面太毒瘤了~~）：

给定一个图，求这个图的最长链所包含的节点个数以及最长链的个数

### 思路：

我们先用Tarjan把图进行缩点（及把能够互相到达的一个子图缩成一个点，并记录当前强连通分量的节点数，这样不会对结果进行影响，当搜到这个强连通分量时，我们只需要把当前强连通分量的节点数加上就好了），然后我们对这个缩过点的图重新进行建边（注意：重新建完图后，可能会有重边，需要判重，否则最后最长链的数量会受到影响），最后我们拓扑加dp把最长链的节点的数量和最长链的数量求出，定义dis[i]表示从第i个点开始到达任意点的最长链的节点的个数，cnt[i]表示从i开始可以到达的最长链的数量，并且记录最长链的节点个数。最后枚举1 ~ n，如果dis[i] == 最长链的节点的个数，那么ans就加上当前点可以到达的最长链的数量，并且%MOD，最后先输出最长链的节点的个数，再输出ans。（如何拓扑 + dp在代码中讲）

### 全文 + 代码： 

https://www.cnblogs.com/qqq1112/p/11625728.html