
神仙题

首先选一个点作树根，只考虑经过根的路径

那么先考虑一个问题，在一个大小为$n$的子树中，让每个点到根的路径长度凑出$a,2a,\ldots,(n-1)a$

这个很好构造。先找出所有儿子，分别为$son_1,\ldots,son_m$，子树大小为$siz_1,\ldots,siz_m$。根到第$i$个儿子的边权是$(1+\sum_{j<i}siz_j)a$，然后对每个儿子递归下去做。

现在假设选了一个根节点$rt$，将儿子分为两组$A,B$，分别做上面的算法，其中$A$权值是$1,2,\ldots,siz_A$，$B$权值是$siz_A+1,2(siz_A+1),\ldots,siz_B(siz_A+1)$

那么从$A$到根节点到$B$的路径可以凑出来$1$到$(siz_A+1)(siz_B+1)-1$中所有数

考虑怎么将儿子分组，$(siz_A+1)(siz_B+1)-1$可以到达$\lfloor\frac{2n^2}{9}\rfloor$

显然两边尽量接近才能让结果更优

如果$siz_A,siz_B$都不小于$\lceil\frac{n-1}{3}\rceil$，那么最极端的情况就是$siz_A=\frac{n-1}{3}$，结果$\ge (\frac{n+2}{3})(\frac{2n+1}{3})-1=\frac{2n^2+5n-7}{9}$

需要的是$\frac{2n^2}{9}$。结果在$n>1$时正确，$n=1$无需考虑。

那么需要选一个根和划分让$siz_A,siz_B\geq \lceil\frac{n-1}{3}\rceil$

如果子树数量$\ge 4$，一定有两个子树大小之和$\le \frac n2$可以不断合并。

如果子树数量$\ge 3$，合并最小的两个子树，剩下那个大小一定$\geq\frac{n-1}{3}$，那么另一个大小也会$\leq 2\frac{n-1}{3}$。

子树数量为$1$只可能是$n=2$，无需考虑

合并完之后子树数量只可能为$2$，这时如果有一个子树大小$\ge \frac{2}{3}(n-1)$就不合法。

选重心做根，最大的子树大小小于等于$\frac{n}{2}$，就合法了。

https://codeforces.com/contest/1205/submission/59208736

