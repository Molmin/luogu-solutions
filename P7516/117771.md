可能拯救我 $\text{Day1}$ 的题目，写篇题解纪念一下    
首先考虑分析题目：    
*  对答案产生贡献的 $(u,v)$ 必须满足 $v\le u$    
*  $\text{Lemma }\alpha$ 若 $(u,v)$ 对答案产生了贡献，那么 $u\to v $ 和 $v \to u$ 上的点编号都大于 $u$   

简单证一下 $\alpha$ :    
如果 $(u,v)$ 之间互相可达，那么很容易在 $G'$ 上发现包含 $u,v$ 点的环  
若环上有 $<u$ 的点，那么在考虑 $u$ 之前，这个环就将从中间断开    

所以在考虑固定的 $v$ 对答案的贡献时就可以假定编号 $<v$ 的点不存在了  

-------------------
回到原题      
明显应该离线，并把删除变成插入    
考虑点对 $(u,v)$ 在插入第几条边时能对答案产生 $+1$ 的贡献    
以 $v$ 为源点在正向图和反向图上分别跑 $\text{dijkstra}$    
处理 $u \to v$ 和 $v \to u$ 上边的编号的最小值 的最大值     
复杂度是 $O(nm\times logn)$ 的，不过我硬是手写堆卡过去了