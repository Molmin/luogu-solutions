令 $f_{i,j}$ 为 $i$ 往上跳 $j$ 步，直到不能跳为止的答案。

$j \leq \sqrt n$。

$f_{i,j} = f_{K(i,j),j} + val_i$。

这样预处理的复杂度是 $n \sqrt n$。

查询的时候做一个前缀和就好了。

然后如果跳 $j$，$j \geq \sqrt n$，那么直接跳。


代码鸽了