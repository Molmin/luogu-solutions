操作顺序无关，因此设 $x_i$ 表示将第 $i$ 行所有数减去 $x_i$，$y_i$ 表示将第 $j$ 行所有数减去 $y_j$。

如果 $x = y = 0$，则代价为 $\sum c_{i, j}$，$x_i$ 或 $y_j$ 每增加 $1$，代价减小 $n - 1$，但 $x_i + y_j$ 不能超过 $c_{i, j}$。

因此，相当于找到一组 $x, y$，使得 $x_i + y_j \leq c_{i, j}$ 并最大化 $\sum x_i + y_i$。注意到这很像最大权完美匹配的 KM 算法中的顶标，不过不等号限制换了一个方向。这启发我们猜测 $\sum x_i + y_i$ 的最大值即 $i, j$ 之间连边 $c_{i, j}$ 的二分图的最小权完美匹配。

证明：最大不会超过最小权完美匹配是显然的，能达到该值则可借助 KM 算法证明。

综上，我们将问题转化为求 $\sum |a_i - b_{p_i}|$ 的最小值，其中 $p$ 是 $1\sim n$ 的排列。从小到大排序后对应匹配即可。初始 $\sum c_{i, j}$ 也容易求。

时间复杂度 $\mathcal{O}(n\log n)$，瓶颈在排序。[代码](https://codeforces.com/contest/1765/submission/185466990)。