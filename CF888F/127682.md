计数类，要么是数学，要么是 $dp$。这题数学不好做，很显然是 $dp$。

**步骤 $1$ :** 

首先题目要求线段不能相交，我从这一点以及数据范围看出了这题是一道区间 $dp$。为什么？因为一棵范围为 $[l,r]$ 的树只有可能是由 $[l,k]$ 和 $[k+1,r]$ 两棵树拼成的。如果是 $[l,k_1]
$ 和 $[k_2,r]$ 共同一棵树，$[k_1+1,k_2-1]$ 是另一棵树，这两棵树拼成的，可以化为上种情况。如果是两段交叉的树拼成，那么线段必定相交（如 $[1,4]$ 这棵树不可能由  $\{ 1,3 \}$ 和 $\{ 2,4 \}$ 两棵树合并而来）。

**步骤 $2$ :** 

确定了要用区间 $dp$ 后，注意遵守一个计数类 $dp$ 的准则，即不重不漏。

为了不漏，我们枚举中间点 $k$，由 $[l,k]$ 和 $[k+1,r]$ 两棵树拼成 $[l,r]$。但是这样显然会重复。

为了不重，我们要找到每棵树唯一的特征。我们可以定为最左边的点 $l$ 连接的最右边节点的位置。

这样有两个好处，一是不重，因为如果 $l$ 所连最右边节点不同，那么两棵树一定不同。所以我们用 $f[i][j]$ 代表 $[i,j]$ 区间内组成一棵树且 $i,j$ 必须相连的方案数，$g[i][j]$ 代表 $[i,j]$ 区间内组成一棵树的方案数。那么 $g$ 可以轻易由 $f$ 转移来，具体的，对于 $g[i][j]$，枚举中间节点 $k$，累加所有 $f[i][k]\times g[k][j]$ 即可。

第二个好处是，我们可以轻易算出 $f$ 数组，原因又有二。第一：对于一棵树 $[l,r]$，$(l,r)$ 这条边是一定可以连的！不用担心会与其他线段交叉。第二，在计算 $f$ 数组，枚举断点 $k$ 时，对于任意 $[l,k]$ 与 $[k+1,r]$，之前肯定都没有连过 $(l,r)$ 这条边，由于之前 $k$ 不同，不连通的两棵树也不同，现在加了一条一样的边，构成的树也不同，所以算 $f$ 也不会重。具体的，对于 $f[i][j]$，枚举每一个中间点 $k$，累加 $g[i][k] \times g[k+1][r]$ 即可。

这道题就轻松地搞定了。




