其实做过一个思路[类似的题](https://www.luogu.com.cn/problem/CF643F)，但是完全没联想到……

另外，有一个有趣的事实是，这是 IMO 的原题。

---

首先有 E1 的做法，大概是通过四次询问缩小到原来的三分之二或者是通过两次询问缩小到原来的四分之三（最后 $n=3$ 特判）。可以勉强卡进 E1 的询问次数限制。

分析为什么 E1 需要太多的询问——每次缩小的若干次查询是完全独立的！我们在正常的询问过程中忽略的太多信息。另一方面有一个通病是在 $n$ 很小的时候缩小的速率太慢。我们需要解决这样两个问题。

交互库的每两个相邻的回答一定有一个是真的，同时交互库的回答相当于告诉我们答案在某一个集合（不在询问集合就在补集）。因此假设对于相邻两个询问，得到的答案是 $S_1,S_2$，因为必定有一个是真的，那么答案一定在 $S_1 \cup S_2$ 内。

注意到只跟“相邻”有关，我们在进行下一次查询中只需要知道上一次的询问结果。假设我们能确定答案在集合 $U$ 中，上一次询问告诉我们答案在 $S$ 中，$S$ 的补集交 $U$ 得到的集合为 $T$。将 $S$ 分成两个集合 $S_0,S_1$，将 $T$ 分成两个集合 $T_0,T_1$。这次询问查询 $S_0 \cup T_0$。根据结果可以执行如下操作：

- 若结果为 `YES`：$U \gets S \cup T_0, S \gets S_0 \cup T_0,T \gets S_1$；   
- 否则：$U \gets S \cup T_1, S \gets S_1 \cup T_1, T \gets S_0$。

（此时如果均分做下去或者尽量平衡做下去有点类似斐波那契数？比较口胡，然后同时没有测试过不加优化的次数，懒得测了。）

这个类似于 E1 的第二个做法。还需要解决的问题是 $n$ 小的时候直接均分次数太多，怎么办？

可以直接 DP 求出 $|S| = i$ 且 $|T| = j$ 的时候所需要的最小次数。因为我们只关心集合大小而不关心实际的数，可以讨论上面可能出现的两种情况，得到一个 $O(n^4)$ 的 DP（同时可以求出划分的方案）。因为大范围均分够了，所以只需要处理小部分即可。

[评测记录](https://codeforces.com/problemset/submission/1746/183242759)。