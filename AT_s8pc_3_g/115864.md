[题目链接](https://atcoder.jp/contests/s8pc-3/tasks/s8pc_3_g)

答案就是 fibonacci 数列的 $n-1$ 阶前缀和的第 $m$ 项，即
$$[x^{m-1}] \frac{1}{(1-x-x^2)(1-x)^{n-1}}$$
考虑进行一下分式分解，将原问题写为
$$[x^{m-1}]\left( \frac{f(x)}{1-x-x^2}+\frac{g(x)}{(1-x)^{n-1}}\right)$$
当然这两个分式都要求是真分式，满足条件
$$f(x)(1-x)^{n-1}+g(x)(1-x-x^2)=1$$
根据 EI 的方法，两边同时对 $(1-x)^{n-1}$ 取模得到
$$g(x)(1-x-x^2) \equiv 1 \pmod{(1-x)^{n-1}}$$
$$g(1-z)(-1+3z-z^2)\equiv 1 \pmod {z^{n-1}}$$
由于 $f(x)$ 的次数只有 $1$，重点就是如何快速求出 $g(x)$。设
$$H(x)=\frac{1}{-1+3x-x^2} \ , \ h(x)=H(x) \bmod x^{n-1}$$
我们只要找出 $h(x)$ 所满足的一个 ODE，这样就能以线性的复杂度求出 $g(x)$ 了。首先
$$(1-3x+x^2)H'(x)-(3-2x)H(x)=0$$
如果把 $H(x)$ 替换为 $h(x)$，得到的就是
$$(1-3x+x^2)h'(x)-(3-2x)h(x)=(ax+b)x^{n-2}$$
递推出 $h(x)$ 的系数后，就可以直接求出 $a,b$ 了，于是
$$(1-x-x^2)g'(x)-(1+2x)g(x)=a(1-x)^{n-1}+b(1-x)^{n-2}$$
就可以在 $\Theta(n)$ 的时间复杂度内分式分解。分解完成后就好办了，前一个分式可以 $\Theta(\log m)$ 提取一项系数（因为 $f(x)$ 的次数只有 $1$）；而后面那个就是 $\Theta(n)$ 个二项式系数的线性组合，也容易处理。

总时间复杂度 $\Theta(n+\log m)$。