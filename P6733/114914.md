#### Description

> 给定 $n$ 杯水，第 $i$ 杯水温度为 $c_i$，体积为 $a_i$，求两两混合后温度第 $k$ 大是多少。

#### Solution

水二分，比方分不知道简单到哪里去了（点名表扬 Sept（

求第 $k$ 大，自然联想到二分。二分的过程好理解，主要是二分的 check 怎么写。

设要 check 的是 $mid$，则我们要求满足：

$$\frac{a_ic_i+a_jc_j}{a_i+a_j} \ge mid$$

的数对 $(i,j)$ 的个数是否大于 $0$。

考虑化简上面那个不等式：

$$\begin{aligned}a_ic_i+a_jc_j &\ge mid(a_i+a_j)\\a_ic_i+a_jc_j&\ge mid\ a_i+mid\ a_j\\(c_i-mid)a_i& \ge (mid-c_j) a_j\end{aligned}$$

左右都可以算，于是问题演变成了求数对个数使得 $a_i \ge b_j$ 的问题。

官方题解给的是双指针的做法，这里提供一种归并做法。

首先先把归并排序模板套上，也就是给序列排个序，排序的同时可以直接执行计算。因为我们都知道归并排序的时候会存在一个值 $pil$，将需要排序的区间 $a_{[l,r]}$ 拆分为三个部分：$<pil$ 的，$=pil$ 的和 $>pil$ 的，然后再分别排序。那么问题其实可以转化为在区间 $b_{[l,r]}$ 中固定一个值 $k$，寻找有多少个数小于 $k$，可以直接将归并里的 $pil$ 设为 $k$，然后在函数里排序的同时进行操作。最终在题目中实现的时候就从 $1$ 到 $n$ 枚举 $a_i$ 然后在 $b_{[1,n]}$ 中归并查找即可。

然后这题就做完了。