# 题目

[传送门](https://www.luogu.com.cn/problem/CF1336C)

# 题解

考虑构想一下最终情况：在 $S$ 的前 $i$ 位已经以某种放入方式放进 $A$ 之后，$T$ 成为了 $A$ 的前缀，然后 $T$ 的 $i+1$ 到 $lenS$ 位直接放入 $A$ 的后面（显然 $i$ 有可能为 $lenS$），如果我们直接枚举这个 $i$，显然很难做，考虑往前退一步的情况，一共就两种情况：

1. $S$ 的第 $i$ 位直接放入 $A$ 的后面；
2. $S$ 的第 $i$ 位放到了 $A$ 的前面；

对于第一种情况，说明 $A$ 在 $S[i]$ 放入之前，其前缀就已经是 $T$ 了，即 $S[1...i-1]$ 构成了 $T$

对于情况二，说明$S[i]$ 还未放入时 $A$ 的前缀是 $T[2...lenT]$，即 $S[1...i-1]$ 构成了 $T[2...lenT]$

考虑再往前退一步？四种情况

1. 1. $S$ 的第 $i-1$ 位直接放入 $A$ 的后面；
   2. $S$ 的第 $i-1$ 位放到了 $A$ 的前面；
2. 1. $S$ 的第 $i-1$ 位直接放入 $A$ 的后面；
   2. $S$ 的第 $i-1$ 位放到了 $A$ 的前面；

对于 $1.1$，说明 $A$ 在 $S[i],S[i-1]$ 放入之前，其前缀已经是 $T$，即 $S[1...i-2]$ 构成了 $T$

对于 $1.2$，说明 $A$ 在 $S[i],S[i-1]$ 放入之前，其前缀是 $T[2...lenT]$，且 $T[1]=S[i-1]$，即 $S[1...i-2]$ 构成了 $T[2...lenT]$

对于 $1.3$，说明 $A$ 在 $S[i],S[i-1]$ 放入之前，其前缀是 $T[2...lenT]$，且 $T[1]=S[i]$，即 $S[1...i-2]$ 构成了 $T[2...lenT]$

对于 $1.4$，说明 $A$ 在 $S[i],S[i-1]$ 放入之前，其前缀是 $T[3...len]$，且 $T[2]=S[i-1],T[1]=S[i]$，即 $S[1...i-2]$ 构成了 $T[3...len]$

再往前面退...通过看上面的分析中“即...”部分，我们会发现，**总是 $S[1...x]$ 构成了 $T[l...r]$，然后考虑加入 $S[x+1]$ 会发生什么**

**这就是这道题的子状态，只需将其写作状态**，即定义状态 $f[l][r]$ 为 $S[1...r-l+1]$ 构成 $T[l...r]$ 的部分的方案数

对于这个状态，首先有初始化 $f[i][i]=2,S[1]=T[i]$，然后考虑转移：

1. 如果 $S[r-l+1]=T[r]$，则 $f[l][r]+=f[l][r-1]$；
2. 如果 $S[r-l+1]=T[l]$，则 $f[l][r]+=f[l+1][r]$；

但是直到这里，我们求的都是用 $S$ 构成 $T$ 的方案数，但是题目只要求 $T$ 成为 $A$ 的前缀，而我们的状态定义显然有 $i>lenT$ 的部分，对于这些部分，我们进行特殊定义：

> 当 $i>lenT$ 时，$T[i]$ 可以为任意字符。

这样这个方法就完整了，最后的答案显然为
$$
\sum_{i=lenT}^{lenS}f[1][i]
$$

# 代码

```cpp
https://www.cnblogs.com/Arextre/p/13394160.html
```

