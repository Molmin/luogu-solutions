显然操作一是建立在字符集上的询问。

一种简单的想法是对于每个字符询问出他左边第一个和他一样的字符，这种做法是 $n\log n$ 的。二分过程是平凡的，只需要记录一下之前的字符的前缀和即可。

进一步，很多询问是无效的，容易发现我们真正关心的位置是每个字符的最后一次出现的位置，因此在字符集上二分就好，$n\log 26$.