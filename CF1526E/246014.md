## CF1526E 【Oolimry and Suffix Array】

### 题意

+ 长度为 $n$ 的字符串 $s$ 的编号为 $i$ 的后缀为 $s[i,n-1]$；
+ 把字符串 $s$ 的所有后缀按升序排序后，所有后缀对应的编号按后缀排序后的顺序组成的数组为字符串 $s$ 的后缀数组；
+ 给出一个长度为 $n$，字符集大小为 $k$ 的字符串的后缀数组，求有多少种可能的字符串；
+ $n,k\le2\times10^5$。

### 做法

要且只要所有大小相邻的后缀满足大小关系，整个字符串就是合法的。

如果后缀 $i$ 小于后缀 $j$，则 $s_i\le s_j$。如果 $s_i<s_j$，则一定满足后缀 $i$ 小于后缀 $j$；如果 $s_i=s_j$，只有后缀 $i+1$ 小于后缀 $j+1$ 时，才满足后缀 $i$ 小于后缀 $j$。综上，我们只需要知道后缀 $i+1$ 和后缀 $j+1$ 的大小关系就可以判断 $s_i=s_j$ 是否成立，而我们已经知道了后缀数组，所以不难判断。

由上，我们可以推出 $1\le s_{a_1}\le(<) s_{a_2}\le(<)\dots\le(<)s_{a_n}\le k$，此时每个位置的符号已经唯一确定，我们需要求多少个数组 $s$ 满足上式。

发现有两种符号不好处理，不妨把每个小于等于号后面所有数加上一，把小于等于号转换成小于号，原式等价于 $1<s_{a_1}<s_{a_2}<\dots<s_{a_n}<k+b$，$b$ 为原式中小于等于号的个数。

满足上述式子的方案数式经典的计数模型，答案为 $C_{k+b+n}^n$。