现在有 $n$ 条线 $m$ 个平衡器，平衡器从左往右，第 $i$ 个平衡器连接了 $x_i,y_i(x_i<y_i)$，你需要给平衡器定向，定向后的平衡器若是从 $x_i$ 指向 $y_i$，则你从 $x_i$ 走到这个平衡器时会跑到 $y_i$，你需要给出满足和不满足以下条件的定向方案或判断无解：从每根线的最左面出发一直向右走，最后都会走到同一根线的最右面。$n\leqslant 50000,m\leqslant 100000$。

##### 满足条件

假设我们最后全走到了 $t$，我们记录 $vis_i$ 表示现在从 $i$ 开始走是否会走到 $t$，我们从右往左添加平衡器，一开始只有 $vis_t=1$，若现在添加的平衡器为 $(x,y)$，分类讨论：

- 若 $vis_x=vis_y=0$ 或 $vis_x=vis_y=1$ 怎么调都不会改变。
- 若 $vis_x=1,vis_y=0$，把平衡器设为 $y\rightarrow x$ 可以让 $vis_y$ 也变成 $1$。
- 若 $vis_y=1,vis_x=0$ 类似上面。

注意到这等价于把 $vis_x$ 和 $vis_y$ 都赋值为两者的或，所以我们可以用 bitset 来加速枚举，每一位表示终点为 $i$ 的答案，这样添加一个平衡器就等价于把两个 bitset 或起来，复杂度 $O(\dfrac{nm}{w})$。

##### 不满足条件

由于 $m>0$，所以若 $n=2$ 一定无解。下面的构造方式证明了 $n>2$ 时一定有解。

我们设 $end_i$ 表示 $i$ 目前最后会走到哪里，$siz_i$ 表示最终会走到 $i$ 的线的数量。那么我们只需要保证对任意 $i$，$siz_i<n$。我们依旧从后向前添加平衡器，一开始 $end_i=i,siz_i=1$。假设现在添加的是 $(x,y)$，我们发现，这等价于要不然把 $end_x$ 改为 $end_y$，要不然把 $end_y$ 改为 $end_x$。注意到这会使 $siz_{end_x}$ 或 $siz_{end_y}$ 加上 $1$，所以当 $siz_{end_x}=n-1$ 时定向为 $x\rightarrow y$ 即可，$siz_{end_y}=n-1$ 时同理，注意到由于 $n>2,2n-2>n$，所以不会出现两个都为 $n-1$ 的情况。如果两个都不为 $n-1$ 任意定向即可。复杂度 $O(n+m)$。