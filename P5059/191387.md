新手第一篇题解，望包涵。

题意：在 $n\times n$ 的棋盘**格点**上放置若干棋子，使每行有至少两枚棋子且棋子两两不能横向相邻，求放置方法数。

核心思想：数列代换

解：

容易发现，每行之间不会相互影响。

设在长度为 $a$ 的一行中放置 $b$ 个子的方法数为 $A(a, b)\:(a, b\in\mathbb{N})$，则有:

$A(a, b)=A(a-1, b)+A(a-2, b-1)\:(b>1)$

其中第一项对应最后一格不放棋子的方法数，第二项对应最后一格放棋子的方法数。

令 $f(x)=\sum_{i=2}^{x}A(x, i)$，则有

$f(x)=f(x-1)+f(x-2)+A(x-2, 1)$，

即 $f(x)=f(x-1)+f(x-2)+x-2$.

观察到该数列的相邻项之比与 $\frac{\sqrt{5}+1}{2}$ 接近，考虑其与斐波那契数列的关系。

~~直接上OEIS，此题解决~~

经过~~Excel乱算~~观察，发现 $f(x)-f(x-1)=F(x)-1$，故所求即 $\Sigma F(i)-x$.

由斐波那契数列定义 $F(x)=F(x-1)+F(x-2)\:(x\ge3)$，有

$\sum F(x)=(F(2)+...+F(x-1))+(F(1)+...+F(x-2))+F(1)+F(2)$

即 $\sum F(x)=\sum F(x-1)+\sum F(x-2)+1$.

$\sum F(i)$ 的形式就类似于 $F(i+1)$. 

由定义，有 $\sum F(x)=\sum F(x-1)+F(x)$：

若 $\sum F(x)=F(x+2)-1$，有

$\sum F(x+1)=F(x)+F(x-1)-1=F(x+3)-1$.

观察有 $\sum F(1)=F(3)-1$.

由数学归纳法，$\forall x\ge1$，$\sum F(x)=F(x+1)-1+F(x)=F(x+2)-1$.

代入可得 $f(x)=F(x+2)-x-1$，而题目所求结果为 $f(n+1)^{n+1}\bmod p$，求算即可。时间复杂度 $O(\log^2n)$，不会 T。快速幂 + 快速倍增，遂 A。


------------


代码太烂，恕不附。




