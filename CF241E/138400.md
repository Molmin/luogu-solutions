呐，???? ycx 来补差分约束了？

我们考虑如果已知所有边的边权，那么如何判是否合法。考虑搞个 DP，$dp_i$ 表示 $1\to i$ 的所有路径的长度集合大小为 $1$ 的情况下的最短路。注意 DP 过程中如果遇到不为 $1$ 的直接输出不合法。然后这个地方有个坑点：题目只要求 $1\to n$ 的路径长度唯一，并不要求其他的长度为一，也就是对于那些不在任何一条 $1\to n$ 路径上的点，我们 dark 当他不存在。

那么我们能够通过一个合法的 DP 数组还原出每条边的权。于是我们只需要找出一组合法的 DP 数组。它显然要满足，对于所有边 $(x,y)$，都有 $dp_y-dp_x\in\{1,2\}$。那么可以列出不等式，然后差分约束。（注意这里似乎还要满足 $dp_1=0$，不过无伤大雅，我们只研究 DP 值与 DP 值的差）

时间复杂度 $\mathrm O(nm)$。

**_[code](https://www.luogu.com.cn/paste/hhggn836)_**