设 $d = a_n - a_1$，考虑 $n = 2$ 的情况，发现任意时刻 $a_1$ 可对 $d$ 取模。因此，答案即 $a_1\bmod d$ 的最小值加上 $d$。

通过不断选最大值将所有点拉到一个足够远的地方，消除不可以碰到负轴的限制。

考虑到选 $a_i$ 做轴会将最小值改变 $(2a_i - a_n) - a_1$，而因为 $a_1\equiv a_n\pmod d$，所以最小值模 $d$ 会改变 $2(a_i - a_1)$。但操作后 $a_1$ 和 $a_n$ 交换了相对位置，此时再选择 $a_i$ 则会抵消掉前一次操作。没有关系，在两次操作之间操作一次端点即可。

换言之，如果 $a_i$ 在某个奇数次被操作，又在某个偶数次被操作，则这两次操作可以抵消。我们只需要在操作之间插入不改变 $a_1\bmod d$ 的两端操作，即可让每个 $a_i$ 对 $a_1\bmod d$ 的贡献取到任意倍 $2(a_i - a_1)$。

根据裴蜀定理，$a_1\bmod d$ 的最小值即 $\gcd(d, 2(a_i - a_1))$。时间复杂度 $\mathcal{O}(n)$。[代码](https://atcoder.jp/contests/arc152/submissions/36888421)。