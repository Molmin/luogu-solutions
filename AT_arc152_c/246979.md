### 题意

给定一个严格单增的正整数序列 $a$。你可以执行以下操作任意次（包括 $0$ 次）：
- 选择序列中的一个数 $s$，然后对于序列中的每个数 $a_i$，将其替换为 $2s-a_i$。注意，只有当操作后序列中不存在负数时，该操作才可以被执行。

你希望通过执行若干次操作使序列的最大值尽可能地小。请求出这个最小化的最大值。

------------

将序列画到数轴上。考虑每一次操作的实质，可以发现其实质为选取数轴上的一个点，并将所有点以该点为对称中心翻转。

由此我们可以得到两条性质：
- 进行任何一次操作，其最大值与最小值之差不变。
- 不论如何操作，点分布的整体形态不变，即要么和初始的分布相同，要么是初始分布翻转后的结果。

对于第二条性质而言，设其中提到的两种分布形态为状态 $A$ 和 $B$，并令初始状态为 $A$，则每次操作要么使序列从状态 $A$ 变为状态 $B$，要么使其从状态 $B$ 变回状态 $A$。这启发我们每个点对于最小值的贡献只有两种情况，且和奇偶性有关。

不妨先考虑第一次操作。设操作的数为 $a_i$，则翻转后原先的最大值变为最小值，即最小值由 $a_1$ 变为了 $2a_i-a_n$。也即，操作 $a_i$ 对最小值的贡献为 $a_1+a_n-2a_i$。不妨令其为 $b_i=\left|a_1+a_n-2a_i\right|$。

进一步，设现在某次操作后为状态 $A$，则相当于对点进行整体平移 $x$ 的位置，易见即使平移过后，操作 $a_i$ 的贡献仍然为 $a_1+a_n-2a_i$。而对于状态 $B$，易见其贡献只是上值的相反数。因此我们可以断言：对于 $a_i$ 的操作，要么使最小值增加 $b_i$，要么使最小值减少 $b_i$，且符号取决于该次操作的编号的奇偶性。

考虑一种情况。假设我想在奇数次操作的时候对 $a_i$ 进行操作，但很不巧现在需要进行的又是第偶数次，怎么办呢？这时我们可以直接对 $a_n$ 进行操作，这样再操作就是第奇数次了。而消除 $a_n$ 操作的方法也很简单，在某个时候再进行一次操作把序列翻回来即可。

综上所述，我们将问题转化为了：给定序列 $b$，求将 $a_1$ 加上 $b_1,b_2,\dots,b_n$ 的线性组合后能够得到的最小非负值。

根据裴蜀定理，$b_1,b_2,\dots,b_n$ 的非负线性组合的最小值为 $\gcd(b_1,b_2,\dots,b_n)$（不妨设其为 $d$），且其他非负线性组合均为其倍数。因此 $a_1\bmod d$ 就是能够得到的最小值。再将其加上原序列最大值与最小值的差即是能够得到的最大值。

[***code***](https://www.luogu.com.cn/paste/uwjtchuh)

------------
官方题解和该题解的做法是本质相同的。如果你不理解，只需将该题解的 $a_n-a_1$ 换进官方题解。