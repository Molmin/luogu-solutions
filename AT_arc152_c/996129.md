在数轴上考虑，易得一次操作相当于选定对称轴翻转。

任意时刻只存在两种相对状态——原状态和翻转状态，且和操作奇偶性相关。

令 $d=a_n-a_1$，通过不断以最小值为轴翻转，可知任意时刻 $a_1$ 可对 $d$ 取模。

不断以最大值为轴翻转，可以剔除 $a_i\ge 0$ 的限制。

考察以 $a_i$ 为轴翻转，最小值由 $a_1\to 2a_i-a_n$，增加了 $2a_i-a_1-a_n$，由于 $a_1$ 同余 $a_n\pmod d$，对 $a_1\bmod d$ 的贡献即 $2(a_i-a_1)$。再操作一次会相互抵消。

通过不断以最大值为轴翻转，可以剔除操作奇偶性的限制。

由裴蜀定理可得，$2(a_i-a_1)$ 的线性组合为 $k\cdot \gcd(d,\gcd_i2(a_i-a_1))$。故 $a_1$ 最小可以达到 $a_1\bmod \gcd(d,\gcd_i 2(a_i-a_1))$。
