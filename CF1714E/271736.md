观察个位数就可以得到一些变换的规律。

譬如：$1\to2\to4\to8\to6\to2\to\cdots$ 是有循环节的。

考虑 $0\sim 9$ 之间的联系，可以得到下图：

![](https://cdn.luogu.com.cn/upload/image_hosting/7nf2i26w.png)

这是 $0\sim 9$ 每个数经过变换后得到结果形成的一幅有向图。

$7\to14\to18\to26\to32\to\cdots$ 在此图中就表示为 $7\to4\to8\to6\to2\to\cdots$

可以发现，图中有一个由 $2,4,8,6$ 组成的环，即：若一列数的个位能变成 $2,4,8,6$ 中的任何一个，就能变成其他三个，并且增量为 $20$。因为 $2\to4\to8\to16\to22$ 一圈的增量是 $22-2=20$。也就是说，在保证个位不变的情况下，十位可以每次增加 $2$（奇偶性不变）。

我们得到这样一个结论：判断序列中每一个数个位能否变成 $2$ 并加上对应的增量，若之后的每一个数的十位奇偶性相同，则一定可以变成同一个个位为 $2$ 的数。

通过图中的关系我们可以发现，一个数的个位若为 $1,2,3,4,6,7,8,9$，则都可以通过加上固定的增量变成 $2$。可以提前手算出增量数组：$add[10]=\{-1,1,0,9,18,-1,6,25,14,23\}$，其中 $-1$ 表示无法达到。

然后我们再关注这无法达到的两个数 $0,5$。$5$ 只能变换一次变成个位为 $0$，直接计算即可。

- 注意：在判断序列是否每个数都相同时，需要特判或排除 $a[0],a[n+1]$ 的情况。譬如：`if(a[i]==a[i-1])cnt++;` 是错的，需要 `if(a[i]==a[i-1]&&i!=1)cnt++;`。因为 $a_i$ 可能为 $0$！！！

较为简洁的代码：

```cpp
const int MAXN=2e5+5;
int t,n,a[MAXN],add[10]={-1,1,0,9,18,-1,6,25,14,23};

int main(){
	t=read();
	while(t--){
		n=read();
		int cnt=0;
		for(int i=1;i<=n;++i){
			a[i]=read();
			if(a[i]%10==5)a[i]+=5;
			if(a[i]==a[i-1]&&i!=1)cnt++;
		}
		if(cnt==n-1){puts("YES");continue;}
		cnt=0;
		for(int i=1;i<=n;++i){
			if(add[a[i]%10]==-1)break;
			a[i]+=add[a[i]%10];a[i]/=10;a[i]&=1;
			if(a[i-1]==a[i]&&i!=1)cnt++;
		}
		if(cnt==n-1){puts("YES");continue;}
		puts("NO");
	}
	return 0;
}
```