设序列中有 $a$ 个 $1$，$b$ 个 $-1$。

分类讨论：

1. $a\le b$

这种情况答案的下界为 $1$ 并且容易构造。令不存在两个连续的 $1$ 即可。

一种特殊情况是 $a=0$ 此时最大子段和为 $-1$。不过也满足不存在两个连续的 $1$。

答案是 $\dbinom {b+1}{a}$

2. $a>b$

显然，答案的下界为 $a-b$。并且这个下界容易构造。构造 $1,-1$ 交替的序列，最后多余的 $1$ 放到末尾即可。

实际上，这个序列达到下界的充要条件是每个前缀的和均在 $[0,a-b]$。

充分性：

不存在两个前缀和做差 $>a-b$，所以不存在任何一个区间的和 $>a-b$，满足条件。

必要性：

若有前缀的和 $<0$，那么砍掉这个前缀，剩余的序列和就超过了 $a-b$；

若有前缀的和 $>a-b$，那么这个前缀就不满足条件。

证毕。

这个也可以 dp。

朴素做法时间复杂度 $O(n^2)$，存在线性算法。