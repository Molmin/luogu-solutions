一个直接冲的做法

记深度为 $i$ 的叶子数量为 $f_i$，其 OGF 为 $F$. 设当前最小非零项的次数为 $d$，那么我们做一次变换就是

$$
F\leftarrow (1+x^d)F-x^d
$$

一次变换会使 $f_d$ 减一，我们要做 $f_d$ 次这样的变换，利用线性递推的知识容易知道将 $f_d$ 减为 $0$ 时得到

$$
F\leftarrow (1+x^d)^{f_d}F-x^d
$$

令 $G=1-F$，就有

$$
G\leftarrow (1+x^d)^{-g_d}G
$$

两边取对数，可以每次在 $\Theta(n/d)$ 的复杂度内完成 $\ln G$ 的转移. 而还原系数时，由于低于 $d$ 次的项全部为 $0$，所以我们有 $[x^d]\ln G=[x^d] G$，这样就不用做 exp 了. 当然做了也无所谓，复杂度还是 $\Theta(n\log n)$ 