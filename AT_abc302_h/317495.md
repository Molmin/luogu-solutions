~~/se /se /se~~

### 题意

给定一棵 $n$ 个点的树，每个点有两个球 $(a_i,b_i)$。对于 $v=2,\dots,n$，求在 $1$ 到 $v$ 的路径上每个点取一个球，最多能取得多少种不同的球。

$n \le 2 \times 10^5,1 \le (a_i,b_i) \le n$。

### 分析

先考虑对于一条路径怎么做，把路径抽出来，抽象成一个数组。如果对于 $1 \le i \le m$，$a_i$ 和 $b_i$ 连边，一条边只能取一段，那么一个连通块的答案显然是 $\min(E,V)$。

考虑这怎么放到树上，加边操作很好做，上个并查集解决问题；关键在于删除，显然树上的点先进先出，那么可以套一个可撤销并查集（**注意不带路径压缩**）。哇，你做完了（~~当然你还要码一码~~）！

复杂度 $\mathcal O(n\log n)$。

### Code

提交记录：<https://atcoder.jp/contests/abc302/submissions/43494342>。