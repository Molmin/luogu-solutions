考虑将一个糖果看作一个有向图游戏，因为一个位置在 $i$ 的糖果可以分裂成一个位置在 $j$ 和一个位置在 $k$ 的糖果($i \lt j \le k$)，因此可以看作 $i$ 的后继状态是子游戏 $j$ 和子游戏 $k$ 的和。因此根据 SG 函数的定义，$SG_i=mex\left\{\begin{matrix}SG_j \bigoplus SG_k|i \lt j \le k \end{matrix}\right\}$，然后我们便可以暴力求出每个位置的球的 $SG$ 的值，然后我们又可以发现，我们只需关心一个位置的球的个数的奇偶性（因为后手总是能与先手做同样的操作），所以根据 SG 定理，我们将所有的球个数为奇数的 $SG$ 值异或起来的值 $sum$ 便是最终的胜负状态，至于求第一步的方案数和第一步字典序最小的操作，我们只需枚举 $i,j,k$ 看是否将对手逼入了必败态，即看 $sum\bigoplus SG_i \bigoplus SG_j \bigoplus SG_k$ 是否为 $0$。这样就可以求出了方案数和字典序最小的方案了。