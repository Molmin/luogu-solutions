- **题意**：

多组询问，每次给定 $n$ 个二元组 $(a_i,b_i)$，保证任意两个二元组的 $a_i$ 或者 $b_i$ 至少一个不同。求从这 $n$ 个二元组中选三个满足 $a_i$ 或者 $b_i$ 至少一个两两不同的方案数。

$\sum n\leq 2\cdot 10^5,a_i,b_i\leq n$。

- **做法**：

考虑容斥，总方案数为 $n\choose3$，转化为求选三个二元组满足 $a_i,b_i$ 均存在相等的方案数。

先思考一下选的过程：我们选定一个二元组 $i$ 之后，必定会在 $a_i$ 相等的这些二元组中再选一个，我们把第二个选定的二元组称为 $j$。那么第三个选定的二元组 $k$ 必定满足 $b_i=b_k$ 或者 $b_j=b_k$。

考虑优化，注意到值域很小，我们对每个 $a_i$ 开一个 `vector`，将二元组按 $a_i$ 分组，同时对每个 $b_i$ 开一个桶，统计对于每个 $b_i$ 统计二元组个数。一个二元组被选定的次数显然为所在的 `vector` 的大小减 $1$，对答案的贡献是这个二元组的 $b_i$ 对应的出现次数减 $1$，枚举 $a_i$ 计算即可。

时间复杂度为 $O(n)$。

- [代码](https://www.luogu.com.cn/paste/kpeukbtr)