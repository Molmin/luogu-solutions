提供一个单 $\log$ 的 SA 做法。

先把所有的串连起来。**询问串之间用小于 `a` 的字符连接。**

枚举 $T$ 的前缀，判断区间中是否存在一个子串满足是这个前缀加上一个字母，满足这个字母大于 $T$ 的前缀的后面一个字符。

如果前缀为 $T$ 本身，那么后面一个字符是极小的。这个显然满足字典序的定义。

然后就考虑在 SA 上二分出一个区间，满足区间中的后缀与 $T$ 的 LCP 长度**等于**正在枚举的 $T$ 的前缀长度 $len$。这个可以记录一下上次二分结果。

然后求这个区间中满足 $sa_i\in [l,r-len]$ 的最小的 $i$。

主席树维护后缀区间最小值即可。或者扫描线。

[评测记录](https://codeforces.com/contest/1037/submission/146886615)

我也不知道为什么我不太会 SAM 的单 $\log$ 解法。SA 着重刻画了字典序关系，是解决本题非常自然的工具。