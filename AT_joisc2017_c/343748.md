一道较为困难的贪心。


------------


首先看到题目要求最大的最小，马上想到二分速度，但是这个 $O(n)$ 的 check 函数并不是很好写。


------------


考虑贪心，读题我们可以先得到一些显然的结论：

1. 两个人相遇，肯定不会立刻点燃，而是会在一个人要灭的时候在点燃，这样可以使点燃的时间最长。

2. 人们肯定都会向手持烟火的那个人跑去。

3. 人们跑步的时候肯定会保持最大速度。


------------


通过以上几个结论，我们可以进行一些转换。

1. 我们发现可以把两个人相遇当成烟火燃烧时间加 $T$​​ 相遇后他们就相当于跟着拿烟火那个人跑。

2. 由于两两之间的距离是确定的，每个人的速度也是确定的，那么我们可以把他们之间的距离换成时间。
3. 手持烟花的人如果往一边跑，他另一边的人与他的距离不变，另一边以 2 倍速度减少。


------------


我们先想到了一个贪心，就是那烟火的人不停往离他最近的那个人跑。

看起来很有道理，但实际有反例。

![](https://cdn.luogu.com.cn/upload/image_hosting/dcnng91e.png)

如此图（三角形代表有烟火的人），原来他是可以走到左边，如按上述贪心，他会先向右走，如果这一段路程浪费了，他有可能走不到左边了，而他走到左边则能到右边。


------------


上述过程给我们了一个启示，就是我们可以把一些人当成一个组。

具体的，我们从拿烟花的那个人开始，到他左边第一个能使他烟火燃烧时间变长的位置分成一组，记录下这一组中能使他增长的时间与需要的时间，就是这个过程他烟火时间最少的时间。然后从这个点开始再一次找到第一个能使他烟火燃烧时间变长的位置分成一组，重复操作。

![](https://cdn.luogu.com.cn/upload/image_hosting/siotxm1a.png)

------------


如此图（三角形代表有烟火的人），需要时间为 2T，增加时间为 $\frac{1}{3}T$。

如果这样，我们发现当能选一组是一定要选，这样肯定不会使答案变劣。这样在除了最左边和最右边有一段不会优的，其他都可以处理。如果不行那么就是有一段没有解。

然后我们发现最后一段其实更与之前是一样的只要用相反的方法就好了。


------------


时间复杂度 $O(n \log n)$。

[代码](https://www.luogu.com.cn/paste/tgq12vhe)





