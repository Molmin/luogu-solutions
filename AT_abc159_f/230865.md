给一种题解区没有的做法，挺简单的吧。

一开题解区全是分析的高级 $01$ 背包，哈哈，我不会。

### 题目分析：

考虑一个最简单的问题，求 $[1,n]$ 的子序列有多少等于 $S$ 呢？

这东西显然可以生成函数，对于每一位，要么选要么不选，$a_i$ 的贡献就直接写成 $(1+x^{a_i})$，则整个函数表达出来就是：

$$f([1,n])=(1+x^{a_1})(1+x^{a_2}) \cdots (1+x^{a_n})$$

答案就是这个多项式的第 $S$ 项系数。

推广到原问题就是求 $l,r$ 满足 $1 \le l < r \le n$ 下的 $f([l,r])$ 的第 $S$ 项系数和。

直接做 $O(n^3)$ 的，有点难受，考虑点优化。

其实这个东西就是一个乘法分配律，用 $g_i$ 表示 $(1+x^{a_i})$，假如现在 $n=3$，把式子写出来：

$$g_1 + g_1 g_2 + g_1 g_2 g_3 + g_2 +g_2 g_3+g_3$$

提出来，

$$g_1(1+ g_2 +g_2 g_3)+g_2(1+g_3)+g_3$$

看明白了吗？化简后的式子第 $i$ 项的式子就是第 $i+1$ 项加 $1$ 再乘 $g_i$，第 $n$ 项就是 $g_n$。

要对它使用高级的 $\texttt{NTT}$ 吗？大可不必，大于 $S$ 的项永远不会对 $S$ 有贡献，所以我们只处理到 $S$，每次乘一个二项式，直接乘就是带两倍常数的 $O(S)$，整体复杂度 $O(nS)$。

或者直接对上面那个式子做类似 $01$ 背包的 dp，也是 $O(nS)$ 的，方法差不多，不再赘述。