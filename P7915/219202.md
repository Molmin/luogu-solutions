## 十四行诗
- 根据题意，我们第一次要么取出 $a_1$ , 要么取出 $a_{2n}$.

- 由对称性，我们只需研究取出 $a_1$ 时的情况.

- 根据题意，$\exists k \in (1,2n]$ $s.t.$ $a_1=a_k$

- 由回文性，$a_k$ 是我们最后取出的数。

- 在此之前，我们只能从左取出 $a_{2\cdots k-1}$ 中的数，也只能从右取出 $a_{k+1\cdots 2n}$ 中的数.

- 现在问题转化为如何顺次往 $a_{2\cdots k-1}$ 中插入   $a_{2n \cdots k + 1}$ 中的数，形成回文串.

- 初始时令数列 $u = a_{2\cdots k-1}$ , $v = a_{2n \cdots k + 1}$

- 这里我们只讨论$u$ , $v$ 大小均不小于二且 $u_1\ne v_1$ 的非平凡情况，其他平凡情况留作习题.

- 若 $\left\{u_1,v_1\right\}=\left\{u_{-1},v_{-1}\right\}$ , 那么如果先取 $v_1$ 可行，那么我们可以先取 $u_1$ 再取 $v_1$ 从而也可行，也更优，出于贪心，应先取 $u_1$.

- 另外，若 $u_1\in\left\{u_{-1},v_{-1}\right\}$,则先取 $u_1$.

- 否则，若 $v_1\in\left\{u_{-1},v_{-1}\right\}$,则先取 $v_1$.

- 否则，判为无解.

- 然后问题化小，继续处理两数列，直至平凡情况，可以求解.

- 时间复杂度严格线性.



