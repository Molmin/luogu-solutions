好像没有人用和我同一个思路分析的······

大致来说一下。

首先，期望是线性的，所以相当于要算出的是每一题答对题数的期望（拗口）。

也就是求每一题答对的概率。

也就是求相邻两题$a_i$和$a_{i+!}$答案相同的概率。

第一类：若$a_i\le a_{i+1}$.

那么对于上一题$gx选择的任意一个答案，**有$a_{i+1}$**的概率正确（恰好这题也是它）。

所以概率是$\frac{1}{a_{i+1}}$

第二类：否则。

**同理。**

对于这一题$gx选择的任意一个答案，**有$a_{i}$**的概率正确（恰好上题也是它）。

所以概率为$\frac{1}{a_{i}}$.

综上概率就是$\frac{1}{\max{a_{i},a_{i+1}}}$.

代码（~~真的需要吗~~）：
```cpp
#include<bits/stdc++.h>
using namespace std;
int n,A,B,C,a[10000009];
double ret;
int main(){
	scanf("%d%d%d%d%d", &n, &A, &B, &C, a + 1);
	for (int i = 2; i <= n; i++)
		a[i] = ((long long) a[i - 1] * A + B) % 100000001;
	for (int i = 1; i <= n; i++)
		a[i] = a[i] % C + 1;
	//以上：Ctrl+C+V的膜力。
	//主过程是后面一行（还有一行输出）。
	for(int i=1;i<=n;++i)ret+=1.0/max(a[i],a[i%n+1]);
	printf("%.3lf\n",ret);
    return 0;
}
```