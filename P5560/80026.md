（写一篇感性认识+不严谨数学证明的题解）

首先题意是——将n个节点连成一棵树，权值（相邻两点的$gcd$）最小。（一开始我还理解错了以为必须是相邻链接）

而相邻链接是我最开始的想法(10个点的情况)：

![](https://cdn.luogu.com.cn/upload/image_hosting/pmfx92ac.png)

显然有一个非常明显的规律：相邻两点之间gcd的值为1 1 3 1 1 3 1 1 3……

这也非常好证明：

记相邻两点权值为$(n+1)^2-1=n*(n+2),n^2-1=(n-1)*(n+1)$,显然$(n+2)$与$n$互质，$(n+1)$与$(n-1)$互质。那么唯一可能改变$gcd$的值的只能是$(n+2)$与$(n-1)$。而除了$3$之外它们不可能再有别的公因子，因为假设它们都能整除$p$($p>=3$且为质数)，显然$(n+2)-(n-1)=3$,不是$p$的因子，因此矛盾。所以只可能被三整除。而（n-1）是3倍数的情况一定是$0$、$0$、$1$（逻辑运算），那么$gcd$一定也是$1$、$1$、$3$。

但是这么做很快就被9的答案是8这个事实给打脸了。

因为它是这么做成的：

![](https://cdn.luogu.com.cn/upload/image_hosting/tdjxt6o9.png)

63并没有和48连，而是让48做了一个叶子节点。24也没有和15连而是与35连，做叶子节点。

这种方法成功的解决了所有边权为3的问题。而这种方法有什么特点？

**找规律！** 那就是：如果是3的倍数连8，如果是8的倍数连3，如果都是那就做叶子节点。

结果来了一个4与10……

![4个点的情况](https://cdn.luogu.com.cn/upload/image_hosting/m6rhb7uc.png)

![10个点的情况](https://cdn.luogu.com.cn/upload/image_hosting/ye3pu75v.png)

4个点时，24与其他三个点至少公因数是3，本可以用权值为1相连的35还尚未出现；10个点时，可以与120以权值为1相连的143也没出现，只好将就用3。

但是10之后呢？尝试了许多组数据发现都可以全部以1相连！

为什么呢？首先（与相邻两个点互质的这里不讨论，直接连接就行）对于与相邻点直接连接权值为3的点来说，3的倍数而非6的倍数的点来说，可以与8连；而对于6的倍数（不是11、13倍数）来说，可以与143连；如果都已经与143都不互质了呢（注意：如果前两个条件已经满足那么不会走到这一步）？那显然这个数已经比143大的多了，其中一定有其他的质数组合（例如：17* 19），使得权值也为1。依次类推，每次找不到8就找143、再找323……

（这里没有严格证明，纯属感性认知）

所以只要不是4与10，都可以找到权值全部为1的情况，答案就是$n-1$，而4与10都将其中一条边权值从1变成了3，所以答案为$n+1$。