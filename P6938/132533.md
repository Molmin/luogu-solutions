精通人性的谜语人男讲师只讲了一下求最大流的正确性还有什么乱七八糟的东西就讲完了，反正就是讲不完一道题了属于是，毕竟题目很简单是吧，流汗。           

我们首先去掉 $v$ 系数，丢进表达式中化一下简就可以发现是常数，所以直接设为 $1$ 最后算答案时除掉就好了。

这样就具有一个网络流模型的雏形了。

首先最大流的正确性其实还是挺关键的，可以通过反证法后分类讨论证明：显然想让原式表达式的值越大那么肯定两个正数越大越好是吧，那么不是最大流就是说残留网络上还存在至少一条增广路。         

对任意一条增广路进行讨论：           

- 没有反向边的增广路，此时直接流过去显然会让原表达式值更大；

- 有反向边的增广路但全是水的反向边，这个显然也直接流；

- 有反向边并且该增广路上有 Flubber 的反向边，这时我们注意到，如果要继续往下增广得到的路径可能会有 Flubber 和水对冲的情况，但是事实上在扔掉系数 $v$ 之后这两者的路径是可以互换的，进而这条增广路可以实现，个人印象中网络流的基础证明里面是有运用这个套路的。               

那么只要残留网络上存在一条增广路原式的值就不可能是最大的。         

通过建立超级源点 $S$，对 $1$ 和 $2$ 连容量无穷的边，容易求得原图最大流 $Z$。

接着我们考虑找到了最大流 $Z$ 后可以怎样求解原问题。           

由于 $F + W = Z$。对于原式，~~手动三分~~发现当 $F = aZ$ 时原式可以取得最大值，而且函数应该长成一个单峰的样子。                

我们不妨对于全图找到光是 Flubber 跑或水跑可以得到的最大流，记其为 $Fmax,Wmax$，那么显然 $F \in [Wmax - Fmax,Fmax]$ 并且由于流的值是实数，对于这个区间中的任何一个数 $F$ 都能取到，之后分类讨论一下该区间在单峰函数上的位置情况后可以得到实际的 $F'$ 的取值，~~经典高一数学题~~。                   

再之后为了构造出来一组不对冲的方案，我们重新对网络流建模来构造方案：       
- 重新建原图，然后把 $(S,1)$ 的容量改为单向的 $F'$，把 $(S,2)$ 的容量改为单向的 $W'$；

- 跑一遍最大流，标记残留网络上每条边在一组最大流上的方向，原图中每条边的容量重新设定为在跑完最大流时该边的流量，这么做是为了分配这个流量给水和 Flubber。（若没读懂请反复理解）

- 最后将 $(S , 1)$ 的容量改为单向的 $F'$，将 $(S,2)$ 的容量改为 $0$，重新跑一遍最大流后每条边的流量即是 Flubber 的流量，而容量减去流量就是水的流量，毕竟两者的流量相加总的容量。            

最后输出的时候可能会有一些 $-0.0$ 之类的情况可能要手判一下，不清楚spj 可不可以判这个。