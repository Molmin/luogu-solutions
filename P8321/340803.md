这个期望一眼假，直接算出权值和然后除以 $n!$。

注意到同时有颜色和大小两种约束，考虑强制钦定确定某种贡献。

显然不会去强制做掉颜色的限制，考虑将 $a,b$ 序列接起来，形成新的序列，记作 $c$，并从大到小排序。

这样有什么好处呢，我们发现对于 $c$ 中的任意一堆匹配，其权值是后面的数的值。

也就是，在计算一个数的匹配方案时，我们只关心前面有几个可以匹配的数了。

然后这个东西就可以 $\rm dp$ 了，记 $f(i,j)$ 表示考虑到 $c$ 中第 $i$ 个数，匹配了 $j$ 对的方案数。

记 $cnt(i,0/1)$ 表示 $c_{[1,i]}$ 中有几个来自 $a$ 或 $b$ 的，$v_i$ 表示 $c_i$ 来自哪里，则有：

$$f(i,j)=f(i-1,j)+f(i-1,j-1)\times (cnt(i,1-v_i)-j+1)\times c_i$$

然后就可以做了，记得有的数组开两倍大小。