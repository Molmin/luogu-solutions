设 $i$ 位置的期望是 $f_i$

（以下部分中，加'表示操作后的值）

注意到每次操作$i$，$f'_i = f_{i-1}+f_{i+1}-f_i$，时间复杂度 $O(mk)$。

移项发现 $f'_i-f_{i-1}=f_{i+1}-f_i$，$f_{i+1}-f'_i=f_i-f_{i-1}$，设$d_i=d_{i+1}-d_i$，则 $d'_i=d_{i+1}, d'_{i+1}=d_i$，相当于交换$d_i$ 与 $d_{i+1}$。每一轮相当于一个置换，然后倍增，大概是对一个置换快速幂。
