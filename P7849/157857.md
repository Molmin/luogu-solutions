首先我们考虑一个乱序等差数列的两个位置 $i,j$，可以根据公差表示为如下式子：

$$A_i+d(j'-i')\equiv A_j \pmod p$$

其中 $i',j'$ 为等差数列排序后 $A_i,A_j$ 所在的位置。

对于 $A_i,A_j$ 可以通过询问 $2$ 来获取在模意义下的值，对于 $i',j'$ 可以通过询问 $1$ 来获得。

具体地，我们可以询问 $n-1$ 次 $i$ 与其他位置的大小关系，从而得知它在排序后等差序列的位置，也就是 $i'$。

$i,j$ 可以随机，也可以自己假定。

然后可得:

$$d\equiv (A_j-A_i)\times inv(j'-i') \pmod p$$

其中 $inv$ 表示逆元。

总询问次数为 $n-1+n-1+1+1=2n$，问题解决。

对于询问 $1$ 次数我一开始是没打算限制的，后来验题的时候发现可以用 $n$ 次询问 $2$ 求出乱序等差数列每个数在模意义下的值，就可以求出公差。

然后懒得改了，就限制了一下这种方法，给了个部分分，就有了 $q$ 的限制。

然后就是 sort 的做法会被卡。

因为 STL 的 sort 询问上限是 $\mathcal O(n\log n)$ 次，然后就不能通过本题，然后因为交互库写的比较丑，就会出现 RE，TLE，WA 等问题。

还有就是每次输入要换行。