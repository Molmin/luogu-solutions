$n$ 一定在根不停向右走的最后一个节点，则 $n$ 与根节点奇偶性相同

由于是完全二叉树，所以 $root=\lfloor\dfrac n2\rfloor\text{或}\lceil \dfrac n2\rceil$

则可以知道对于一个 $n$ 只有一种合法的根节点，由于 $root$ 和 $n$ 奇偶性相同，所以它的右子树的大小为偶数

容易发现，$root$ 的左右子树为两个高度相同的合法树，或为两个高度相差为 $1$ 且高度较小的子树是完美二叉树

考虑使用大小为 $1$ 和 $2$ 的合法树构造其他的合法树

由于右子树一定是偶数，所以只有 $2$ 可以作为右子树，所以可以构造出的树大小为 $4$ 和 $5$

我们接着构造，可以发现，虽然大小为 $2$ 和 $4$ 的子树高度相差为 $1$，但 $2$ 这个树不是完美二叉树，同理，其他用 $1,2$ 和 $4,5$ 组合的情况也是不合法的

所以只能 $4,5$ 组合，$4$ 是偶数放在右子树，所以可以构造出的树为 $9,10$

以此类推

再证明唯一性，使用数学归纳法即可，大小为 $1,2$ 的树是唯一的，对于一棵合法的树，通过上面的构造方法可知，它的左右子树要么全是偶数且相同，要么一个偶数一个奇数，这两种情况一种交换后树不变，一种无法交换，而根据数学归纳法，左右子树都是唯一的，所以这棵树是唯一的

```cpp
int n,now;
int main()
{
	now = 1,n = read();
	while(now <= n)
	{
		if(now == n || now == n - 1) { puts("1");return 0; }
		now = now * 2 + 1 + (now & 1);
	}puts("0");
}
```