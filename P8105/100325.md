CF618E 来的 idea。

给一个[原题面](https://www.luogu.com.cn/problem/U168596)，我觉得我写的很好啊

题意：给定点集支持区间平移区间绕某个点旋转或位似，和询问区间点横坐标和纵坐标分别的平均数。

题解：

1.暴力。

2.维护区间旋转角度，区间加，线段树即可。

3.维护区间放大倍数，区间加，线段树即可。

4.维护区间平移，两个线段树即可。

5.暴力。

6.留给会正解但不完全会的选手。

7.留给常数大选手。

8.注意到区间旋转位似都可以拿矩阵维护，就相当于矩阵加和矩阵乘，或者用虚数维护。

对于平移操作，就是加上一个虚数。

对于旋转和位似操作，可以先把这个中心移到原点，再乘上一个虚数即可，维护区间加，区间乘即可。

复杂度 $O(n\log n)$。