给一张 $n$ 个点的图，有 $m$ 个三元组 $(a_i,b_i,c_i)$，表示 $a_i,b_i$ 间有两条边，$a_i\to b_i$ 的权为 $c_i$，$b_i\to a_i$ 的边权为 $-c_i$。$Q$ 组询问求两点间的最长路。如果不连通输出 ```nan```，如果最长路无限大输出 ```inf```。

```nan``` 是容易的，考虑怎么做 ```inf```。注意到，如果 $x,y$ 所在连通块内存在一个正环 $l$，那么必然是 ```inf```。进一步发现，如果 $l$ 为负环，那么 $\overline l$ （即反向的 $l$）由定义可知其为正环。因此可以得知：$x,y$ 间不是 ```inf```，当且仅当其所在连通块内所有环边权之和为 $0$。

如果暴力找环的话，环的数量有可能非常多。但是注意到，上述结论本质上等价于：连通块中，任意两点 $u,v$ 均满足 $u$ 到 $v$ 的所有路径权值和相等。那么使用 **[dfs 最短路](https://www.luogu.com.cn/problem/P8881)** 可以在线性时间内得到答案。

具体而言，随便挑一个点 $u$ 开始 dfs，过程中维护当前走过路径的权值和 $dis$。每次到达一个走过的点 $v$ 时，上一次到 $v$ 的路径权值和 $d_v$ 与 $dis$ 不等，则整个连通块都完蛋了；否则返回。

复杂度 $O(n+m+(n+Q)\alpha(n))$。容易实现至 $O(n+m+Q)$。