简要题意：求拓补序，但是对每个点的编号有范围限制。只需输出一种方案即可。

很 naive 的思路第 $i$ 次选择是在出度为 $0$ 的且 $l_x \geq i$ 的点里面选，优先选 $r_x$ 最小的。但是被 hack 了，比如一个图形如 $1[1-3]\rightarrow 2[2-2]$，然后 $3[1-2]$ 单出来（中括号表示点的拓补序范围限制）。合法方案是 $1,2,3$，但是贪心会先选 $3$，再选 $1$，非法了。

显然的优化思路是把 $r_1$ 与 $r_2-1$  取 min，也就是反着拓补一遍，把 $r_u$ 向其后继节点 $\min r_v-1$ 取 min。

图片是官方英语题解证明的中文翻译（~~虽然是 chatgpt 写的但是我自己看懂了~~），证明里的 $R$ 是取 min 处理之后得到的。你发现根据证明，取 min 过程不减一也是对的。

![](https://cdn.luogu.com.cn/upload/image_hosting/3bk434h9.png)