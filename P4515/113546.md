本题的若干篇洛谷题解中大部分用到了容斥原理，不过遗憾的是，所有容斥原理的题解的复杂度都止步于 $O(2^n\times n)$ 的指数级别。

但我们有一种简单的方法，可以将容斥原理的复杂度优化到 $O(n^3)$。

这是一个变形的容斥原理，我们可以知道答案一定可以写成每个子集的交乘上一个系数求和。

事实上稍加推导可以发现，大小为 $m$ 的子集的容斥系数为 $(-2)^{m-1}$，提供一个归纳性证明：
$$
\dfrac{(-1)^{m-1}+1}{2}-\sum\limits_{i=1}^{m-1}\binom m i\times (-2)^{i-1}=\dfrac{(-1)^{m-1}+1+(-1)^m-1-(-2)^{m}}{2}=(-2)^{m-1}
$$
我们可以考虑枚举一个三角形 $Tri$，求交集为 $Tri$ 的子集的容斥系数和。

而这可以再套一层三维差分的容斥，转化为计算八个形如“包含 $Tri$ 的所有三角形集合的所有子集的容斥系数和”的东西。

这一点是容易的，设包含 $Tri$ 的三角形有 $m$ 个，则系数和为：
$$
\sum\limits_{i=1}^m\binom m i\times (-2)^{i-1}=\dfrac{(-1)^{m}-1}{-2}
$$
也即当 $m$ 为偶数时系数为 $0$，否则系数为 $1$。

枚举三角形的三条边并通过三维差分计算即可，时间复杂度 $O(n^3)$。