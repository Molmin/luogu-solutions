看了下题解区，感觉最后有人是乱判的素数，有人甚至用上了 Miller-Rabin、Min_25 筛？建议做一下 [这题](https://www.luogu.com.cn/problem/P1835)。

其实乱做一下就好了。$b\ge 3$ 的情形没啥可讲，直接切入正题 $b=2$，发现只需算某个区间的素数个数。虽然左右端点都是 $10^9$ 级别，但目测一下就有 $[10^9,10^9+2.1\times 10^6]$ 中有超过 $10^5$ 个素数。于是区间长度就被变成了 $10^6$。

考虑这时咋做。由于合数 $n$ 必有一小于 $\sqrt n$ 的素因子，因此只用先筛出来 $[1,4\times 10^4]$ 中的所有素数，再用类似埃筛的思想筛出大区间里的所有素数。由于大区间的长度不大，所以复杂度只有 $O(k\ln k\ln n)$。再加上 $b\ge 3$ 部分的复杂度，跑起来应该还是很快的。